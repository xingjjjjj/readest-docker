(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,427133,t=>{"use strict";let e="http://www.w3.org/XML/1998/namespace",r="http://www.w3.org/2001/10/synthesis",i=new Set(["article","aside","audio","blockquote","caption","details","dialog","div","dl","dt","dd","figure","footer","form","figcaption","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","math","nav","ol","p","pre","section","tr"]),n=t=>t.lang||t?.getAttributeNS?.(e,"lang")||(t.parentElement?n(t.parentElement):null),s=t=>t?.getAttributeNS?.(e,"lang")||(t.parentElement?s(t.parentElement):null),l=t=>!t.toString().trim();class a{#t=[];#e;#r=-1;#i;constructor(t,e=t=>t){this.#e=t,this.#i=e}current(){if(this.#t[this.#r])return this.#i(this.#t[this.#r])}first(){if(this.#t[0])return this.#r=0,this.#i(this.#t[0])}prev(){let t=this.#r-1;if(this.#t[t])return this.#r=t,this.#i(this.#t[t])}next(){let t=this.#r+1;if(this.#t[t])return this.#r=t,this.#i(this.#t[t]);for(;;){let{done:e,value:r}=this.#e.next();if(e)break;if(this.#t.push(r),this.#t[t])return this.#r=t,this.#i(this.#t[t])}}find(t){let e=this.#t.findIndex(e=>t(e));if(e>-1)return this.#r=e,this.#i(this.#t[e]);for(;;){let{done:e,value:r}=this.#e.next();if(e)break;if(this.#t.push(r),t(r))return this.#r=this.#t.length-1,this.#i(r)}}}class h{#n;#s;#l;#a=new XMLSerializer;constructor(t,h,o,g,u){this.doc=t,this.highlight=g,this.#n=new a(function*(t){let e,r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);for(let n=r.nextNode();n;n=r.nextNode()){let r=n.tagName.toLowerCase();i.has(r)&&(e&&(e.setEndBefore(n),l(e)||(yield e)),(e=t.createRange()).setStart(n,0))}e||(e=t.createRange()).setStart(t.body.firstChild??t.body,0),e.setEndAfter(t.body.lastChild??t.body),l(e)||(yield e)}(t),t=>{let{entries:i,ssml:l}=((t,i,l,a)=>{let h=n(t.commonAncestorContainer),o=s(t.commonAncestorContainer),g=((t="en",e="word")=>{let r=new Intl.Segmenter(t,{granularity:e}),i="word"===e;return function*(t,e){let n=t.join("").replace(/\r\n/g,"  ").replace(/\r/g," ").replace(/\n/g," "),s=0,l=-1,a=0,h=Array.from(r.segment(n)),o=[];for(let t=0;t<h.length;t++){let e=h[t],r=h[t+1],i=e.segment.trim(),n=r?.segment?.trim(),s=/(?:^|\s)([A-Z][a-z]{1,5})\.$/.test(i),l=/^[A-Z]/.test(n||"");if(s&&l){let i={index:e.index,segment:e.segment+(r?.segment||""),isWordLike:!0};o.push(i),t++}else o.push(e)}for(let{index:r,segment:h,isWordLike:g}of o){if(i&&!g)continue;for(;a<=r;)a+=t[++l].length;let o=l,u=r-(a-t[l].length),f=r+h.length-1;if(f<n.length)for(;a<=f;)a+=t[++l].length;let m=l,d=f-(a-t[l].length)+1;yield[(s++).toString(),e(o,u,m,d)]}}})(h,a),u=t.cloneContents(),f=[...i(t,g,l)];for(let[t,e]of[...i(u,g,l)]){let r=document.createElement("foliate-mark");r.dataset.name=t,e.insertNode(r)}let m=((t,i,n)=>{let s=document.implementation.createDocument(r,"speak"),{lang:l}=n;l&&s.documentElement.setAttributeNS(e,"lang",l);let a=(t,n,l)=>{let h;if(!t)return;if(3===t.nodeType)return s.createTextNode(t.textContent);if(4===t.nodeType)return s.createCDATASection(t.textContent);if(1!==t.nodeType&&11!==t.nodeType||i&&i(t)===NodeFilter.FILTER_REJECT)return;let o=t.nodeName.toLowerCase();"foliate-mark"===o?(h=s.createElementNS(r,"mark")).setAttribute("name",t.dataset.name):"br"===o?h=s.createElementNS(r,"break"):("em"===o||"strong"===o)&&(h=s.createElementNS(r,"emphasis"));let g=t.lang||t.getAttributeNS?.(e,"lang");g&&(h||(h=s.createElementNS(r,"lang")),h.setAttributeNS(e,"lang",g));let u=t.getAttributeNS?.(r,"alphabet")||l;if(!h){let e=t.getAttributeNS?.(r,"ph");e&&(h=s.createElementNS(r,"phoneme"),u&&h.setAttribute("alphabet",u),h.setAttribute("ph",e))}h||(h=n);let f=t.firstChild;for(;f;){let t=a(f,h,u);t&&h!==t&&h.append(t),f=f.nextSibling}return h};return a(t,s.documentElement,n.alphabet),s})(u,l,{lang:h,alphabet:o});return{entries:f,ssml:m}})(t,h,o,u);return this.#s=new Map(i),[l,t]})}#h(t,e){return e?t.querySelector(`mark[name="${CSS.escape(e)}"`):null}#o(t,e){if(!t)return;if(!e)return this.#a.serializeToString(t);let i=document.implementation.createDocument(r,"speak");i.documentElement.replaceWith(i.importNode(t.documentElement,!0));let n=e(i)?.previousSibling;for(;n;){let t=n.previousSibling??n.parentNode?.previousSibling;n.parentNode.removeChild(n),n=t}return this.#a.serializeToString(i)}start(){this.#l=null;let[t]=this.#n.first()??[];return t?this.#o(t,t=>this.#h(t,this.#l)):this.next()}resume(){let[t]=this.#n.current()??[];return t?this.#o(t,t=>this.#h(t,this.#l)):this.next()}prev(t){this.#l=null;let[e,r]=this.#n.prev()??[];return t&&r&&this.highlight(r.cloneRange()),this.#o(e)}next(t){this.#l=null;let[e,r]=this.#n.next()??[];return t&&r&&this.highlight(r.cloneRange()),this.#o(e)}prevMark(t){let e=Array.from(this.#s.keys());if(0===e.length)return;let r=this.#l?e.indexOf(this.#l):-1;if(r>0){let i=e[r-1],n=this.#s.get(i);if(n){this.#l=i,t&&this.highlight(n.cloneRange());let[e]=this.#n.current()??[];return this.#o(e,t=>this.#h(t,i))}}else{let[e,r]=this.#n.prev()??[];if(e&&r){let i=Array.from(this.#s.keys());if(!(i.length>0))return this.#l=null,t&&this.highlight(r.cloneRange()),this.#o(e);{let r=i[i.length-1],n=this.#s.get(r);if(n)return this.#l=r,t&&this.highlight(n.cloneRange()),this.#o(e,t=>this.#h(t,r))}}}}nextMark(t){let e=Array.from(this.#s.keys());if(0===e.length)return;let r=this.#l?e.indexOf(this.#l):-1;if(r>=0&&r<e.length-1){let i=e[r+1],n=this.#s.get(i);if(n){this.#l=i,t&&this.highlight(n.cloneRange());let[e]=this.#n.current()??[];return this.#o(e,t=>this.#h(t,i))}}else{let[e,r]=this.#n.next()??[];if(e&&r){let i=Array.from(this.#s.keys());if(!(i.length>0))return this.#l=null,t&&this.highlight(r.cloneRange()),this.#o(e);{let r=i[0],n=this.#s.get(r);if(n)return this.#l=r,t&&this.highlight(n.cloneRange()),this.#o(e,t=>this.#h(t,r))}}}}from(t){let e;this.#l=null;let[r]=this.#n.find(e=>0>=t.compareBoundaryPoints(Range.END_TO_START,e));for(let[r,i]of this.#s.entries())if(0>=t.compareBoundaryPoints(Range.START_TO_START,i)){e=r;break}return this.#o(r,t=>this.#h(t,e))}setMark(t){let e=this.#s.get(t);if(e)return this.#l=t,this.highlight(e.cloneRange()),e}}t.s(["TTS",()=>h])}]);