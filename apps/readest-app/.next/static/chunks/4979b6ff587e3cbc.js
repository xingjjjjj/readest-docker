(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,680472,e=>{e.v({name:"@readest/readest-app",version:"0.9.97",private:!0,scripts:{dev:"dotenv -e .env.tauri -- next dev",build:"dotenv -e .env.tauri -- next build",start:"dotenv -e .env.tauri -- next start","dev-web":"dotenv -e .env.web -- next dev","build-web":"dotenv -e .env.web -- next build","start-web":"dotenv -e .env.web -- next start","build-tauri":"dotenv -e .env.tauri -- next build","i18n:extract":"i18next-scanner",lint:"eslint .",test:"dotenv -e .env -e .env.test.local vitest",tauri:"tauri",clippy:"cargo clippy -p Readest --no-deps -- -D warnings","prepare-public-vendor":"mkdirp ./public/vendor/pdfjs ./public/vendor/simplecc","copy-pdfjs-js":'cpx "../../packages/foliate-js/node_modules/pdfjs-dist/legacy/build/{pdf.worker.min.mjs,pdf.min.mjs,pdf.d.mts}" ./public/vendor/pdfjs',"copy-pdfjs-wasm":'cpx "../../packages/foliate-js/node_modules/pdfjs-dist/wasm/{openjpeg.wasm,qcms_bg.wasm}" ./public/vendor/pdfjs',"copy-pdfjs-fonts":'cpx "../../packages/foliate-js/node_modules/pdfjs-dist/{cmaps,standard_fonts}/*" ./public/vendor/pdfjs',"copy-flatten-pdfjs-annotation-layer-css":'npx postcss "../../packages/foliate-js/vendor/pdfjs/annotation_layer_builder.css" --no-map -u postcss-nested > ./public/vendor/pdfjs/annotation_layer_builder.css',"copy-flatten-pdfjs-text-layer-css":'npx postcss "../../packages/foliate-js/vendor/pdfjs/text_layer_builder.css" --no-map -u postcss-nested > ./public/vendor/pdfjs/text_layer_builder.css',"copy-flatten-pdfjs-css":"pnpm copy-flatten-pdfjs-annotation-layer-css && pnpm copy-flatten-pdfjs-text-layer-css","copy-pdfjs":"pnpm copy-pdfjs-js && pnpm copy-pdfjs-wasm && pnpm copy-pdfjs-fonts && pnpm copy-flatten-pdfjs-css","copy-simplecc":'cpx "../../packages/simplecc-wasm/dist/web/*" ./public/vendor/simplecc',"setup-pdfjs":"pnpm prepare-public-vendor && pnpm copy-pdfjs","setup-simplecc":"pnpm prepare-public-vendor && pnpm copy-simplecc","setup-vendors":"pnpm setup-pdfjs && pnpm setup-simplecc","build-win-x64":"dotenv -e .env.tauri.local -- tauri build --target i686-pc-windows-msvc --bundles nsis","build-win-arm64":"dotenv -e .env.tauri.local -- tauri build --target aarch64-pc-windows-msvc --bundles nsis","build-linux-x64":"dotenv -e .env.tauri.local -- tauri build --target x86_64-unknown-linux-gnu --bundles appimage","build-macos-universial":"dotenv -e .env.tauri.local -e .env.apple-nonstore.local -- tauri build -t universal-apple-darwin --bundles dmg","build-macos-universial-appstore":"dotenv -e .env.tauri.local -e .env.apple-appstore.local -- tauri build -t universal-apple-darwin --bundles app --config src-tauri/tauri.appstore.conf.json","build-macos-universial-appstore-dev":"dotenv -e .env.tauri.local -e .env.apple-appstore-dev.local -- tauri build -t universal-apple-darwin --bundles app --config src-tauri/tauri.appstore-dev.conf.json","build-ios":"dotenv -e .env.ios-appstore-dev.local -- tauri ios build","build-ios-appstore":"dotenv -e .env.ios-appstore.local -- tauri ios build --export-method app-store-connect","release-macos-universial-appstore":"dotenv -e .env.tauri.local -e .env.apple-appstore.local -- bash scripts/release-mac-appstore.sh","release-ios-appstore":"dotenv -e .env.ios-appstore.local -- bash scripts/release-ios-appstore.sh","release-google-play":"dotenv -e .env.google-play.local -- bash scripts/release-google-play.sh","config-wrangler":'sed -i "s/\\${TRANSLATIONS_KV_ID}/$TRANSLATIONS_KV_ID/g" wrangler.toml',preview:"pnpm patch-build-webpack && NEXT_PUBLIC_APP_PLATFORM=web opennextjs-cloudflare build && pnpm restore-build-original && opennextjs-cloudflare preview --ip 0.0.0.0 --port 3001",deploy:"pnpm patch-build-webpack && NEXT_PUBLIC_APP_PLATFORM=web opennextjs-cloudflare build && pnpm restore-build-original && opennextjs-cloudflare deploy",upload:"pnpm patch-build-webpack && NEXT_PUBLIC_APP_PLATFORM=web opennextjs-cloudflare build && pnpm restore-build-original && opennextjs-cloudflare upload","cf-typegen":"wrangler types --env-interface CloudflareEnv cloudflare-env.d.ts","patch-build-webpack":'if [ "$(uname)" = "Darwin" ]; then sed -i \'\' \'s/next build"/next build --webpack"/\' package.json; else sed -i \'s/next build"/next build --webpack"/\' package.json; fi',"restore-build-original":'if [ "$(uname)" = "Darwin" ]; then sed -i \'\' \'s/next build --webpack"/next build"/\' package.json; else sed -i \'s/next build --webpack"/next build"/\' package.json; fi',"update-metadata":"bash ./scripts/sync-release-notes.sh release-notes.json ../../data/metainfo/appdata.xml","check:optional-chaining":"count=$(grep -rno '\\?\\.[a-zA-Z_$]' .next/static/chunks/* out/_next/static/chunks/* | wc -l); if [ \"$count\" -gt 0 ]; then echo '❌ Optional chaining found in output!'; exit 1; else echo '✅ No optional chaining found.'; fi","check:translations":"count=$(grep -rno '__STRING_NOT_TRANSLATED__' public/locales/* | wc -l); if [ \"$count\" -gt 0 ]; then echo '❌ Untranslated strings found!'; exit 1; else echo '✅ All strings translated.'; fi","check:lookbehind-regex":"count=$(grep -rnoE '\\(\\?<[!=]' .next/static/chunks/* out/_next/static/chunks/* | wc -l); if [ \"$count\" -gt 0 ]; then echo '❌ Lookbehind regex found in output!'; exit 1; else echo '✅ No lookbehind regex found.'; fi","check:all":"pnpm check:translations && pnpm check:lookbehind-regex","build-check":"pnpm build && pnpm build-web && pnpm check:all"},dependencies:{"@choochmeque/tauri-plugin-sharekit-api":"^0.3.0","@fabianlars/tauri-plugin-oauth":"2","@opennextjs/cloudflare":"^1.14.7","@serwist/next":"^9.4.2",jose:"^5.9.6","@tauri-apps/api":"2.9.1","@tauri-apps/plugin-cli":"^2.4.1","@tauri-apps/plugin-deep-link":"^2.4.6","@tauri-apps/plugin-dialog":"^2.6.0","@tauri-apps/plugin-fs":"^2.4.5","@tauri-apps/plugin-haptics":"^2.3.2","@tauri-apps/plugin-http":"^2.5.6","@tauri-apps/plugin-log":"^2.8.0","@tauri-apps/plugin-opener":"^2.5.3","@tauri-apps/plugin-os":"^2.3.2","@tauri-apps/plugin-process":"^2.3.1","@tauri-apps/plugin-shell":"~2.3.4","@tauri-apps/plugin-updater":"^2.9.0","@tauri-apps/plugin-websocket":"~2.4.2","@zip.js/zip.js":"^2.7.53","abortcontroller-polyfill":"^1.7.8",clsx:"^2.1.1",cors:"^2.8.5",dayjs:"^1.11.13",dompurify:"^3.3.0","foliate-js":"workspace:*","franc-min":"^6.2.0","highlight.js":"^11.11.1",i18next:"^24.2.0","i18next-browser-languagedetector":"^8.0.2","i18next-http-backend":"^3.0.1","iso-639-2":"^3.0.2","iso-639-3":"^3.0.1","isomorphic-ws":"^5.0.0","js-md5":"^0.8.3","jwt-decode":"^4.0.0",marked:"^15.0.12",next:"16.0.10",overlayscrollbars:"^2.11.4","overlayscrollbars-react":"^0.5.6","posthog-js":"^1.246.0",react:"19.2.0","react-color":"^2.19.3","react-dom":"19.2.0","react-i18next":"^15.2.0","react-icons":"^5.4.0","react-responsive":"^10.0.0","react-virtuoso":"^4.17.0","react-window":"^1.8.11",semver:"^7.7.1","styled-jsx":"^5.1.7",tinycolor2:"^1.6.0",uuid:"^11.1.0",ws:"^8.18.3",zod:"^4.0.8",zustand:"5.0.6"},devDependencies:{"@next/bundle-analyzer":"^15.4.2","@tailwindcss/typography":"^0.5.16","@tauri-apps/cli":"2.9.6","@testing-library/dom":"^10.4.0","@testing-library/react":"^16.3.0","@types/cors":"^2.8.17","@types/cssbeautify":"^0.3.5","@types/node":"^22.15.31","@types/react":"18.3.12","@types/react-color":"^3.0.13","@types/react-dom":"18.3.1","@types/react-window":"^1.8.8","@types/semver":"^7.7.0","@types/tinycolor2":"^1.4.6","@types/uuid":"^10.0.0","@types/ws":"^8.18.1","@typescript-eslint/eslint-plugin":"^8.48.0","@typescript-eslint/parser":"^8.48.0","@vitejs/plugin-react":"^5.1.1",autoprefixer:"^10.4.20","caniuse-lite":"^1.0.30001746",cpx2:"^8.0.0",daisyui:"^4.12.24","dotenv-cli":"^7.4.4",eslint:"^9.16.0","eslint-config-next":"16.0.0","eslint-plugin-jsx-a11y":"^6.10.2","i18next-scanner":"^4.6.0",jsdom:"^26.1.0",mkdirp:"^3.0.1","node-env-run":"^4.0.2",postcss:"^8.4.49","postcss-cli":"^11.0.0","postcss-nested":"^7.0.2","raw-loader":"^4.0.2",serwist:"^9.3.0",tailwindcss:"^3.4.18",typescript:"^5.7.2","vite-tsconfig-paths":"^5.1.4",vitest:"^4.0.15",wrangler:"^4.56.0"}})},480893,163967,392631,190463,e=>{"use strict";var t=e.i(374517),r=e.i(917409);let n=new class{async pullChanges(e,t,r,n){return console.log("[SyncClient] Cloud sync disabled (local storage mode)"),{books:null,configs:null,notes:null}}async pushChanges(e){return console.log("[SyncClient] Cloud sync disabled (local storage mode)"),{books:null,configs:null,notes:null}}},a=(0,r.createContext)({syncClient:n});e.s(["SyncProvider",0,({children:e})=>(0,t.jsx)(a.Provider,{value:{syncClient:n},children:e}),"useSyncContext",0,()=>(0,r.useContext)(a)],480893);var o=e.i(128818),i=e.i(329748),s=e.i(431263);let l=[{id:"none",name:"None",url:"",loaded:!0},{id:"concrete",name:"Concrete",url:"/images/concrete-texture.png",loaded:!0},{id:"paper",name:"Paper",url:"/images/paper-texture.png",loaded:!0},{id:"sand",name:"Sand",url:"/images/sand-texture.jpg",loaded:!0},{id:"parchment",name:"Parchment",url:"/images/parchment-paper.jpg",loaded:!0},{id:"scrapbook",name:"Scrapbook",url:"/images/scrapbook-texture.jpg",loaded:!0},{id:"leaves",name:"Leaves",url:"/images/leaves-pattern.jpg",loaded:!0},{id:"moon",name:"Moon Sky",url:"/images/moon-sky.jpg",loaded:!0},{id:"night-sky",name:"Night Sky",url:"/images/night-sky.jpg",loaded:!0}];function u(e){let t=(0,i.getFilename)(e).replace(/\.(jpg|jpeg|png|gif|bmp|webp)$/i,"");return{id:(0,s.md5Fingerprint)(t),name:t,path:e}}let c="background-texture",p=(e,t)=>{let r=e.getElementById(c)||e.createElement("style");r.id=c,r.textContent=`
    .sidebar-container, .notebook-container, .foliate-viewer {
      position: relative;
    }

    body::before, .sidebar-container::before, .notebook-container::before,
    .foliate-viewer::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 0;
      background-image: url("${t.blobUrl||t.url}");
      background-repeat: repeat;
      background-size: var(--bg-texture-size, cover);
      mix-blend-mode: var(--bg-texture-blend-mode, multiply);
      opacity: var(--bg-texture-opacity, 0.6);
    }
    body::before {
      height: 100vh;
    }
    `,r.parentNode||e.head.appendChild(r)},d=e=>{let t=e.getElementById(c);t&&t.parentNode&&t.parentNode.removeChild(t)};e.s(["PREDEFINED_TEXTURES",0,l,"createCustomTexture",()=>u,"mountBackgroundTexture",0,p,"unmountBackgroundTexture",0,d],163967);var g=e.i(424439);function f(e){let{blobUrl:t,loaded:r,error:n,...a}=e;return a}let m=(0,o.create)((e,t)=>({textures:[],loading:!1,setTextures:t=>e({textures:t}),addTexture:r=>{let n=u(r),a=t().textures.find(e=>e.id===n.id);if(a)return t().updateTexture(n.id,{...n,path:n.path,downloadedAt:Date.now(),deletedAt:void 0,loaded:!1,blobUrl:void 0,error:void 0}),e(e=>({textures:[...e.textures]})),a;let o={...n,downloadedAt:Date.now()};return e(e=>({textures:[...e.textures,o]})),o},removeTexture:r=>{let n=t().getTexture(r);if(!n)return!1;n.blobUrl&&URL.revokeObjectURL(n.blobUrl);let a=t().updateTexture(r,{deletedAt:Date.now(),blobUrl:void 0,loaded:!1,error:void 0});return e(e=>({textures:[...e.textures]})),a},updateTexture:(r,n)=>{let a=t().textures.findIndex(e=>e.id===r);return -1!==a&&(e(e=>({textures:e.textures.map((e,t)=>t===a?{...e,...n}:e)})),!0)},getTexture:e=>t().textures.find(t=>t.id===e),getAllTextures:()=>t().textures,getAvailableTextures:()=>t().textures.filter(e=>!e.deletedAt),clearAllTextures:()=>{let{textures:r}=t();r.forEach(e=>{e.blobUrl&&URL.revokeObjectURL(e.blobUrl)}),e({textures:[]})},loadTexture:async(e,r)=>{let n=t().getTexture(r);if(!n)throw Error(`Texture with id "${r}" not found`);if(n.deletedAt)throw Error(`Texture "${n.name}" has been deleted`);if(n.loaded&&n.blobUrl&&!n.error)return n;try{t().updateTexture(r,{loaded:!1,error:void 0});let a=await e.getAppService(),o=await a.openFile(n.path,"Images"),i=n.path.split(".").pop()?.toLowerCase(),s=new Blob([await o.arrayBuffer()],{type:{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",bmp:"image/bmp"}[i||""]||"image/jpeg"}),l=URL.createObjectURL(s);return t().updateTexture(r,{blobUrl:l,loaded:!0,error:void 0}),t().getTexture(r)}catch(n){let e=n instanceof Error?n.message:"Unknown error";throw t().updateTexture(r,{loaded:!1,error:e,blobUrl:void 0}),n}},loadTextures:async(r,n)=>{e({loading:!0});try{return(await Promise.allSettled(n.map(e=>t().loadTexture(r,e)))).filter(e=>"fulfilled"===e.status).map(e=>e.value)}finally{e({loading:!1})}},loadAllTextures:async e=>{let r=t().getAvailableTextures().map(e=>e.id);return await t().loadTextures(e,r)},unloadTexture:e=>{let r=t().getTexture(e);return r?.blobUrl&&URL.revokeObjectURL(r.blobUrl),t().updateTexture(e,{blobUrl:void 0,loaded:!1,error:void 0})},unloadAllTextures:()=>{let e=t().getAllTextures();e.forEach(e=>{e.blobUrl&&URL.revokeObjectURL(e.blobUrl)}),e.forEach(e=>{t().updateTexture(e.id,{blobUrl:void 0,loaded:!1,error:void 0})})},getLoadedTextures:()=>t().getAvailableTextures().filter(e=>e.loaded&&!e.error),isTextureLoaded:e=>{let r=t().getTexture(e);return r?.loaded===!0&&!r.error&&!r.deletedAt},applyTexture:async(e,r)=>{let n=t().getAvailableTextures(),a=[...l,...n].find(e=>e.id===r);a&&"none"!==a.id?(n.find(e=>e.id===r)&&!t().isTextureLoaded(r)&&(a=await t().loadTexture(e,r)),p(document,a)):d(document)},loadCustomTextures:async r=>{try{let{settings:n}=g.useSettingsStore.getState(),a=t().textures;if(n?.customTextures){let o=n.customTextures.map(e=>{let t=a.find(t=>t.id===e.id);return{...e,loaded:t?.loaded||!1,error:t?.error,blobUrl:t?.blobUrl}});e({textures:o}),await t().loadAllTextures(r)}}catch(e){console.error("Failed to load custom textures settings:",e)}},saveCustomTextures:async e=>{try{let{settings:r,setSettings:n,saveSettings:a}=g.useSettingsStore.getState(),{textures:o}=t();r.customTextures=o.map(f),n(r),a(e,r)}catch(e){throw console.error("Failed to save custom textures settings:",e),e}}}));window.addEventListener("beforeunload",()=>{m.getState().getAllTextures().forEach(e=>{e.blobUrl&&URL.revokeObjectURL(e.blobUrl)})}),e.s(["useCustomTextureStore",0,m],392631);var v=e.i(981441);e.s(["useEinkMode",0,()=>{let{setIsEinkMode:e}=(0,v.useThemeStore)();return{applyEinkMode:(0,r.useCallback)(t=>{e(t),t?document.body.classList.add("no-transitions"):document.body.classList.remove("no-transitions"),document.documentElement.setAttribute("data-eink",t.toString())},[e])}}],190463)},329748,e=>{"use strict";var t=e.i(99500),r=e.i(62725);let n=async(...e)=>await (0,t.join)(...e);e.s(["getBaseFilename",0,e=>{let t=e.replace(/\\/g,"/").split("/").pop()||"",r=t.split(".");return r.length<=1?t:r.slice(0,-1).join(".")},"getDirPath",0,e=>{let t=e.replace(/\\/g,"/").split("/");return t.pop(),t.join("/")},"getFilename",0,e=>(((0,r.isValidURL)(e)||(0,r.isContentURI)(e)||(0,r.isFileURI)(e))&&(e=decodeURI(e)),e.replace(/\\/g,"/").split("/").pop().split("?")[0]),"joinPaths",0,n])},266765,e=>{"use strict";var t=e.i(62725);let r=e=>{if(!e)return"auto";let t=new Set(["ar","he","fa","ur","dv","ps","sd","yi"]),r=e.split("-")[0].toLowerCase();return t.has(r)?"rtl":"auto"};e.s(["getDirFromLanguage",0,r,"getDirFromUILanguage",0,()=>r((0,t.getUserLang)())])},431263,e=>{"use strict";var t=e.i(805143);function r(e){return/^[0-9a-f]{32}$/.test(e)}function n(e){return(0,t.md5)(e).slice(0,7)}async function a(e){let r=t.md5.create();for(let t=-1;t<=10;t++){let n=Math.min(e.size,1024<<2*t),a=Math.min(n+1024,e.size);if(n>=e.size)break;let o=e.slice(n,a),i=new Uint8Array(await o.arrayBuffer());r.update(i)}return r.hex()}e.s(["isMd5",()=>r,"md5Fingerprint",()=>n,"partialMD5",()=>a])},99500,e=>{"use strict";var t,r,n=e.i(871611);async function a(){return(0,n.invoke)("plugin:path|resolve_directory",{directory:r.AppConfig})}async function o(){return(0,n.invoke)("plugin:path|resolve_directory",{directory:r.AppData})}async function i(){return(0,n.invoke)("plugin:path|resolve_directory",{directory:r.AppCache})}async function s(){return(0,n.invoke)("plugin:path|resolve_directory",{directory:r.Document})}async function l(){return(0,n.invoke)("plugin:path|resolve_directory",{directory:r.AppLog})}async function u(){return(0,n.invoke)("plugin:path|resolve_directory",{directory:r.Temp})}async function c(...e){return(0,n.invoke)("plugin:path|join",{paths:e})}async function p(e,t){return(0,n.invoke)("plugin:path|basename",{path:e,ext:t})}(t=r||(r={}))[t.Audio=1]="Audio",t[t.Cache=2]="Cache",t[t.Config=3]="Config",t[t.Data=4]="Data",t[t.LocalData=5]="LocalData",t[t.Document=6]="Document",t[t.Download=7]="Download",t[t.Picture=8]="Picture",t[t.Public=9]="Public",t[t.Video=10]="Video",t[t.Resource=11]="Resource",t[t.Temp=12]="Temp",t[t.AppConfig=13]="AppConfig",t[t.AppData=14]="AppData",t[t.AppLocalData=15]="AppLocalData",t[t.AppCache=16]="AppCache",t[t.AppLog=17]="AppLog",t[t.Desktop=18]="Desktop",t[t.Executable=19]="Executable",t[t.Font=20]="Font",t[t.Home=21]="Home",t[t.Runtime=22]="Runtime",t[t.Template=23]="Template",e.s(["BaseDirectory",()=>r,"appCacheDir",()=>i,"appConfigDir",()=>a,"appDataDir",()=>o,"appLogDir",()=>l,"basename",()=>p,"documentDir",()=>s,"join",()=>c,"tempDir",()=>u])},141886,e=>{"use strict";e.i(262504);let t=()=>!1,r=null,n=async()=>{if(!r){let{WebAppService:t}=await e.A(377298);r=new t,await r.init()}return r};e.s(["default",0,{getAppService:async()=>{let e=window.__TAURI__;if(!t()||!e)return n()}},"getAPIBaseUrl",0,()=>"http://localhost:3000/api","getNodeAPIBaseUrl",0,()=>"http://localhost:3000/api","hasCli",0,()=>!0===window.__READEST_CLI_ACCESS,"isPWA",0,()=>window.matchMedia("(display-mode: standalone)").matches,"isTauriAppPlatform",0,t,"isWebAppPlatform",0,()=>!0])},341537,e=>{"use strict";var t=e.i(871611);async function r(e){return await (0,t.invoke)("plugin:native-bridge|copy_uri_to_path",{payload:e})}async function n(e){await (0,t.invoke)("plugin:native-bridge|use_background_audio",{payload:e})}async function a(e){return await (0,t.invoke)("plugin:native-bridge|install_package",{payload:e})}async function o(e){return await (0,t.invoke)("plugin:native-bridge|set_system_ui_visibility",{payload:e})}async function i(){return await (0,t.invoke)("plugin:native-bridge|get_status_bar_height")}let s=null;async function l(){if(s)return s;let e=await (0,t.invoke)("plugin:native-bridge|get_sys_fonts_list");return s=e,e}async function u(e){await (0,t.invoke)("plugin:native-bridge|intercept_keys",{payload:e})}async function c(e){await (0,t.invoke)("plugin:native-bridge|lock_screen_orientation",{payload:e})}async function p(){return await (0,t.invoke)("plugin:native-bridge|get_system_color_scheme")}async function d(){return await (0,t.invoke)("plugin:native-bridge|get_safe_area_insets")}async function g(){return await (0,t.invoke)("plugin:native-bridge|get_screen_brightness")}async function f(e){return await (0,t.invoke)("plugin:native-bridge|set_screen_brightness",{payload:e})}async function m(){return await (0,t.invoke)("plugin:native-bridge|get_external_sdcard_path")}async function v(){return await (0,t.invoke)("plugin:native-bridge|select_directory")}e.s(["copyURIToPath",()=>r,"getExternalSDCardPath",()=>m,"getSafeAreaInsets",()=>d,"getScreenBrightness",()=>g,"getStatusBarHeight",()=>i,"getSysFontsList",()=>l,"getSystemColorScheme",()=>p,"installPackage",()=>a,"interceptKeys",()=>u,"invokeUseBackgroundAudio",()=>n,"lockScreenOrientation",()=>c,"selectDirectory",()=>v,"setScreenBrightness",()=>f,"setSystemUIVisibility",()=>o])},233878,e=>{"use strict";var t=e.i(917409),r={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=t.default.createContext&&t.default.createContext(r);e.s(["DefaultContext",()=>r,"IconContext",()=>n])},57290,e=>{"use strict";var t=e.i(374517),r=e.i(917409);let n=(0,r.createContext)(void 0);e.s(["AuthProvider",0,({children:e})=>{let[a,o]=(0,r.useState)(()=>localStorage.getItem("token")),[i,s]=(0,r.useState)(()=>{{let e=localStorage.getItem("user");return e?JSON.parse(e):null}});(0,r.useEffect)(()=>{(async()=>{if(a&&!i)try{let e=await fetch("/api/auth/verify",{headers:{Authorization:`Bearer ${a}`}});if(e.ok){let t=await e.json();s(t.user),localStorage.setItem("user",JSON.stringify(t.user))}else localStorage.removeItem("token"),localStorage.removeItem("user"),o(null),s(null)}catch(e){console.error("Token verification failed:",e),localStorage.removeItem("token"),localStorage.removeItem("user"),o(null),s(null)}})()},[a,i]);let l=async()=>{console.log("Logging out");try{await fetch("/api/auth/logout",{method:"POST",headers:{Authorization:`Bearer ${a}`}})}catch(e){console.error("Logout request failed:",e)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),o(null),s(null)}};return(0,t.jsx)(n.Provider,{value:{token:a,user:i,login:(e,t)=>{console.log("Logging in as",t.username),o(e),s(t),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t))},logout:l,isLoggedIn:!!a&&!!i},children:e})},"useAuth",0,()=>{let e=(0,r.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}])},724475,(e,t,r)=>{"use strict";r.match=function(e,t){return l(e).some(function(e){var r=e.inverse,n="all"===e.type||t.type===e.type;if(n&&r||!(n||r))return!1;var a=e.expressions.every(function(e){var r=e.feature,n=e.modifier,a=e.value,o=t[r];if(!o)return!1;switch(r){case"orientation":case"scan":return o.toLowerCase()===a.toLowerCase();case"width":case"height":case"device-width":case"device-height":a=p(a),o=p(o);break;case"resolution":a=c(a),o=c(o);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":a=u(a),o=u(o);break;case"grid":case"color":case"color-index":case"monochrome":a=parseInt(a,10)||1,o=parseInt(o,10)||0}switch(n){case"min":return o>=a;case"max":return o<=a;default:return o===a}});return a&&!r||!a&&r})},r.parse=l;var n=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,a=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,o=/^(?:(min|max)-)?(.+)/,i=/(em|rem|px|cm|mm|in|pt|pc)?$/,s=/(dpi|dpcm|dppx)?$/;function l(e){return e.split(",").map(function(e){var t=(e=e.trim()).match(n),r=t[1],i=t[2],s=t[3]||"",l={};return l.inverse=!!r&&"not"===r.toLowerCase(),l.type=i?i.toLowerCase():"all",l.expressions=(s=s.match(/\([^\)]+\)/g)||[]).map(function(e){var t=e.match(a),r=t[1].toLowerCase().match(o);return{modifier:r[1],feature:r[2],value:t[2]}}),l})}function u(e){var t,r=Number(e);return r||(r=(t=e.match(/^(\d+)\s*\/\s*(\d+)$/))[1]/t[2]),r}function c(e){var t=parseFloat(e);switch(String(e).match(s)[1]){case"dpcm":return t/2.54;case"dppx":return 96*t;default:return t}}function p(e){var t=parseFloat(e);switch(String(e).match(i)[1]){case"em":case"rem":return 16*t;case"cm":return 96*t/2.54;case"mm":return 96*t/2.54/10;case"in":return 96*t;case"pt":return 72*t;case"pc":return 72*t/12;default:return t}}},342716,(e,t,r)=>{"use strict";var n=e.r(724475).match,a="undefined"!=typeof window?window.matchMedia:null;function o(e,t,r){var o,i=this;function s(e){i.matches=e.matches,i.media=e.media}a&&!r&&(o=a.call(window,e)),o?(this.matches=o.matches,this.media=o.media,o.addListener(s)):(this.matches=n(e,t),this.media=e),this.addListener=function(e){o&&o.addListener(e)},this.removeListener=function(e){o&&o.removeListener(e)},this.dispose=function(){o&&o.removeListener(s)}}t.exports=function(e,t,r){return new o(e,t,r)}},35305,(e,t,r)=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},561227,(e,t,r)=>{"use strict";var n=e.r(35305);function a(){}function o(){}o.resetWarningCache=a,t.exports=function(){function e(e,t,r,a,o,i){if(i!==n){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:a};return r.PropTypes=r,r}},304153,(e,t,r)=>{t.exports=e.r(561227)()},34970,e=>{"use strict";var t=e.i(917409),r=e.i(342716),n=/[A-Z]/g,a=/^ms-/,o={};function i(e){return"-"+e.toLowerCase()}let s=function(e){if(o.hasOwnProperty(e))return o[e];var t=e.replace(n,i);return o[e]=a.test(t)?"-"+t:t};var l=e.i(304153);let u=l.default.oneOfType([l.default.string,l.default.number]),c={all:l.default.bool,grid:l.default.bool,aural:l.default.bool,braille:l.default.bool,handheld:l.default.bool,print:l.default.bool,projection:l.default.bool,screen:l.default.bool,tty:l.default.bool,tv:l.default.bool,embossed:l.default.bool},{type:p,...d}={orientation:l.default.oneOf(["portrait","landscape"]),scan:l.default.oneOf(["progressive","interlace"]),aspectRatio:l.default.string,deviceAspectRatio:l.default.string,height:u,deviceHeight:u,width:u,deviceWidth:u,color:l.default.bool,colorIndex:l.default.bool,monochrome:l.default.bool,resolution:u,type:Object.keys(c)},g={minAspectRatio:l.default.string,maxAspectRatio:l.default.string,minDeviceAspectRatio:l.default.string,maxDeviceAspectRatio:l.default.string,minHeight:u,maxHeight:u,minDeviceHeight:u,maxDeviceHeight:u,minWidth:u,maxWidth:u,minDeviceWidth:u,maxDeviceWidth:u,minColor:l.default.number,maxColor:l.default.number,minColorIndex:l.default.number,maxColorIndex:l.default.number,minMonochrome:l.default.number,maxMonochrome:l.default.number,minResolution:u,maxResolution:u,...d};var f={...c,...g};let m=(0,t.createContext)(void 0),v=e=>{if(e)return Object.keys(e).reduce((t,r)=>(t[s(r)]=e[r],t),{})},b=()=>{let e=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{e.current=!0},[]),e.current},h=(e,n,a)=>{let o=(e=>{let r=(0,t.useContext)(m),n=()=>v(e)||v(r),[a,o]=(0,t.useState)(n);return(0,t.useEffect)(()=>{let e=n();!function(e,t){if(e===t)return!0;if(!e||!t)return!1;let r=Object.keys(e),n=Object.keys(t),a=r.length;if(n.length!==a)return!1;for(let n=0;n<a;n++){let a=r[n];if(e[a]!==t[a]||!Object.prototype.hasOwnProperty.call(t,a))return!1}return!0}(a,e)&&o(e)},[e,r]),a})(n),i=(e=>{let r=()=>{let t;return e.query||(t=[],Object.keys(f).forEach(r=>{let n=e[r];null!=n&&t.push(((e,t)=>{let r=s(e);if("number"==typeof t&&(t=`${t}px`),!0===t)return r;if(!1===t)return`not ${r}`;return`(${r}: ${t})`})(r,n))}),t.join(" and "))},[n,a]=(0,t.useState)(r);return(0,t.useEffect)(()=>{let e=r();n!==e&&a(e)},[e]),n})(e);if(!i)throw Error("Invalid or missing MediaQuery!");let l=((e,n)=>{let a=()=>(0,r.default)(e,n||{},!!n),[o,i]=(0,t.useState)(a),s=b();return(0,t.useEffect)(()=>{if(s){let e=a();return i(e),()=>{e&&e.dispose()}}},[e,n]),o})(i,o),u=(e=>{let[r,n]=(0,t.useState)(e.matches);return(0,t.useEffect)(()=>{let t=e=>{n(e.matches)};return e.addListener(t),n(e.matches),()=>{e.removeListener(t)}},[e]),r})(l),c=b();return(0,t.useEffect)(()=>{c&&a&&a(u)},[u]),(0,t.useEffect)(()=>()=>{l&&l.dispose()},[]),u},y=e=>{let t=h({maxWidth:480}),r=h({minWidth:481,maxWidth:1024});return t||r?1.25*e:e};e.s(["useDefaultIconSize",0,()=>y(20),"useResponsiveSize",0,y],34970)},745519,e=>{"use strict";var t=e.i(680472);e.s(["getAppVersion",0,()=>t.default.version])},995970,e=>{"use strict";var t=e.i(706174);let r="readest-telemetry-opt-out";e.s(["TELEMETRY_OPT_OUT_KEY",0,r,"optInTelemetry",0,()=>{localStorage.setItem(r,"false"),t.default.opt_in_capturing()},"optOutTelemetry",0,()=>{localStorage.setItem(r,"true"),t.default.opt_out_capturing()}])},89272,e=>{"use strict";var t=e.i(917409),r=e.i(392631),n=e.i(424439);e.s(["useBackgroundTexture",0,()=>({applyBackgroundTexture:(0,t.useCallback)((e,t)=>{let a=t.backgroundTextureId,o=t.backgroundOpacity,i=t.backgroundSize;if(!a||"none"===a)return;document.documentElement.style.setProperty("--bg-texture-opacity",`${o}`),document.documentElement.style.setProperty("--bg-texture-size",i);let s=n.useSettingsStore.getState().settings,l=s.customTextures?.find(e=>e.id===a);l&&r.useCustomTextureStore.getState().addTexture(l.path),r.useCustomTextureStore.getState().applyTexture(e,a)},[])})])},549084,(e,t,r)=>{Object.groupBy??=(e,t)=>{let r=Object.create(null),n=0;for(let a of e){let e=t(a,n++);e in r?r[e].push(a):r[e]=[a]}return r},Map.groupBy??=(e,t)=>{let r=new Map,n=0;for(let a of e){let e=t(a,n++),o=r.get(e);o?o.push(a):r.set(e,[a])}return r}},981410,e=>{"use strict";var t=e.i(307178),r=e.i(374517);e.i(549084);var n=e.i(875785),a=e.i(917409),o=e.i(233878),i=e.i(57290),s=e.i(96508),l=e.i(706174),u=(0,a.createContext)({client:l.default});function c(e){var t=e.children,r=e.client,n=e.apiKey,o=e.options,i=(0,a.useRef)(null),s=(0,a.useMemo)(function(){return r?(n&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),o&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),r):(n||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),l.default)},[r,n,JSON.stringify(o)]);return(0,a.useEffect)(function(){if(!r){var e=i.current;e?(n!==e.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),o&&!function e(t,r,n){if(void 0===n&&(n=new WeakMap),t===r)return!0;if("object"!=typeof t||null===t||"object"!=typeof r||null===r)return!1;if(n.has(t)&&n.get(t)===r)return!0;n.set(t,r);var a=Object.keys(t),o=Object.keys(r);if(a.length!==o.length)return!1;for(var i=0;i<a.length;i++){var s=a[i];if(!o.includes(s)||!e(t[s],r[s],n))return!1}return!0}(o,e.options)&&l.default.set_config(o)):(l.default.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),l.default.init(n,o)),i.current={apiKey:n,options:null!=o?o:{}}}},[r,n,JSON.stringify(o)]),a.default.createElement(u.Provider,{value:{client:s}},t)}var p=function(e,t){return(p=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},d=function(e){return"function"==typeof e},g={componentStack:null,error:null},f=a.default.Component;if("function"!=typeof f&&null!==f)throw TypeError("Class extends value "+String(f)+" is not a constructor or null");function m(){this.constructor=v}function v(e){var t=f.call(this,e)||this;return t.state=g,t}p(v,f),v.prototype=null===f?Object.create(f):(m.prototype=f.prototype,new m),v.prototype.componentDidCatch=function(e,t){var r,n=t.componentStack,a=this.props.additionalProperties;this.setState({error:e,componentStack:n}),d(a)?r=a(e):"object"==typeof a&&(r=a),this.context.client.captureException(e,r)},v.prototype.render=function(){var e=this.props,t=e.children,r=e.fallback,n=this.state;if(null==n.componentStack)return d(t)?t():t;var o=d(r)?a.default.createElement(r,{error:n.error,componentStack:n.componentStack}):r;return a.default.isValidElement(o)?o:(console.warn("[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."),a.default.createElement(a.default.Fragment,null))},v.contextType=u;var b=e.i(995970),h=e.i(745519);let y=t.default.env.NEXT_PUBLIC_POSTHOG_HOST||atob("aHR0cHM6Ly91cy5pLnBvc3Rob2cuY29t"),x=t.default.env.NEXT_PUBLIC_POSTHOG_KEY||atob("cGhjX2ViNXowbVRxWm8yZm5YYnZGNmE3bFh5TThpTmRSNTNsR1A3VFM3VGh4S08=");x&&"true"!==localStorage.getItem(b.TELEMETRY_OPT_OUT_KEY)&&l.default.init(x,{api_host:y,person_profiles:"always"});let w=({children:e})=>((0,a.useEffect)(()=>{l.default.register_for_session({$app_version:(0,h.getAppVersion)()})},[]),(0,r.jsx)(c,{client:l.default,children:e}));var _=e.i(480893),k=e.i(981441),T=e.i(424439),j=e.i(341537),S=e.i(34970),E=e.i(89272),A=e.i(190463),P=e.i(62725),C=e.i(266765);if(!window.__STORAGE_MODE_SET__){let e="local";window.__STORAGE_MODE__=e,window.__STORAGE_MODE_SET__=!0,console.log("[Providers] Global: Set window.__STORAGE_MODE__ to:",e)}e.s(["default",0,({children:e})=>{let{envConfig:t,appService:l}=(0,s.useEnv)(),{applyUILanguage:u}=(0,T.useSettingsStore)(),{applyBackgroundTexture:c}=(0,E.useBackgroundTexture)(),{applyEinkMode:p}=(0,A.useEinkMode)(),d=(0,S.useDefaultIconSize)();if((()=>{let{appService:e}=(0,s.useEnv)(),t=(0,a.useRef)({top:0,right:0,bottom:0,left:0}),{updateSafeAreaInsets:r}=(0,k.useThemeStore)(),n=e=>{let{top:n,right:a,bottom:o,left:i}=t.current;(e.top!==n||e.right!==a||e.bottom!==o||e.left!==i)&&(t.current=e,r(e))},o=(0,a.useCallback)(()=>{if(!e)return;if(!e.hasSafeAreaInset)return void n(t.current);let r=getComputedStyle(document.documentElement),a=r.getPropertyValue("--safe-area-inset-top"),o=/Chrome\/139/.test(navigator.userAgent);e.isAndroidApp&&o?(0,j.getSafeAreaInsets)().then(e=>{e.error?console.error("Error getting safe area insets from native bridge:",e.error):n({top:Math.round(e.top),right:Math.round(e.right),bottom:Math.round(e.bottom),left:Math.round(e.left)})}):a&&n({top:Math.round(parseFloat(r.getPropertyValue("--safe-area-inset-top"))||0),right:Math.round(parseFloat(r.getPropertyValue("--safe-area-inset-right"))||0),bottom:Math.round(parseFloat(r.getPropertyValue("--safe-area-inset-bottom"))||0),left:Math.round(parseFloat(r.getPropertyValue("--safe-area-inset-left"))||0)})},[e]);(0,a.useEffect)(()=>(o(),window.screen?.orientation?window.screen.orientation.addEventListener("change",o):window.addEventListener("orientationchange",o),()=>{window.screen?.orientation?window.screen.orientation.removeEventListener("change",o):window.removeEventListener("orientationchange",o)}),[o])})(),(0,a.useEffect)(()=>{window.__STORAGE_MODE__||(window.__STORAGE_MODE__="local"),console.log("[Providers] useEffect: window.__STORAGE_MODE__ =",window.__STORAGE_MODE__);let e=e=>{document.documentElement.lang=e,"rtl"===(0,C.getDirFromUILanguage)()?document.documentElement.classList.add("ui-rtl"):document.documentElement.classList.remove("ui-rtl")};return e((0,P.getLocale)()),n.default.on("languageChanged",e),()=>{n.default.off("languageChanged",e)}},[]),(0,a.useEffect)(()=>{(0,k.loadDataTheme)(),l&&((0,k.initSystemThemeListener)(l),l.loadSettings().then(e=>{let r=e.globalViewSettings;u(r.uiLanguage),c(t,r),r.isEink&&p(!0)}))},[t,l,u,c,p]),l)return(0,r.jsx)(w,{children:(0,r.jsx)(i.AuthProvider,{children:(0,r.jsx)(o.IconContext.Provider,{value:{size:`${d}px`},children:(0,r.jsx)(_.SyncProvider,{children:e})})})})}],981410)},535344,e=>{e.v(t=>Promise.all(["static/chunks/707fa1d803e8352d.js","static/chunks/186eb9e8eac529d0.js","static/chunks/b4bc2eb83c48c07e.js"].map(t=>e.l(t))).then(()=>t(724109)))},377298,e=>{e.v(t=>Promise.all(["static/chunks/78a48cfbcadf8172.js","static/chunks/186eb9e8eac529d0.js","static/chunks/b4bc2eb83c48c07e.js"].map(t=>e.l(t))).then(()=>t(925714)))},787065,e=>{e.v(t=>Promise.all(["static/chunks/2d5ac207652187cc.js"].map(t=>e.l(t))).then(()=>t(35168)))}]);