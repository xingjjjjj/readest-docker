(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,262739,(t,e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return i}});let i=t=>{}},594060,t=>{t.v("/_next/static/media/simplecc_wasm_bg.d9cca8fc.wasm")},237189,t=>{"use strict";var e=t.i(374517),r=t.i(96508),i=t.i(604111),n=t.i(194072);t.s(["default",0,()=>{let t=(0,i.useTranslation)(),{appService:o}=(0,r.useEnv)(),a=o?.isIOSApp||o?.isMacOSApp?"https://www.apple.com/legal/internet-services/itunes/dev/stdeula/":"https://readest.com/terms-of-service";return(0,e.jsxs)("div",{className:"my-2 flex flex-wrap justify-center gap-4 text-sm sm:text-xs",children:[(0,e.jsx)(n.default,{href:a,className:"text-blue-500 underline hover:text-blue-600",children:t("Terms of Service")}),(0,e.jsx)(n.default,{href:"https://readest.com/privacy-policy",className:"text-blue-500 underline hover:text-blue-600",children:t("Privacy Policy")})]})}])},194072,t=>{"use strict";var e=t.i(374517),r=t.i(141886),i=t.i(699475);t.s(["default",0,({href:t,children:n,...o})=>{let a=async e=>{(0,r.isTauriAppPlatform)()&&(e.preventDefault(),await (0,i.openUrl)(t))};return(0,e.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",onClick:a,...o,children:n})}])},647735,t=>{"use strict";t.i(553438);var e=t.i(503523),r=t.i(841964),i=t.i(141886),n=t.i(262504);let o=0,a=(t,i)=>{let n=(0,e.getCurrentWindow)().label,a=new r.WebviewWindow(`${"main"===n?"reader":n}-${o}`,{url:i,width:800,height:600,center:!0,resizable:!0,title:t.isMacOSApp?"":"Readest",decorations:!!t.isMacOSApp,transparent:!t.isMacOSApp,shadow:!t.isMacOSApp||void 0,titleBarStyle:t.isMacOSApp?"overlay":void 0});a.once("tauri://created",()=>{console.log("new window created"),o+=1}),a.once("tauri://error",t=>{console.error("error creating window",t)}),a.once("tauri://destroyed",()=>{o-=1})};t.s(["navigateToLibrary",0,(t,e,r,i)=>{let n=sessionStorage.getItem("lastLibraryParams");i&&n&&(e=n),t.replace(`/library${e?`?${e}`:""}`,r)},"navigateToLogin",0,t=>{let e=window.location.pathname,r=window.location.search;t.push(`/auth?redirect=${encodeURIComponent("/auth"!==e?e+r:"/")}`)},"navigateToProfile",0,t=>{t.push("/user")},"navigateToReader",0,(t,e,r,o)=>{let a=e.join(n.BOOK_IDS_SEPARATOR);if((0,i.isWebAppPlatform)()&&!(0,i.isPWA)())t.push(`/reader/${a}${r?`?${r}`:""}`,o);else{let e=new URLSearchParams(r||"");e.set("ids",a),t.push(`/reader?${e.toString()}`,o)}},"showLibraryWindow",0,(t,e)=>{let r=new URLSearchParams;e.forEach(t=>r.append("file",t)),a(t,`/library?${r.toString()}`)},"showReaderWindow",0,(t,e)=>{let r=e.join(n.BOOK_IDS_SEPARATOR),i=new URLSearchParams("");i.set("ids",r),a(t,`/reader?${i.toString()}`)}])},168375,t=>{"use strict";var e=t.i(374517),r=t.i(7284),i=t.i(917409),n=t.i(981441),o=t.i(305133);t.s(["Toast",0,()=>{let{safeAreaInsets:t}=(0,n.useThemeStore)(),[a,s]=(0,i.useState)(""),[l,f]=(0,i.useState)("info"),[u,h]=(0,i.useState)(5e3),[c,p]=(0,i.useState)(""),[d,g]=(0,i.useState)(!1),m=(0,i.useRef)(null),y={info:"toast-info toast-center toast-middle",success:"toast-success toast-top sm:toast-end toast-center",warning:"toast-warning toast-top sm:toast-end toast-center",error:"toast-error toast-top sm:toast-end toast-center"},w={info:(0,e.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,e.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),success:(0,e.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),warning:(0,e.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),error:(0,e.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,e.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})};(0,i.useEffect)(()=>{a&&setTimeout(()=>{g(!0)},0)},[a]),(0,i.useEffect)(()=>{if(m.current&&clearTimeout(m.current),a){let t=setTimeout(()=>{g(!1),setTimeout(()=>s(""),300)},u);return m.current=t,()=>{t&&clearTimeout(t)}}},[a,u]);let b=async t=>{let{message:e,type:r="info",timeout:i,className:n="",callback:o=null}=t.detail;s(e),f(r),i&&h(i),o&&"function"==typeof o&&setTimeout(()=>o(),i||5e3),p(n)};return(0,i.useEffect)(()=>(o.eventDispatcher.on("toast",b),()=>{o.eventDispatcher.off("toast",b)}),[]),a&&(0,e.jsx)("div",{className:(0,r.default)("toast z-50 w-auto max-w-screen-sm transition-all duration-300",y[l],d?"scale-100 opacity-100":"scale-95 opacity-0"),style:{top:y[l].includes("toast-top")?`${(t?.top||0)+44}px`:void 0},children:(0,e.jsxs)("div",{className:(0,r.default)("alert flex items-center gap-3 shadow-2xl backdrop-blur-sm","min-h-0 rounded-2xl px-5 py-4","not-eink:bg-gradient-to-r border-0",{info:"alert-primary border-base-300",success:"alert-success not-eink:from-green-500 not-eink:to-emerald-500",warning:"alert-warning not-eink:from-amber-500 not-eink:to-orange-500",error:"alert-error not-eink:from-red-500 not-eink:to-rose-500"}[l],"eink:bg-base-100 eink:border eink:border-base-content","info"!==l&&"text-white"),children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:w[l]}),(0,e.jsx)("span",{className:(0,r.default)("max-h-[50vh] flex-1 overflow-y-auto","font-sans text-base font-medium leading-snug sm:text-sm","info"===l?"max-w-[60vw] truncate sm:max-w-[80vw]":"min-w-[60vw] max-w-[80vw] whitespace-normal break-words sm:min-w-40 sm:max-w-80",c),children:a.split("\n").map((t,r)=>(0,e.jsxs)(i.default.Fragment,{children:[t||(0,e.jsx)(e.Fragment,{children:" "}),r<a.split("\n").length-1&&(0,e.jsx)("br",{})]},r))}),(0,e.jsx)("button",{onClick:()=>{g(!1),setTimeout(()=>s(""),300),m.current&&clearTimeout(m.current)},className:(0,r.default)("flex-shrink-0 rounded-lg p-1 transition-colors","info"===l?"hover:bg-base-300":"hover:bg-white/20 active:bg-white/30"),"aria-label":"Dismiss",children:(0,e.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,e.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})}])},345598,t=>{"use strict";var e=t.i(503523),r=t.i(283683),i=t.i(44438),n=t.i(897755),o=t.i(305133);let a=async()=>{let t=(0,e.getCurrentWindow)(),r=await t.scaleFactor(),i=await t.outerPosition();return{x:i.x/r,y:i.y/r}},s=async()=>{(0,e.getCurrentWindow)().minimize()},l=async()=>{let t=await (0,e.getCurrentWindow)().innerSize();t.width-=1,t.height-=1,await (0,e.getCurrentWindow)().setSize(t),setTimeout(async()=>{let t=await (0,e.getCurrentWindow)().innerSize();t.width+=1,t.height+=1,await (0,e.getCurrentWindow)().setSize(t)},100)},f=async()=>{let t=(0,e.getCurrentWindow)();await t.isFullscreen()?(await t.setFullscreen(!1),await t.unmaximize()):await t.toggleMaximize(),await (0,n.type)()==="linux"&&l()},u=async()=>{(0,e.getCurrentWindow)().close()},h=async t=>{let i=(0,e.getCurrentWindow)();return await i.onCloseRequested(async e=>{e.preventDefault(),await t(),i.label.startsWith("reader")?(await (0,r.emitTo)("main","close-reader-window",{label:i.label}),setTimeout(()=>i.destroy(),300)):"main"===i.label&&await i.destroy()})},c=async()=>{let t=(0,e.getCurrentWindow)(),r=await t.isFullscreen();await t.isMaximized()?await t.unmaximize():await t.setFullscreen(!r),await (0,n.type)()==="linux"&&l()},p=async t=>{let r=(0,e.getCurrentWindow)();await r.setAlwaysOnTop(t)},d=async()=>{await o.eventDispatcher.dispatch("quit-app"),await (0,i.exit)(0)};t.s(["tauriGetWindowLogicalPosition",0,a,"tauriHandleClose",0,u,"tauriHandleMinimize",0,s,"tauriHandleOnCloseWindow",0,h,"tauriHandleSetAlwaysOnTop",0,p,"tauriHandleToggleFullScreen",0,c,"tauriHandleToggleMaximize",0,f,"tauriQuitApp",0,d])},20414,t=>{"use strict";var e=t.i(128818),r=t.i(871611);let i=(0,e.create)((e,i)=>({appService:void 0,isTrafficLightVisible:!1,shouldShowTrafficLight:!1,trafficLightInFullscreen:!1,initializeTrafficLightStore:t=>{e({appService:t,isTrafficLightVisible:t.hasTrafficLight,shouldShowTrafficLight:t.hasTrafficLight})},setTrafficLightVisibility:async(i,n)=>{let{getCurrentWindow:o}=await t.A(888741),a=o(),s=await a.isFullscreen();e({isTrafficLightVisible:!s&&i,shouldShowTrafficLight:i,trafficLightInFullscreen:s}),(0,r.invoke)("set_traffic_lights",{visible:i,x:n?.x??10,y:n?.y??22})},initializeTrafficLightListeners:async()=>{let{getCurrentWindow:r}=await t.A(888741),n=r(),o=await n.listen("will-enter-fullscreen",()=>{e({isTrafficLightVisible:!1,trafficLightInFullscreen:!0})}),a=await n.listen("will-exit-fullscreen",()=>{let{shouldShowTrafficLight:t}=i();e({isTrafficLightVisible:t,trafficLightInFullscreen:!1})});e({unlistenEnterFullScreen:o,unlistenExitFullScreen:a})},cleanupTrafficLightListeners:()=>{let{unlistenEnterFullScreen:t,unlistenExitFullScreen:r}=i();t&&t(),r&&r(),e({unlistenEnterFullScreen:void 0,unlistenExitFullScreen:void 0})}}));t.s(["useTrafficLightStore",0,i])},675788,t=>{"use strict";var e=t.i(374517),r=t.i(7284),i=t.i(917409),n=t.i(96508),o=t.i(345598),a=t.i(141886),s=t.i(604111);let l=({onClick:t,label:r,id:i,children:n})=>(0,e.jsx)("button",{id:i,onClick:t,className:"window-button bg-base-200/35 hover:bg-base-200 text-base-content/85 hover:text-base-content","aria-label":r,children:n});t.s(["default",0,({className:f,headerRef:u,showMinimize:h=!0,showMaximize:c=!0,showClose:p=!0,onMinimize:d,onToggleMaximize:g,onClose:m})=>{let y=(0,s.useTranslation)(),w=(0,i.useRef)(null),{appService:b}=(0,n.useEnv)(),v=(0,i.useRef)({lastPointerTime:0,pointerStartPosition:{x:0,y:0},isDragging:!1}),A=t=>t.closest(".btn")||t.closest(".window-button")||t.closest(".dropdown-container")||t.closest(".exclude-title-bar-mousedown"),x=async e=>{if(A(e.target))return;let{getCurrentWindow:r}=await t.A(888741);1===e.buttons&&(2===e.detail?r().toggleMaximize():r().startDragging())},E=async e=>{if(A(e.target)||"mouse"===e.pointerType)return;e.preventDefault();let r=Date.now(),i=r-v.current.lastPointerTime;if(v.current.pointerStartPosition={x:e.clientX,y:e.clientY},i<300){let{getCurrentWindow:e}=await t.A(888741);e().toggleMaximize();return}v.current.lastPointerTime=r,v.current.isDragging=!1},B=async e=>{if(A(e.target)||v.current.isDragging||"mouse"===e.pointerType)return;e.preventDefault();let r=Math.abs(e.clientX-v.current.pointerStartPosition.x),i=Math.abs(e.clientY-v.current.pointerStartPosition.y);if(r>5||i>5){v.current.isDragging=!0;try{let{getCurrentWindow:e}=await t.A(888741);await e().startDragging()}catch(t){console.warn("Failed to start window dragging:",t)}}},L=()=>{v.current.isDragging=!1};(0,i.useEffect)(()=>{if(!(0,a.isTauriAppPlatform)())return;let t=u?.current;if(t)return t.addEventListener("mousedown",x),t.addEventListener("pointerdown",E),t.addEventListener("pointermove",B),t.addEventListener("pointerup",L),t.addEventListener("pointercancel",L),()=>{t.removeEventListener("mousedown",x),t.removeEventListener("pointerdown",E),t.removeEventListener("pointermove",B),t.removeEventListener("pointerup",L),t.removeEventListener("pointercancel",L)}},[]);let T=async()=>{d?d():(0,o.tauriHandleMinimize)()},S=async()=>{g?g():(0,o.tauriHandleToggleMaximize)()},C=async()=>{m?m():(0,o.tauriHandleClose)()};return(0,e.jsxs)("div",{ref:w,className:(0,r.default)("window-buttons flex h-8 items-center justify-end space-x-2",p||c||h?"visible":"hidden",f),children:[h&&b?.hasWindowBar&&(0,e.jsx)(l,{onClick:T,label:y("Minimize"),id:"titlebar-minimize",children:(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{fill:"currentColor",d:"M20 14H4v-2h16"})})}),c&&b?.hasWindowBar&&(0,e.jsx)(l,{onClick:S,label:y("Maximize or Restore"),id:"titlebar-maximize",children:(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{fill:"currentColor",d:"M4 4h16v16H4zm2 4v10h12V8z"})})}),p&&(b?.hasWindowBar||m)&&(0,e.jsx)(l,{onClick:C,label:y("Close"),id:"titlebar-close",children:(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})})})]})}])},399458,t=>{"use strict";let e,r=(t,e)=>[-1,...e,t.length].reduce(({xs:e,a:r},i)=>({xs:e?.concat([t.slice(r+1,i)])??[],a:i}),{}).xs,i=/\d/,n=/^epubcfi\((.*)\)$/,o=t=>t.replace(/[\^[\](),;=]/g,"^$&"),a=t=>n.test(t)?t:`epubcfi(${t})`,s=(e=(...t)=>t.join("!"),(...t)=>`epubcfi(${e(...t.map(t=>t.match(n)?.[1]??t))})`),l=(t,e)=>{let r;return r=([t])=>t===e,t.map((t,e,i)=>r(t,e,i)?e:null).filter(t=>null!=t)},f=t=>{let e,r=[];for(let[i,n]of t){if("/"===i)r.push({index:n});else{let t=r[r.length-1];if(":"===i)t.offset=n;else if("~"===i)t.temporal=n;else if("@"===i)t.spatial=(t.spatial??[]).concat(n);else if(";s"===i)t.side=n;else if("["===i)if("/"===e&&n)t.id=n;else{t.text=(t.text??[]).concat(n);continue}}e=i}return r},u=t=>r(t,l(t,"!")).map(f),h=t=>{let e=(t=>{let e=[],r,n,o="",a=t=>(e.push(t),r=null,o=""),s=t=>(o+=t,n=!1);for(let e of Array.from(t.trim()).concat("")){if("^"===e&&!n){n=!0;continue}if("!"===r)a(["!"]);else if(","===r)a([","]);else if("/"===r||":"===r)if(i.test(e)){s(e);continue}else a([r,parseInt(o)]);else if("~"===r)if(i.test(e)||"."===e){s(e);continue}else a(["~",parseFloat(o)]);else if("@"===r){if(":"===e){a(["@",parseFloat(o)]),r="@";continue}if(i.test(e)||"."===e){s(e);continue}a(["@",parseFloat(o)])}else if("["===r){";"!==e||n?","!==e||n?"]"!==e||n?s(e):a(["[",o]):(a(["[",o]),r="["):(a(["[",o]),r=";");continue}else if(r?.startsWith(";")){"="!==e||n?";"!==e||n?"]"!==e||n?s(e):a([r,o]):(a([r,o]),r=";"):(r=`;${o}`,o="");continue}("/"===e||":"===e||"~"===e||"@"===e||"["===e||"!"===e||","===e)&&(r=e)}return e})(t.match(n)?.[1]??t),o=l(e,",");if(!o.length)return u(e);let[a,s,f]=r(e,o).map(u);return{parent:a,start:s,end:f}},c=({index:t,id:e,offset:r,temporal:i,spatial:n,text:a,side:s})=>{let l=s?`;s=${s}`:"";return`/${t}`+(e?`[${o(e)}${l}]`:"")+(null!=r&&t%2?`:${r}`:"")+(i?`~${i}`:"")+(n?`@${n.join(":")}`:"")+(a||!e&&s?"["+(a?.map(o)?.join(",")??"")+l+"]":"")},p=t=>t.parent?[t.parent,t.start,t.end].map(p).join(","):t.map(t=>t.map(c).join("")).join("!"),d=t=>a(p(t)),g=(t,e)=>{let r,i;return"string"==typeof t?d(g(h(t),e)):t.parent?(r=t.parent,i=t[e?"end":"start"],r.slice(0,-1).concat([r[r.length-1].concat(i[0])]).concat(i.slice(1))):t},m=(t,e)=>{"string"==typeof t&&(t=h(t)),"string"==typeof e&&(e=h(e)),t=g(t),e=g(e,!0);let r=t[t.length-1],i=e[e.length-1],n=[],o=[],a=[],s=!0,l=Math.max(r.length,i.length);for(let t=0;t<l;t++){let e=r[t],l=i[t];(s&&=e?.index===l?.index&&!e?.offset&&!l?.offset)?n.push(e):(e&&o.push(e),l&&a.push(l))}return d({parent:t.slice(0,-1).concat([n]),start:[o],end:[a]})},y=(t,e)=>{if("string"==typeof t&&(t=h(t)),"string"==typeof e&&(e=h(e)),t.start||e.start)return y(g(t),g(e))||y(g(t,!0),g(e,!0));for(let r=0;r<Math.max(t.length,e.length);r++){let i=t[r]??[],n=e[r]??[],o=Math.max(i.length,n.length)-1;for(let t=0;t<=o;t++){let e=i[t],r=n[t];if(!e)return -1;if(!r||e.index>r.index)return 1;if(e.index<r.index)return -1;if(t===o){if(e.offset>r.offset)return 1;if(e.offset<r.offset)return -1}}}return 0},w=({nodeType:t})=>3===t||4===t,b=(t,e)=>{let r=Array.from(t.childNodes).filter(t=>w(t)||(({nodeType:t})=>1===t)(t));return e?r.map(t=>{let r=e(t);return r===NodeFilter.FILTER_REJECT?null:r===NodeFilter.FILTER_SKIP?b(t,e):t}).flat().filter(t=>t):r},v=(t,e)=>{let r=b(t,e).reduce((t,e)=>{let r=t[t.length-1];return r?w(e)?Array.isArray(r)?r.push(e):w(r)?t[t.length-1]=[r,e]:t.push(e):(({nodeType:t})=>1===t)(r)?t.push(null,e):t.push(e):t.push(e),t},[]);return(({nodeType:t})=>1===t)(r[0])&&r.unshift("first"),(({nodeType:t})=>1===t)(r[r.length-1])&&r.push("last"),r.unshift("before"),r.push("after"),r},A=(t,e,r)=>{let{id:i}=e[e.length-1];if(i){let e=t.ownerDocument.getElementById(i);if(e)return{node:e,offset:0}}for(let{index:i}of e){let e=t?v(t,r)[i]:null;if("first"===e)return{node:t.firstChild??t};if("last"===e)return{node:t.lastChild??t};if("before"===e)return{node:t,before:!0};if("after"===e)return{node:t,after:!0};t=e}let{offset:n}=e[e.length-1];if(!Array.isArray(t))return{node:t,offset:n};let o=0;for(let e of t){let{length:t}=e.nodeValue;if(o+t>=n)return{node:e,offset:n-o};o+=t}},x=(t,e,r)=>{let{parentNode:i,id:n}=t,o=v(i,r),a=o.findIndex(e=>Array.isArray(e)?e.some(e=>e===t):e===t),s=o[a];if(Array.isArray(s)){let r=0;for(let i of s)if(i===t){r+=e;break}else r+=i.nodeValue.length;e=r}let l={id:n,index:a,offset:e};return(i!==t.ownerDocument.documentElement?x(i,null,r).concat(l):[l]).filter(t=>-1!==t.index)},E={fromIndex:t=>a(`/6/${(t+1)*2}`),toIndex:t=>t?.at(-1).index/2-1};t.s(["collapse",0,g,"compare",0,y,"fake",0,E,"fromCalibreHighlight",0,({spine_index:t,start_cfi:e,end_cfi:r})=>{let i=E.fromIndex(t)+"!";return m(i+e.slice(2),i+r.slice(2))},"fromCalibrePos",0,t=>{let[e]=h(t),r=e.shift();return e.shift(),d([[{index:6},r],e])},"fromElements",0,t=>{let e=[],{parentNode:r}=t[0],i=x(r);for(let[n,o]of v(r).entries()){let r=t[e.length];o===r&&e.push(d([i.concat({id:r.id,index:n})]))}return e},"fromRange",0,(t,e)=>{let{startContainer:r,startOffset:i,endContainer:n,endOffset:o}=t,a=x(r,i,e);return t.collapsed?d([a]):m([a],[x(n,o,e)])},"isCFI",0,n,"joinIndir",0,s,"parse",0,h,"toElement",0,(t,e)=>A(t.documentElement,g(e)).node,"toRange",0,(t,e,r)=>{let i=g(e),n=g(e,!0),o=t.documentElement,a=A(o,i[0],r),s=A(o,n[0],r),l=t.createRange();return a.before?l.setStartBefore(a.node):a.after?l.setStartAfter(a.node):l.setStart(a.node,a.offset),s.before?l.setEndBefore(s.node):s.after?l.setEndAfter(s.node):l.setEnd(s.node,s.offset),l}])},955066,835106,t=>{"use strict";var e=t.i(399458);let r={EPUB:"epub",PDF:"pdf",MOBI:"mobi",AZW:"azw",AZW3:"azw3",CBZ:"cbz",FB2:"fb2",FBZ:"fbz",TXT:"txt",MD:"md"},i={EPUB:["application/epub+zip"],PDF:["application/pdf"],MOBI:["application/x-mobipocket-ebook"],AZW:["application/vnd.amazon.ebook"],AZW3:["application/vnd.amazon.mobi8-ebook","application/x-mobi8-ebook"],CBZ:["application/vnd.comicbook+zip","application/zip","application/x-cbz"],FB2:["application/x-fictionbook+xml","text/xml","application/xml"],FBZ:["application/x-zip-compressed-fb2","application/zip"],TXT:["text/plain"],MD:["text/markdown","text/x-markdown"]};class n{file;constructor(t){this.file=t}async isZip(){let t=new Uint8Array(await this.file.slice(0,4).arrayBuffer());return 80===t[0]&&75===t[1]&&3===t[2]&&4===t[3]}async isPDF(){let t=new Uint8Array(await this.file.slice(0,5).arrayBuffer());return 37===t[0]&&80===t[1]&&68===t[2]&&70===t[3]&&45===t[4]}async makeZipLoader(){let e=async()=>{let t=Math.min(65536,this.file.size),e=new Uint8Array(await this.file.slice(this.file.size-t,this.file.size).arrayBuffer());for(let t=e.length-22;t>=0;t--)if(80===e[t]&&75===e[t+1]&&5===e[t+2]&&6===e[t+3]){let r=e[t+20]+(e[t+21]<<8),i=t+22,n=e.slice(i,i+r);return new TextDecoder().decode(n)}return null},{configure:r,ZipReader:i,BlobReader:n,TextWriter:o,BlobWriter:a}=await t.A(187722);r({useWebWorkers:!1});let s=new i(new n(this.file)),l=await s.getEntries(),f=new Map(l.map(t=>[t.filename,t])),u=t=>(e,...r)=>f.has(e)?t(f.get(e),...r):null,h=u(t=>t.getData?t.getData(new o):null);return{entries:l,loadText:h,loadBlob:u((t,e)=>t.getData?t.getData(new a(e)):null),getSize:t=>f.get(t)?.uncompressedSize??0,getComment:e,sha1:void 0}}isCBZ(){return"application/vnd.comicbook+zip"===this.file.type||this.file.name.endsWith(`.${r.CBZ}`)}isFB2(){return"application/x-fictionbook+xml"===this.file.type||this.file.name.endsWith(`.${r.FB2}`)}isFBZ(){return"application/x-zip-compressed-fb2"===this.file.type||this.file.name.endsWith(".fb.zip")||this.file.name.endsWith(".fb2.zip")||this.file.name.endsWith(`.${r.FBZ}`)}async open(){let e=null,i="EPUB";if(!this.file.size)throw Error("File is empty");try{if(await this.isZip()){let n=await this.makeZipLoader(),{entries:o}=n;if(this.isCBZ()){let{makeComicBook:r}=await t.A(664253);e=await r(n,this.file),i="CBZ"}else if(this.isFBZ()){let a=o.find(t=>t.filename.endsWith(`.${r.FB2}`)),s=await n.loadBlob((a??o[0]).filename),{makeFB2:l}=await t.A(119421);e=await l(s),i="FBZ"}else{let{EPUB:r}=await t.A(620701);e=await new r(n).init(),i="EPUB"}}else if(await this.isPDF()){let{makePDF:r}=await t.A(511607);e=await r(this.file),i="PDF"}else if(await (await t.A(722516)).isMOBI(this.file)){let r=await t.A(89544),{MOBI:n}=await t.A(722516);switch(e=await new n({unzlib:r.unzlibSync}).open(this.file),this.file.name.split(".").pop()?.toLowerCase()){case"azw":i="AZW";break;case"azw3":i="AZW3";break;default:i="MOBI"}}else if(this.isFB2()){let{makeFB2:r}=await t.A(119421);e=await r(this.file),i="FB2"}}catch(t){if(console.error("Failed to open document:",t),t instanceof Error&&t.message?.includes("not a valid zip"))throw Error("Unsupported or corrupted book file");throw t}return{book:e,format:i}}}t.s(["CFI",0,e,"DocumentLoader",()=>n,"EXTS",0,r,"getDirection",0,t=>{let{defaultView:e}=t,{writingMode:r,direction:i}=e.getComputedStyle(t.body);return{vertical:"vertical-rl"===r||"vertical-lr"===r,rtl:"rtl"===t.body.dir||"rtl"===i||"rtl"===t.documentElement.dir}},"getFileExtFromMimeType",0,t=>{if(!t)return"";for(let e in i)if(i[e].includes(t))return r[e];return""}],835106);var o=t.i(262504),a=t.i(62725),s=t.i(266765),l=t.i(819045);t.i(431263);var f=t.i(805143);let u=(t,e=!1)=>{let r=(0,a.getUserLang)();if(!t)return"";if("string"==typeof t)return t;let i=Object.keys(t);return e?t[i[0]]:t[r]||t[i[0]]},h=(t=!1,e="")=>(e=e||(0,a.getUserLang)(),t)?new Intl.ListFormat("en",{style:"narrow",type:"unit"}):new Intl.ListFormat(e,{style:"long",type:"conjunction"}),c=t=>{try{let e="string"==typeof t?t:t?.[0];return e?e.split("-")[0]:""}catch{return""}},p=["ar","bo","de","en","es","fr","hi","it","nl","pl","pt","ru","th","tr","uk"],d=(t,e)=>{if(!t)return"";let r=t.split(" ");return e&&r.length>1?`${r[r.length-1]}, ${r.slice(0,-1).join(" ")}`:t},g=t=>o.SUPPORTED_LANGS[t]||t.toUpperCase(),m=t=>{let e=Array.isArray(t)?t[0]:t;if((0,l.isValidLang)(e)){let t=(0,l.normalizedLangCode)(e);return(0,l.code6392to6391)(t)||t}return"en"},y=t=>{try{if(t.includes("urn:"))return t.match(/[^:]+$/)?.[0]||"";if(t.includes(":"))return t.match(/^[^:]+:(.+)$/)?.[1]||""}catch{}return t};t.s(["INIT_BOOK_CONFIG",0,{updatedAt:0},"flattenContributors",0,t=>t?Array.isArray(t)?t.map(t=>"string"==typeof t?t:u(t?.name)).join(", "):"string"==typeof t?t:u(t?.name):"","formatAuthors",0,(t,e,r)=>{let i=c(e)||"en",n=!!r&&p.includes(i);return Array.isArray(t)?h("zh"===i,i).format(t.map(t=>"string"==typeof t?d(t,n):d(u(t?.name),n))):"string"==typeof t?d(t,n):d(u(t?.name),n)},"formatBytes",0,(t,e="en-US")=>{if(!t)return"";let r=Math.floor(Math.log(t)/Math.log(1024)),i=t/Math.pow(1024,r);return new Intl.NumberFormat(e,{style:"unit",unit:["byte","kilobyte","megabyte","gigabyte","terabyte"][r],unitDisplay:"short",maximumFractionDigits:2}).format(i)},"formatDate",0,(t,e=!1)=>{if(!t)return;let r=(0,a.getUserLang)();try{return new Date(t).toLocaleDateString(r,{year:"numeric",month:"long",day:"numeric",timeZone:e?"UTC":void 0})}catch{return}},"formatDescription",0,t=>t?("string"==typeof t?t:u(t)).replace(/<\/?[^>]+(>|$)/g,"").replace(/&#\d+;/g,"").trim():"","formatLanguage",0,t=>Array.isArray(t)?t.map(g).join(", "):g(t||""),"formatPublisher",0,t=>"string"==typeof t?t:u(t),"formatTitle",0,t=>"string"==typeof t?t:u(t),"getBookDirFromLanguage",0,t=>{let e=m(t)||"";return(0,s.getDirFromLanguage)(e)},"getBookDirFromWritingMode",0,t=>{switch(t){case"horizontal-tb":return"ltr";case"horizontal-rl":case"vertical-rl":return"rtl";default:return"auto"}},"getBookLangCode",0,c,"getConfigFilename",0,t=>{if(!t.relativePath)throw Error(`Book ${t.title} (${t.hash}) is missing relativePath. Please re-import the book.`);let e=t.relativePath.replace(/\.[^.]+$/,"");return`${e}/config.json`},"getCoverFilename",0,t=>{if(!t.relativePath)throw Error(`Book ${t.title} (${t.hash}) is missing relativePath. Please re-import the book.`);let e=t.relativePath.replace(/\.[^.]+$/,""),r=`${e}/cover.png`;return console.log("[getCoverFilename] ✓ Using relativePath:",t.relativePath),console.log("[getCoverFilename] ✓ Cover path result:",r),r},"getCurrentPage",0,(t,e)=>{let r=t.format,{section:i,pageinfo:n}=e;return"PDF"===r?i?i.current+1:0:n?n.current+1:0},"getDir",0,t=>{if(!t.relativePath)throw Error(`Book ${t.title} (${t.hash}) is missing relativePath. Please re-import the book.`);return t.relativePath.replace(/\.[^.]+$/,"")},"getLibraryBackupFilename",0,()=>"library_backup.json","getLibraryFilename",0,()=>"library.json","getLocalBookFilename",0,t=>{if(!t.relativePath)throw Error(`Book ${t.title} (${t.hash}) is missing relativePath. Please re-import the book.`);return t.relativePath},"getMetadataHash",0,t=>{try{var e;let r,i=(r=t.title,"string"==typeof r?r:u(r,!0)),n=(!(e=t.author)?[]:Array.isArray(e)?e.map(t=>"string"==typeof t?t:u(t?.name,!0)).filter(Boolean):["string"==typeof e?e:u(e?.name,!0)]).join(","),o=(t=>{if(!t)return[];if(Array.isArray(t)){let e=(t=>{for(let e of["uuid","calibre","isbn"]){let r=t.find(t=>"string"==typeof t?t.toLowerCase().includes(e):t.scheme.toLowerCase()===e);if(r)return"string"==typeof r?y(r):r.value}})(t);if(e)return[e]}return Array.isArray(t)?t.map(t=>"string"==typeof t?y(t):t.value).filter(Boolean):"string"==typeof t?[y(t)]:[t.value]})(t.altIdentifier||t.identifier).join(","),a=`${i}|${n}|${o}`;return(0,f.md5)(a.normalize("NFC"))}catch(t){console.error("Error generating metadata hash:",t)}},"getPrimaryLanguage",0,m,"listFormater",0,h],955066)},27357,t=>{"use strict";let e=new Set(["PDF","CBZ"]);t.s(["FIXED_LAYOUT_FORMATS",0,e])},421966,t=>{"use strict";t.s(["deserializeConfig",0,(t,e,r)=>{let i=JSON.parse(t),{viewSettings:n,searchConfig:o}=i;return i.viewSettings={...e,...n},i.searchConfig={...r,...o},i.updatedAt??=Date.now(),i},"serializeConfig",0,(t,e,r)=>{let i=(t=JSON.parse(JSON.stringify(t))).viewSettings,n=t.searchConfig;return t.viewSettings=Object.entries(i).reduce((t,[r,i])=>(e[r]!==i&&(t[r]=i),t),{}),t.searchConfig=Object.entries(n).reduce((t,[e,i])=>(r[e]!==i&&(t[e]=i),t),{}),JSON.stringify(t)}])},316377,(t,e,r)=>{var i={675:function(t,e){"use strict";e.byteLength=function(t){var e=l(t),r=e[0],i=e[1];return(r+i)*3/4-i},e.toByteArray=function(t){var e,r,o=l(t),a=o[0],s=o[1],f=new n((a+s)*3/4-s),u=0,h=s>0?a-4:a;for(r=0;r<h;r+=4)e=i[t.charCodeAt(r)]<<18|i[t.charCodeAt(r+1)]<<12|i[t.charCodeAt(r+2)]<<6|i[t.charCodeAt(r+3)],f[u++]=e>>16&255,f[u++]=e>>8&255,f[u++]=255&e;return 2===s&&(e=i[t.charCodeAt(r)]<<2|i[t.charCodeAt(r+1)]>>4,f[u++]=255&e),1===s&&(e=i[t.charCodeAt(r)]<<10|i[t.charCodeAt(r+1)]<<4|i[t.charCodeAt(r+2)]>>2,f[u++]=e>>8&255,f[u++]=255&e),f},e.fromByteArray=function(t){for(var e,i=t.length,n=i%3,o=[],a=0,s=i-n;a<s;a+=16383)o.push(function(t,e,i){for(var n,o=[],a=e;a<i;a+=3)n=(t[a]<<16&0xff0000)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(r[n>>18&63]+r[n>>12&63]+r[n>>6&63]+r[63&n]);return o.join("")}(t,a,a+16383>s?s:a+16383));return 1===n?o.push(r[(e=t[i-1])>>2]+r[e<<4&63]+"=="):2===n&&o.push(r[(e=(t[i-2]<<8)+t[i-1])>>10]+r[e>>4&63]+r[e<<2&63]+"="),o.join("")};for(var r=[],i=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=o.length;a<s;++a)r[a]=o[a],i[o.charCodeAt(a)]=a;function l(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");-1===r&&(r=e);var i=r===e?0:4-r%4;return[r,i]}i[45]=62,i[95]=63},72:function(t,e,r){"use strict";var i=r(675),n=r(783),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(t){if(t>0x7fffffff)throw RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,r){if("number"==typeof t){if("string"==typeof e)throw TypeError('The "string" argument must be of type string. Received type number');return u(t)}return l(t,e,r)}function l(t,e,r){if("string"==typeof t){var i=t,n=e;if(("string"!=typeof n||""===n)&&(n="utf8"),!s.isEncoding(n))throw TypeError("Unknown encoding: "+n);var o=0|p(i,n),l=a(o),f=l.write(i,n);return f!==o&&(l=l.slice(0,f)),l}if(ArrayBuffer.isView(t))return h(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(k(t,ArrayBuffer)||t&&k(t.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(k(t,SharedArrayBuffer)||t&&k(t.buffer,SharedArrayBuffer)))return function(t,e,r){var i;if(e<0||t.byteLength<e)throw RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),s.prototype),i}(t,e,r);if("number"==typeof t)throw TypeError('The "value" argument must not be of type number. Received type number');var u=t.valueOf&&t.valueOf();if(null!=u&&u!==t)return s.from(u,e,r);var d=function(t){if(s.isBuffer(t)){var e=0|c(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||function(t){return t!=t}(t.length)?a(0):h(t):"Buffer"===t.type&&Array.isArray(t.data)?h(t.data):void 0}(t);if(d)return d;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function f(t){if("number"!=typeof t)throw TypeError('"size" argument must be of type number');if(t<0)throw RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return f(t),a(t<0?0:0|c(t))}function h(t){for(var e=t.length<0?0:0|c(t.length),r=a(e),i=0;i<e;i+=1)r[i]=255&t[i];return r}e.Buffer=s,e.SlowBuffer=function(t){return+t!=t&&(t=0),s.alloc(+t)},e.INSPECT_MAX_BYTES=50,e.kMaxLength=0x7fffffff,s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,r){return l(t,e,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,r){return(f(t),t<=0)?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)};function c(t){if(t>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|t}function p(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||k(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return S(t).length;default:if(n)return i?-1:L(t).length;e=(""+e).toLowerCase(),n=!0}}function d(t,e,r){var n,o,a,s=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",o=e;o<r;++o)n+=P[t[o]];return n}(this,e,r);case"utf8":case"utf-8":return w(this,e,r);case"ascii":return function(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}(this,e,r);case"latin1":case"binary":return function(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}(this,e,r);case"base64":return n=this,o=e,a=r,0===o&&a===n.length?i.fromByteArray(n):i.fromByteArray(n.slice(o,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,r){for(var i=t.slice(e,r),n="",o=0;o<i.length;o+=2)n+=String.fromCharCode(i[o]+256*i[o+1]);return n}(this,e,r);default:if(s)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),s=!0}}function g(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function m(t,e,r,i,n){var o;if(0===t.length)return -1;if("string"==typeof r?(i=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(o=r*=1)!=o&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length)if(n)return -1;else r=t.length-1;else if(r<0)if(!n)return -1;else r=0;if("string"==typeof e&&(e=s.from(e,i)),s.isBuffer(e))return 0===e.length?-1:y(t,e,r,i,n);if("number"==typeof e){if(e&=255,"function"==typeof Uint8Array.prototype.indexOf)if(n)return Uint8Array.prototype.indexOf.call(t,e,r);else return Uint8Array.prototype.lastIndexOf.call(t,e,r);return y(t,[e],r,i,n)}throw TypeError("val must be string, number or Buffer")}function y(t,e,r,i,n){var o,a=1,s=t.length,l=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return -1;a=2,s/=2,l/=2,r/=2}function f(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(n){var u=-1;for(o=r;o<s;o++)if(f(t,o)===f(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else -1!==u&&(o-=o-u),u=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var h=!0,c=0;c<l;c++)if(f(t,o+c)!==f(e,c)){h=!1;break}if(h)return o}return -1}s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(k(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),k(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,i=e.length,n=0,o=Math.min(r,i);n<o;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:+(i<r)},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);if(void 0===e)for(r=0,e=0;r<t.length;++r)e+=t[r].length;var r,i=s.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var o=t[r];if(k(o,Uint8Array)&&(o=s.from(o)),!s.isBuffer(o))throw TypeError('"list" argument must be an Array of Buffers');o.copy(i,n),n+=o.length}return i},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){var t=this.length;return 0===t?"":0==arguments.length?w(this,0,t):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},o&&(s.prototype[o]=s.prototype.inspect),s.prototype.compare=function(t,e,r,i,n){if(k(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return -1;if(e>=r)return 1;if(e>>>=0,r>>>=0,i>>>=0,n>>>=0,this===t)return 0;for(var o=n-i,a=r-e,l=Math.min(o,a),f=this.slice(i,n),u=t.slice(e,r),h=0;h<l;++h)if(f[h]!==u[h]){o=f[h],a=u[h];break}return o<a?-1:+(a<o)},s.prototype.includes=function(t,e,r){return -1!==this.indexOf(t,e,r)},s.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)};function w(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var o,a,s,l,f=t[n],u=null,h=f>239?4:f>223?3:f>191?2:1;if(n+h<=r)switch(h){case 1:f<128&&(u=f);break;case 2:(192&(o=t[n+1]))==128&&(l=(31&f)<<6|63&o)>127&&(u=l);break;case 3:o=t[n+1],a=t[n+2],(192&o)==128&&(192&a)==128&&(l=(15&f)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=t[n+1],a=t[n+2],s=t[n+3],(192&o)==128&&(192&a)==128&&(192&s)==128&&(l=(15&f)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=h}var c=i,p=c.length;if(p<=4096)return String.fromCharCode.apply(String,c);for(var d="",g=0;g<p;)d+=String.fromCharCode.apply(String,c.slice(g,g+=4096));return d}function b(t,e,r){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>r)throw RangeError("Trying to access beyond buffer length")}function v(t,e,r,i,n,o){if(!s.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<o)throw RangeError('"value" argument is out of bounds');if(r+i>t.length)throw RangeError("Index out of range")}function A(t,e,r,i,n,o){if(r+i>t.length||r<0)throw RangeError("Index out of range")}function x(t,e,r,i,o){return e*=1,r>>>=0,o||A(t,e,r,4,34028234663852886e22,-34028234663852886e22),n.write(t,e,r,i,23,4),r+4}function E(t,e,r,i,o){return e*=1,r>>>=0,o||A(t,e,r,8,17976931348623157e292,-17976931348623157e292),n.write(t,e,r,i,52,8),r+8}s.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var n,o,a,s,l,f,u,h,c=this.length-e;if((void 0===r||r>c)&&(r=c),t.length>0&&(r<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var p=!1;;)switch(i){case"hex":return function(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i))>n&&(i=n):i=n;var o=e.length;i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s,l=parseInt(e.substr(2*a,2),16);if((s=l)!=s)break;t[r+a]=l}return a}(this,t,e,r);case"utf8":case"utf-8":return n=e,o=r,C(L(t,this.length-n),this,n,o);case"ascii":return a=e,s=r,C(T(t),this,a,s);case"latin1":case"binary":return function(t,e,r,i){return C(T(e),t,r,i)}(this,t,e,r);case"base64":return l=e,f=r,C(S(t),this,l,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=e,h=r,C(function(t,e){for(var r,i,n=[],o=0;o<t.length&&!((e-=2)<0);++o)i=(r=t.charCodeAt(o))>>8,n.push(r%256),n.push(i);return n}(t,this.length-u),this,u,h);default:if(p)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),p=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var i=this.subarray(t,e);return Object.setPrototypeOf(i,s.prototype),i},s.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||b(t,e,this.length);for(var i=this[t],n=1,o=0;++o<e&&(n*=256);)i+=this[t+o]*n;return i},s.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||b(t,e,this.length);for(var i=this[t+--e],n=1;e>0&&(n*=256);)i+=this[t+--e]*n;return i},s.prototype.readUInt8=function(t,e){return t>>>=0,e||b(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||b(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||b(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||b(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+0x1000000*this[t+3]},s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||b(t,4,this.length),0x1000000*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||b(t,e,this.length);for(var i=this[t],n=1,o=0;++o<e&&(n*=256);)i+=this[t+o]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*e)),i},s.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||b(t,e,this.length);for(var i=e,n=1,o=this[t+--i];i>0&&(n*=256);)o+=this[t+--i]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return(t>>>=0,e||b(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||b(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?0xffff0000|r:r},s.prototype.readInt16BE=function(t,e){t>>>=0,e||b(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?0xffff0000|r:r},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||b(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||b(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return t>>>=0,e||b(t,4,this.length),n.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||b(t,4,this.length),n.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||b(t,8,this.length),n.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||b(t,8,this.length),n.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,r,i){if(t*=1,e>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;v(this,t,e,r,n,0)}var o=1,a=0;for(this[e]=255&t;++a<r&&(o*=256);)this[e+a]=t/o&255;return e+r},s.prototype.writeUIntBE=function(t,e,r,i){if(t*=1,e>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;v(this,t,e,r,n,0)}var o=r-1,a=1;for(this[e+o]=255&t;--o>=0&&(a*=256);)this[e+o]=t/a&255;return e+r},s.prototype.writeUInt8=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUInt16BE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUInt32LE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,4,0xffffffff,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUInt32BE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,4,0xffffffff,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeIntLE=function(t,e,r,i){if(t*=1,e>>>=0,!i){var n=Math.pow(2,8*r-1);v(this,t,e,r,n-1,-n)}var o=0,a=1,s=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a|0)-s&255;return e+r},s.prototype.writeIntBE=function(t,e,r,i){if(t*=1,e>>>=0,!i){var n=Math.pow(2,8*r-1);v(this,t,e,r,n-1,-n)}var o=r-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a|0)-s&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,4,0x7fffffff,-0x80000000),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,r){return t*=1,e>>>=0,r||v(this,t,e,4,0x7fffffff,-0x80000000),t<0&&(t=0xffffffff+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeFloatLE=function(t,e,r){return x(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return x(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return E(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return E(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,i){if(!s.isBuffer(t))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n=i-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,i);else if(this===t&&r<e&&e<i)for(var o=n-1;o>=0;--o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,i),e);return n},s.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!s.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===t.length){var n,o=t.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(t=o)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(n=e;n<r;++n)this[n]=t;else{var a=s.isBuffer(t)?t:s.from(t,i),l=a.length;if(0===l)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(n=0;n<r-e;++n)this[n+e]=a[n%l]}return this};var B=/[^+/0-9A-Za-z-_]/g;function L(t,e){e=e||1/0;for(var r,i=t.length,n=null,o=[],a=0;a<i;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319||a+1===i){(e-=3)>-1&&o.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return o}function T(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function S(t){return i.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function C(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length)&&!(n>=t.length);++n)e[n+r]=t[n];return n}function k(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}var P=function(){for(var t="0123456789abcdef",e=Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)e[i+n]=t[r]+t[n];return e}()},783:function(t,e){e.read=function(t,e,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,f=l>>1,u=-7,h=r?n-1:0,c=r?-1:1,p=t[e+h];for(h+=c,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+t[e+h],h+=c,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;u>0;a=256*a+t[e+h],h+=c,u-=8);if(0===o)o=1-f;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),o-=f}return(p?-1:1)*a*Math.pow(2,o-i)},e.write=function(t,e,r,i,n,o){var a,s,l,f=8*o-n-1,u=(1<<f)-1,h=u>>1,c=5960464477539062e-23*(23===n),p=i?0:o-1,d=i?1:-1,g=+(e<0||0===e&&1/e<0);for(isNaN(e=Math.abs(e))||e===1/0?(s=+!!isNaN(e),a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+h>=1?e+=c/l:e+=c*Math.pow(2,1-h),e*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(e*l-1)*Math.pow(2,n),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,n),a=0));n>=8;t[r+p]=255&s,p+=d,s/=256,n-=8);for(a=a<<n|s,f+=n;f>0;t[r+p]=255&a,p+=d,a/=256,f-=8);t[r+p-d]|=128*g}}},n={};function o(t){var e=n[t];if(void 0!==e)return e.exports;var r=n[t]={exports:{}},a=!0;try{i[t](r,r.exports,o),a=!1}finally{a&&delete n[t]}return r.exports}o.ab="/ROOT/node_modules/.pnpm/next@16.0.10_@babel+core@7.28.0_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/compiled/buffer/",e.exports=o(72)},778218,t=>{"use strict";var e=t.i(917409),r=t.i(96508),i=t.i(559147),n=t.i(424439);t.s(["useLibrary",0,()=>{let{envConfig:t}=(0,r.useEnv)(),{setLibrary:o}=(0,i.useLibraryStore)(),{setSettings:a}=(0,n.useSettingsStore)(),[s,l]=(0,e.useState)(!1),f=(0,e.useRef)(!1);return(0,e.useEffect)(()=>{f.current||(f.current=!0,(async()=>{let e=await t.getAppService();a(await e.loadSettings()),o(await e.loadLibraryBooks()),l(!0)})())},[]),{libraryLoaded:s}}])},104945,t=>{"use strict";let e=t=>document.createElementNS("http://www.w3.org/2000/svg",t);class r{#t=e("svg");#e=new Map;#r=null;constructor(t){this.#r=t,Object.assign(this.#t.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"})}get element(){return this.#t}get #i(){return/^((?!chrome|android).)*AppleWebKit/i.test(navigator.userAgent)&&!window.chrome&&window.getComputedStyle(this.#r.body).zoom||1}#n(t){let e=t.commonAncestorContainer,r=Array.from(e.querySelectorAll?.("p, h1, h2, h3, h4")||[]),i=[];return r.forEach(e=>{let r=document.createRange();t.intersectsNode(e)&&(r.selectNodeContents(e),0>r.compareBoundaryPoints(Range.START_TO_START,t)&&r.setStart(t.startContainer,t.startOffset),r.compareBoundaryPoints(Range.END_TO_END,t)>0&&r.setEnd(t.endContainer,t.endOffset),i.push(r))}),0===i.length?[t]:i}add(t,e,r,i){this.#e.has(t)&&this.remove(t),"function"==typeof e&&(e=e(this.#t.getRootNode()));let n=this.#i,o=[];this.#n(e).forEach(t=>{let e=Array.from(t.getClientRects()).map(t=>({left:t.left*n,top:t.top*n,right:t.right*n,bottom:t.bottom*n,width:t.width*n,height:t.height*n}));o=o.concat(e)});let a=r(o,i);this.#t.append(a),this.#e.set(t,{range:e,draw:r,options:i,element:a,rects:o})}remove(t){this.#e.has(t)&&(this.#t.removeChild(this.#e.get(t).element),this.#e.delete(t))}redraw(){for(let t of this.#e.values()){let{range:e,draw:r,options:i,element:n}=t;this.#t.removeChild(n);let o=this.#i,a=[];this.#n(e).forEach(t=>{let e=Array.from(t.getClientRects()).map(t=>({left:t.left*o,top:t.top*o,right:t.right*o,bottom:t.bottom*o,width:t.width*o,height:t.height*o}));a=a.concat(e)});let s=r(a,i);this.#t.append(s),t.element=s,t.rects=a}}hitTest({x:t,y:e}){let r=Array.from(this.#e.entries());for(let i=r.length-1;i>=0;i--){let[n,o]=r[i];for(let{left:r,top:i,right:a,bottom:s}of o.rects)if(i<=e+5&&r<=t+5&&s>e-5&&a>t-5)return[n,o.range,{left:r,top:i,right:a,bottom:s}]}return[]}static underline(t,r={}){let{color:i="red",width:n=2,padding:o=0,writingMode:a}=r,s=e("g");if(s.setAttribute("fill",i),"vertical-rl"===a||"vertical-lr"===a)for(let{right:r,top:i,height:a}of t){let t=e("rect");t.setAttribute("x",r-n/2+o),t.setAttribute("y",i),t.setAttribute("height",a),t.setAttribute("width",n),s.append(t)}else for(let{left:r,bottom:i,width:a}of t){let t=e("rect");t.setAttribute("x",r),t.setAttribute("y",i-n/2+o),t.setAttribute("height",n),t.setAttribute("width",a),s.append(t)}return s}static strikethrough(t,r={}){let{color:i="red",width:n=2,writingMode:o}=r,a=e("g");if(a.setAttribute("fill",i),"vertical-rl"===o||"vertical-lr"===o)for(let{right:r,left:i,top:o,height:s}of t){let t=e("rect");t.setAttribute("x",(r+i)/2),t.setAttribute("y",o),t.setAttribute("height",s),t.setAttribute("width",n),a.append(t)}else for(let{left:r,top:i,bottom:o,width:s}of t){let t=e("rect");t.setAttribute("x",r),t.setAttribute("y",(i+o)/2),t.setAttribute("height",n),t.setAttribute("width",s),a.append(t)}return a}static squiggly(t,r={}){let{color:i="red",width:n=2,padding:o=0,writingMode:a}=r,s=e("g");s.setAttribute("fill","none"),s.setAttribute("stroke",i),s.setAttribute("stroke-width",n);let l=1.5*n;if("vertical-rl"===a||"vertical-lr"===a)for(let{right:r,top:i,height:a}of t){let t=e("path"),f=Math.round(a/l/1.5),u=a/f,h=Array.from({length:f},(t,e)=>`l${e%2?-l:l} ${u}`).join("");t.setAttribute("d",`M${r-n/2+o} ${i}${h}`),s.append(t)}else for(let{left:r,bottom:i,width:a}of t){let t=e("path"),f=Math.round(a/l/1.5),u=a/f,h=Array.from({length:f},(t,e)=>`l${u} ${e%2?l:-l}`).join("");t.setAttribute("d",`M${r} ${i+n/2+o}${h}`),s.append(t)}return s}static highlight(t,r={}){let{color:i="red",padding:n=0}=r,o=e("g");for(let{left:r,top:a,height:s,width:l}of(o.setAttribute("fill",i),o.style.opacity="var(--overlayer-highlight-opacity, .3)",o.style.mixBlendMode="var(--overlayer-highlight-blend-mode, normal)",t)){let t=e("rect");t.setAttribute("x",r-n),t.setAttribute("y",a-n),t.setAttribute("height",s+2*n),t.setAttribute("width",l+2*n),o.append(t)}return o}static outline(t,r={}){let{color:i="red",width:n=3,padding:o=0,radius:a=3}=r,s=e("g");for(let{left:r,top:l,height:f,width:u}of(s.setAttribute("fill","none"),s.setAttribute("stroke",i),s.setAttribute("stroke-width",n),t)){let t=e("rect");t.setAttribute("x",r-o),t.setAttribute("y",l-o),t.setAttribute("height",f+2*o),t.setAttribute("width",u+2*o),t.setAttribute("rx",a),s.append(t)}return s}static bubble(t,r={}){let{color:i="#fbbf24",writingMode:n,opacity:o=.85,size:a=20,padding:s=10}=r,l="vertical-rl"===n||"vertical-lr"===n,f=e("g");if(f.style.opacity=o,0===t.length)return f;t.splice(1);let u=t[0],h=u.right-a+s,c=l?u.bottom-a+s:u.top-a+s;u.top=c-s,u.right=h+a+s,u.bottom=c+a+s,u.left=h-s;let p=e("path"),d=.15*a,g=`
            M ${h+d} ${c}
            h ${a-2*d}
            a ${d} ${d} 0 0 1 ${d} ${d}
            v ${.65*a-2*d}
            a ${d} ${d} 0 0 1 ${-d} ${d}
            h ${-(.3*a)}
            l ${-(.15*a)} ${.2*a}
            l ${.05*a} ${-(.2*a)}
            h ${-(.6*a)+2*d}
            a ${d} ${d} 0 0 1 ${-d} ${-d}
            v ${-(.65*a)+2*d}
            a ${d} ${d} 0 0 1 ${d} ${-d}
            z
        `.replace(/\s+/g," ").trim();p.setAttribute("d",g),p.setAttribute("fill",i),p.setAttribute("stroke","rgba(0, 0, 0, 0.2)"),p.setAttribute("stroke-width","1");let m=e("g");m.setAttribute("stroke","rgba(0, 0, 0, 0.3)"),m.setAttribute("stroke-width","1.5"),m.setAttribute("stroke-linecap","round");let y=c+.18*a,w=c+.33*a,b=c+.48*a,v=h+.2*a,A=h+.8*a,x=e("line");x.setAttribute("x1",v),x.setAttribute("y1",y),x.setAttribute("x2",A),x.setAttribute("y2",y);let E=e("line");E.setAttribute("x1",v),E.setAttribute("y1",w),E.setAttribute("x2",A),E.setAttribute("y2",w);let B=e("line");if(B.setAttribute("x1",v),B.setAttribute("y1",b),B.setAttribute("x2",h+.6*a),B.setAttribute("y2",b),m.append(x,E,B),l){let t=h+a/2,e=c+a/2;p.setAttribute("transform",`rotate(90 ${t} ${e})`),m.setAttribute("transform",`rotate(90 ${t} ${e})`)}return f.append(p),f.append(m),f}static copyImage([t],r={}){let{src:i}=r,n=e("image"),{left:o,top:a,height:s,width:l}=t;return n.setAttribute("href",i),n.setAttribute("x",o),n.setAttribute("y",a),n.setAttribute("height",s),n.setAttribute("width",l),n}}t.s(["Overlayer",()=>r])},187722,t=>{t.v(e=>Promise.all(["static/chunks/81d1d75e9e131825.js"].map(e=>t.l(e))).then(()=>e(859708)))},722516,t=>{t.v(e=>Promise.all(["static/chunks/469432e3b698cd7d.js"].map(e=>t.l(e))).then(()=>e(54225)))},119421,t=>{t.v(e=>Promise.all(["static/chunks/19020269b9e1aa74.js"].map(e=>t.l(e))).then(()=>e(283704)))},89544,t=>{t.v(e=>Promise.all(["static/chunks/684ebfba3ff2905e.js"].map(e=>t.l(e))).then(()=>e(516286)))},511607,t=>{t.v(e=>Promise.all(["static/chunks/3be72551b54a43b7.js"].map(e=>t.l(e))).then(()=>e(186508)))},620701,t=>{t.v(e=>Promise.all(["static/chunks/8e4e60ea9cdebc21.js"].map(e=>t.l(e))).then(()=>e(480474)))},664253,t=>{t.v(e=>Promise.all(["static/chunks/2fd9391baa13278f.js"].map(e=>t.l(e))).then(()=>e(148225)))},218492,t=>{t.v(e=>Promise.all(["static/chunks/db5785ad2c9de42a.js"].map(e=>t.l(e))).then(()=>e(825865)))},888741,t=>{t.v(e=>Promise.all(["static/chunks/36f64fba030685ba.js"].map(e=>t.l(e))).then(()=>e(186846)))},476099,t=>{t.v(e=>Promise.all(["static/chunks/aaeaef2cc5676826.js"].map(e=>t.l(e))).then(()=>e(135463)))},804133,t=>{t.v(e=>Promise.all(["static/chunks/81fb451f81fb07ed.js"].map(e=>t.l(e))).then(()=>e(103374)))}]);