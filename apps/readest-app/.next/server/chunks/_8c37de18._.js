module.exports=[612206,e=>{"use strict";let t,r=(e,t)=>[-1,...t,e.length].reduce(({xs:t,a:r},n)=>({xs:t?.concat([e.slice(r+1,n)])??[],a:n}),{}).xs,n=/\d/,s=/^epubcfi\((.*)\)$/,i=e=>e.replace(/[\^[\](),;=]/g,"^$&"),l=e=>s.test(e)?e:`epubcfi(${e})`,a=(t=(...e)=>e.join("!"),(...e)=>`epubcfi(${t(...e.map(e=>e.match(s)?.[1]??e))})`),o=(e,t)=>{let r;return r=([e])=>e===t,e.map((e,t,n)=>r(e,t,n)?t:null).filter(e=>null!=e)},f=e=>{let t,r=[];for(let[n,s]of e){if("/"===n)r.push({index:s});else{let e=r[r.length-1];if(":"===n)e.offset=s;else if("~"===n)e.temporal=s;else if("@"===n)e.spatial=(e.spatial??[]).concat(s);else if(";s"===n)e.side=s;else if("["===n)if("/"===t&&s)e.id=s;else{e.text=(e.text??[]).concat(s);continue}}t=n}return r},u=e=>r(e,o(e,"!")).map(f),c=e=>{let t=(e=>{let t=[],r,s,i="",l=e=>(t.push(e),r=null,i=""),a=e=>(i+=e,s=!1);for(let t of Array.from(e.trim()).concat("")){if("^"===t&&!s){s=!0;continue}if("!"===r)l(["!"]);else if(","===r)l([","]);else if("/"===r||":"===r)if(n.test(t)){a(t);continue}else l([r,parseInt(i)]);else if("~"===r)if(n.test(t)||"."===t){a(t);continue}else l(["~",parseFloat(i)]);else if("@"===r){if(":"===t){l(["@",parseFloat(i)]),r="@";continue}if(n.test(t)||"."===t){a(t);continue}l(["@",parseFloat(i)])}else if("["===r){";"!==t||s?","!==t||s?"]"!==t||s?a(t):l(["[",i]):(l(["[",i]),r="["):(l(["[",i]),r=";");continue}else if(r?.startsWith(";")){"="!==t||s?";"!==t||s?"]"!==t||s?a(t):l([r,i]):(l([r,i]),r=";"):(r=`;${i}`,i="");continue}("/"===t||":"===t||"~"===t||"@"===t||"["===t||"!"===t||","===t)&&(r=t)}return t})(e.match(s)?.[1]??e),i=o(t,",");if(!i.length)return u(t);let[l,a,f]=r(t,i).map(u);return{parent:l,start:a,end:f}},h=({index:e,id:t,offset:r,temporal:n,spatial:s,text:l,side:a})=>{let o=a?`;s=${a}`:"";return`/${e}`+(t?`[${i(t)}${o}]`:"")+(null!=r&&e%2?`:${r}`:"")+(n?`~${n}`:"")+(s?`@${s.join(":")}`:"")+(l||!t&&a?"["+(l?.map(i)?.join(",")??"")+o+"]":"")},d=e=>e.parent?[e.parent,e.start,e.end].map(d).join(","):e.map(e=>e.map(h).join("")).join("!"),p=e=>l(d(e)),m=(e,t)=>{let r,n;return"string"==typeof e?p(m(c(e),t)):e.parent?(r=e.parent,n=e[t?"end":"start"],r.slice(0,-1).concat([r[r.length-1].concat(n[0])]).concat(n.slice(1))):e},_=(e,t)=>{"string"==typeof e&&(e=c(e)),"string"==typeof t&&(t=c(t)),e=m(e),t=m(t,!0);let r=e[e.length-1],n=t[t.length-1],s=[],i=[],l=[],a=!0,o=Math.max(r.length,n.length);for(let e=0;e<o;e++){let t=r[e],o=n[e];(a&&=t?.index===o?.index&&!t?.offset&&!o?.offset)?s.push(t):(t&&i.push(t),o&&l.push(o))}return p({parent:e.slice(0,-1).concat([s]),start:[i],end:[l]})},g=(e,t)=>{if("string"==typeof e&&(e=c(e)),"string"==typeof t&&(t=c(t)),e.start||t.start)return g(m(e),m(t))||g(m(e,!0),m(t,!0));for(let r=0;r<Math.max(e.length,t.length);r++){let n=e[r]??[],s=t[r]??[],i=Math.max(n.length,s.length)-1;for(let e=0;e<=i;e++){let t=n[e],r=s[e];if(!t)return -1;if(!r||t.index>r.index)return 1;if(t.index<r.index)return -1;if(e===i){if(t.offset>r.offset)return 1;if(t.offset<r.offset)return -1}}}return 0},v=({nodeType:e})=>3===e||4===e,b=(e,t)=>{let r=Array.from(e.childNodes).filter(e=>v(e)||(({nodeType:e})=>1===e)(e));return t?r.map(e=>{let r=t(e);return r===NodeFilter.FILTER_REJECT?null:r===NodeFilter.FILTER_SKIP?b(e,t):e}).flat().filter(e=>e):r},k=(e,t)=>{let r=b(e,t).reduce((e,t)=>{let r=e[e.length-1];return r?v(t)?Array.isArray(r)?r.push(t):v(r)?e[e.length-1]=[r,t]:e.push(t):(({nodeType:e})=>1===e)(r)?e.push(null,t):e.push(t):e.push(t),e},[]);return(({nodeType:e})=>1===e)(r[0])&&r.unshift("first"),(({nodeType:e})=>1===e)(r[r.length-1])&&r.push("last"),r.unshift("before"),r.push("after"),r},w=(e,t,r)=>{let{id:n}=t[t.length-1];if(n){let t=e.ownerDocument.getElementById(n);if(t)return{node:t,offset:0}}for(let{index:n}of t){let t=e?k(e,r)[n]:null;if("first"===t)return{node:e.firstChild??e};if("last"===t)return{node:e.lastChild??e};if("before"===t)return{node:e,before:!0};if("after"===t)return{node:e,after:!0};e=t}let{offset:s}=t[t.length-1];if(!Array.isArray(e))return{node:e,offset:s};let i=0;for(let t of e){let{length:e}=t.nodeValue;if(i+e>=s)return{node:t,offset:s-i};i+=e}},y=(e,t,r)=>{let{parentNode:n,id:s}=e,i=k(n,r),l=i.findIndex(t=>Array.isArray(t)?t.some(t=>t===e):t===e),a=i[l];if(Array.isArray(a)){let r=0;for(let n of a)if(n===e){r+=t;break}else r+=n.nodeValue.length;t=r}let o={id:s,index:l,offset:t};return(n!==e.ownerDocument.documentElement?y(n,null,r).concat(o):[o]).filter(e=>-1!==e.index)},E={fromIndex:e=>l(`/6/${(e+1)*2}`),toIndex:e=>e?.at(-1).index/2-1};e.s(["collapse",0,m,"compare",0,g,"fake",0,E,"fromCalibreHighlight",0,({spine_index:e,start_cfi:t,end_cfi:r})=>{let n=E.fromIndex(e)+"!";return _(n+t.slice(2),n+r.slice(2))},"fromCalibrePos",0,e=>{let[t]=c(e),r=t.shift();return t.shift(),p([[{index:6},r],t])},"fromElements",0,e=>{let t=[],{parentNode:r}=e[0],n=y(r);for(let[s,i]of k(r).entries()){let r=e[t.length];i===r&&t.push(p([n.concat({id:r.id,index:s})]))}return t},"fromRange",0,(e,t)=>{let{startContainer:r,startOffset:n,endContainer:s,endOffset:i}=e,l=y(r,n,t);return e.collapsed?p([l]):_([l],[y(s,i,t)])},"isCFI",0,s,"joinIndir",0,a,"parse",0,c,"toElement",0,(e,t)=>w(e.documentElement,m(t)).node,"toRange",0,(e,t,r)=>{let n=m(t),s=m(t,!0),i=e.documentElement,l=w(i,n[0],r),a=w(i,s[0],r),o=e.createRange();return l.before?o.setStartBefore(l.node):l.after?o.setStartAfter(l.node):o.setStart(l.node,l.offset),a.before?o.setEndBefore(a.node):a.after?o.setEndAfter(a.node):o.setEnd(a.node,a.offset),o}])},826165,e=>{"use strict";var t,r,n,s,i;function l(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function a(e,t,r,n,s){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}"function"==typeof SuppressedError&&SuppressedError;let o="__TAURI_TO_IPC_KEY__";class f{constructor(e){t.set(this,void 0),r.set(this,0),n.set(this,[]),s.set(this,void 0),a(this,t,e||(()=>{}),"f"),this.id=function(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}(e=>{let i=e.index;if("end"in e)return void(i==l(this,r,"f")?this.cleanupCallback():a(this,s,i,"f"));let o=e.message;if(i==l(this,r,"f")){for(l(this,t,"f").call(this,o),a(this,r,l(this,r,"f")+1,"f");l(this,r,"f")in l(this,n,"f");){let e=l(this,n,"f")[l(this,r,"f")];l(this,t,"f").call(this,e),delete l(this,n,"f")[l(this,r,"f")],a(this,r,l(this,r,"f")+1,"f")}l(this,r,"f")===l(this,s,"f")&&this.cleanupCallback()}else l(this,n,"f")[i]=o})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(e){a(this,t,e,"f")}get onmessage(){return l(this,t,"f")}[(t=new WeakMap,r=new WeakMap,n=new WeakMap,s=new WeakMap,o)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[o]()}}async function u(e,t={},r){return window.__TAURI_INTERNALS__.invoke(e,t,r)}function c(e,t="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(e,t)}class h{get rid(){return l(this,i,"f")}constructor(e){i.set(this,void 0),a(this,i,e,"f")}async close(){return u("plugin:resources|close",{rid:this.rid})}}i=new WeakMap,e.s(["Channel",()=>f,"Resource",()=>h,"convertFileSrc",()=>c,"invoke",()=>u],826165)},310848,e=>{e.v(t=>Promise.all(["server/chunks/f449e_@zip_js_zip_js_index_05a28c8a.js"].map(t=>e.l(t))).then(()=>t(531872)))},260943,e=>{e.v(t=>Promise.all(["server/chunks/packages_foliate-js_mobi_f7dd4b25.js"].map(t=>e.l(t))).then(()=>t(3209)))},829768,e=>{e.v(t=>Promise.all(["server/chunks/packages_foliate-js_fb2_669414ef.js"].map(t=>e.l(t))).then(()=>t(906533)))},704396,e=>{e.v(t=>Promise.all(["server/chunks/packages_foliate-js_vendor_fflate_bdf6918a.js"].map(t=>e.l(t))).then(()=>t(880987)))},228371,e=>{e.v(t=>Promise.all(["server/chunks/packages_foliate-js_pdf_6667cb35.js"].map(t=>e.l(t))).then(()=>t(64767)))},926413,e=>{e.v(t=>Promise.all(["server/chunks/packages_foliate-js_epub_2f7535b7.js"].map(t=>e.l(t))).then(()=>t(721448)))},121014,e=>{e.v(t=>Promise.all(["server/chunks/packages_foliate-js_comic-book_4b3761e5.js"].map(t=>e.l(t))).then(()=>t(983135)))}];

//# sourceMappingURL=_8c37de18._.js.map