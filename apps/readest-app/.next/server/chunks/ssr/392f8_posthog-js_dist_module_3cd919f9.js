module.exports=[836458,a=>{"use strict";let b,c;var d=void 0,e="undefined"!=typeof globalThis?globalThis:d,f=Array.prototype,g=f.forEach,h=f.indexOf,i=null==e?void 0:e.navigator,j=null==e?void 0:e.document,k=null==e?void 0:e.location,l=null==e?void 0:e.fetch,m=null!=e&&e.XMLHttpRequest&&"withCredentials"in new e.XMLHttpRequest?e.XMLHttpRequest:void 0,n=null==e?void 0:e.AbortController,o=null==i?void 0:i.userAgent,p=null!=d?d:{},q={DEBUG:!1,LIB_VERSION:"1.246.0"},r="$copy_autocapture",s=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"],t=((bo={}).GZipJS="gzip-js",bo.Base64="base64",bo),u=["fatal","error","warning","log","info","debug"];function v(a,b){return -1!==a.indexOf(b)}var w=function(a){return a.trim()},x=function(a){return a.replace(/^\$/,"")},y=Array.isArray,z=Object.prototype,A=z.hasOwnProperty,B=z.toString,C=y||function(a){return"[object Array]"===B.call(a)},D=a=>"function"==typeof a,E=a=>a===Object(a)&&!C(a),F=a=>{if(E(a)){for(var b in a)if(A.call(a,b))return!1;return!0}return!1},G=a=>void 0===a,H=a=>"[object String]"==B.call(a),I=a=>H(a)&&0===a.trim().length,J=a=>null===a,K=a=>G(a)||J(a),L=a=>"[object Number]"==B.call(a),M=a=>"[object Boolean]"===B.call(a),N=a=>v(s,a),O=a=>{var b={t:function(a){d&&(q.DEBUG||p.POSTHOG_DEBUG)&&!G(d.console)&&d.console},info:function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];b.t("log",...c)},warn:function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];b.t("warn",...c)},error:function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];b.t("error",...c)},critical:function(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];console.error(a,...c)},uninitializedWarning:a=>{b.error("You must initialize PostHog before calling "+a)},createLogger:b=>O(a+" "+b)};return b},P=O("[PostHog.js]"),Q=P.createLogger,R=Q("[ExternalScriptsLoader]"),S=(a,b,c)=>{if(a.config.disable_external_dependency_loading)return R.warn(b+" was requested but loading of external scripts is disabled."),c("Loading of external scripts is disabled");var d=null==j?void 0:j.querySelectorAll("script");if(d){for(var e=0;e<d.length;e++)if(d[e].src===b)return c()}var f=()=>{if(!j)return c("document not found");var d=j.createElement("script");if(d.type="text/javascript",d.crossOrigin="anonymous",d.src=b,d.onload=a=>c(void 0,a),d.onerror=a=>c(a),a.config.prepare_external_dependency_script&&(d=a.config.prepare_external_dependency_script(d)),!d)return c("prepare_external_dependency_script returned null");var e,f=j.querySelectorAll("body > script");f.length>0?null==(e=f[0].parentNode)||e.insertBefore(d,f[0]):j.body.appendChild(d)};null!=j&&j.body?f():null==j||j.addEventListener("DOMContentLoaded",f)};function T(){return(T=Object.assign.bind()).apply(null,arguments)}function U(a,b){if(null==a)return{};var c={};for(var d in a)if(({}).hasOwnProperty.call(a,d)){if(-1!==b.indexOf(d))continue;c[d]=a[d]}return c}p.__PosthogExtensions__=p.__PosthogExtensions__||{},p.__PosthogExtensions__.loadExternalDependency=(a,b,c)=>{var d="/static/"+b+".js?v="+a.version;"remote-config"===b&&(d="/array/"+a.config.token+"/config.js"),"toolbar"===b&&(d=d+"&t="+3e5*Math.floor(Date.now()/3e5));var e=a.requestRouter.endpointFor("assets",d);S(a,e,c)},p.__PosthogExtensions__.loadSiteApp=(a,b,c)=>{var d=a.requestRouter.endpointFor("api",b);S(a,d,c)};var V={};function W(a,b,c){if(C(a)){if(g&&a.forEach===g)a.forEach(b,c);else if("length"in a&&a.length===+a.length){for(var d=0,e=a.length;d<e;d++)if(d in a&&b.call(c,a[d],d)===V)return}}}function X(a,b,c){if(!K(a)){if(C(a))return W(a,b,c);if(a instanceof FormData){for(var d of a.entries())if(b.call(c,d[1],d[0])===V)return}else for(var e in a)if(A.call(a,e)&&b.call(c,a[e],e)===V)return}}var Y=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return W(c,function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},Z=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return W(c,function(b){W(b,function(b){a.push(b)})}),a};function $(a){for(var b=Object.keys(a),c=b.length,d=Array(c);c--;)d[c]=[b[c],a[b[c]]];return d}var _=function(a){return function(){try{for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return a.apply(this,c)}catch(a){P.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),P.critical(a)}}},aa=function(a){var b={};return X(a,function(a,c){(H(a)&&a.length>0||L(a))&&(b[c]=a)}),b},ab=["herokuapp.com","vercel.app","netlify.app"];function ac(a,b){for(var c=0;c<a.length;c++)if(b(a[c]))return a[c]}function ad(a,b,c,d){var{capture:e=!1,passive:f=!0}=null!=d?d:{};null==a||a.addEventListener(b,c,{capture:e,passive:f})}var ae="$people_distinct_id",af="__alias",ag="__timers",ah="$autocapture_disabled_server_side",ai="$heatmaps_enabled_server_side",aj="$exception_capture_enabled_server_side",ak="$error_tracking_suppression_rules",al="$web_vitals_enabled_server_side",am="$dead_clicks_enabled_server_side",an="$web_vitals_allowed_metrics",ao="$session_recording_enabled_server_side",ap="$console_log_recording_enabled_server_side",aq="$session_recording_network_payload_capture",ar="$session_recording_masking",as="$session_recording_canvas_recording",at="$replay_sample_rate",au="$replay_minimum_duration",av="$replay_script_config",aw="$sesid",ax="$session_is_sampled",ay="$session_recording_url_trigger_activated_session",az="$session_recording_event_trigger_activated_session",aA="$enabled_feature_flags",aB="$early_access_features",aC="$feature_flag_details",aD="$stored_person_properties",aE="$stored_group_properties",aF="$surveys",aG="$surveys_activated",aH="$flag_call_reported",aI="$user_state",aJ="$client_session_props",aK="$capture_rate_limit",aL="$initial_campaign_params",aM="$initial_referrer_info",aN="$initial_person_info",aO="$epp",aP="__POSTHOG_TOOLBAR__",aQ="$posthog_cookieless",aR=[ae,af,"__cmpns",ag,ao,ai,aw,aA,ak,aI,aB,aC,aE,aD,aF,aH,aJ,aK,aL,aM,aO,aN];function aS(a){return a instanceof Element&&(a.id===aP||!(null==a.closest||!a.closest(".toolbar-global-fade-container")))}function aT(a){return!!a&&1===a.nodeType}function aU(a,b){return!!a&&!!a.tagName&&a.tagName.toLowerCase()===b.toLowerCase()}function aV(a){return!!a&&3===a.nodeType}function aW(a){return a?w(a).split(/\s+/):[]}function aX(a){var b="";switch(typeof a.className){case"string":b=a.className;break;case"object":b=(a.className&&"baseVal"in a.className?a.className.baseVal:null)||a.getAttribute("class")||"";break;default:b=""}return aW(b)}function aY(a){return K(a)?null:w(a).split(/(\s+)/).filter(a=>a8(a)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function aZ(a){var b="";return a0(a)&&!a1(a)&&a.childNodes&&a.childNodes.length&&X(a.childNodes,function(a){var c;aV(a)&&a.textContent&&(b+=null!=(c=aY(a.textContent))?c:"")}),w(b)}function a$(a){var b;return G(a.target)?a.srcElement||null:null!=(b=a.target)&&b.shadowRoot?a.composedPath()[0]||null:a.target||null}var a_=["a","button","form","input","select","textarea","label"];function a0(a){for(var b=a;b.parentNode&&!aU(b,"body");b=b.parentNode){var c=aX(b);if(v(c,"ph-sensitive")||v(c,"ph-no-capture"))return!1}if(v(aX(a),"ph-include"))return!0;var d=a.type||"";if(H(d))switch(d.toLowerCase()){case"hidden":case"password":return!1}var e=a.name||a.id||"";return!(H(e)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(e.replace(/[^a-zA-Z0-9]/g,"")))}function a1(a){return!!(aU(a,"input")&&!["button","checkbox","submit","reset"].includes(a.type)||aU(a,"select")||aU(a,"textarea")||"true"===a.getAttribute("contenteditable"))}var a2="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",a3=RegExp("^(?:"+a2+")$"),a4=new RegExp(a2),a5="\\d{3}-?\\d{2}-?\\d{4}",a6=RegExp("^("+a5+")$"),a7=RegExp("("+a5+")");function a8(a,b){return void 0===b&&(b=!0),!(K(a)||H(a)&&(a=w(a),(b?a3:a4).test((a||"").replace(/[- ]/g,""))||(b?a6:a7).test(a)))&&!0}function a9(a){var b=aZ(a);return a8(b=(b+" "+function a(b){var c="";return b&&b.childNodes&&b.childNodes.length&&X(b.childNodes,function(b){var d;if(b&&"span"===(null==(d=b.tagName)?void 0:d.toLowerCase()))try{var e=aZ(b);c=(c+" "+e).trim(),b.childNodes&&b.childNodes.length&&(c=(c+" "+a(b)).trim())}catch(a){P.error("[AutoCapture]",a)}}),c}(a)).trim())?b:""}function ba(a){return a.replace(/"|\\"/g,'\\"')}class bb{constructor(){this.clicks=[]}isRageClick(a,b,c){var d=this.clicks[this.clicks.length-1];if(d&&Math.abs(a-d.x)+Math.abs(b-d.y)<30&&c-d.timestamp<1e3){if(this.clicks.push({x:a,y:b,timestamp:c}),3===this.clicks.length)return!0}else this.clicks=[{x:a,y:b,timestamp:c}];return!1}}var bc=["localhost","127.0.0.1"],bd=a=>{var b=null==j?void 0:j.createElement("a");return G(b)?null:(b.href=a,b)},be=function(a,b){void 0===b&&(b="&");var c,d,e=[];return X(a,function(a,b){G(a)||G(b)||"undefined"===b||(c=encodeURIComponent(a instanceof File?a.name:a.toString()),d=encodeURIComponent(b),e[e.length]=d+"="+c)}),e.join(b)},bf=function(a,b){for(var c,d=((a.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]===b){c=f;break}}if(!C(c)||c.length<2)return"";var g=c[1];try{g=decodeURIComponent(g)}catch(a){P.error("Skipping decoding for malformed query param: "+g)}return g.replace(/\+/g," ")},bg=function(a,b,c){if(!a||!b||!b.length)return a;for(var d=a.split("#"),e=d[0]||"",f=d[1],g=e.split("?"),h=g[1],i=g[0],j=(h||"").split("&"),k=[],l=0;l<j.length;l++){var m=j[l].split("=");C(m)&&(b.includes(m[0])?k.push(m[0]+"="+c):k.push(j[l]))}var n=i;return null!=h&&(n+="?"+k.join("&")),null!=f&&(n+="#"+f),n},bh=function(a,b){var c=a.match(RegExp(b+"=([^&]*)"));return c?c[1]:null},bi=Q("[AutoCapture]");function bj(a,b){return b.length>a?b.slice(0,a)+"...":b}class bk{constructor(a){this.i=!1,this.o=null,this.rageclicks=new bb,this.h=!1,this.instance=a,this.m=null}get S(){var a,b,c=E(this.instance.config.autocapture)?this.instance.config.autocapture:{};return c.url_allowlist=null==(a=c.url_allowlist)?void 0:a.map(a=>new RegExp(a)),c.url_ignorelist=null==(b=c.url_ignorelist)?void 0:b.map(a=>new RegExp(a)),c}$(){this.isBrowserSupported()||bi.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.i&&(this.$(),this.i=!0)}onRemoteConfig(a){a.elementsChainAsString&&(this.h=a.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[ah]:!!a.autocapture_opt_out}),this.o=!!a.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(a){this.m=a}getElementSelectors(a){var b,c=[];return null==(b=this.m)||b.forEach(b=>{var d=null==j?void 0:j.querySelectorAll(b);null==d||d.forEach(d=>{a===d&&c.push(b)})}),c}get isEnabled(){var a,b,c=null==(a=this.instance.persistence)?void 0:a.props[ah];if(J(this.o)&&!M(c)&&!this.instance.config.advanced_disable_decide)return!1;var d=null!=(b=this.o)?b:!!c;return!!this.instance.config.autocapture&&!d}k(a,b){if(void 0===b&&(b="$autocapture"),this.isEnabled){var c,e=a$(a);aV(e)&&(e=e.parentNode||null),"$autocapture"===b&&"click"===a.type&&a instanceof MouseEvent&&this.instance.config.rageclick&&null!=(c=this.rageclicks)&&c.isRageClick(a.clientX,a.clientY,(new Date).getTime())&&this.k(a,"$rageclick");if(e&&function(a,b,c,e,f){if(void 0===c&&(c=void 0),!d||!a||aU(a,"html")||!aT(a))return!1}(e,0,this.S,0,0)){var{props:f,explicitNoCapture:g}=function(a,b){for(var c,e,{e:f,maskAllElementAttributes:g,maskAllText:h,elementAttributeIgnoreList:i,elementsChainAsString:j}=b,k=[a],l=a;l.parentNode&&!aU(l,"body");)(m=l.parentNode)&&11===m.nodeType?(k.push(l.parentNode.host),l=l.parentNode.host):(k.push(l.parentNode),l=l.parentNode);var m,n,o=[],p={},q=!1,r=!1;if(X(k,a=>{var b=a0(a);"a"===a.tagName.toLowerCase()&&(q=a.getAttribute("href"),q=b&&q&&a8(q)&&q),v(aX(a),"ph-no-capture")&&(r=!0),o.push(function(a,b,c,d){var e=a.tagName.toLowerCase(),f={tag_name:e};a_.indexOf(e)>-1&&!c&&("a"===e.toLowerCase()||"button"===e.toLowerCase()?f.$el_text=bj(1024,a9(a)):f.$el_text=bj(1024,aZ(a)));var g=aX(a);g.length>0&&(f.classes=g.filter(function(a){return""!==a})),X(a.attributes,function(c){var e;if((!a1(a)||-1!==["name","id","class","aria-label"].indexOf(c.name))&&(null==d||!d.includes(c.name))&&!b&&a8(c.value)&&(!H(e=c.name)||"_ngcontent"!==e.substring(0,10)&&"_nghost"!==e.substring(0,7))){var g=c.value;"class"===c.name&&(g=aW(g).join(" ")),f["attr__"+c.name]=bj(1024,g)}});for(var h=1,i=1,j=a;j=function(a){if(a.previousElementSibling)return a.previousElementSibling;var b=a;do b=b.previousSibling;while(b&&!aT(b))return b}(j);)h++,j.tagName===a.tagName&&i++;return f.nth_child=h,f.nth_of_type=i,f}(a,g,h,i)),Y(p,function(a){if(!a0(a))return{};var b={};return X(a.attributes,function(a){if(a.name&&0===a.name.indexOf("data-ph-capture-attribute")){var c=a.name.replace("data-ph-capture-attribute-",""),d=a.value;c&&d&&a8(d)&&(b[c]=d)}}),b}(a))}),r)return{props:{},explicitNoCapture:r};if(h||("a"===a.tagName.toLowerCase()||"button"===a.tagName.toLowerCase()?o[0].$el_text=a9(a):o[0].$el_text=aZ(a)),q){o[0].attr__href=q;var s,t,u=null==(s=bd(q))?void 0:s.host,w=null==d||null==(t=d.location)?void 0:t.host;u&&w&&u!==w&&(n=q)}return{props:Y({$event_type:f.type,$ce_version:1},j?{}:{$elements:o},{$elements_chain:o.map(a=>{var b,c,d,e={text:null==(c=a.$el_text)?void 0:c.slice(0,400),tag_name:a.tag_name,href:null==(d=a.attr__href)?void 0:d.slice(0,2048),attr_class:(b=a.attr__class)?C(b)?b:aW(b):void 0,attr_id:a.attr__id,nth_child:a.nth_child,nth_of_type:a.nth_of_type,attributes:{}};return $(a).filter(a=>{var[b]=a;return 0===b.indexOf("attr__")}).forEach(a=>{var[b,c]=a;return e.attributes[b]=c}),e}).map(a=>{var b,c,d="";if(a.tag_name&&(d+=a.tag_name),a.attr_class)for(var e of(a.attr_class.sort(),a.attr_class))d+="."+e.replace(/"/g,"");var f=T({},a.text?{text:a.text}:{},{"nth-child":null!=(b=a.nth_child)?b:0,"nth-of-type":null!=(c=a.nth_of_type)?c:0},a.href?{href:a.href}:{},a.attr_id?{attr_id:a.attr_id}:{},a.attributes),g={};return $(f).sort((a,b)=>{var[c]=a,[d]=b;return c.localeCompare(d)}).forEach(a=>{var[b,c]=a;return g[ba(b.toString())]=ba(c.toString())}),d+=":",d+=$(g).map(a=>{var[b,c]=a;return b+'="'+c+'"'}).join("")}).join(";")},null!=(c=o[0])&&c.$el_text?{$el_text:null==(e=o[0])?void 0:e.$el_text}:{},n&&"click"===f.type?{$external_click_url:n}:{},p)}}(e,{e:a,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.S.element_attribute_ignorelist,elementsChainAsString:this.h});if(g)return!1;var h=this.getElementSelectors(e);if(h&&h.length>0&&(f.$element_selectors=h),b===r){var i,j=aY(null==d||null==(i=d.getSelection())?void 0:i.toString()),k=a.type||"clipboard";if(!j)return!1;f.$selected_content=j,f.$copy_type=k}return this.instance.capture(b,f),!0}}}isBrowserSupported(){return D(null==j?void 0:j.querySelectorAll)}}Math.trunc||(Math.trunc=function(a){return a<0?Math.ceil(a):Math.floor(a)}),Number.isInteger||(Number.isInteger=function(a){return L(a)&&isFinite(a)&&Math.floor(a)===a});var bl="0123456789abcdef";class bm{constructor(a){if(this.bytes=a,16!==a.length)throw TypeError("not 128-bit length")}static fromFieldsV7(a,b,c,d){if(!Number.isInteger(a)||!Number.isInteger(b)||!Number.isInteger(c)||!Number.isInteger(d)||a<0||b<0||c<0||d<0||a>0xffffffffffff||b>4095||c>0x3fffffff||d>0xffffffff)throw RangeError("invalid field value");var e=new Uint8Array(16);return e[0]=a/0x10000000000,e[1]=a/0x100000000,e[2]=a/0x1000000,e[3]=a/65536,e[4]=a/256,e[5]=a,e[6]=112|b>>>8,e[7]=b,e[8]=128|c>>>24,e[9]=c>>>16,e[10]=c>>>8,e[11]=c,e[12]=d>>>24,e[13]=d>>>16,e[14]=d>>>8,e[15]=d,new bm(e)}toString(){for(var a="",b=0;b<this.bytes.length;b++)a=a+bl.charAt(this.bytes[b]>>>4)+bl.charAt(15&this.bytes[b]),3!==b&&5!==b&&7!==b&&9!==b||(a+="-");if(36!==a.length)throw Error("Invalid UUIDv7 was generated");return a}clone(){return new bm(this.bytes.slice(0))}equals(a){return 0===this.compareTo(a)}compareTo(a){for(var b=0;b<16;b++){var c=this.bytes[b]-a.bytes[b];if(0!==c)return Math.sign(c)}return 0}}class bn{constructor(){this.I=0,this.P=0,this.R=new br}generate(){var a=this.generateOrAbort();if(G(a)){this.I=0;var b=this.generateOrAbort();if(G(b))throw Error("Could not generate UUID after timestamp reset");return b}return a}generateOrAbort(){var a=Date.now();if(a>this.I)this.I=a,this.T();else{if(!(a+1e4>this.I))return;this.P++,this.P>0x3ffffffffff&&(this.I++,this.T())}return bm.fromFieldsV7(this.I,Math.trunc(this.P/0x40000000),0x3fffffff&this.P,this.R.nextUint32())}T(){this.P=1024*this.R.nextUint32()+(1023&this.R.nextUint32())}}var bo,bp,bq=a=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");for(var b=0;b<a.length;b++)a[b]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return a};d&&!G(d.crypto)&&crypto.getRandomValues&&(bq=a=>crypto.getRandomValues(a));class br{constructor(){this.M=new Uint32Array(8),this.C=1/0}nextUint32(){return this.C>=this.M.length&&(bq(this.M),this.C=0),this.M[this.C++]}}var bs=()=>bt().toString(),bt=()=>(bp||(bp=new bn)).generate(),bu="",bv=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,bw={O:()=>!!j,F:function(a){P.error("cookieStore error: "+a)},A:function(a){if(j){try{for(var b=a+"=",c=j.cookie.split(";").filter(a=>a.length),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}}catch(a){}return null}},D:function(a){var b;try{b=JSON.parse(bw.A(a))||{}}catch(a){}return b},L:function(a,b,c,d,e){if(j)try{var f="",g="",h=function(a,b){if(b){var c=function(a,b){if(void 0===b&&(b=j),bu)return bu;if(!b||["localhost","127.0.0.1"].includes(a))return"";for(var c=a.split("."),d=Math.min(c.length,8),e="dmn_chk_"+bs();!bu&&d--;){var f=c.slice(d).join("."),g=e+"=1;domain=."+f+";path=/";b.cookie=g+";max-age=3",b.cookie.includes(e)&&(b.cookie=g+";max-age=0",bu=f)}return bu}(a);if(!c){var d,e=(d=a.match(bv))?d[0]:"";e!==c&&P.info("Warning: cookie subdomain discovery mismatch",e,c),c=e}return c?"; domain=."+c:""}return""}(j.location.hostname,d);if(c){var i=new Date;i.setTime(i.getTime()+24*c*36e5),f="; expires="+i.toUTCString()}e&&(g="; secure");var k=a+"="+encodeURIComponent(JSON.stringify(b))+f+"; SameSite=Lax; path=/"+h+g;return k.length>3686.4&&P.warn("cookieStore warning: large cookie, len="+k.length),j.cookie=k,k}catch(a){return}},N:function(a,b){try{bw.L(a,"",-1,b)}catch(a){return}}},bx=null,by={O:function(){if(!J(bx))return bx;var a=!0;return G(d)&&(a=!1),a||P.error("localStorage unsupported; falling back to cookie store"),bx=a,a},F:function(a){P.error("localStorage error: "+a)},A:function(a){try{return null==d?void 0:d.localStorage.getItem(a)}catch(a){by.F(a)}return null},D:function(a){try{return JSON.parse(by.A(a))||{}}catch(a){}return null},L:function(a,b){try{null==d||d.localStorage.setItem(a,JSON.stringify(b))}catch(a){by.F(a)}},N:function(a){try{null==d||d.localStorage.removeItem(a)}catch(a){by.F(a)}}},bz=["distinct_id",aw,ax,aO,aN],bA=T({},by,{D:function(a){try{var b={};try{b=bw.D(a)||{}}catch(a){}var c=Y(b,JSON.parse(by.A(a)||"{}"));return by.L(a,c),c}catch(a){}return null},L:function(a,b,c,d,e,f){try{by.L(a,b,void 0,void 0,f);var g={};bz.forEach(a=>{b[a]&&(g[a]=b[a])}),Object.keys(g).length&&bw.L(a,g,c,d,e,f)}catch(a){by.F(a)}},N:function(a,b){try{null==d||d.localStorage.removeItem(a),bw.N(a,b)}catch(a){by.F(a)}}}),bB={},bC={O:function(){return!0},F:function(a){P.error("memoryStorage error: "+a)},A:function(a){return bB[a]||null},D:function(a){return bB[a]||null},L:function(a,b){bB[a]=b},N:function(a){delete bB[a]}},bD=null,bE={O:function(){return J(bD)&&(bD=!0,G(d)&&(bD=!1)),bD},F:function(a){P.error("sessionStorage error: ",a)},A:function(a){try{return null==d?void 0:d.sessionStorage.getItem(a)}catch(a){bE.F(a)}return null},D:function(a){try{return JSON.parse(bE.A(a))||null}catch(a){}return null},L:function(a,b){try{null==d||d.sessionStorage.setItem(a,JSON.stringify(b))}catch(a){bE.F(a)}},N:function(a){try{null==d||d.sessionStorage.removeItem(a)}catch(a){bE.F(a)}}},bF=((bU={})[bU.PENDING=-1]="PENDING",bU[bU.DENIED=0]="DENIED",bU[bU.GRANTED=1]="GRANTED",bU);class bG{constructor(a){this._instance=a}get S(){return this._instance.config}get consent(){return this.j()?bF.DENIED:this.U}isOptedOut(){return this.consent===bF.DENIED||this.consent===bF.PENDING&&this.S.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(a){this.q.L(this.B,+!!a,this.S.cookie_expiration,this.S.cross_subdomain_cookie,this.S.secure_cookie)}reset(){this.q.N(this.B,this.S.cross_subdomain_cookie)}get B(){var{token:a,opt_out_capturing_cookie_prefix:b}=this._instance.config;return(b||"__ph_opt_in_out_")+a}get U(){var a=this.q.A(this.B);return"1"===a?bF.GRANTED:"0"===a?bF.DENIED:bF.PENDING}get q(){if(!this.H){var a=this.S.opt_out_capturing_persistence_type;this.H="localStorage"===a?by:bw;var b="localStorage"===a?bw:by;b.A(this.B)&&(this.H.A(this.B)||this.optInOut("1"===b.A(this.B)),b.N(this.B,this.S.cross_subdomain_cookie))}return this.H}j(){return!!this.S.respect_dnt&&!!ac([null==i?void 0:i.doNotTrack,null==i?void 0:i.msDoNotTrack,p.doNotTrack],a=>v([!0,1,"1","yes"],a))}}var bH=Q("[Dead Clicks]"),bI=()=>!0,bJ=a=>{var b,c=!(null==(b=a.instance.persistence)||!b.get_property(am)),d=a.instance.config.capture_dead_clicks;return M(d)?d:c};class bK{get lazyLoadedDeadClicksAutocapture(){return this.W}constructor(a,b,c){this.instance=a,this.isEnabled=b,this.onCapture=c,this.startIfEnabled()}onRemoteConfig(a){this.instance.persistence&&this.instance.persistence.register({[am]:null==a?void 0:a.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.G(()=>{this.J()})}G(a){var b,c;null!=(b=p.__PosthogExtensions__)&&b.initDeadClicksAutocapture&&a(),null==(c=p.__PosthogExtensions__)||null==c.loadExternalDependency||c.loadExternalDependency(this.instance,"dead-clicks-autocapture",b=>{b?bH.error("failed to load script",b):a()})}J(){var a;if(j){if(!this.W&&null!=(a=p.__PosthogExtensions__)&&a.initDeadClicksAutocapture){var b=E(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};b.__onCapture=this.onCapture,this.W=p.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,b),this.W.start(j),bH.info("starting...")}}else bH.error("`document` not found. Cannot start.")}stop(){this.W&&(this.W.stop(),this.W=void 0,bH.info("stopping..."))}}var bL=Q("[ExceptionAutocapture]");class bM{constructor(a){var b;this.V=()=>{var a;d&&this.isEnabled&&null!=(a=p.__PosthogExtensions__)&&a.errorWrappingFunctions},this._instance=a,this.tt=!(null==(b=this._instance.persistence)||!b.props[aj]),this.S=this.it(),this.startIfEnabled()}it(){var a=this._instance.config.capture_exceptions,b={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return E(a)?b=T({},b,a):(G(a)?this.tt:a)&&(b=T({},b,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),b}get isEnabled(){return this.S.capture_console_errors||this.S.capture_unhandled_errors||this.S.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(bL.info("enabled"),this.G(this.V))}G(a){var b,c;null!=(b=p.__PosthogExtensions__)&&b.errorWrappingFunctions&&a(),null==(c=p.__PosthogExtensions__)||null==c.loadExternalDependency||c.loadExternalDependency(this._instance,"exception-autocapture",b=>{if(b)return bL.error("failed to load script",b);a()})}Z(){var a,b,c;null==(a=this.K)||a.call(this),this.K=void 0,null==(b=this.Y)||b.call(this),this.Y=void 0,null==(c=this.X)||c.call(this),this.X=void 0}onRemoteConfig(a){var b=a.autocaptureExceptions;this.tt=!!b,this.S=this.it(),this._instance.persistence&&this._instance.persistence.register({[aj]:this.tt}),this.startIfEnabled()}captureException(a){a.$exception_personURL=this._instance.requestRouter.endpointFor("ui")+"/project/"+this._instance.config.token+"/person/"+this._instance.get_distinct_id(),this._instance.exceptions.sendExceptionEvent(a)}}function bN(a){return!G(Event)&&bO(a,Event)}function bO(a,b){try{return a instanceof b}catch(a){return!1}}function bP(a){switch(Object.prototype.toString.call(a)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object DOMError]":return!0;default:return bO(a,Error)}}function bQ(a,b){return Object.prototype.toString.call(a)==="[object "+b+"]"}function bR(a){return bQ(a,"DOMError")}var bS=/\(error: (.*)\)/;function bT(a,b,c,d){var e={platform:"web:javascript",filename:a,function:"<anonymous>"===b?"?":b,in_app:!0};return G(c)||(e.lineno=c),G(d)||(e.colno=d),e}var bU,bV,bW,bX,bY=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,bZ=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,b$=/\((\S*)(?::(\d+))(?::(\d+))\)/,b_=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,b0=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,b1=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b.sort((a,b)=>a[0]-b[0]).map(a=>a[1]);return function(a,b){void 0===b&&(b=0);for(var c=[],e=a.split("\n"),f=b;f<e.length;f++){var g=e[f];if(!(g.length>1024)){var h=bS.test(g)?g.replace(bS,"$1"):g;if(!h.match(/\S*Error: /)){for(var i of d){var j=i(h);if(j){c.push(j);break}}if(c.length>=50)break}}}if(!c.length)return[];var k=Array.from(c);return k.reverse(),k.slice(0,50).map(a=>{var b;return T({},a,{filename:a.filename||((b=k)[b.length-1]||{}).filename,function:a.function||"?"})})}}([30,a=>{var b=bY.exec(a);if(b){var[,c,d,e]=b;return bT(c,"?",+d,+e)}var f=bZ.exec(a);if(f){if(f[2]&&0===f[2].indexOf("eval")){var g=b$.exec(f[2]);g&&(f[2]=g[1],f[3]=g[2],f[4]=g[3])}var[h,i]=b2(f[1]||"?",f[2]);return bT(i,h,f[3]?+f[3]:void 0,f[4]?+f[4]:void 0)}}],[50,a=>{var b=b_.exec(a);if(b){if(b[3]&&b[3].indexOf(" > eval")>-1){var c=b0.exec(b[3]);c&&(b[1]=b[1]||"eval",b[3]=c[1],b[4]=c[2],b[5]="")}var d=b[3],e=b[1]||"?";return[e,d]=b2(e,d),bT(d,e,b[4]?+b[4]:void 0,b[5]?+b[5]:void 0)}}]),b2=(a,b)=>{var c=-1!==a.indexOf("safari-extension"),d=-1!==a.indexOf("safari-web-extension");return c||d?[-1!==a.indexOf("@")?a.split("@")[0]:"?",c?"safari-extension:"+b:"safari-web-extension:"+b]:[a,b]},b3=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function b4(a,b){void 0===b&&(b=0);var c=a.stacktrace||a.stack||"",d=a&&b5.test(a.message)?1:0;try{var e,f,g=(e=b1(c,d),f=function(a){var b=globalThis._posthogChunkIds;if(!b)return{};var c=Object.keys(b);return bX&&c.length===bW||(bW=c.length,bX=c.reduce((c,d)=>{bV||(bV={});var e=bV[d];if(e)c[e[0]]=e[1];else for(var f=a(d),g=f.length-1;g>=0;g--){var h=f[g],i=null==h?void 0:h.filename,j=b[d];if(i&&j){c[i]=j,bV[d]=[i,j];break}}return c},{})),bX}(b1),e.forEach(a=>{a.filename&&(a.chunk_id=f[a.filename])}),e);return g.slice(0,g.length-b)}catch(a){}return[]}var b5=/Minified React error #\d+;/i;function b6(a,b){return{$exception_list:function a(b,c){var d,e,f,g,h,i,j,k,l=(d=b,e=c,i=b4(d),j=null==(g=null==e?void 0:e.handled)||g,k=null!=(h=null==e?void 0:e.synthetic)&&h,{type:null!=e&&e.overrideExceptionType?e.overrideExceptionType:d.name,value:(f=d.message).error&&"string"==typeof f.error.message?String(f.error.message):String(f),stacktrace:{frames:i,type:"raw"},mechanism:{handled:j,synthetic:k}});return b.cause&&bP(b.cause)&&b.cause!==b?[l,...a(b.cause,{handled:null==c?void 0:c.handled,synthetic:null==c?void 0:c.synthetic})]:[l]}(a,b),$exception_level:"error"}}function b7(a,b){var c,d,e,f=null==(c=null==b?void 0:b.handled)||c,g=null==(d=null==b?void 0:b.synthetic)||d,h={type:null!=b&&b.overrideExceptionType?b.overrideExceptionType:null!=(e=null==b?void 0:b.defaultExceptionType)?e:"Error",value:a||(null==b?void 0:b.defaultExceptionMessage),mechanism:{handled:f,synthetic:g}};if(null!=b&&b.syntheticException){var i=b4(b.syntheticException,1);i.length&&(h.stacktrace={frames:i,type:"raw"})}return{$exception_list:[h],$exception_level:"error"}}class b8{constructor(a){var b;this._instance=a,this.et=(null==d||null==(b=d.location)?void 0:b.pathname)||""}get isEnabled(){return"history_change"===this._instance.config.capture_pageview}startIfEnabled(){this.isEnabled&&(P.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.rt&&this.rt(),this.rt=void 0,P.info("History API monitoring stopped")}monitorHistoryChanges(){}st(a){try{var b,c=null==d||null==(b=d.location)?void 0:b.pathname;if(!c)return;c!==this.et&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:a}),this.et=c}catch(b){P.error("Error capturing "+a+" pageview",b)}}nt(){if(!this.rt){var a=()=>{this.st("popstate")};ad(d,"popstate",a),this.rt=()=>{d&&d.removeEventListener("popstate",a)}}}}function b9(a){var b,c;return(null==(b=JSON.stringify(a,(c=[],function(a,b){if(E(b)){for(;c.length>0&&c[c.length-1]!==this;)c.pop();return c.includes(b)?"[Circular]":(c.push(b),b)}return b})))?void 0:b.length)||0}var ca=((b=ca||{})[b.DomContentLoaded=0]="DomContentLoaded",b[b.Load=1]="Load",b[b.FullSnapshot=2]="FullSnapshot",b[b.IncrementalSnapshot=3]="IncrementalSnapshot",b[b.Meta=4]="Meta",b[b.Custom=5]="Custom",b[b.Plugin=6]="Plugin",b),cb=((c=cb||{})[c.Mutation=0]="Mutation",c[c.MouseMove=1]="MouseMove",c[c.MouseInteraction=2]="MouseInteraction",c[c.Scroll=3]="Scroll",c[c.ViewportResize=4]="ViewportResize",c[c.Input=5]="Input",c[c.TouchMove=6]="TouchMove",c[c.MediaInteraction=7]="MediaInteraction",c[c.StyleSheetRule=8]="StyleSheetRule",c[c.CanvasMutation=9]="CanvasMutation",c[c.Font=10]="Font",c[c.Log=11]="Log",c[c.Drag=12]="Drag",c[c.StyleDeclaration=13]="StyleDeclaration",c[c.Selection=14]="Selection",c[c.AdoptedStyleSheet=15]="AdoptedStyleSheet",c[c.CustomElement=16]="CustomElement",c),cc="[SessionRecording]",cd="redacted",ce={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:a=>a,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},cf=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],cg=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],ch=["/s/","/e/","/i/"];function ci(a,b,c,d){if(K(a))return a;var e=(null==b?void 0:b["content-length"])||new Blob([a]).size;return H(e)&&(e=parseInt(e)),e>c?cc+" "+d+" body too large to record ("+e+" bytes)":a}function cj(a,b){if(K(a))return a;var c=a;return a8(c,!1)||(c=cc+" "+b+" body "+cd),X(cg,a=>{var d,e;null!=(d=c)&&d.length&&-1!==(null==(e=c)?void 0:e.indexOf(a))&&(c=cc+" "+b+" body "+cd+" as might contain: "+a)}),c}function ck(a,b,c,d,e){return b>c&&(P.warn("min cannot be greater than max."),b=c),L(a)?a>c?(d&&P.warn(d+" cannot be  greater than max: "+c+". Using max value instead."),c):a<b?(d&&P.warn(d+" cannot be less than min: "+b+". Using min value instead."),b):a:(d&&P.warn(d+" must be a number. using max or fallback. max: "+c+", fallback: "+e),ck(e||c,b,c,d))}class cl{constructor(a,b){var c,d;void 0===b&&(b={}),this.ot=100,this.lt=10,this.ut={},this.ht={},this.dt=()=>{Object.keys(this.ut).forEach(a=>{this.ut[a]=this.ut[a]+this.lt,this.ut[a]>=this.ot&&delete this.ut[a]})},this.vt=a=>{var b=this._rrweb.mirror.getNode(a);if("svg"!==(null==b?void 0:b.nodeName)&&b instanceof Element){var c=b.closest("svg");if(c)return[this._rrweb.mirror.getId(c),c]}return[a,b]},this.ct=a=>{var b,c,d,e,f,g,h,i;return(null!=(b=null==(c=a.removes)?void 0:c.length)?b:0)+(null!=(d=null==(e=a.attributes)?void 0:e.length)?d:0)+(null!=(f=null==(g=a.texts)?void 0:g.length)?f:0)+(null!=(h=null==(i=a.adds)?void 0:i.length)?h:0)},this.throttleMutations=a=>{if(3!==a.type||0!==a.data.source)return a;var b=a.data,c=this.ct(b);b.attributes&&(b.attributes=b.attributes.filter(a=>{var b,c,d,[e,f]=this.vt(a.id);return 0!==this.ut[e]&&(this.ut[e]=null!=(b=this.ut[e])?b:this.ot,this.ut[e]=Math.max(this.ut[e]-1,0),0===this.ut[e]&&(this.ht[e]||(this.ht[e]=!0,null==(c=(d=this.ft).onBlockedNode)||c.call(d,e,f))),a)}));var d=this.ct(b);return 0!==d||c===d?a:void 0},this._rrweb=a,this.ft=b,this.lt=ck(null!=(c=this.ft.refillRate)?c:this.lt,0,100,"mutation throttling refill rate"),this.ot=ck(null!=(d=this.ft.bucketSize)?d:this.ot,0,100,"mutation throttling bucket size"),setInterval(()=>{this.dt()},1e3)}}var cm=Uint8Array,cn=Uint16Array,co=Uint32Array,cp=new cm([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),cq=new cm([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cr=new cm([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cs=function(a,b){for(var c=new cn(31),d=0;d<31;++d)c[d]=b+=1<<a[d-1];var e=new co(c[30]);for(d=1;d<30;++d)for(var f=c[d];f<c[d+1];++f)e[f]=f-c[d]<<5|d;return[c,e]},ct=cs(cp,2),cu=ct[0],cv=ct[1];cu[28]=258,cv[258]=28;for(var cw=cs(cq,0)[1],cx=new cn(32768),cy=0;cy<32768;++cy){var cz=(43690&cy)>>>1|(21845&cy)<<1;cz=(61680&(cz=(52428&cz)>>>2|(13107&cz)<<2))>>>4|(3855&cz)<<4,cx[cy]=((65280&cz)>>>8|(255&cz)<<8)>>>1}var cA=function(a,b,c){for(var d=a.length,e=0,f=new cn(b);e<d;++e)++f[a[e]-1];var g,h=new cn(b);for(e=0;e<b;++e)h[e]=h[e-1]+f[e-1]<<1;if(c){g=new cn(1<<b);var i=15-b;for(e=0;e<d;++e)if(a[e])for(var j=e<<4|a[e],k=b-a[e],l=h[a[e]-1]++<<k,m=l|(1<<k)-1;l<=m;++l)g[cx[l]>>>i]=j}else for(g=new cn(d),e=0;e<d;++e)g[e]=cx[h[a[e]-1]++]>>>15-a[e];return g},cB=new cm(288);for(cy=0;cy<144;++cy)cB[cy]=8;for(cy=144;cy<256;++cy)cB[cy]=9;for(cy=256;cy<280;++cy)cB[cy]=7;for(cy=280;cy<288;++cy)cB[cy]=8;var cC=new cm(32);for(cy=0;cy<32;++cy)cC[cy]=5;var cD=cA(cB,9,0),cE=cA(cC,5,0),cF=function(a){return(a/8|0)+(7&a&&1)},cG=function(a,b,c){(null==c||c>a.length)&&(c=a.length);var d=new(a instanceof cn?cn:a instanceof co?co:cm)(c-b);return d.set(a.subarray(b,c)),d},cH=function(a,b,c){c<<=7&b;var d=b/8|0;a[d]|=c,a[d+1]|=c>>>8},cI=function(a,b,c){c<<=7&b;var d=b/8|0;a[d]|=c,a[d+1]|=c>>>8,a[d+2]|=c>>>16},cJ=function(a,b){for(var c=[],d=0;d<a.length;++d)a[d]&&c.push({s:d,f:a[d]});var e=c.length,f=c.slice();if(!e)return[new cm(0),0];if(1==e){var g=new cm(c[0].s+1);return g[c[0].s]=1,[g,1]}c.sort(function(a,b){return a.f-b.f}),c.push({s:-1,f:25001});var h=c[0],i=c[1],j=0,k=1,l=2;for(c[0]={s:-1,f:h.f+i.f,l:h,r:i};k!=e-1;)h=c[c[j].f<c[l].f?j++:l++],i=c[j!=k&&c[j].f<c[l].f?j++:l++],c[k++]={s:-1,f:h.f+i.f,l:h,r:i};var m=f[0].s;for(d=1;d<e;++d)f[d].s>m&&(m=f[d].s);var n=new cn(m+1),o=cK(c[k-1],n,0);if(o>b){d=0;var p=0,q=o-b,r=1<<q;for(f.sort(function(a,b){return n[b.s]-n[a.s]||a.f-b.f});d<e;++d){var s=f[d].s;if(!(n[s]>b))break;p+=r-(1<<o-n[s]),n[s]=b}for(p>>>=q;p>0;){var t=f[d].s;n[t]<b?p-=1<<b-n[t]++-1:++d}for(;d>=0&&p;--d){var u=f[d].s;n[u]==b&&(--n[u],++p)}o=b}return[new cm(n),o]},cK=function(a,b,c){return -1==a.s?Math.max(cK(a.l,b,c+1),cK(a.r,b,c+1)):b[a.s]=c},cL=function(a){for(var b=a.length;b&&!a[--b];);for(var c=new cn(++b),d=0,e=a[0],f=1,g=function(a){c[d++]=a},h=1;h<=b;++h)if(a[h]==e&&h!=b)++f;else{if(!e&&f>2){for(;f>138;f-=138)g(32754);f>2&&(g(f>10?f-11<<5|28690:f-3<<5|12305),f=0)}else if(f>3){for(g(e),--f;f>6;f-=6)g(8304);f>2&&(g(f-3<<5|8208),f=0)}for(;f--;)g(e);f=1,e=a[h]}return[c.subarray(0,d),b]},cM=function(a,b){for(var c=0,d=0;d<b.length;++d)c+=a[d]*b[d];return c},cN=function(a,b,c){var d=c.length,e=cF(b+2);a[e]=255&d,a[e+1]=d>>>8,a[e+2]=255^a[e],a[e+3]=255^a[e+1];for(var f=0;f<d;++f)a[e+f+4]=c[f];return 8*(e+4+d)},cO=function(a,b,c,d,e,f,g,h,i,j,k){cH(b,k++,c),++e[256];for(var l=cJ(e,15),m=l[0],n=l[1],o=cJ(f,15),p=o[0],q=o[1],r=cL(m),s=r[0],t=r[1],u=cL(p),v=u[0],w=u[1],x=new cn(19),y=0;y<s.length;++y)x[31&s[y]]++;for(y=0;y<v.length;++y)x[31&v[y]]++;for(var z=cJ(x,7),A=z[0],B=z[1],C=19;C>4&&!A[cr[C-1]];--C);var D,E,F,G,H=j+5<<3,I=cM(e,cB)+cM(f,cC)+g,J=cM(e,m)+cM(f,p)+g+14+3*C+cM(x,A)+(2*x[16]+3*x[17]+7*x[18]);if(H<=I&&H<=J)return cN(b,k,a.subarray(i,i+j));if(cH(b,k,1+(J<I)),k+=2,J<I){D=cA(m,n,0),E=m,F=cA(p,q,0),G=p;var K=cA(A,B,0);for(cH(b,k,t-257),cH(b,k+5,w-1),cH(b,k+10,C-4),k+=14,y=0;y<C;++y)cH(b,k+3*y,A[cr[y]]);k+=3*C;for(var L=[s,v],M=0;M<2;++M){var N=L[M];for(y=0;y<N.length;++y){var O=31&N[y];cH(b,k,K[O]),k+=A[O],O>15&&(cH(b,k,N[y]>>>5&127),k+=N[y]>>>12)}}}else D=cD,E=cB,F=cE,G=cC;for(y=0;y<h;++y)if(d[y]>255){cI(b,k,D[(O=d[y]>>>18&31)+257]),k+=E[O+257],O>7&&(cH(b,k,d[y]>>>23&31),k+=cp[O]);var P=31&d[y];cI(b,k,F[P]),k+=G[P],P>3&&(cI(b,k,d[y]>>>5&8191),k+=cq[P])}else cI(b,k,D[d[y]]),k+=E[d[y]];return cI(b,k,D[256]),k+E[256]},cP=new co([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),cQ=function(){for(var a=new co(256),b=0;b<256;++b){for(var c=b,d=9;--d;)c=(1&c&&0xedb88320)^c>>>1;a[b]=c}return a}(),cR=function(){var a=0xffffffff;return{p:function(b){for(var c=a,d=0;d<b.length;++d)c=cQ[255&c^b[d]]^c>>>8;a=c},d:function(){return 0xffffffff^a}}},cS=function(a,b,c){for(;c;++b)a[b]=c,c>>>=8},cT=function(a,b){var c=b.filename;if(a[0]=31,a[1]=139,a[2]=8,a[8]=b.level<2?4:2*(9==b.level),a[9]=3,0!=b.mtime&&cS(a,4,Math.floor(new Date(b.mtime||Date.now())/1e3)),c){a[3]=8;for(var d=0;d<=c.length;++d)a[d+10]=c.charCodeAt(d)}};function cU(a,b){void 0===b&&(b={});var c,d,e,f=cR(),g=a.length;f.p(a);var h=(d=b,e=10+((c=b).filename&&c.filename.length+1||0),function(a,b,c,d,e,f){var g=a.length,h=new cm(d+g+5*(1+Math.floor(g/7e3))+8),i=h.subarray(d,h.length-8),j=0;if(!b||g<8)for(var k=0;k<=g;k+=65535){var l=k+65535;l<g?j=cN(i,j,a.subarray(k,l)):(i[k]=f,j=cN(i,j,a.subarray(k,g)))}else{for(var m=cP[b-1],n=m>>>13,o=8191&m,p=(1<<c)-1,q=new cn(32768),r=new cn(p+1),s=Math.ceil(c/3),t=2*s,u=function(b){return(a[b]^a[b+1]<<s^a[b+2]<<t)&p},v=new co(25e3),w=new cn(288),x=new cn(32),y=0,z=0,A=(k=0,0),B=0,C=0;k<g;++k){var D=u(k),E=32767&k,F=r[D];if(q[E]=F,r[D]=E,B<=k){var G=g-k;if((y>7e3||A>24576)&&G>423){j=cO(a,i,0,v,w,x,z,A,C,k-C,j),A=y=z=0,C=k;for(var H=0;H<286;++H)w[H]=0;for(H=0;H<30;++H)x[H]=0}var I=2,J=0,K=o,L=E-F&32767;if(G>2&&D==u(k-L))for(var M=Math.min(n,G)-1,N=Math.min(32767,k),O=Math.min(258,G);L<=N&&--K&&E!=F;){if(a[k+I]==a[k+I-L]){for(var P=0;P<O&&a[k+P]==a[k+P-L];++P);if(P>I){if(I=P,J=L,P>M)break;var Q=Math.min(L,P-2),R=0;for(H=0;H<Q;++H){var S=k-L+H+32768&32767,T=S-q[S]+32768&32767;T>R&&(R=T,F=S)}}}L+=(E=F)-(F=q[E])+32768&32767}if(J){v[A++]=0x10000000|cv[I]<<18|cw[J];var U=31&cv[I],V=31&cw[J];z+=cp[U]+cq[V],++w[257+U],++x[V],B=k+I,++y}else v[A++]=a[k],++w[a[k]]}}j=cO(a,i,f,v,w,x,z,A,C,k-C,j)}return cG(h,0,d+cF(j)+8)}(a,null==d.level?6:d.level,null==d.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+d.mem,e,8,!0)),i=h.length;return cT(h,b),cS(h,i-8,f.d()),cS(h,i-4,g),h}function cV(a,b){var c=a.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(a);for(var d=new cm(a.length+(a.length>>>1)),e=0,f=function(a){d[e++]=a},g=0;g<c;++g){if(e+5>d.length){var h=new cm(e+8+(c-g<<1));h.set(d),d=h}var i=a.charCodeAt(g);i<128||b?f(i):(i<2048?f(192|i>>>6):(i>55295&&i<57344?(f(240|(i=65536+(1047552&i)|1023&a.charCodeAt(++g))>>>18),f(128|i>>>12&63)):f(224|i>>>12),f(128|i>>>6&63)),f(128|63&i))}return cG(d,0,e)}var cW="disabled",cX="sampled",cY="active",cZ="buffering",c$="paused",c_="trigger",c0=c_+"_activated",c1=c_+"_pending",c2=c_+"_"+cW;class c3{constructor(a){this.gt=a}triggerStatus(a){var b=this.gt.map(b=>b.triggerStatus(a));return b.includes(c0)?c0:b.includes(c1)?c1:c2}stop(){this.gt.forEach(a=>a.stop())}}class c4{constructor(a){this.gt=a}triggerStatus(a){var b=new Set;for(var c of this.gt)b.add(c.triggerStatus(a));switch(b.delete(c2),b.size){case 0:return c2;case 1:return Array.from(b)[0];default:return c1}}stop(){this.gt.forEach(a=>a.stop())}}class c5{triggerStatus(){return c1}stop(){}}class c6{constructor(a){this._t=[],this.bt=[],this.urlBlocked=!1,this._instance=a}onRemoteConfig(a){var b,c;this._t=(null==(b=a.sessionRecording)?void 0:b.urlTriggers)||[],this.bt=(null==(c=a.sessionRecording)?void 0:c.urlBlocklist)||[]}wt(a){var b;return 0===this._t.length?c2:(null==(b=this._instance)?void 0:b.get_property(ay))===a?c0:c1}triggerStatus(a){var b=this.wt(a),c=b===c0?c0:b===c1?c1:c2;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:c}),c}checkUrlTriggerConditions(a,b,c){}stop(){}}class c7{constructor(a){this.linkedFlag=null,this.linkedFlagSeen=!1,this.yt=()=>{},this._instance=a}triggerStatus(){var a=c1;return K(this.linkedFlag)&&(a=c2),this.linkedFlagSeen&&(a=c0),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:a}),a}onRemoteConfig(a,b){var c;if(this.linkedFlag=(null==(c=a.sessionRecording)?void 0:c.linkedFlag)||null,!K(this.linkedFlag)&&!this.linkedFlagSeen){var d=H(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,e=H(this.linkedFlag)?null:this.linkedFlag.variant;this.yt=this._instance.onFeatureFlags((a,c)=>{var f=!1;if(E(c)&&d in c){var g=c[d];f=M(g)?!0===g:e?g===e:!!g}this.linkedFlagSeen=f,f&&b(d,e)})}}stop(){this.yt()}}class c8{constructor(a){this.St=[],this._instance=a}onRemoteConfig(a){var b;this.St=(null==(b=a.sessionRecording)?void 0:b.eventTriggers)||[]}$t(a){var b;return 0===this.St.length?c2:(null==(b=this._instance)?void 0:b.get_property(az))===a?c0:c1}triggerStatus(a){var b=this.$t(a),c=b===c0?c0:b===c1?c1:c2;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:c}),c}stop(){}}function c9(a){return a.isRecordingEnabled?cZ:cW}function da(a){if(!a.receivedDecide)return cZ;if(!a.isRecordingEnabled)return cW;if(a.urlTriggerMatching.urlBlocked)return c$;var b=!0===a.isSampled,c=new c3([a.eventTriggerMatching,a.urlTriggerMatching,a.linkedFlagMatching]).triggerStatus(a.sessionId);return b?cX:c===c0?cY:c===c1?cZ:!1===a.isSampled?cW:cY}function db(a){if(!a.receivedDecide)return cZ;if(!a.isRecordingEnabled)return cW;if(a.urlTriggerMatching.urlBlocked)return c$;var b=new c4([a.eventTriggerMatching,a.urlTriggerMatching,a.linkedFlagMatching]).triggerStatus(a.sessionId),c=b!==c2,d=M(a.isSampled);return c&&b===c1?cZ:c&&b===c2||d&&!a.isSampled?cW:!0===a.isSampled?cX:cY}var dc="[SessionRecording]",dd=Q(dc);function de(){var a;return null==p||null==(a=p.__PosthogExtensions__)||null==(a=a.rrweb)?void 0:a.record}var df=[cb.MouseMove,cb.MouseInteraction,cb.Scroll,cb.ViewportResize,cb.Input,cb.TouchMove,cb.MediaInteraction,cb.Drag],dg=a=>({rrwebMethod:a,enqueuedAt:Date.now(),attempt:1});function dh(a){return function(a,b){for(var c="",d=0;d<a.length;){var e=a[d++];(e<128||b)&&(c+=String.fromCharCode(e))}return c}(cU(cV(JSON.stringify(a))),!0)}function di(a){return a.type===ca.Custom&&"sessionIdle"===a.data.tag}class dj{get sessionId(){return this.kt}get xt(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get started(){return this.Et}get It(){if(!this._instance.sessionManager)throw Error(dc+" must be started with a valid sessionManager.");return this._instance.sessionManager}get Pt(){var a,b;return this.Rt.triggerStatus(this.sessionId)===c1?6e4:null!=(a=null==(b=this._instance.config.session_recording)?void 0:b.full_snapshot_interval_millis)?a:3e5}get Tt(){var a=this._instance.get_property(ax);return M(a)?a:null}get Mt(){var a,b,c=null==(a=this.M)?void 0:a.data[(null==(b=this.M)?void 0:b.data.length)-1],{sessionStartTimestamp:d}=this.It.checkAndGetSessionAndWindowId(!0);return c?c.timestamp-d:null}get Ct(){var a=!!this._instance.get_property(ao),b=!this._instance.config.disable_session_recording;return d&&a&&b}get Ot(){var a=!!this._instance.get_property(ap),b=this._instance.config.enable_recording_console_log;return null!=b?b:a}get Ft(){var a,b,c,d,e,f,g=this._instance.config.session_recording.captureCanvas,h=this._instance.get_property(as),i=null!=(a=null!=(b=null==g?void 0:g.recordCanvas)?b:null==h?void 0:h.enabled)&&a,j=null!=(c=null!=(d=null==g?void 0:g.canvasFps)?d:null==h?void 0:h.fps)?c:4,k=null!=(e=null!=(f=null==g?void 0:g.canvasQuality)?f:null==h?void 0:h.quality)?e:.4;if("string"==typeof k){var l=parseFloat(k);k=isNaN(l)?.4:l}return{enabled:i,fps:ck(j,0,12,"canvas recording fps",4),quality:ck(k,0,1,"canvas recording quality",.4)}}get At(){var a,b,c=this._instance.get_property(aq),d={recordHeaders:null==(a=this._instance.config.session_recording)?void 0:a.recordHeaders,recordBody:null==(b=this._instance.config.session_recording)?void 0:b.recordBody},e=(null==d?void 0:d.recordHeaders)||(null==c?void 0:c.recordHeaders),f=(null==d?void 0:d.recordBody)||(null==c?void 0:c.recordBody),g=E(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,h=!!(M(g)?g:null==c?void 0:c.capturePerformance);return e||f||h?{recordHeaders:e,recordBody:f,recordPerformance:h}:void 0}get Dt(){var a,b,c,d,e,f,g=this._instance.get_property(ar),h={maskAllInputs:null==(a=this._instance.config.session_recording)?void 0:a.maskAllInputs,maskTextSelector:null==(b=this._instance.config.session_recording)?void 0:b.maskTextSelector,blockSelector:null==(c=this._instance.config.session_recording)?void 0:c.blockSelector},i=null!=(d=null==h?void 0:h.maskAllInputs)?d:null==g?void 0:g.maskAllInputs,j=null!=(e=null==h?void 0:h.maskTextSelector)?e:null==g?void 0:g.maskTextSelector,k=null!=(f=null==h?void 0:h.blockSelector)?f:null==g?void 0:g.blockSelector;return G(i)&&G(j)&&G(k)?void 0:{maskAllInputs:null==i||i,maskTextSelector:j,blockSelector:k}}get Lt(){var a=this._instance.get_property(at);return L(a)?a:null}get Nt(){var a=this._instance.get_property(au);return L(a)?a:null}get status(){return this.jt?this.zt({receivedDecide:this.jt,isRecordingEnabled:this.Ct,isSampled:this.Tt,urlTriggerMatching:this.Ut,eventTriggerMatching:this.qt,linkedFlagMatching:this.Bt,sessionId:this.sessionId}):cZ}constructor(a){if(this.zt=c9,this.jt=!1,this.Ht=[],this.Wt="unknown",this.Gt=Date.now(),this.Rt=new c5,this.Jt=void 0,this.Vt=void 0,this.Kt=void 0,this.Yt=void 0,this.Xt=void 0,this._forceAllowLocalhostNetworkCapture=!1,this.Qt=()=>{this.Zt()},this.ti=()=>{this.ii("browser offline",{})},this.ei=()=>{this.ii("browser online",{})},this.ri=()=>{if(null!=j&&j.visibilityState){var a="window "+j.visibilityState;this.ii(a,{})}},this._instance=a,this.Et=!1,this.si="/s/",this.ni=void 0,this.jt=!1,!this._instance.sessionManager)throw dd.error("started without valid sessionManager"),Error(dc+" started without valid sessionManager. This is a bug.");if(this._instance.config.__preview_experimental_cookieless_mode)throw Error(dc+" cannot be used with __preview_experimental_cookieless_mode.");this.Bt=new c7(this._instance),this.Ut=new c6(this._instance),this.qt=new c8(this._instance);var{sessionId:b,windowId:c}=this.It.checkAndGetSessionAndWindowId();this.kt=b,this.oi=c,this.M=this.ai(),this.xt>=this.It.sessionTimeoutMs&&dd.warn("session_idle_threshold_ms ("+this.xt+") is greater than the session timeout ("+this.It.sessionTimeoutMs+"). Session will never be detected as idle")}startIfEnabledOrStop(a){this.Ct?(this.li(a),ad(d,"beforeunload",this.Qt),ad(d,"offline",this.ti),ad(d,"online",this.ei),ad(d,"visibilitychange",this.ri),this.ui(),this.hi(),K(this.Jt)&&(this.Jt=this._instance.on("eventCaptured",a=>{try{if("$pageview"===a.event){var b=null!=a&&a.properties.$current_url?this.di(null==a?void 0:a.properties.$current_url):"";if(!b)return;this.ii("$pageview",{href:b})}}catch(a){dd.error("Could not add $pageview to rrweb session",a)}})),this.Vt||(this.Vt=this.It.onSessionId((a,b,c)=>{var d,e;c&&(this.ii("$session_id_change",{sessionId:a,windowId:b,changeReason:c}),null==(d=this._instance)||null==(d=d.persistence)||d.unregister(az),null==(e=this._instance)||null==(e=e.persistence)||e.unregister(ay))}))):this.stopRecording()}stopRecording(){var a,b,c,e;this.Et&&this.ni&&(this.ni(),this.ni=void 0,this.Et=!1,null==d||d.removeEventListener("beforeunload",this.Qt),null==d||d.removeEventListener("offline",this.ti),null==d||d.removeEventListener("online",this.ei),null==d||d.removeEventListener("visibilitychange",this.ri),this.ai(),clearInterval(this.vi),null==(a=this.Jt)||a.call(this),this.Jt=void 0,null==(b=this.Xt)||b.call(this),this.Xt=void 0,null==(c=this.Vt)||c.call(this),this.Vt=void 0,null==(e=this.Yt)||e.call(this),this.Yt=void 0,this.qt.stop(),this.Ut.stop(),this.Bt.stop(),dd.info("stopped"))}ci(){var a;null==(a=this._instance.persistence)||a.unregister(ax)}fi(a){var b,c=this.kt!==a,d=this.Lt;if(L(d)){var e=this.Tt,f=c||!M(e),g=f?function(a){for(var b=0,c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c)|0;return Math.abs(b)}(a)%100<ck(100*d,0,100):e;f&&(g?this.pi(cX):dd.warn("Sample rate ("+d+") has determined that this sessionId ("+a+") will not be sent to the server."),this.ii("samplingDecisionMade",{sampleRate:d,isSampled:g})),null==(b=this._instance.persistence)||b.register({[ax]:g})}else this.ci()}onRemoteConfig(a){var b,c,d,e;this.ii("$remote_config_received",a),this.gi(a),null!=(b=a.sessionRecording)&&b.endpoint&&(this.si=null==(e=a.sessionRecording)?void 0:e.endpoint),this.ui(),"any"===(null==(c=a.sessionRecording)?void 0:c.triggerMatchType)?(this.zt=da,this.Rt=new c3([this.qt,this.Ut])):(this.zt=db,this.Rt=new c4([this.qt,this.Ut])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:null==(d=a.sessionRecording)?void 0:d.triggerMatchType}),this.Ut.onRemoteConfig(a),this.qt.onRemoteConfig(a),this.Bt.onRemoteConfig(a,(a,b)=>{this.pi("linked_flag_matched",{flag:a,variant:b})}),this.jt=!0,this.startIfEnabledOrStop()}ui(){L(this.Lt)&&K(this.Yt)&&(this.Yt=this.It.onSessionId(a=>{this.fi(a)}))}gi(a){if(this._instance.persistence){var b,c=this._instance.persistence,d=()=>{var b,d,e,f,g,h,i,j,k,l=null==(b=a.sessionRecording)?void 0:b.sampleRate,m=K(l)?null:parseFloat(l);K(m)&&this.ci();var n=null==(d=a.sessionRecording)?void 0:d.minimumDurationMilliseconds;c.register({[ao]:!!a.sessionRecording,[ap]:null==(e=a.sessionRecording)?void 0:e.consoleLogRecordingEnabled,[aq]:T({capturePerformance:a.capturePerformance},null==(f=a.sessionRecording)?void 0:f.networkPayloadCapture),[ar]:null==(g=a.sessionRecording)?void 0:g.masking,[as]:{enabled:null==(h=a.sessionRecording)?void 0:h.recordCanvas,fps:null==(i=a.sessionRecording)?void 0:i.canvasFps,quality:null==(j=a.sessionRecording)?void 0:j.canvasQuality},[at]:m,[au]:G(n)?null:n,[av]:null==(k=a.sessionRecording)?void 0:k.scriptConfig})};d(),null==(b=this.Kt)||b.call(this),this.Kt=this.It.onSessionId(d)}}log(a,b){var c;void 0===b&&(b="log"),null==(c=this._instance.sessionRecording)||c.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:b,trace:[],payload:[JSON.stringify(a)]}},timestamp:Date.now()})}li(a){if(!G(Object.assign)&&!G(Array.from)&&!(this.Et||this._instance.config.disable_session_recording||this._instance.consent.isOptedOut())){var b;(this.Et=!0,this.It.checkAndGetSessionAndWindowId(),de())?this.mi():null==(b=p.__PosthogExtensions__)||null==b.loadExternalDependency||b.loadExternalDependency(this._instance,this.bi,a=>{if(a)return dd.error("could not load recorder",a);this.mi()}),dd.info("starting"),this.status===cY&&this.pi(a||"recording_initialized")}}get bi(){var a;return(null==(a=this._instance)||null==(a=a.persistence)||null==(a=a.get_property(av))?void 0:a.script)||"recorder"}wi(a){var b;return 3===a.type&&-1!==df.indexOf(null==(b=a.data)?void 0:b.source)}yi(a){var b=this.wi(a);b||this.Wt||a.timestamp-this.Gt>this.xt&&(this.Wt=!0,clearInterval(this.vi),this.ii("sessionIdle",{eventTimestamp:a.timestamp,lastActivityTimestamp:this.Gt,threshold:this.xt,bufferLength:this.M.data.length,bufferSize:this.M.size}),this.Zt());var c=!1;if(b&&(this.Gt=a.timestamp,this.Wt)){var d="unknown"===this.Wt;this.Wt=!1,d||(this.ii("sessionNoLongerIdle",{reason:"user activity",type:a.type}),c=!0)}if(!this.Wt){var{windowId:e,sessionId:f}=this.It.checkAndGetSessionAndWindowId(!b,a.timestamp),g=this.kt!==f,h=this.oi!==e;this.oi=e,this.kt=f,g||h?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):c&&this.Si()}}$i(a){try{return a.rrwebMethod(),!0}catch(b){return this.Ht.length<10?this.Ht.push({enqueuedAt:a.enqueuedAt||Date.now(),attempt:a.attempt++,rrwebMethod:a.rrwebMethod}):dd.warn("could not emit queued rrweb event.",b,a),!1}}ii(a,b){return this.$i(dg(()=>de().addCustomEvent(a,b)))}ki(){return this.$i(dg(()=>de().takeFullSnapshot()))}mi(){var a,b,c,d,e={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1};for(var[f,g]of Object.entries(this._instance.config.session_recording||{}))f in e&&("maskInputOptions"===f?e.maskInputOptions=T({password:!0},g):e[f]=g);this.Ft&&this.Ft.enabled&&(e.recordCanvas=!0,e.sampling={canvas:this.Ft.fps},e.dataURLOptions={type:"image/webp",quality:this.Ft.quality}),this.Dt&&(e.maskAllInputs=null==(b=this.Dt.maskAllInputs)||b,e.maskTextSelector=null!=(c=this.Dt.maskTextSelector)?c:void 0,e.blockSelector=null!=(d=this.Dt.blockSelector)?d:void 0);var h=de();if(h){this.xi=null!=(a=this.xi)?a:new cl(h,{refillRate:this._instance.config.session_recording.__mutationRateLimiterRefillRate,bucketSize:this._instance.config.session_recording.__mutationRateLimiterBucketSize,onBlockedNode:(a,b)=>{var c="Too many mutations on node '"+a+"'. Rate limiting. This could be due to SVG animations or something similar";dd.info(c,{node:b}),this.log(dc+" "+c,"warn")}});var i=this.Ei();this.ni=h(T({emit:a=>{this.onRRwebEmit(a)},plugins:i},e)),this.Gt=Date.now(),this.Wt=M(this.Wt)?this.Wt:"unknown",this.ii("$session_options",{sessionRecordingOptions:e,activePlugins:i.map(a=>null==a?void 0:a.name)}),this.ii("$posthog_config",{config:this._instance.config})}else dd.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}Si(){if(this.vi&&clearInterval(this.vi),!0!==this.Wt){var a=this.Pt;a&&(this.vi=setInterval(()=>{this.ki()},a))}}Ei(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n=[],o=null==(l=p.__PosthogExtensions__)||null==(l=l.rrwebPlugins)?void 0:l.getRecordConsolePlugin;o&&this.Ot&&n.push(o());var q=null==(m=p.__PosthogExtensions__)||null==(m=m.rrwebPlugins)?void 0:m.getRecordNetworkPlugin;return this.At&&D(q)&&(!bc.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?n.push(q((a=this._instance.config,b=this.At,e={payloadSizeLimitBytes:ce.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...ce.performanceEntryTypeToObserve],payloadHostDenyList:[...b.payloadHostDenyList||[],...ce.payloadHostDenyList]},f=!1!==a.session_recording.recordHeaders&&b.recordHeaders,g=!1!==a.session_recording.recordBody&&b.recordBody,h=!1!==a.capture_performance&&b.recordPerformance,d=Math.min(1e6,null!=(c=e.payloadSizeLimitBytes)?c:1e6),i=a=>(null!=a&&a.requestBody&&(a.requestBody=ci(a.requestBody,a.requestHeaders,d,"Request")),null!=a&&a.responseBody&&(a.responseBody=ci(a.responseBody,a.responseHeaders,d,"Response")),a),j=b=>{var c;return i(((a,b)=>{var c,d=bd(a.name),e=0===b.indexOf("http")?null==(c=bd(b))?void 0:c.pathname:b;"/"===e&&(e="");var f=null==d?void 0:d.pathname.replace(e||"","");if(!(d&&f&&ch.some(a=>0===f.indexOf(a))))return a})((K(c=b.requestHeaders)||X(Object.keys(null!=c?c:{}),a=>{cf.includes(a.toLowerCase())&&(c[a]=cd)}),b),a.api_host))},(k=D(a.session_recording.maskNetworkRequestFn))&&D(a.session_recording.maskCapturedNetworkRequestFn)&&P.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),k&&(a.session_recording.maskCapturedNetworkRequestFn=b=>{var c=a.session_recording.maskNetworkRequestFn({url:b.name});return T({},b,{name:null==c?void 0:c.url})}),e.maskRequestFn=D(a.session_recording.maskCapturedNetworkRequestFn)?b=>{var c,d=j(b);return d&&null!=(c=null==a.session_recording.maskCapturedNetworkRequestFn?void 0:a.session_recording.maskCapturedNetworkRequestFn(d))?c:void 0}:a=>(function(a){if(!G(a))return a.requestBody=cj(a.requestBody,"Request"),a.responseBody=cj(a.responseBody,"Response"),a})(j(a)),T({},ce,e,{recordHeaders:f,recordBody:g,recordPerformance:h,recordInitialRequests:h})))):dd.info("NetworkCapture not started because we are on localhost.")),n}onRRwebEmit(a){var b;if(this.Ii(),a&&E(a)){if(a.type===ca.Meta){var c=this.di(a.data.href);if(this.Pi=c,!c)return;a.data.href=c}else this.Ri();if(this.Ut.checkUrlTriggerConditions(()=>this.Ti(),()=>this.Mi(),a=>this.Ci(a)),!this.Ut.urlBlocked||a.type===ca.Custom&&"recording paused"===a.data.tag){a.type===ca.FullSnapshot&&this.Si(),a.type===ca.FullSnapshot&&this.jt&&this.Rt.triggerStatus(this.sessionId)===c1&&this.ai();var d=this.xi?this.xi.throttleMutations(a):a;if(d){var e=function(a){if(a&&E(a)&&6===a.type&&E(a.data)&&"rrweb/console@1"===a.data.plugin){a.data.payload.payload.length>10&&(a.data.payload.payload=a.data.payload.payload.slice(0,10),a.data.payload.payload.push("...[truncated]"));for(var b=[],c=0;c<a.data.payload.payload.length;c++)a.data.payload.payload[c]&&a.data.payload.payload[c].length>2e3?b.push(a.data.payload.payload[c].slice(0,2e3)+"...[truncated]"):b.push(a.data.payload.payload[c]);return a.data.payload.payload=b,a}return a}(d);if(this.yi(e),!0!==this.Wt||di(e)){if(di(e)){var f=e.data.payload;f&&(e.timestamp=f.lastActivityTimestamp+f.threshold)}var g=null==(b=this._instance.config.session_recording.compress_events)||b?function(a){if(1024>b9(a))return a;try{if(a.type===ca.FullSnapshot)return T({},a,{data:dh(a.data),cv:"2024-10"});if(a.type===ca.IncrementalSnapshot&&a.data.source===cb.Mutation)return T({},a,{cv:"2024-10",data:T({},a.data,{texts:dh(a.data.texts),attributes:dh(a.data.attributes),removes:dh(a.data.removes),adds:dh(a.data.adds)})});if(a.type===ca.IncrementalSnapshot&&a.data.source===cb.StyleSheetRule)return T({},a,{cv:"2024-10",data:T({},a.data,{adds:a.data.adds?dh(a.data.adds):void 0,removes:a.data.removes?dh(a.data.removes):void 0})})}catch(a){dd.error("could not compress event - will use uncompressed event",a)}return a}(e):e,h={$snapshot_bytes:b9(g),$snapshot_data:g,$session_id:this.kt,$window_id:this.oi};this.status!==cW?this.Oi(h):this.ai()}}}}}Ri(){this._instance.config.capture_pageview}Ii(){if(this.Ht.length){var a=[...this.Ht];this.Ht=[],a.forEach(a=>{Date.now()-a.enqueuedAt<=2e3&&this.$i(a)})}}di(a){var b=this._instance.config.session_recording;if(b.maskNetworkRequestFn){var c,d={url:a};return null==(c=d=b.maskNetworkRequestFn(d))?void 0:c.url}return a}ai(){return this.M={size:0,data:[],sessionId:this.kt,windowId:this.oi},this.M}Zt(){this.Fi&&(clearTimeout(this.Fi),this.Fi=void 0);var a=this.Nt,b=this.Mt,c=L(b)&&b>=0,d=L(a)&&c&&b<a;return this.status===cZ||this.status===c$||this.status===cW||d?(this.Fi=setTimeout(()=>{this.Zt()},2e3),this.M):(this.M.data.length>0&&(function a(b,c){if(void 0===c&&(c=6606028.8),b.size>=c&&b.data.length>1){var d=Math.floor(b.data.length/2),e=b.data.slice(0,d),f=b.data.slice(d);return[a({size:b9(e),data:e,sessionId:b.sessionId,windowId:b.windowId}),a({size:b9(f),data:f,sessionId:b.sessionId,windowId:b.windowId})].flatMap(a=>a)}return[b]})(this.M).forEach(a=>{this.Ai({$snapshot_bytes:a.size,$snapshot_data:a.data,$session_id:a.sessionId,$window_id:a.windowId,$lib:"web",$lib_version:q.LIB_VERSION})}),this.ai())}Oi(a){var b,c=2+((null==(b=this.M)?void 0:b.data.length)||0);!this.Wt&&(this.M.size+a.$snapshot_bytes+c>943718.4||this.M.sessionId!==this.kt)&&(this.M=this.Zt()),this.M.size+=a.$snapshot_bytes,this.M.data.push(a.$snapshot_data),this.Fi||this.Wt||(this.Fi=setTimeout(()=>{this.Zt()},2e3))}Ai(a){this._instance.capture("$snapshot",a,{_url:this._instance.requestRouter.endpointFor("api",this.si),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}Ci(a){var b;this.Rt.triggerStatus(this.sessionId)===c1&&(null==(b=this._instance)||null==(b=b.persistence)||b.register({["url"===a?ay:az]:this.kt}),this.Zt(),this.pi(a+"_trigger_matched"))}Ti(){this.Ut.urlBlocked||(this.Ut.urlBlocked=!0,clearInterval(this.vi),dd.info("recording paused due to URL blocker"),this.ii("recording paused",{reason:"url blocker"}))}Mi(){this.Ut.urlBlocked&&(this.Ut.urlBlocked=!1,this.ki(),this.Si(),this.ii("recording resumed",{reason:"left blocked url"}),dd.info("recording resumed"))}hi(){0!==this.qt.St.length&&K(this.Xt)&&(this.Xt=this._instance.on("eventCaptured",a=>{try{this.qt.St.includes(a.event)&&this.Ci("event")}catch(a){dd.error("Could not activate event trigger",a)}}))}overrideLinkedFlag(){this.Bt.linkedFlagSeen=!0,this.ki(),this.pi("linked_flag_overridden")}overrideSampling(){var a;null==(a=this._instance.persistence)||a.register({[ax]:!0}),this.ki(),this.pi("sampling_overridden")}overrideTrigger(a){this.Ci(a)}pi(a,b){this._instance.register_for_session({$session_recording_start_reason:a}),dd.info(a.replace("_"," "),b),v(["recording_initialized","session_id_changed"],a)||this.ii(a,b)}get sdkDebugProperties(){var{sessionStartTimestamp:a}=this.It.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.M.data.length,$sdk_debug_replay_internal_buffer_size:this.M.size,$sdk_debug_current_session_duration:this.Mt,$sdk_debug_session_start:a}}}var dk=Q("[SegmentIntegration]"),dl="posthog-js";function dm(a,b){var{organization:c,projectId:d,prefix:e,severityAllowList:f=["error"]}=void 0===b?{}:b;return b=>{if(!("*"===f||f.includes(b.level))||!a.__loaded)return b;b.tags||(b.tags={});var g,h,i,j,k,l=a.requestRouter.endpointFor("ui","/project/"+a.config.token+"/person/"+a.get_distinct_id());b.tags["PostHog Person URL"]=l,a.sessionRecordingStarted()&&(b.tags["PostHog Recording URL"]=a.get_session_replay_url({withTimestamp:!0}));var m=(null==(g=b.exception)?void 0:g.values)||[],n=m.map(a=>T({},a,{stacktrace:a.stacktrace?T({},a.stacktrace,{type:"raw",frames:(a.stacktrace.frames||[]).map(a=>T({},a,{platform:"web:javascript"}))}):void 0})),o={$exception_message:(null==(h=m[0])?void 0:h.value)||b.message,$exception_type:null==(i=m[0])?void 0:i.type,$exception_personURL:l,$exception_level:b.level,$exception_list:n,$sentry_event_id:b.event_id,$sentry_exception:b.exception,$sentry_exception_message:(null==(j=m[0])?void 0:j.value)||b.message,$sentry_exception_type:null==(k=m[0])?void 0:k.type,$sentry_tags:b.tags};return c&&d&&(o.$sentry_url=(e||"https://sentry.io/organizations/")+c+"/issues/?project="+d+"&query="+b.event_id),a.exceptions.sendExceptionEvent(o),b}}class dn{constructor(a,b,c,d,e){this.name=dl,this.setupOnce=function(f){f(dm(a,{organization:b,projectId:c,prefix:d,severityAllowList:e}))}}}null!=d&&d.location&&(bh(d.location.hash,"__posthog")||bh(location.hash,"state"));var dp=Q("[Toolbar]"),dq=((fu=dq||{})[fu.UNINITIALIZED=0]="UNINITIALIZED",fu[fu.LOADING=1]="LOADING",fu[fu.LOADED=2]="LOADED",fu);class dr{constructor(a){this.instance=a}Di(a){p.ph_toolbar_state=a}Li(){var a;return null!=(a=p.ph_toolbar_state)?a:dq.UNINITIALIZED}maybeLoadToolbar(a,b,c){return!1}Ni(a){var b=p.ph_load_toolbar||p.ph_load_editor;!K(b)&&D(b)?b(a,this.instance):dp.warn("No toolbar load function found")}loadToolbar(a){return null!=j&&j.getElementById(aP),!1}ji(a){return this.loadToolbar(a)}maybeLoadEditor(a,b,c){return void 0===a&&(a=void 0),void 0===b&&(b=void 0),void 0===c&&(c=void 0),this.maybeLoadToolbar(a,b,c)}}var ds=Q("[TracingHeaders]");class dt{constructor(a){this.zi=void 0,this.Ui=void 0,this.V=()=>{var a,b;G(this.zi)&&(null==(a=p.__PosthogExtensions__)||null==(a=a.tracingHeadersPatchFns)||a._patchXHR(this._instance.sessionManager)),G(this.Ui)&&(null==(b=p.__PosthogExtensions__)||null==(b=b.tracingHeadersPatchFns)||b._patchFetch(this._instance.sessionManager))},this._instance=a}G(a){var b,c;null!=(b=p.__PosthogExtensions__)&&b.tracingHeadersPatchFns&&a(),null==(c=p.__PosthogExtensions__)||null==c.loadExternalDependency||c.loadExternalDependency(this._instance,"tracing-headers",b=>{if(b)return ds.error("failed to load script",b);a()})}startIfEnabledOrStop(){var a,b;this._instance.config.__add_tracing_headers?this.G(this.V):(null==(a=this.zi)||a.call(this),null==(b=this.Ui)||b.call(this),this.zi=void 0,this.Ui=void 0)}}var du=Q("[Web Vitals]");class dv{constructor(a){var b;this.qi=!1,this.i=!1,this.M={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Bi=()=>{clearTimeout(this.Hi),0!==this.M.metrics.length&&(this._instance.capture("$web_vitals",this.M.metrics.reduce((a,b)=>T({},a,{["$web_vitals_"+b.name+"_event"]:T({},b),["$web_vitals_"+b.name+"_value"]:b.value}),{})),this.M={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Wi=a=>{var b,c=null==(b=this._instance.sessionManager)?void 0:b.checkAndGetSessionAndWindowId(!0);if(G(c))du.error("Could not read session ID. Dropping metrics!");else{this.M=this.M||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var d=this.Gi();G(d)||(K(null==a?void 0:a.name)||K(null==a?void 0:a.value)?du.error("Invalid metric received",a):this.Ji&&a.value>=this.Ji?du.error("Ignoring metric with value >= "+this.Ji,a):(this.M.url!==d&&(this.Bi(),this.Hi=setTimeout(this.Bi,this.flushToCaptureTimeoutMs)),G(this.M.url)&&(this.M.url=d),this.M.firstMetricTimestamp=G(this.M.firstMetricTimestamp)?Date.now():this.M.firstMetricTimestamp,a.attribution&&a.attribution.interactionTargetElement&&(a.attribution.interactionTargetElement=void 0),this.M.metrics.push(T({},a,{$current_url:d,$session_id:c.sessionId,$window_id:c.windowId,timestamp:Date.now()})),this.M.metrics.length===this.allowedMetrics.length&&this.Bi()))}},this.V=()=>{var a,b,c,d,e=p.__PosthogExtensions__;G(e)||G(e.postHogWebVitalsCallbacks)||({onLCP:a,onCLS:b,onFCP:c,onINP:d}=e.postHogWebVitalsCallbacks),a&&b&&c&&d?(this.allowedMetrics.indexOf("LCP")>-1&&a(this.Wi.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&b(this.Wi.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&c(this.Wi.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&d(this.Wi.bind(this)),this.i=!0):du.error("web vitals callbacks not loaded - not starting")},this._instance=a,this.qi=!(null==(b=this._instance.persistence)||!b.props[al]),this.startIfEnabled()}get allowedMetrics(){var a,b,c=E(this._instance.config.capture_performance)?null==(a=this._instance.config.capture_performance)?void 0:a.web_vitals_allowed_metrics:void 0;return G(c)?(null==(b=this._instance.persistence)?void 0:b.props[an])||["CLS","FCP","INP","LCP"]:c}get flushToCaptureTimeoutMs(){return(E(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get Ji(){var a=E(this._instance.config.capture_performance)&&L(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:9e5;return 0<a&&a<=6e4?9e5:a}get isEnabled(){var a=null==k?void 0:k.protocol;if("http:"!==a&&"https:"!==a)return du.info("Web Vitals are disabled on non-http/https protocols"),!1;var b=E(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:M(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return M(b)?b:this.qi}startIfEnabled(){this.isEnabled&&!this.i&&(du.info("enabled, starting..."),this.G(this.V))}onRemoteConfig(a){var b=E(a.capturePerformance)&&!!a.capturePerformance.web_vitals,c=E(a.capturePerformance)?a.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[al]:b}),this._instance.persistence.register({[an]:c})),this.qi=b,this.startIfEnabled()}G(a){var b,c;null!=(b=p.__PosthogExtensions__)&&b.postHogWebVitalsCallbacks&&a(),null==(c=p.__PosthogExtensions__)||null==c.loadExternalDependency||c.loadExternalDependency(this._instance,"web-vitals",b=>{b?du.error("failed to load script",b):a()})}Gi(){var a=void 0;return a||du.error("Could not determine current URL"),a}}var dw=Q("[Heatmaps]");function dx(a){return E(a)&&"clientX"in a&&"clientY"in a&&L(a.clientX)&&L(a.clientY)}class dy{constructor(a){var b;this.rageclicks=new bb,this.qi=!1,this.i=!1,this.Vi=null,this.instance=a,this.qi=!(null==(b=this.instance.persistence)||!b.props[ai])}get flushIntervalMilliseconds(){var a=5e3;return E(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(a=this.instance.config.capture_heatmaps.flush_interval_milliseconds),a}get isEnabled(){return G(this.instance.config.capture_heatmaps)?G(this.instance.config.enable_heatmaps)?this.qi:this.instance.config.enable_heatmaps:!1!==this.instance.config.capture_heatmaps}startIfEnabled(){if(this.isEnabled)this.i||(dw.info("starting..."),this.Ki(),this.Vi=setInterval(this.Yi.bind(this),this.flushIntervalMilliseconds));else{var a,b;clearInterval(null!=(a=this.Vi)?a:void 0),null==(b=this.Xi)||b.stop(),this.getAndClearBuffer()}}onRemoteConfig(a){var b=!!a.heatmaps;this.instance.persistence&&this.instance.persistence.register({[ai]:b}),this.qi=b,this.startIfEnabled()}getAndClearBuffer(){var a=this.M;return this.M=void 0,a}Qi(a){this.Zi(a.originalEvent,"deadclick")}Ki(){d&&j&&(ad(d,"beforeunload",this.Yi.bind(this)),ad(j,"click",a=>this.Zi(a||(null==d?void 0:d.event)),{capture:!0}),ad(j,"mousemove",a=>this.te(a||(null==d?void 0:d.event)),{capture:!0}),this.Xi=new bK(this.instance,bI,this.Qi.bind(this)),this.Xi.startIfEnabled(),this.i=!0)}ie(a,b){var c=this.instance.scrollManager.scrollY(),e=this.instance.scrollManager.scrollX(),f=this.instance.scrollManager.scrollElement(),g=function(a,b,c){for(var e=a;e&&aT(e)&&!aU(e,"body")&&e!==c;){if(v(b,null==d?void 0:d.getComputedStyle(e).position))return!0;e=function(a){var b=a.parentNode;return!(!b||!aT(b))&&b}(e)}return!1}(a$(a),["fixed","sticky"],f);return{x:a.clientX+(g?0:e),y:a.clientY+(g?0:c),target_fixed:g,type:b}}Zi(a,b){var c;if(void 0===b&&(b="click"),!aS(a.target)&&dx(a)){var d=this.ie(a,b);null!=(c=this.rageclicks)&&c.isRageClick(a.clientX,a.clientY,(new Date).getTime())&&this.ee(T({},d,{type:"rageclick"})),this.ee(d)}}te(a){!aS(a.target)&&dx(a)&&(clearTimeout(this.re),this.re=setTimeout(()=>{this.ee(this.ie(a,"mousemove"))},500))}ee(a){}Yi(){this.M&&!F(this.M)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class dz{constructor(a){this._instance=a}doPageView(a,b){var c,e=this.se(a,b);return this.ne={pathname:null!=(c=null==d?void 0:d.location.pathname)?c:"",pageViewId:b,timestamp:a},this._instance.scrollManager.resetContext(),e}doPageLeave(a){var b;return this.se(a,null==(b=this.ne)?void 0:b.pageViewId)}doEvent(){var a;return{$pageview_id:null==(a=this.ne)?void 0:a.pageViewId}}se(a,b){var c=this.ne;if(!c)return{$pageview_id:b};var d={$pageview_id:b,$prev_pageview_id:c.pageViewId},e=this._instance.scrollManager.getContext();if(e&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:f,lastScrollY:g,maxScrollY:h,maxContentHeight:i,lastContentY:j,maxContentY:k}=e;if(!(G(f)||G(g)||G(h)||G(i)||G(j)||G(k))){f=Math.ceil(f),g=Math.ceil(g),h=Math.ceil(h),i=Math.ceil(i),j=Math.ceil(j),k=Math.ceil(k);var l=f<=1?1:ck(g/f,0,1),m=f<=1?1:ck(h/f,0,1),n=i<=1?1:ck(j/i,0,1),o=i<=1?1:ck(k/i,0,1);d=Y(d,{$prev_pageview_last_scroll:g,$prev_pageview_last_scroll_percentage:l,$prev_pageview_max_scroll:h,$prev_pageview_max_scroll_percentage:m,$prev_pageview_last_content:j,$prev_pageview_last_content_percentage:n,$prev_pageview_max_content:k,$prev_pageview_max_content_percentage:o})}}return c.pathname&&(d.$prev_pageview_pathname=c.pathname),c.timestamp&&(d.$prev_pageview_duration=(a.getTime()-c.timestamp.getTime())/1e3),d}}var dA=function(a){var b,c,d,e,f="";for(b=c=0,d=(a=(a+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,e=0;e<d;e++){var g=a.charCodeAt(e),h=null;g<128?c++:h=g>127&&g<2048?String.fromCharCode(g>>6|192,63&g|128):String.fromCharCode(g>>12|224,g>>6&63|128,63&g|128),J(h)||(c>b&&(f+=a.substring(b,c)),f+=h,b=c=e+1)}return c>b&&(f+=a.substring(b,a.length)),f},dB=!!m||!!l,dC="text/plain",dD=(a,b)=>{var[c,d]=a.split("?"),e=T({},b);null==d||d.split("&").forEach(a=>{var[b]=a.split("=");delete e[b]});var f=be(e);return c+"?"+(f=f?(d?d+"&":"")+f:d)},dE=(a,b)=>JSON.stringify(a,(a,b)=>"bigint"==typeof b?b.toString():b,b),dF=a=>{var{data:b,compression:c}=a;if(b){if(c===t.GZipJS){var d=new Blob([cU(cV(dE(b)),{mtime:0})],{type:dC});return{contentType:dC,body:d,estimatedSize:d.size}}if(c===t.Base64){let a;var e="data="+encodeURIComponent("string"==typeof(a=function(a){var b,c,d,e,f,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,i=0,j="",k=[];if(!a)return a;a=dA(a);do b=(f=a.charCodeAt(h++)<<16|a.charCodeAt(h++)<<8|a.charCodeAt(h++))>>18&63,c=f>>12&63,d=f>>6&63,e=63&f,k[i++]=g.charAt(b)+g.charAt(c)+g.charAt(d)+g.charAt(e);while(h<a.length)switch(j=k.join(""),a.length%3){case 1:j=j.slice(0,-2)+"==";break;case 2:j=j.slice(0,-1)+"="}return j}(dE(b)))?a:dE(a));return{contentType:"application/x-www-form-urlencoded",body:e,estimatedSize:new Blob([e]).size}}var f=dE(b);return{contentType:"application/json",body:f,estimatedSize:new Blob([f]).size}}},dG=[];l&&dG.push({transport:"fetch",method:a=>{var b,c,{contentType:d,body:e,estimatedSize:f}=null!=(b=dF(a))?b:{},g=new Headers;X(a.headers,function(a,b){g.append(b,a)}),d&&g.append("Content-Type",d);var h=a.url,i=null;if(n){var j=new n;i={signal:j.signal,timeout:setTimeout(()=>j.abort(),a.timeout)}}l(h,T({method:(null==a?void 0:a.method)||"GET",headers:g,keepalive:"POST"===a.method&&52428.8>(f||0),body:e,signal:null==(c=i)?void 0:c.signal},a.fetchOptions)).then(b=>b.text().then(c=>{var d={statusCode:b.status,text:c};if(200===b.status)try{d.json=JSON.parse(c)}catch(a){P.error(a)}null==a.callback||a.callback(d)})).catch(b=>{P.error(b),null==a.callback||a.callback({statusCode:0,text:b})}).finally(()=>i?clearTimeout(i.timeout):null)}}),m&&dG.push({transport:"XHR",method:a=>{var b,c=new m;c.open(a.method||"GET",a.url,!0);var{contentType:d,body:e}=null!=(b=dF(a))?b:{};X(a.headers,function(a,b){c.setRequestHeader(b,a)}),d&&c.setRequestHeader("Content-Type",d),a.timeout&&(c.timeout=a.timeout),c.withCredentials=!0,c.onreadystatechange=()=>{if(4===c.readyState){var b={statusCode:c.status,text:c.responseText};if(200===c.status)try{b.json=JSON.parse(c.responseText)}catch(a){}null==a.callback||a.callback(b)}},c.send(e)}}),null!=i&&i.sendBeacon&&dG.push({transport:"sendBeacon",method:a=>{var b=dD(a.url,{beacon:"1"});try{var c,{contentType:d,body:e}=null!=(c=dF(a))?c:{},f="string"==typeof e?new Blob([e],{type:d}):e;i.sendBeacon(b,f)}catch(a){}}});var dH=function(a,b){if(!function(a){try{new RegExp(a)}catch(a){return!1}return!0}(b))return!1;try{return new RegExp(b).test(a)}catch(a){return!1}};function dI(a,b,c){return dE({distinct_id:a,userPropertiesToSet:b,userPropertiesToSetOnce:c})}var dJ={exact:(a,b)=>b.some(b=>a.some(a=>b===a)),is_not:(a,b)=>b.every(b=>a.every(a=>b!==a)),regex:(a,b)=>b.some(b=>a.some(a=>dH(b,a))),not_regex:(a,b)=>b.every(b=>a.every(a=>!dH(b,a))),icontains:(a,b)=>b.map(dK).some(b=>a.map(dK).some(a=>b.includes(a))),not_icontains:(a,b)=>b.map(dK).every(b=>a.map(dK).every(a=>!b.includes(a)))},dK=a=>a.toLowerCase(),dL=Q("[Error tracking]");class dM{constructor(a){var b,c;this.oe=[],this._instance=a,this.oe=null!=(b=null==(c=this._instance.persistence)?void 0:c.get_property(ak))?b:[]}onRemoteConfig(a){var b,c,d=null!=(b=null==(c=a.errorTracking)?void 0:c.suppressionRules)?b:[];this.oe=d,this._instance.persistence&&this._instance.persistence.register({[ak]:this.oe})}sendExceptionEvent(a){this.ae(a)?dL.info("Skipping exception capture because a suppression rule matched"):this._instance.capture("$exception",a,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ae(a){var b=a.$exception_list;if(!b||!C(b)||0===b.length)return!1;var c=b.reduce((a,b)=>{var{type:c,value:d}=b;return H(c)&&c.length>0&&a.$exception_types.push(c),H(d)&&d.length>0&&a.$exception_messages.push(d),a},{$exception_types:[],$exception_messages:[]});return this.oe.some(a=>{var b=a.values.map(a=>{var b=dJ[a.operator],d=C(a.value)?a.value:[a.value],e=c[a.key];return d.length>0&&b(d,e)});return"OR"===a.type?b.some(Boolean):b.every(Boolean)})}}var dN="Mobile",dO="Android",dP="Tablet",dQ=dO+" "+dP,dR="iPad",dS="Apple",dT=dS+" Watch",dU="Safari",dV="BlackBerry",dW="Samsung",dX=dW+"Browser",dY=dW+" Internet",dZ="Chrome",d$=dZ+" OS",d_=dZ+" iOS",d0="Internet Explorer",d1=d0+" "+dN,d2="Opera",d3=d2+" Mini",d4="Edge",d5="Microsoft "+d4,d6="Firefox",d7=d6+" iOS",d8="Nintendo",d9="PlayStation",ea="Xbox",eb=dO+" "+dN,ec=dN+" "+dU,ed="Windows",ee=ed+" Phone",ef="Nokia",eg="Ouya",eh="Generic",ei=eh+" "+dN.toLowerCase(),ej=eh+" "+dP.toLowerCase(),ek="Konqueror",el="(\\d+(\\.\\d+)?)",em=RegExp("Version/"+el),en=RegExp(ea,"i"),eo=RegExp(d9+" \\w+","i"),ep=RegExp(d8+" \\w+","i"),eq=RegExp(dV+"|PlayBook|BB10","i"),er={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},es=function(a,b){var c;return b=b||"",v(a," OPR/")&&v(a,"Mini")?d3:v(a," OPR/")?d2:eq.test(a)?dV:v(a,"IE"+dN)||v(a,"WPDesktop")?d1:v(a,dX)?dY:v(a,d4)||v(a,"Edg/")?d5:v(a,"FBIOS")?"Facebook "+dN:v(a,"UCWEB")||v(a,"UCBrowser")?"UC Browser":v(a,"CriOS")?d_:v(a,"CrMo")||v(a,dZ)?dZ:v(a,dO)&&v(a,dU)?eb:v(a,"FxiOS")?d7:v(a.toLowerCase(),ek.toLowerCase())?ek:(c=b)&&v(c,dS)||v(a,dU)&&!v(a,dZ)&&!v(a,dO)?v(a,dN)?ec:dU:v(a,d6)?d6:v(a,"MSIE")||v(a,"Trident/")?d0:v(a,"Gecko")?d6:""},et={[d1]:[RegExp("rv:"+el)],[d5]:[RegExp(d4+"?\\/"+el)],[dZ]:[RegExp("("+dZ+"|CrMo)\\/"+el)],[d_]:[RegExp("CriOS\\/"+el)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+el)],[dU]:[em],[ec]:[em],[d2]:[RegExp("(Opera|OPR)\\/"+el)],[d6]:[RegExp(d6+"\\/"+el)],[d7]:[RegExp("FxiOS\\/"+el)],[ek]:[RegExp("Konqueror[:/]?"+el,"i")],[dV]:[RegExp(dV+" "+el),em],[eb]:[RegExp("android\\s"+el,"i")],[dY]:[RegExp(dX+"\\/"+el)],[d0]:[RegExp("(rv:|MSIE )"+el)],Mozilla:[RegExp("rv:"+el)]},eu=function(a,b){var c=et[es(a,b)];if(G(c))return null;for(var d=0;d<c.length;d++){var e=c[d],f=a.match(e);if(f)return parseFloat(f[f.length-2])}return null},ev=[[RegExp(ea+"; "+ea+" (.*?)[);]","i"),a=>[ea,a&&a[1]||""]],[RegExp(d8,"i"),[d8,""]],[RegExp(d9,"i"),[d9,""]],[eq,[dV,""]],[RegExp(ed,"i"),(a,b)=>{if(/Phone/.test(b)||/WPDesktop/.test(b))return[ee,""];if(new RegExp(dN).test(b)&&!/IEMobile\b/.test(b))return[ed+" "+dN,""];var c=/Windows NT ([0-9.]+)/i.exec(b);if(c&&c[1]){var d=er[c[1]]||"";return/arm/i.test(b)&&(d="RT"),[ed,d]}return[ed,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,a=>a&&a[3]?["iOS",[a[3],a[4],a[5]||"0"].join(".")]:["iOS",""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,a=>{var b="";return a&&a.length>=3&&(b=G(a[2])?a[3]:a[2]),["watchOS",b]}],[RegExp("("+dO+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+dO+")","i"),a=>a&&a[2]?[dO,[a[2],a[3],a[4]||"0"].join(".")]:[dO,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,a=>{var b=["Mac OS X",""];if(a&&a[1]){var c=[a[1],a[2],a[3]||"0"];b[1]=c.join(".")}return b}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[d$,""]],[/Linux|debian/i,["Linux",""]]],ew=function(a){return ep.test(a)?d8:eo.test(a)?d9:en.test(a)?ea:RegExp(eg,"i").test(a)?eg:RegExp("("+ee+"|WPDesktop)","i").test(a)?ee:/iPad/.test(a)?dR:/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(a)?dT:eq.test(a)?dV:/(kobo)\s(ereader|touch)/i.test(a)?"Kobo":RegExp(ef,"i").test(a)?ef:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(a)||/(kf[a-z]+)( bui|\)).+silk\//i.test(a)?"Kindle Fire":/(Android|ZTE)/i.test(a)?!new RegExp(dN).test(a)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(a)?/pixel[\daxl ]{1,6}/i.test(a)&&!/pixel c/i.test(a)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(a)||/lmy47v/i.test(a)&&!/QTAQZ3/i.test(a)?dO:dQ:dO:RegExp("(pda|"+dN+")","i").test(a)?ei:RegExp(dP,"i").test(a)&&!RegExp(dP+" pc","i").test(a)?ej:""},ex="https?://(.*)",ey=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],ez=Z(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],ey),eA="<masked>";function eB(a,b,c){if(!j)return{};var d=b?Z([],ey,c||[]):[];return eC(bg(j.URL,d,eA),a)}function eC(a,b){var c=ez.concat(b||[]),d={};return X(c,function(b){var c=bf(a,b);d[b]=c||null}),d}function eD(a){var b=a?0===a.search(ex+"google.([^/?]*)")?"google":0===a.search(ex+"bing.com")?"bing":0===a.search(ex+"yahoo.com")?"yahoo":0===a.search(ex+"duckduckgo.com")?"duckduckgo":null:null,c={};if(!J(b)){c.$search_engine=b;var d=j?bf(j.referrer,"yahoo"!=b?"q":"p"):"";d.length&&(c.ph_keyword=d)}return c}function eE(){return navigator.language||navigator.userLanguage}function eF(){return(null==j?void 0:j.referrer)||"$direct"}function eG(a,b){var c=a?Z([],ey,b||[]):[],d=null==k?void 0:k.href.substring(0,1e3);return{r:eF().substring(0,1e3),u:d?bg(d,c,eA):void 0}}function eH(a){var b,{r:c,u:d}=a,e={$referrer:c,$referring_domain:null==c?void 0:"$direct"==c?"$direct":null==(b=bd(c))?void 0:b.host};if(d){e.$current_url=d;var f=bd(d);e.$host=null==f?void 0:f.host,e.$pathname=null==f?void 0:f.pathname,Y(e,eC(d))}return c&&Y(e,eD(c)),e}function eI(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(a){return}}var eJ=Q("[FeatureFlags]"),eK="$active_feature_flags",eL="$override_feature_flags",eM="$feature_flag_payloads",eN="$override_feature_flag_payloads",eO="$feature_flag_request_id",eP=a=>{var b={};for(var[c,d]of $(a||{}))d&&(b[c]=d);return b},eQ=((fv={}).FeatureFlags="feature_flags",fv.Recordings="recordings",fv);class eR{constructor(a){this.le=!1,this.ue=!1,this.he=!1,this.de=!1,this.ve=!1,this.ce=!1,this.fe=!1,this._instance=a,this.featureFlagEventHandlers=[]}decide(){if(this._instance.config.__preview_remote_config)this.ce=!0;else{var a=!this.pe&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.ge({disableFlags:a})}}get hasLoadedFlags(){return this.ue}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var a=this._instance.get_property(aC),b=this._instance.get_property(eL),c=this._instance.get_property(eN);if(!c&&!b)return a||{};var d=Y({},a||{});for(var e of[...new Set([...Object.keys(c||{}),...Object.keys(b||{})])]){var f,g,h=d[e],i=null==b?void 0:b[e],j=G(i)?null!=(f=null==h?void 0:h.enabled)&&f:!!i,k=G(i)?h.variant:"string"==typeof i?i:void 0,l=null==c?void 0:c[e],m=T({},h,{enabled:j,variant:j?null!=k?k:null==h?void 0:h.variant:void 0});j!==(null==h?void 0:h.enabled)&&(m.original_enabled=null==h?void 0:h.enabled),k!==(null==h?void 0:h.variant)&&(m.original_variant=null==h?void 0:h.variant),l&&(m.metadata=T({},null==h?void 0:h.metadata,{payload:l,original_payload:null==h||null==(g=h.metadata)?void 0:g.payload})),d[e]=m}return this.le||(eJ.warn(" Overriding feature flag details!",{flagDetails:a,overriddenPayloads:c,finalDetails:d}),this.le=!0),d}getFlagVariants(){var a=this._instance.get_property(aA),b=this._instance.get_property(eL);if(!b)return a||{};for(var c=Y({},a),d=Object.keys(b),e=0;e<d.length;e++)c[d[e]]=b[d[e]];return this.le||(eJ.warn(" Overriding feature flags!",{enabledFlags:a,overriddenFlags:b,finalFlags:c}),this.le=!0),c}getFlagPayloads(){var a=this._instance.get_property(eM),b=this._instance.get_property(eN);if(!b)return a||{};for(var c=Y({},a||{}),d=Object.keys(b),e=0;e<d.length;e++)c[d[e]]=b[d[e]];return this.le||(eJ.warn(" Overriding feature flag payloads!",{flagPayloads:a,overriddenPayloads:b,finalPayloads:c}),this.le=!0),c}reloadFeatureFlags(){this.de||this._instance.config.advanced_disable_feature_flags||this.pe||(this.pe=setTimeout(()=>{this.ge()},5))}_e(){clearTimeout(this.pe),this.pe=void 0}ensureFlagsLoaded(){this.ue||this.he||this.pe||this.reloadFeatureFlags()}setAnonymousDistinctId(a){this.$anon_distinct_id=a}setReloadingPaused(a){this.de=a}ge(a){var b;if(this._e(),!this._instance.config.advanced_disable_decide)if(this.he)this.ve=!0;else{var c={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:T({},(null==(b=this._instance.persistence)?void 0:b.get_initial_props())||{},this._instance.get_property(aD)||{}),group_properties:this._instance.get_property(aE)};(null!=a&&a.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(c.disable_flags=!0);var d=this._instance.config.__preview_flags_v2&&this._instance.config.__preview_remote_config;d&&(c.timezone=eI()),this.he=!0,this._instance.me({method:"POST",url:this._instance.requestRouter.endpointFor("api",d?"/flags/?v=2":"/decide/?v=4"),data:c,compression:this._instance.config.disable_compression?void 0:t.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:a=>{var b,d,e,f=!0;200===a.statusCode&&(this.ve||(this.$anon_distinct_id=void 0),f=!1),this.he=!1,this.ce||(this.ce=!0,this._instance.be(null!=(e=a.json)?e:{})),(!c.disable_flags||this.ve)&&((this.fe=!f,a.json&&null!=(d=a.json.quotaLimited)&&d.includes(eQ.FeatureFlags))?eJ.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more."):(c.disable_flags||this.receivedFeatureFlags(null!=(b=a.json)?b:{},f),this.ve&&(this.ve=!1,this.ge())))}})}}getFeatureFlag(a,b){if(void 0===b&&(b={}),this.ue||this.getFlags()&&this.getFlags().length>0){var c=this.getFlagVariants()[a],d=""+c,e=this._instance.get_property(eO)||void 0,f=this._instance.get_property(aH)||{};if((b.send_event||!("send_event"in b))&&(!(a in f)||!f[a].includes(d))){C(f[a])?f[a].push(d):f[a]=[d],null==(i=this._instance.persistence)||i.register({[aH]:f});var g=this.getFeatureFlagDetails(a),h={$feature_flag:a,$feature_flag_response:c,$feature_flag_payload:this.getFeatureFlagPayload(a)||null,$feature_flag_request_id:e,$feature_flag_bootstrapped_response:(null==(j=this._instance.config.bootstrap)||null==(j=j.featureFlags)?void 0:j[a])||null,$feature_flag_bootstrapped_payload:(null==(k=this._instance.config.bootstrap)||null==(k=k.featureFlagPayloads)?void 0:k[a])||null,$used_bootstrap_value:!this.fe};G(null==g||null==(l=g.metadata)?void 0:l.version)||(h.$feature_flag_version=g.metadata.version);var i,j,k,l,m,n,o,p,q,r,s=null!=(m=null==g||null==(n=g.reason)?void 0:n.description)?m:null==g||null==(o=g.reason)?void 0:o.code;s&&(h.$feature_flag_reason=s),null!=g&&null!=(p=g.metadata)&&p.id&&(h.$feature_flag_id=g.metadata.id),G(null==g?void 0:g.original_variant)&&G(null==g?void 0:g.original_enabled)||(h.$feature_flag_original_response=G(g.original_variant)?g.original_enabled:g.original_variant),null!=g&&null!=(q=g.metadata)&&q.original_payload&&(h.$feature_flag_original_payload=null==g||null==(r=g.metadata)?void 0:r.original_payload),this._instance.capture("$feature_flag_called",h)}return c}eJ.warn('getFeatureFlag for key "'+a+"\" failed. Feature flags didn't load in time.")}getFeatureFlagDetails(a){return this.getFlagsWithDetails()[a]}getFeatureFlagPayload(a){return this.getFlagPayloads()[a]}getRemoteConfigPayload(a,b){var c=this._instance.config.token;this._instance.me({method:"POST",url:this._instance.requestRouter.endpointFor("api","/decide/?v=4"),data:{distinct_id:this._instance.get_distinct_id(),token:c},compression:this._instance.config.disable_compression?void 0:t.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:c=>{var d,e=null==(d=c.json)?void 0:d.featureFlagPayloads;b((null==e?void 0:e[a])||void 0)}})}isFeatureEnabled(a,b){if(void 0===b&&(b={}),this.ue||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(a,b);eJ.warn('isFeatureEnabled for key "'+a+"\" failed. Feature flags didn't load in time.")}addFeatureFlagsHandler(a){this.featureFlagEventHandlers.push(a)}removeFeatureFlagsHandler(a){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(b=>b!==a)}receivedFeatureFlags(a,b){if(this._instance.persistence){this.ue=!0;var c=this.getFlagVariants(),d=this.getFlagPayloads(),e=this.getFlagsWithDetails();!function(a,b,c,d,e){void 0===c&&(c={}),void 0===d&&(d={}),void 0===e&&(e={});var f,g=((f=a.flags)?(a.featureFlags=Object.fromEntries(Object.keys(f).map(a=>{var b;return[a,null!=(b=f[a].variant)?b:f[a].enabled]})),a.featureFlagPayloads=Object.fromEntries(Object.keys(f).filter(a=>f[a].enabled).filter(a=>{var b;return null==(b=f[a].metadata)?void 0:b.payload}).map(a=>{var b;return[a,null==(b=f[a].metadata)?void 0:b.payload]}))):eJ.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),a),h=g.flags,i=g.featureFlags,j=g.featureFlagPayloads;if(i){var k=a.requestId;if(C(i)){eJ.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var l={};if(i)for(var m=0;m<i.length;m++)l[i[m]]=!0;b&&b.register({[eK]:i,[aA]:l})}else{var n=i,o=j,p=h;a.errorsWhileComputingFlags&&(n=T({},c,n),o=T({},d,o),p=T({},e,p)),b&&b.register(T({[eK]:Object.keys(eP(n)),[aA]:n||{},[eM]:o||{},[aC]:p||{}},k?{[eO]:k}:{}))}}}(a,this._instance.persistence,c,d,e),this.we(b)}}override(a,b){void 0===b&&(b=!1),eJ.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:a,suppressWarning:b})}overrideFeatureFlags(a){if(!this._instance.__loaded||!this._instance.persistence)return eJ.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(!1===a)return this._instance.persistence.unregister(eL),this._instance.persistence.unregister(eN),void this.we();if(a&&"object"==typeof a&&("flags"in a||"payloads"in a)){var b;if(this.le=!!(null!=(b=a.suppressWarning)&&b),"flags"in a){if(!1===a.flags)this._instance.persistence.unregister(eL);else if(a.flags)if(C(a.flags)){for(var c={},d=0;d<a.flags.length;d++)c[a.flags[d]]=!0;this._instance.persistence.register({[eL]:c})}else this._instance.persistence.register({[eL]:a.flags})}return"payloads"in a&&(!1===a.payloads?this._instance.persistence.unregister(eN):a.payloads&&this._instance.persistence.register({[eN]:a.payloads})),void this.we()}this.we()}onFeatureFlags(a){if(this.addFeatureFlagsHandler(a),this.ue){var{flags:b,flagVariants:c}=this.ye();a(b,c)}return()=>this.removeFeatureFlagsHandler(a)}updateEarlyAccessFeatureEnrollment(a,b){var c,d=(this._instance.get_property(aB)||[]).find(b=>b.flagKey===a),e={["$feature_enrollment/"+a]:b},f={$feature_flag:a,$feature_enrollment:b,$set:e};d&&(f.$early_access_feature_name=d.name),this._instance.capture("$feature_enrollment_update",f),this.setPersonPropertiesForFlags(e,!1);var g=T({},this.getFlagVariants(),{[a]:b});null==(c=this._instance.persistence)||c.register({[eK]:Object.keys(eP(g)),[aA]:g}),this.we()}getEarlyAccessFeatures(a,b,c){void 0===b&&(b=!1);var d=this._instance.get_property(aB),e=c?"&"+c.map(a=>"stage="+a).join("&"):"";if(d&&!b)return a(d);this._instance.me({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+e),method:"GET",callback:b=>{var c;if(b.json){var d=b.json.earlyAccessFeatures;return null==(c=this._instance.persistence)||c.register({[aB]:d}),a(d)}}})}ye(){var a=this.getFlags(),b=this.getFlagVariants();return{flags:a.filter(a=>b[a]),flagVariants:Object.keys(b).filter(a=>b[a]).reduce((a,c)=>(a[c]=b[c],a),{})}}we(a){var{flags:b,flagVariants:c}=this.ye();this.featureFlagEventHandlers.forEach(d=>d(b,c,{errorsLoading:a}))}setPersonPropertiesForFlags(a,b){void 0===b&&(b=!0);var c=this._instance.get_property(aD)||{};this._instance.register({[aD]:T({},c,a)}),b&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(aD)}setGroupPropertiesForFlags(a,b){void 0===b&&(b=!0);var c=this._instance.get_property(aE)||{};0!==Object.keys(c).length&&Object.keys(c).forEach(b=>{c[b]=T({},c[b],a[b]),delete a[b]}),this._instance.register({[aE]:T({},c,a)}),b&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(a){if(a){var b=this._instance.get_property(aE)||{};this._instance.register({[aE]:T({},b,{[a]:{}})})}else this._instance.unregister(aE)}}var eS=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class eT{constructor(a){this.S=a,this.props={},this.Se=!1,this.$e=(a=>{var b="";return a.token&&(b=a.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),a.persistence_name?"ph_"+a.persistence_name:"ph_"+b+"_posthog"})(a),this.q=this.ke(a),this.load(),a.debug&&P.info("Persistence loaded",a.persistence,T({},this.props)),this.update_config(a,a),this.save()}ke(a){-1===eS.indexOf(a.persistence.toLowerCase())&&(P.critical("Unknown persistence type "+a.persistence+"; falling back to localStorage+cookie"),a.persistence="localStorage+cookie");var b=a.persistence.toLowerCase();return"localstorage"===b&&by.O()?by:"localstorage+cookie"===b&&bA.O()?bA:"sessionstorage"===b&&bE.O()?bE:"memory"===b?bC:"cookie"===b?bw:bA.O()?bA:bw}properties(){var a={};return X(this.props,function(b,c){if(c===aA&&E(b))for(var d,e=Object.keys(b),f=0;f<e.length;f++)a["$feature/"+e[f]]=b[e[f]];else d=!1,(J(aR)?d:h&&aR.indexOf===h?-1!=aR.indexOf(c):(X(aR,function(a){if(d||(d=a===c))return V}),d))||(a[c]=b)}),a}load(){if(!this.xe){var a=this.q.D(this.$e);a&&(this.props=Y({},a))}}save(){this.xe||this.q.L(this.$e,this.props,this.Ee,this.Ie,this.Pe,this.S.debug)}remove(){this.q.N(this.$e,!1),this.q.N(this.$e,!0)}clear(){this.remove(),this.props={}}register_once(a,b,c){if(E(a)){G(b)&&(b="None"),this.Ee=G(c)?this.Re:c;var d=!1;if(X(a,(a,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==b||(this.props[c]=a,d=!0)}),d)return this.save(),!0}return!1}register(a,b){if(E(a)){this.Ee=G(b)?this.Re:b;var c=!1;if(X(a,(b,d)=>{a.hasOwnProperty(d)&&this.props[d]!==b&&(this.props[d]=b,c=!0)}),c)return this.save(),!0}return!1}unregister(a){a in this.props&&(delete this.props[a],this.save())}update_campaign_params(){if(!this.Se){var a=eB(this.S.custom_campaign_params,this.S.mask_personal_data_properties,this.S.custom_personal_data_properties);F(aa(a))||this.register(a),this.Se=!0}}update_search_keyword(){var a;this.register((a=null==j?void 0:j.referrer)?eD(a):{})}update_referrer_info(){var a;this.register_once({$referrer:eF(),$referring_domain:null!=j&&j.referrer&&(null==(a=bd(j.referrer))?void 0:a.host)||"$direct"},void 0)}set_initial_person_info(){this.props[aL]||this.props[aM]||this.register_once({[aN]:eG(this.S.mask_personal_data_properties,this.S.custom_personal_data_properties)},void 0)}get_initial_props(){var a={};X([aM,aL],b=>{var c=this.props[b];c&&X(c,function(b,c){a["$initial_"+x(c)]=b})});var b,c,d=this.props[aN];return d&&Y(a,(b=eH(d),c={},X(b,function(a,b){c["$initial_"+x(b)]=a}),c)),a}safe_merge(a){return X(this.props,function(b,c){c in a||(a[c]=b)}),a}update_config(a,b){if(this.Re=this.Ee=a.cookie_expiration,this.set_disabled(a.disable_persistence),this.set_cross_subdomain(a.cross_subdomain_cookie),this.set_secure(a.secure_cookie),a.persistence!==b.persistence){var c=this.ke(a),d=this.props;this.clear(),this.q=c,this.props=d,this.save()}}set_disabled(a){this.xe=a,this.xe?this.remove():this.save()}set_cross_subdomain(a){a!==this.Ie&&(this.Ie=a,this.remove(),this.save())}set_secure(a){a!==this.Pe&&(this.Pe=a,this.remove(),this.save())}set_event_timer(a,b){var c=this.props[ag]||{};c[a]=b,this.props[ag]=c,this.save()}remove_event_timer(a){var b=(this.props[ag]||{})[a];return G(b)||(delete this.props[ag][a],this.save()),b}get_property(a){return this.props[a]}set_property(a,b){this.props[a]=b,this.save()}}class eU{constructor(){this.Te={},this.Te={}}on(a,b){return this.Te[a]||(this.Te[a]=[]),this.Te[a].push(b),()=>{this.Te[a]=this.Te[a].filter(a=>a!==b)}}emit(a,b){for(var c of this.Te[a]||[])c(b);for(var d of this.Te["*"]||[])d(a,b)}}class eV{constructor(a){this.Me=new eU,this.Ce=(a,b)=>this.Oe(a,b)&&this.Fe(a,b)&&this.Ae(a,b),this.Oe=(a,b)=>null==b||!b.event||(null==a?void 0:a.event)===(null==b?void 0:b.event),this._instance=a,this.De=new Set,this.Le=new Set}init(){var a,b;G(null==(a=this._instance)?void 0:a.Ne)||null==(b=this._instance)||b.Ne((a,b)=>{this.on(a,b)})}register(a){var b,c;if(!G(null==(b=this._instance)?void 0:b.Ne)&&(a.forEach(a=>{var b,c;null==(b=this.Le)||b.add(a),null==(c=a.steps)||c.forEach(a=>{var b;null==(b=this.De)||b.add((null==a?void 0:a.event)||"")})}),null!=(c=this._instance)&&c.autocapture)){var d,e=new Set;a.forEach(a=>{var b;null==(b=a.steps)||b.forEach(a=>{null!=a&&a.selector&&e.add(null==a?void 0:a.selector)})}),null==(d=this._instance)||d.autocapture.setElementSelectors(e)}}on(a,b){var c;null!=b&&0!=a.length&&(this.De.has(a)||this.De.has(null==b?void 0:b.event))&&this.Le&&(null==(c=this.Le)?void 0:c.size)>0&&this.Le.forEach(a=>{this.je(b,a)&&this.Me.emit("actionCaptured",a.name)})}ze(a){this.onAction("actionCaptured",b=>a(b))}je(a,b){if(null==(null==b?void 0:b.steps))return!1;for(var c of b.steps)if(this.Ce(a,c))return!0;return!1}onAction(a,b){return this.Me.on(a,b)}Fe(a,b){if(null!=b&&b.url){var c,d=null==a||null==(c=a.properties)?void 0:c.$current_url;if(!d||"string"!=typeof d||!eV.Ue(d,null==b?void 0:b.url,(null==b?void 0:b.url_matching)||"contains"))return!1}return!0}static Ue(a,b,c){switch(c){case"regex":return!!d&&dH(a,b);case"exact":return b===a;case"contains":return dH(a,eV.qe(b).replace(/_/g,".").replace(/%/g,".*"));default:return!1}}static qe(a){return a.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Ae(a,b){if((null!=b&&b.href||null!=b&&b.tag_name||null!=b&&b.text)&&!this.Be(a).some(a=>!(null!=b&&b.href&&!eV.Ue(a.href||"",null==b?void 0:b.href,(null==b?void 0:b.href_matching)||"exact"))&&(null==b||!b.tag_name||a.tag_name===(null==b?void 0:b.tag_name))&&!(null!=b&&b.text&&!eV.Ue(a.text||"",null==b?void 0:b.text,(null==b?void 0:b.text_matching)||"exact")&&!eV.Ue(a.$el_text||"",null==b?void 0:b.text,(null==b?void 0:b.text_matching)||"exact"))))return!1;if(null!=b&&b.selector){var c,d=null==a||null==(c=a.properties)?void 0:c.$element_selectors;if(!d||!d.includes(null==b?void 0:b.selector))return!1}return!0}Be(a){return null==(null==a?void 0:a.properties.$elements)?[]:null==a?void 0:a.properties.$elements}}var eW=Q("[Surveys]");class eX{constructor(a){this._instance=a,this.He=new Map,this.We=new Map}register(a){var b;G(null==(b=this._instance)?void 0:b.Ne)||(this.Ge(a),this.Je(a))}Je(a){var b=a.filter(a=>{var b,c;return(null==(b=a.conditions)?void 0:b.actions)&&(null==(c=a.conditions)||null==(c=c.actions)||null==(c=c.values)?void 0:c.length)>0});0!==b.length&&(null==this.Ve&&(this.Ve=new eV(this._instance),this.Ve.init(),this.Ve.ze(a=>{this.onAction(a)})),b.forEach(a=>{var b,c,d,e,f;a.conditions&&null!=(b=a.conditions)&&b.actions&&null!=(c=a.conditions)&&null!=(c=c.actions)&&c.values&&(null==(d=a.conditions)||null==(d=d.actions)||null==(d=d.values)?void 0:d.length)>0&&(null==(e=this.Ve)||e.register(a.conditions.actions.values),null==(f=a.conditions)||null==(f=f.actions)||null==(f=f.values)||f.forEach(b=>{if(b&&b.name){var c=this.We.get(b.name);c&&c.push(a.id),this.We.set(b.name,c||[a.id])}}))}))}Ge(a){var b;0!==a.filter(a=>{var b,c;return(null==(b=a.conditions)?void 0:b.events)&&(null==(c=a.conditions)||null==(c=c.events)||null==(c=c.values)?void 0:c.length)>0}).length&&(null==(b=this._instance)||b.Ne((a,b)=>{this.onEvent(a,b)}),a.forEach(a=>{var b;null==(b=a.conditions)||null==(b=b.events)||null==(b=b.values)||b.forEach(b=>{if(b&&b.name){var c=this.He.get(b.name);c&&c.push(a.id),this.He.set(b.name,c||[a.id])}})}))}onEvent(a,b){var c,d=(null==(c=this._instance)||null==(c=c.persistence)?void 0:c.props[aG])||[];if("survey shown"===a&&b&&d.length>0){eW.info("survey event matched, removing survey from activated surveys",{event:a,eventPayload:b,existingActivatedSurveys:d});var e,f=null==b||null==(e=b.properties)?void 0:e.$survey_id;if(f){var g=d.indexOf(f);g>=0&&(d.splice(g,1),this.Ke(d))}}else this.He.has(a)&&(eW.info("survey event matched, updating activated surveys",{event:a,surveys:this.He.get(a)}),this.Ke(d.concat(this.He.get(a)||[])))}onAction(a){var b,c=(null==(b=this._instance)||null==(b=b.persistence)?void 0:b.props[aG])||[];this.We.has(a)&&this.Ke(c.concat(this.We.get(a)||[]))}Ke(a){var b;null==(b=this._instance)||null==(b=b.persistence)||b.register({[aG]:[...new Set(a)]})}getSurveys(){var a;return(null==(a=this._instance)||null==(a=a.persistence)?void 0:a.props[aG])||[]}getEventToSurveys(){return this.He}Ye(){return this.Ve}}class eY{constructor(a){this.Xe=null,this.Qe=!1,this.Ze=!1,this.tr=[],this._instance=a,this._surveyEventReceiver=null}onRemoteConfig(a){var b=a.surveys;if(K(b))return eW.warn("Decide not loaded yet. Not loading surveys.");var c=C(b);this.ir=c?b.length>0:b,eW.info("decide response received, hasSurveys: "+this.ir),this.ir&&this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var a=[],b=0;b<localStorage.length;b++){var c=localStorage.key(b);(null!=c&&c.startsWith("seenSurvey_")||null!=c&&c.startsWith("inProgressSurvey_"))&&a.push(c)}a.forEach(a=>localStorage.removeItem(a))}loadIfEnabled(){if(!this.Xe)if(this.Ze)eW.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)eW.info("Disabled. Not loading surveys.");else if(this.ir){var a=null==p?void 0:p.__PosthogExtensions__;if(a){this.Ze=!0;try{var b=a.generateSurveys;if(b)return void this.er(b);var c=a.loadExternalDependency;if(!c)return void this.rr("PostHog loadExternalDependency extension not found.");c(this._instance,"surveys",b=>{b||!a.generateSurveys?this.rr("Could not load surveys script",b):this.er(a.generateSurveys)})}catch(a){throw this.rr("Error initializing surveys",a),a}finally{this.Ze=!1}}else eW.error("PostHog Extensions not found.")}else eW.info("No surveys to load.")}er(a){this.Xe=a(this._instance),this._surveyEventReceiver=new eX(this._instance),eW.info("Surveys loaded successfully"),this.sr({isLoaded:!0})}rr(a,b){eW.error(a,b),this.sr({isLoaded:!1,error:a})}onSurveysLoaded(a){return this.tr.push(a),this.Xe&&this.sr({isLoaded:!0}),()=>{this.tr=this.tr.filter(b=>b!==a)}}getSurveys(a,b){if(void 0===b&&(b=!1),this._instance.config.disable_surveys)return eW.info("Disabled. Not loading surveys."),a([]);var c=this._instance.get_property(aF);if(c&&!b)return a(c,{isLoaded:!0});if(this.Qe)return a([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.Qe=!0,this._instance.me({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:b=>{this.Qe=!1;var c=b.statusCode;if(200!==c||!b.json){var d="Surveys API could not be loaded, status: "+c;return eW.error(d),a([],{isLoaded:!1,error:d})}var e,f,g=b.json.surveys||[],h=g.filter(a=>{var b,c;return!(!a.start_date||a.end_date)&&(!(null==(b=a.conditions)||null==(b=b.events)||null==(b=b.values)||!b.length)||!(null==(c=a.conditions)||null==(c=c.actions)||null==(c=c.values)||!c.length))});return h.length>0&&(null==(f=this._surveyEventReceiver)||f.register(h)),null==(e=this._instance.persistence)||e.register({[aF]:g}),a(g,{isLoaded:!0})}})}catch(a){throw this.Qe=!1,a}}sr(a){for(var b of this.tr)try{a.isLoaded?this.getSurveys(b):b([],a)}catch(a){eW.error("Error in survey callback",a)}}getActiveMatchingSurveys(a,b){if(void 0===b&&(b=!1),!K(this.Xe))return this.Xe.getActiveMatchingSurveys(a,b);eW.warn("init was not called")}nr(a){var b=null;return this.getSurveys(c=>{var d;b=null!=(d=c.find(b=>b.id===a))?d:null}),b}ar(a){if(K(this.Xe))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var b="string"==typeof a?this.nr(a):a;return b?this.Xe.checkSurveyEligibility(b):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(a){if(K(this.Xe))return eW.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var b=this.ar(a);return{visible:b.eligible,disabledReason:b.reason}}canRenderSurveyAsync(a,b){return K(this.Xe)?(eW.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(c=>{this.getSurveys(b=>{var d,e=null!=(d=b.find(b=>b.id===a))?d:null;if(e){var f=this.ar(e);c({visible:f.eligible,disabledReason:f.reason})}else c({visible:!1,disabledReason:"Survey not found"})},b)})}renderSurvey(a,b){if(K(this.Xe))eW.warn("init was not called");else{var c=this.nr(a),d=null==j?void 0:j.querySelector(b);c?d?this.Xe.renderSurvey(c,d):eW.warn("Survey element not found"):eW.warn("Survey not found")}}}var eZ=Q("[RateLimiter]");class e${constructor(a){var b,c;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=a=>{var b=a.text;if(b&&b.length)try{(JSON.parse(b).quota_limited||[]).forEach(a=>{eZ.info((a||"events")+" is quota limited."),this.serverLimits[a]=(new Date).getTime()+6e4})}catch(a){return void eZ.warn('could not rate limit - continuing. Error: "'+(null==a?void 0:a.message)+'"',{text:b})}},this.instance=a,this.captureEventsPerSecond=(null==(b=a.config.rate_limiting)?void 0:b.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null==(c=a.config.rate_limiting)?void 0:c.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(a){void 0===a&&(a=!1);var b,c,d,e=(new Date).getTime(),f=null!=(b=null==(c=this.instance.persistence)?void 0:c.get_property(aK))?b:{tokens:this.captureEventsBurstLimit,last:e};f.tokens+=(e-f.last)/1e3*this.captureEventsPerSecond,f.last=e,f.tokens>this.captureEventsBurstLimit&&(f.tokens=this.captureEventsBurstLimit);var g=f.tokens<1;return g||a||(f.tokens=Math.max(0,f.tokens-1)),!g||this.lastEventRateLimited||a||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=g,null==(d=this.instance.persistence)||d.set_property(aK,f),{isRateLimited:g,remainingTokens:f.tokens}}isServerRateLimited(a){var b=this.serverLimits[a||"events"]||!1;return!1!==b&&(new Date).getTime()<b}}var e_=Q("[RemoteConfig]");class e0{constructor(a){this._instance=a}get remoteConfig(){var a;return null==(a=p._POSTHOG_REMOTE_CONFIG)||null==(a=a[this._instance.config.token])?void 0:a.config}lr(a){var b,c;null!=(b=p.__PosthogExtensions__)&&b.loadExternalDependency?null==(c=p.__PosthogExtensions__)||null==c.loadExternalDependency||c.loadExternalDependency(this._instance,"remote-config",()=>a(this.remoteConfig)):(e_.error("PostHog Extensions not found. Cannot load remote config."),a())}ur(a){this._instance.me({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:b=>{a(b.json)}})}load(){try{if(this.remoteConfig)return e_.info("Using preloaded remote config",this.remoteConfig),void this.be(this.remoteConfig);if(this._instance.config.advanced_disable_decide)return void e_.warn("Remote config is disabled. Falling back to local config.");this.lr(a=>{a?this.be(a):(e_.info("No config found after loading remote JS config. Falling back to JSON."),this.ur(a=>{this.be(a)}))})}catch(a){e_.error("Error loading remote config",a)}}be(a){a?this._instance.config.__preview_remote_config?(this._instance.be(a),!1!==a.hasFeatureFlags&&this._instance.featureFlags.ensureFlagsLoaded()):e_.info("__preview_remote_config is disabled. Logging config instead",a):e_.error("Failed to fetch remote config from PostHog.")}}class e1{constructor(a,b){this.hr=!0,this.dr=[],this.vr=ck((null==b?void 0:b.flush_interval_ms)||3e3,250,5e3,"flush interval",3e3),this.cr=a}enqueue(a){this.dr.push(a),this.pr||this.gr()}unload(){this._r();var a=Object.values(this.dr.length>0?this.mr():{});[...a.filter(a=>0===a.url.indexOf("/e")),...a.filter(a=>0!==a.url.indexOf("/e"))].map(a=>{this.cr(T({},a,{transport:"sendBeacon"}))})}enable(){this.hr=!1,this.gr()}gr(){var a=this;this.hr||(this.pr=setTimeout(()=>{if(this._r(),this.dr.length>0){var b=this.mr();for(var c in b)!function(){var d=b[c],e=(new Date).getTime();d.data&&C(d.data)&&X(d.data,a=>{a.offset=Math.abs(a.timestamp-e),delete a.timestamp}),a.cr(d)}()}},this.vr))}_r(){clearTimeout(this.pr),this.pr=void 0}mr(){var a={};return X(this.dr,b=>{var c,d=(b?b.batchKey:null)||b.url;G(a[d])&&(a[d]=T({},b,{data:[]})),null==(c=a[d].data)||c.push(b.data)}),this.dr=[],a}}var e2=["retriesPerformedSoFar"];class e3{constructor(a){this.br=!1,this.wr=3e3,this.dr=[],this._instance=a,this.dr=[],this.yr=!0,!G(d)&&"onLine"in d.navigator&&(this.yr=d.navigator.onLine,ad(d,"online",()=>{this.yr=!0,this.Yi()}),ad(d,"offline",()=>{this.yr=!1}))}get length(){return this.dr.length}retriableRequest(a){var{retriesPerformedSoFar:b}=a,c=U(a,e2);L(b)&&b>0&&(c.url=dD(c.url,{retry_count:b})),this._instance.me(T({},c,{callback:a=>{200!==a.statusCode&&(a.statusCode<400||a.statusCode>=500)&&(null!=b?b:0)<10?this.Sr(T({retriesPerformedSoFar:b},c)):null==c.callback||c.callback(a)}}))}Sr(a){var b,c,d,e=a.retriesPerformedSoFar||0;a.retriesPerformedSoFar=e+1;var f=(d=(Math.random()-.5)*((c=Math.min(18e5,b=3e3*Math.pow(2,e)))-b/2),Math.ceil(c+d)),g=Date.now()+f;this.dr.push({retryAt:g,requestOptions:a});var h="Enqueued failed request for retry in "+f;navigator.onLine||(h+=" (Browser is offline)"),P.warn(h),this.br||(this.br=!0,this.$r())}$r(){this.kr&&clearTimeout(this.kr),this.kr=setTimeout(()=>{this.yr&&this.dr.length>0&&this.Yi(),this.$r()},this.wr)}Yi(){var a=Date.now(),b=[],c=this.dr.filter(c=>c.retryAt<a||(b.push(c),!1));if(this.dr=b,c.length>0)for(var{requestOptions:d}of c)this.retriableRequest(d)}unload(){for(var{requestOptions:a}of(this.kr&&(clearTimeout(this.kr),this.kr=void 0),this.dr))try{this._instance.me(T({},a,{transport:"sendBeacon"}))}catch(a){P.error(a)}this.dr=[]}}class e4{constructor(a){this.Er=()=>{this.Ir||(this.Ir={});var a,b,c,d,e=this.scrollElement(),f=this.scrollY(),g=e?Math.max(0,e.scrollHeight-e.clientHeight):0,h=f+((null==e?void 0:e.clientHeight)||0),i=(null==e?void 0:e.scrollHeight)||0;this.Ir.lastScrollY=Math.ceil(f),this.Ir.maxScrollY=Math.max(f,null!=(a=this.Ir.maxScrollY)?a:0),this.Ir.maxScrollHeight=Math.max(g,null!=(b=this.Ir.maxScrollHeight)?b:0),this.Ir.lastContentY=h,this.Ir.maxContentY=Math.max(h,null!=(c=this.Ir.maxContentY)?c:0),this.Ir.maxContentHeight=Math.max(i,null!=(d=this.Ir.maxContentHeight)?d:0)},this._instance=a}getContext(){return this.Ir}resetContext(){var a=this.Ir;return setTimeout(this.Er,0),a}startMeasuringScrollPosition(){ad(d,"scroll",this.Er,{capture:!0}),ad(d,"scrollend",this.Er,{capture:!0}),ad(d,"resize",this.Er)}scrollElement(){if(!this._instance.config.scroll_root_selector)return null==d?void 0:d.document.documentElement;for(var a of C(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector]){var b=null==d?void 0:d.document.querySelector(a);if(b)return b}}scrollY(){if(this._instance.config.scroll_root_selector){var a=this.scrollElement();return a&&a.scrollTop||0}return d&&(d.scrollY||d.pageYOffset||d.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var a=this.scrollElement();return a&&a.scrollLeft||0}return d&&(d.scrollX||d.pageXOffset||d.document.documentElement.scrollLeft)||0}}var e5=a=>eG(null==a?void 0:a.config.mask_personal_data_properties,null==a?void 0:a.config.custom_personal_data_properties);class e6{constructor(a,b,c,d){this.Pr=a=>{var b=this.Rr();if(!b||b.sessionId!==a){var c={sessionId:a,props:this.Tr(this._instance)};this.Mr.register({[aJ]:c})}},this._instance=a,this.Cr=b,this.Mr=c,this.Tr=d||e5,this.Cr.onSessionId(this.Pr)}Rr(){return this.Mr.props[aJ]}getSetOnceProps(){var a,b=null==(a=this.Rr())?void 0:a.props;return b?"r"in b?eH(b):{$referring_domain:b.referringDomain,$pathname:b.initialPathName,utm_source:b.utm_source,utm_campaign:b.utm_campaign,utm_medium:b.utm_medium,utm_content:b.utm_content,utm_term:b.utm_term}:{}}getSessionProps(){var a={};return X(aa(this.getSetOnceProps()),(b,c)=>{"$current_url"===c&&(c="url"),a["$session_entry_"+x(c)]=b}),a}}var e7=Q("[SessionId]");class e8{constructor(a,b,c){if(this.Or=[],!a.persistence)throw Error("SessionIdManager requires a PostHogPersistence instance");if(a.config.__preview_experimental_cookieless_mode)throw Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.S=a.config,this.Mr=a.persistence,this.oi=void 0,this.kt=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.Fr=b||bs,this.Ar=c||bs;var d,e=this.S.persistence_name||this.S.token,f=this.S.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*ck(f,60,36e3,"session_idle_timeout_seconds",1800),a.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Dr(),this.Lr="ph_"+e+"_window_id",this.Nr="ph_"+e+"_primary_window_exists",this.jr()){var g=bE.D(this.Lr),h=bE.D(this.Nr);g&&!h?this.oi=g:bE.N(this.Lr),bE.L(this.Nr,!0)}if(null!=(d=this.S.bootstrap)&&d.sessionID)try{var i=(a=>{var b=a.replace(/-/g,"");if(32!==b.length)throw Error("Not a valid UUID");if("7"!==b[12])throw Error("Not a UUIDv7");return parseInt(b.substring(0,12),16)})(this.S.bootstrap.sessionID);this.zr(this.S.bootstrap.sessionID,(new Date).getTime(),i)}catch(a){e7.error("Invalid sessionID in bootstrap",a)}this.Ur()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(a){return G(this.Or)&&(this.Or=[]),this.Or.push(a),this.kt&&a(this.kt,this.oi),()=>{this.Or=this.Or.filter(b=>b!==a)}}jr(){return"memory"!==this.S.persistence&&!this.Mr.xe&&bE.O()}qr(a){a!==this.oi&&(this.oi=a,this.jr()&&bE.L(this.Lr,a))}Br(){return this.oi?this.oi:this.jr()?bE.D(this.Lr):null}zr(a,b,c){a===this.kt&&b===this._sessionActivityTimestamp&&c===this._sessionStartTimestamp||(this._sessionStartTimestamp=c,this._sessionActivityTimestamp=b,this.kt=a,this.Mr.register({[aw]:[b,a,c]}))}Hr(){if(this.kt&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.kt,this._sessionStartTimestamp];var a=this.Mr.props[aw];return C(a)&&2===a.length&&a.push(a[0]),a||[0,null,0]}resetSessionId(){this.zr(null,null,null)}Ur(){ad(d,"beforeunload",()=>{this.jr()&&bE.N(this.Nr)},{capture:!1})}checkAndGetSessionAndWindowId(a,b){if(void 0===a&&(a=!1),void 0===b&&(b=null),this.S.__preview_experimental_cookieless_mode)throw Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var c=b||(new Date).getTime(),[d,e,f]=this.Hr(),g=this.Br(),h=L(f)&&f>0&&Math.abs(c-f)>864e5,i=!1,j=!e,k=!a&&Math.abs(c-d)>this.sessionTimeoutMs;j||k||h?(e=this.Fr(),g=this.Ar(),e7.info("new session ID generated",{sessionId:e,windowId:g,changeReason:{noSessionId:j,activityTimeout:k,sessionPastMaximumLength:h}}),f=c,i=!0):g||(g=this.Ar(),i=!0);var l=0===d||!a||h?c:d,m=0===f?(new Date).getTime():f;return this.qr(g),this.zr(e,l,m),a||this.Dr(),i&&this.Or.forEach(a=>a(e,g,i?{noSessionId:j,activityTimeout:k,sessionPastMaximumLength:h}:void 0)),{sessionId:e,windowId:g,sessionStartTimestamp:m,changeReason:i?{noSessionId:j,activityTimeout:k,sessionPastMaximumLength:h}:void 0,lastActivityTimestamp:d}}Dr(){clearTimeout(this.Wr),this.Wr=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}}var e9=["$set_once","$set"],fa=Q("[SiteApps]");class fb{constructor(a){this._instance=a,this.Gr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}Jr(a,b){if(b){var c=this.globalsForEvent(b);this.Gr.push(c),this.Gr.length>1e3&&(this.Gr=this.Gr.slice(10))}}get siteAppLoaders(){var a;return null==(a=p._POSTHOG_REMOTE_CONFIG)||null==(a=a[this._instance.config.token])?void 0:a.siteApps}init(){if(this.isEnabled){var a=this._instance.Ne(this.Jr.bind(this));this.Vr=()=>{a(),this.Gr=[],this.Vr=void 0}}}globalsForEvent(a){if(!a)throw Error("Event payload is required");var b,c,d,e,f,g,h,i={},j=this._instance.get_property("$groups")||[];for(var[k,l]of Object.entries(this._instance.get_property("$stored_group_properties")||{}))i[k]={id:j[k],type:k,properties:l};var{$set_once:m,$set:n}=a;return{event:T({},U(a,e9),{properties:T({},a.properties,n?{$set:T({},null!=(b=null==(c=a.properties)?void 0:c.$set)?b:{},n)}:{},m?{$set_once:T({},null!=(d=null==(e=a.properties)?void 0:e.$set_once)?d:{},m)}:{}),elements_chain:null!=(f=null==(g=a.properties)?void 0:g.$elements_chain)?f:"",distinct_id:null==(h=a.properties)?void 0:h.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:i}}setupSiteApp(a){var b=this.apps[a.id],c=()=>{var c;!b.errored&&this.Gr.length&&(fa.info("Processing "+this.Gr.length+" events for site app with id "+a.id),this.Gr.forEach(a=>null==b.processEvent?void 0:b.processEvent(a)),b.processedBuffer=!0),Object.values(this.apps).every(a=>a.processedBuffer||a.errored)&&(null==(c=this.Vr)||c.call(this))},d=!1,e=e=>{b.errored=!e,b.loaded=!0,fa.info("Site app with id "+a.id+" "+(e?"loaded":"errored")),d&&c()};try{var{processEvent:f}=a.init({posthog:this._instance,callback:a=>{e(a)}});f&&(b.processEvent=f),d=!0}catch(b){fa.error("Error while initializing PostHog app with config id "+a.id,b),e(!1)}if(d&&b.loaded)try{c()}catch(c){fa.error("Error while processing buffered events PostHog app with config id "+a.id,c),b.errored=!0}}Kr(){var a=this.siteAppLoaders||[];for(var b of a)this.apps[b.id]={id:b.id,loaded:!1,errored:!1,processedBuffer:!1};for(var c of a)this.setupSiteApp(c)}Yr(a){if(0!==Object.keys(this.apps).length){var b=this.globalsForEvent(a);for(var c of Object.values(this.apps))try{null==c.processEvent||c.processEvent(b)}catch(b){fa.error("Error while processing event "+a.event+" for site app "+c.id,b)}}}onRemoteConfig(a){var b,c,d,e=this;if(null!=(b=this.siteAppLoaders)&&b.length)return this.isEnabled?(this.Kr(),void this._instance.on("eventCaptured",a=>this.Yr(a))):void fa.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if(null==(c=this.Vr)||c.call(this),null!=(d=a.siteApps)&&d.length)if(this.isEnabled){var f=function(a){var b;p["__$$ph_site_app_"+a]=e._instance,null==(b=p.__PosthogExtensions__)||null==b.loadSiteApp||b.loadSiteApp(e._instance,h,b=>{if(b)return fa.error("Error while initializing PostHog app with config id "+a,b)})};for(var{id:g,url:h}of a.siteApps)f(g)}else fa.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var fc=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],fd=function(a,b){if(!a)return!1;var c=a.toLowerCase();return fc.concat(b||[]).some(a=>{var b=a.toLowerCase();return -1!==c.indexOf(b)})},fe=function(a,b){if(!a)return!1;var c=a.userAgent;if(c&&fd(c,b))return!0;try{var d=null==a?void 0:a.userAgentData;if(null!=d&&d.brands&&d.brands.some(a=>fd(null==a?void 0:a.brand,b)))return!0}catch(a){}return!!a.webdriver},ff=((fw={}).US="us",fw.EU="eu",fw.CUSTOM="custom",fw),fg="i.posthog.com";class fh{constructor(a){this.Xr={},this.instance=a}get apiHost(){var a=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===a?"https://us.i.posthog.com":a}get uiHost(){var a,b=null==(a=this.instance.config.ui_host)?void 0:a.replace(/\/$/,"");return b||(b=this.apiHost.replace("."+fg,".posthog.com")),"https://app.posthog.com"===b?"https://us.posthog.com":b}get region(){return this.Xr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Xr[this.apiHost]=ff.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Xr[this.apiHost]=ff.EU:this.Xr[this.apiHost]=ff.CUSTOM),this.Xr[this.apiHost]}endpointFor(a,b){if(void 0===b&&(b=""),b&&(b="/"===b[0]?b:"/"+b),"ui"===a)return this.uiHost+b;if(this.region===ff.CUSTOM)return this.apiHost+b;var c=fg+b;switch(a){case"assets":return"https://"+this.region+"-assets."+c;case"api":return"https://"+this.region+"."+c}}}var fi={icontains:(a,b)=>!!d&&b.href.toLowerCase().indexOf(a.toLowerCase())>-1,not_icontains:(a,b)=>!!d&&-1===b.href.toLowerCase().indexOf(a.toLowerCase()),regex:(a,b)=>!!d&&dH(b.href,a),not_regex:(a,b)=>!!d&&!dH(b.href,a),exact:(a,b)=>b.href===a,is_not:(a,b)=>b.href!==a};class fj{constructor(a){var b=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(a){void 0===a&&(a=!1),b.getWebExperiments(a=>{fj.Qr("retrieved web experiments from the server"),b.Zr=new Map,a.forEach(a=>{if(a.feature_flag_key){b.Zr&&(fj.Qr("setting flag key ",a.feature_flag_key," to web experiment ",a),null==(c=b.Zr)||c.set(a.feature_flag_key,a));var c,d=b._instance.getFeatureFlag(a.feature_flag_key);H(d)&&a.variants[d]&&b.ts(a.name,d,a.variants[d].transforms)}else if(a.variants)for(var e in a.variants){var f=a.variants[e];fj.es(f)&&b.ts(a.name,e,f.transforms)}})},a)},this._instance=a,this._instance.onFeatureFlags(a=>{this.onFeatureFlags(a)})}onFeatureFlags(a){if(this._is_bot())fj.Qr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(K(this.Zr))return this.Zr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();fj.Qr("applying feature flags",a),a.forEach(a=>{var b;if(this.Zr&&null!=(b=this.Zr)&&b.has(a)){var c,d=this._instance.getFeatureFlag(a),e=null==(c=this.Zr)?void 0:c.get(a);d&&null!=e&&e.variants[d]&&this.ts(e.name,d,e.variants[d].transforms)}})}}previewWebExperiment(){var a=fj.getWindowLocation();if(null!=a&&a.search){var b=bf(null==a?void 0:a.search,"__experiment_id"),c=bf(null==a?void 0:a.search,"__experiment_variant");b&&c&&(fj.Qr("previewing web experiments "+b+" && "+c),this.getWebExperiments(a=>{this.rs(parseInt(b),c,a)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(a,b,c){if(this._instance.config.disable_web_experiments&&!c)return a([]);var d=this._instance.get_property("$web_experiments");if(d&&!b)return a(d);this._instance.me({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:b=>200===b.statusCode&&b.json?a(b.json.experiments||[]):a([])})}rs(a,b,c){var d=c.filter(b=>b.id===a);d&&d.length>0&&(fj.Qr("Previewing web experiment ["+d[0].name+"] with variant ["+b+"]"),this.ts(d[0].name,b,d[0].variants[b].transforms))}static es(a){return!K(a.conditions)&&fj.ss(a)&&fj.ns(a)}static ss(a){if(K(a.conditions)||K(null==(b=a.conditions)?void 0:b.url))return!0;var b,c,d,e,f=fj.getWindowLocation();return!!f&&(null==(c=a.conditions)||!c.url||fi[null!=(d=null==(e=a.conditions)?void 0:e.urlMatchType)?d:"icontains"](a.conditions.url,f))}static getWindowLocation(){return null==d?void 0:d.location}static ns(a){if(K(a.conditions)||K(null==(c=a.conditions)?void 0:c.utm))return!0;var b=eB();if(b.utm_source){var c,d,e,f,g,h,i,j,k,l=null==(d=a.conditions)||null==(d=d.utm)||!d.utm_campaign||(null==(e=a.conditions)||null==(e=e.utm)?void 0:e.utm_campaign)==b.utm_campaign,m=null==(f=a.conditions)||null==(f=f.utm)||!f.utm_source||(null==(g=a.conditions)||null==(g=g.utm)?void 0:g.utm_source)==b.utm_source,n=null==(h=a.conditions)||null==(h=h.utm)||!h.utm_medium||(null==(i=a.conditions)||null==(i=i.utm)?void 0:i.utm_medium)==b.utm_medium,o=null==(j=a.conditions)||null==(j=j.utm)||!j.utm_term||(null==(k=a.conditions)||null==(k=k.utm)?void 0:k.utm_term)==b.utm_term;return l&&n&&o&&m}return!1}static Qr(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];P.info("[WebExperiments] "+a,c)}ts(a,b,c){this._is_bot()?fj.Qr("Refusing to render web experiment since the viewer is a likely bot"):"control"!==b?c.forEach(c=>{if(c.selector){fj.Qr("applying transform of variant "+b+" for experiment "+a+" ",c);var d,e=null==(d=document)?void 0:d.querySelectorAll(c.selector);null==e||e.forEach(a=>{c.html&&(a.innerHTML=c.html),c.css&&a.setAttribute("style",c.css)})}}):fj.Qr("Control variants leave the page unmodified.")}_is_bot(){return i&&this._instance?fe(i,this._instance.config.custom_blocked_useragents):void 0}}var fk={},fl=()=>{},fm="posthog",fn=!dB&&-1===(null==o?void 0:o.indexOf("MSIE"))&&-1===(null==o?void 0:o.indexOf("Mozilla")),fo=()=>{var a;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:function(a){var b=null==a?void 0:a.hostname;if(!H(b))return!1;var c=b.split(".").slice(-2).join(".");for(var d of ab)if(c===d)return!1;return!0}(null==j?void 0:j.location),persistence:"localStorage+cookie",persistence_name:"",loaded:fl,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:k&&H(null==k?void 0:k.search)&&-1!==k.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==d||null==(a=d.location)?void 0:a.protocol),ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:a=>{var b="Bad HTTP status: "+a.statusCode+" "+a.text;P.error(b)},get_device_id:a=>a,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:3e3},_onCapture:fl}},fp=a=>{var b={};G(a.process_person)||(b.person_profiles=a.process_person),G(a.xhr_headers)||(b.request_headers=a.xhr_headers),G(a.cookie_name)||(b.persistence_name=a.cookie_name),G(a.disable_cookie)||(b.disable_persistence=a.disable_cookie),G(a.store_google)||(b.save_campaign_params=a.store_google),G(a.verbose)||(b.debug=a.verbose);var c=Y({},b,a);return C(a.property_blacklist)&&(G(a.property_denylist)?c.property_denylist=a.property_blacklist:C(a.property_denylist)?c.property_denylist=[...a.property_blacklist,...a.property_denylist]:P.error("Invalid value for property_denylist config: "+a.property_denylist)),c};class fq{constructor(){this.__forceAllowLocalhost=!1}get os(){return this.__forceAllowLocalhost}set os(a){P.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=a}}class fr{get decideEndpointWasHit(){var a,b;return null!=(a=null==(b=this.featureFlags)?void 0:b.hasLoadedFlags)&&a}constructor(){this.webPerformance=new fq,this.ls=!1,this.version=q.LIB_VERSION,this.us=new eU,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=fo(),this.SentryIntegration=dn,this.sentryIntegration=a=>{var b;return b=dm(this,a),{name:dl,processEvent:a=>b(a)}},this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.hs=!1,this.ds=null,this.vs=null,this.cs=null,this.featureFlags=new eR(this),this.toolbar=new dr(this),this.scrollManager=new e4(this),this.pageViewManager=new dz(this),this.surveys=new eY(this),this.experiments=new fj(this),this.exceptions=new dM(this),this.rateLimiter=new e$(this),this.requestRouter=new fh(this),this.consent=new bG(this),this.people={set:(a,b,c)=>{var d=H(a)?{[a]:b}:a;this.setPersonProperties(d),null==c||c({})},set_once:(a,b,c)=>{var d=H(a)?{[a]:b}:a;this.setPersonProperties(void 0,d),null==c||c({})}},this.on("eventCaptured",a=>P.info('send "'+(null==a?void 0:a.event)+'"',a))}init(a,b,c){if(c&&c!==fm){var d,e=null!=(d=fk[c])?d:new fr;return e._init(a,b,c),fk[c]=e,fk[fm][c]=e,e}return this._init(a,b,c)}_init(a,b,c){if(void 0===b&&(b={}),G(a)||I(a))return P.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return P.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this.fs=[],b.person_profiles&&(this.vs=b.person_profiles),this.set_config(Y({},fo(),fp(b),{name:c,token:a})),this.config.on_xhr_error&&P.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=b.disable_compression?void 0:t.GZipJS,this.persistence=new eT(this.config),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new eT(T({},this.config,{persistence:"sessionStorage"}));var e=T({},this.persistence.props),f=T({},this.sessionPersistence.props);if(this.ps=new e1(a=>this.gs(a),this.config.request_queue_config),this._s=new e3(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new e8(this),this.sessionPropsManager=new e6(this,this.sessionManager,this.persistence)),new dt(this).startIfEnabledOrStop(),this.siteApps=new fb(this),null==(g=this.siteApps)||g.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new dj(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new bk(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new dy(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new dv(this),this.exceptionObserver=new bM(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new bK(this,bJ),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new b8(this),this.historyAutocapture.startIfEnabled(),q.DEBUG=q.DEBUG||this.config.debug,q.DEBUG&&P.info("Starting in debug mode",{this:this,config:b,thisC:T({},this.config),p:e,s:f}),this.bs(),void 0!==(null==(h=b.bootstrap)?void 0:h.distinctID)){var g,h,i,j,k=this.config.get_device_id(bs()),l=null!=(i=b.bootstrap)&&i.isIdentifiedID?k:b.bootstrap.distinctID;this.persistence.set_property(aI,null!=(j=b.bootstrap)&&j.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:b.bootstrap.distinctID,$device_id:l})}if(this.ws()){var m,n,o=Object.keys((null==(m=b.bootstrap)?void 0:m.featureFlags)||{}).filter(a=>{var c;return!(null==(c=b.bootstrap)||null==(c=c.featureFlags)||!c[a])}).reduce((a,c)=>{var d;return a[c]=(null==(d=b.bootstrap)||null==(d=d.featureFlags)?void 0:d[c])||!1,a},{}),p=Object.keys((null==(n=b.bootstrap)?void 0:n.featureFlagPayloads)||{}).filter(a=>o[a]).reduce((a,c)=>{var d,e;return null!=(d=b.bootstrap)&&null!=(d=d.featureFlagPayloads)&&d[c]&&(a[c]=null==(e=b.bootstrap)||null==(e=e.featureFlagPayloads)?void 0:e[c]),a},{});this.featureFlags.receivedFeatureFlags({featureFlags:o,featureFlagPayloads:p})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:aQ,$device_id:null},"");else if(!this.get_distinct_id()){var r=this.config.get_device_id(bs());this.register_once({distinct_id:r,$device_id:r},""),this.persistence.set_property(aI,"anonymous")}return ad(d,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),b.segment?function(a,b){var c=a.config.segment;if(!c)return b();!function(a,b){var c=a.config.segment;if(!c)return b();var d=c=>{var d=()=>c.anonymousId()||bs();a.config.get_device_id=d,c.id()&&(a.register({distinct_id:c.id(),$device_id:d()}),a.persistence.set_property(aI,"identified")),b()},e=c.user();"then"in e&&D(e.then)?e.then(a=>d(a)):d(e)}(a,()=>{var d;c.register((Promise&&Promise.resolve||dk.warn("This browser does not have Promise support, and can not use the segment integration"),d=(b,c)=>{if(!c)return b;b.event.userId||b.event.anonymousId===a.get_distinct_id()||(dk.info("No userId set, resetting PostHog"),a.reset()),b.event.userId&&b.event.userId!==a.get_distinct_id()&&(dk.info("UserId set, identifying with PostHog"),a.identify(b.event.userId));var d=a.calculateEventProperties(c,b.event.properties);return b.event.properties=Object.assign({},d,b.event.properties),b},{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:a=>d(a,a.event.event),page:a=>d(a,"$pageview"),identify:a=>d(a,"$identify"),screen:a=>d(a,"$screen")})).then(()=>{b()})})}(this,()=>this.ys()):this.ys(),D(this.config._onCapture)&&this.config._onCapture!==fl&&(P.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",a=>this.config._onCapture(a.event,a))),this}be(a){var b,c,d,e,f,g,h,i;j&&j.body?(this.compression=void 0,a.supportedCompression&&!this.config.disable_compression&&(this.compression=v(a.supportedCompression,t.GZipJS)?t.GZipJS:v(a.supportedCompression,t.Base64)?t.Base64:void 0),null!=(b=a.analytics)&&b.endpoint&&(this.analyticsDefaultEndpoint=a.analytics.endpoint),this.set_config({person_profiles:this.vs?this.vs:"identified_only"}),null==(c=this.siteApps)||c.onRemoteConfig(a),null==(d=this.sessionRecording)||d.onRemoteConfig(a),null==(e=this.autocapture)||e.onRemoteConfig(a),null==(f=this.heatmaps)||f.onRemoteConfig(a),this.surveys.onRemoteConfig(a),null==(g=this.webVitalsAutocapture)||g.onRemoteConfig(a),null==(h=this.exceptionObserver)||h.onRemoteConfig(a),this.exceptions.onRemoteConfig(a),null==(i=this.deadClicksAutocapture)||i.onRemoteConfig(a)):(P.info("document not ready yet, trying again in 500 milliseconds..."),setTimeout(()=>{this.be(a)},500))}ys(){try{this.config.loaded(this)}catch(a){P.critical("`loaded` function failed",a)}this.Ss(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this.$s()},1),new e0(this).load(),this.featureFlags.decide()}Ss(){var a;this.has_opted_out_capturing()||this.config.request_batching&&(null==(a=this.ps)||a.enable())}_dom_loaded(){this.has_opted_out_capturing()||W(this.__request_queue,a=>this.gs(a)),this.__request_queue=[],this.Ss()}_handle_unload(){var a,b;this.config.request_batching?(this.ks()&&this.capture("$pageleave"),null==(a=this.ps)||a.unload(),null==(b=this._s)||b.unload()):this.ks()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}me(a){this.__loaded&&(fn?this.__request_queue.push(a):this.rateLimiter.isServerRateLimited(a.batchKey)||(a.transport=a.transport||this.config.api_transport,a.url=dD(a.url,{ip:+!!this.config.ip}),a.headers=T({},this.config.request_headers),a.compression="best-available"===a.compression?this.compression:a.compression,a.fetchOptions=a.fetchOptions||this.config.fetch_options,(a=>{var b,c,d,e=T({},a);e.timeout=e.timeout||6e4,e.url=dD(e.url,{_:(new Date).getTime().toString(),ver:q.LIB_VERSION,compression:e.compression});var f=null!=(b=e.transport)?b:"fetch",g=null!=(c=null==(d=ac(dG,a=>a.transport===f))?void 0:d.method)?c:dG[0].method;if(!g)throw Error("No available transport method");g(e)})(T({},a,{callback:b=>{var c,d;this.rateLimiter.checkForLimiting(b),b.statusCode>=400&&(null==(c=(d=this.config).on_request_error)||c.call(d,b)),null==a.callback||a.callback(b)}}))))}gs(a){this._s?this._s.retriableRequest(a):this.me(a)}_execute_array(a){var b,c=[],d=[],e=[];W(a,a=>{a&&(C(b=a[0])?e.push(a):D(a)?a.call(this):C(a)&&"alias"===b?c.push(a):C(a)&&-1!==b.indexOf("capture")&&D(this[b])?e.push(a):d.push(a))});var f=function(a,b){W(a,function(a){if(C(a[0])){var c=b;X(a,function(a){c=c[a[0]].apply(c,a.slice(1))})}else this[a[0]].apply(this,a.slice(1))},b)};f(c,this),f(d,this),f(e,this)}ws(){var a,b;return(null==(a=this.config.bootstrap)?void 0:a.featureFlags)&&Object.keys(null==(b=this.config.bootstrap)?void 0:b.featureFlags).length>0||!1}push(a){this._execute_array([a])}capture(a,b,c){var d;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.ps){if(!this.consent.isOptedOut())if(!G(a)&&H(a)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var e=null!=c&&c.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==e||!e.isRateLimited){null!=b&&b.$current_url&&!H(null==b?void 0:b.$current_url)&&(P.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),null==b||delete b.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var f,g,h,i,j=new Date,k=(null==c?void 0:c.timestamp)||j,l=bs(),m={uuid:l,event:a,properties:this.calculateEventProperties(a,b||{},k,l)};e&&(m.properties.$lib_rate_limit_remaining_tokens=e.remainingTokens),(null==c?void 0:c.$set)&&(m.$set=null==c?void 0:c.$set);var n=this.xs(null==c?void 0:c.$set_once);n&&(m.$set_once=n),(f=m,g=null!=c&&c._noTruncate?null:this.config.properties_string_max_length,h=a=>H(a)&&!J(g)?a.slice(0,g):a,i=new Set,m=function a(b,c){var d;return b!==Object(b)?h?h(b,c):b:i.has(b)?void 0:(i.add(b),C(b)?(d=[],W(b,b=>{d.push(a(b))})):(d={},X(b,(b,c)=>{i.has(b)||(d[c]=a(b,c))})),d)}(f)).timestamp=k,G(null==c?void 0:c.timestamp)||(m.properties.$event_time_override_provided=!0,m.properties.$event_time_override_system_time=j);var o=T({},m.properties.$set,m.$set);if(F(o)||this.setPersonPropertiesForFlags(o),!K(this.config.before_send)){var p=this.Es(m);if(!p)return;m=p}this.us.emit("eventCaptured",m);var q={method:"POST",url:null!=(d=null==c?void 0:c._url)?d:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:m,compression:"best-available",batchKey:null==c?void 0:c._batchKey};return!this.config.request_batching||c&&(null==c||!c._batchKey)||null!=c&&c.send_instantly?this.gs(q):this.ps.enqueue(q),m}P.critical("This capture call is ignored due to client rate limiting.")}}else P.error("No event name provided to posthog.capture")}else P.uninitializedWarning("posthog.capture")}Ne(a){return this.on("eventCaptured",b=>a(b.event,b))}calculateEventProperties(a,b,c,e,f){if(c=c||new Date,!this.persistence||!this.sessionPersistence)return b;var g,h=f?void 0:this.persistence.remove_event_timer(a),i=T({},b);if(i.token=this.config.token,this.config.__preview_experimental_cookieless_mode&&(i.$cookieless_mode=!0),"$snapshot"===a){var l=T({},this.persistence.properties(),this.sessionPersistence.properties());return i.distinct_id=l.distinct_id,(!H(i.distinct_id)&&!L(i.distinct_id)||I(i.distinct_id))&&P.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),i}var m,n=function(a,b){if(!o)return{};var c,e,f=a?Z([],ey,b||[]):[],[g,h]=function(a){for(var b=0;b<ev.length;b++){var[c,d]=ev[b],e=c.exec(a),f=e&&(D(d)?d(e,a):d);if(f)return f}return["",""]}(o);return Y(aa({$os:g,$os_version:h,$browser:es(o,navigator.vendor),$device:ew(o),$device_type:(e=ew(o))===dR||e===dQ||"Kobo"===e||"Kindle Fire"===e||e===ej?dP:e===d8||e===ea||e===d9||e===eg?"Console":e===dT?"Wearable":e?dN:"Desktop",$timezone:eI(),$timezone_offset:function(){try{return(new Date).getTimezoneOffset()}catch(a){return}}()}),{$current_url:bg(null==k?void 0:k.href,f,eA),$host:null==k?void 0:k.host,$pathname:null==k?void 0:k.pathname,$raw_user_agent:o.length>1e3?o.substring(0,997)+"...":o,$browser_version:eu(o,navigator.vendor),$browser_language:eE(),$browser_language_prefix:"string"==typeof(c=eE())?c.split("-")[0]:void 0,$screen_height:null==d?void 0:d.screen.height,$screen_width:null==d?void 0:d.screen.width,$viewport_height:null==d?void 0:d.innerHeight,$viewport_width:null==d?void 0:d.innerWidth,$lib:"web",$lib_version:q.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:p,windowId:r}=this.sessionManager.checkAndGetSessionAndWindowId(f,c.getTime());i.$session_id=p,i.$window_id=r}this.sessionPropsManager&&Y(i,this.sessionPropsManager.getSessionProps());try{this.sessionRecording&&Y(i,this.sessionRecording.sdkDebugProperties),i.$sdk_debug_retry_queue_size=null==(g=this._s)?void 0:g.length}catch(a){i.$sdk_debug_error_capturing_properties=String(a)}if(this.requestRouter.region===ff.CUSTOM&&(i.$lib_custom_api_host=this.config.api_host),m="$pageview"!==a||f?"$pageleave"!==a||f?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(c):this.pageViewManager.doPageView(c,e),i=Y(i,m),"$pageview"===a&&j&&(i.title=j.title),!G(h)){var s=c.getTime()-h;i.$duration=parseFloat((s/1e3).toFixed(3))}o&&this.config.opt_out_useragent_filter&&(i.$browser_type=this._is_bot()?"bot":"browser"),(i=Y({},n,this.persistence.properties(),this.sessionPersistence.properties(),i)).$is_identified=this._isIdentified(),C(this.config.property_denylist)?X(this.config.property_denylist,function(a){delete i[a]}):P.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var t=this.config.sanitize_properties;t&&(P.error("sanitize_properties is deprecated. Use before_send instead"),i=t(i,a));var u=this.Is();return i.$process_person_profile=u,u&&!f&&this.Ps("_calculate_event_properties"),i}xs(a){if(!this.persistence||!this.Is()||this.ls)return a;var b,c=Y({},this.persistence.get_initial_props(),(null==(b=this.sessionPropsManager)?void 0:b.getSetOnceProps())||{},a||{}),d=this.config.sanitize_properties;return d&&(P.error("sanitize_properties is deprecated. Use before_send instead"),c=d(c,"$set_once")),this.ls=!0,F(c)?void 0:c}register(a,b){var c;null==(c=this.persistence)||c.register(a,b)}register_once(a,b,c){var d;null==(d=this.persistence)||d.register_once(a,b,c)}register_for_session(a){var b;null==(b=this.sessionPersistence)||b.register(a)}unregister(a){var b;null==(b=this.persistence)||b.unregister(a)}unregister_for_session(a){var b;null==(b=this.sessionPersistence)||b.unregister(a)}Rs(a,b){this.register({[a]:b})}getFeatureFlag(a,b){return this.featureFlags.getFeatureFlag(a,b)}getFeatureFlagPayload(a){var b=this.featureFlags.getFeatureFlagPayload(a);try{return JSON.parse(b)}catch(a){return b}}isFeatureEnabled(a,b){return this.featureFlags.isFeatureEnabled(a,b)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(a,b){this.featureFlags.updateEarlyAccessFeatureEnrollment(a,b)}getEarlyAccessFeatures(a,b,c){return void 0===b&&(b=!1),this.featureFlags.getEarlyAccessFeatures(a,b,c)}on(a,b){return this.us.on(a,b)}onFeatureFlags(a){return this.featureFlags.onFeatureFlags(a)}onSurveysLoaded(a){return this.surveys.onSurveysLoaded(a)}onSessionId(a){var b,c;return null!=(b=null==(c=this.sessionManager)?void 0:c.onSessionId(a))?b:()=>{}}getSurveys(a,b){void 0===b&&(b=!1),this.surveys.getSurveys(a,b)}getActiveMatchingSurveys(a,b){void 0===b&&(b=!1),this.surveys.getActiveMatchingSurveys(a,b)}renderSurvey(a,b){this.surveys.renderSurvey(a,b)}canRenderSurvey(a){return this.surveys.canRenderSurvey(a)}canRenderSurveyAsync(a,b){return void 0===b&&(b=!1),this.surveys.canRenderSurveyAsync(a,b)}identify(a,b,c){if(!this.__loaded||!this.persistence)return P.uninitializedWarning("posthog.identify");if(L(a)&&(a=a.toString(),P.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),a){if(["distinct_id","distinctid"].includes(a.toLowerCase()))P.critical('The string "'+a+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(this.Ps("posthog.identify")){var d=this.get_distinct_id();this.register({$user_id:a}),this.get_property("$device_id")||this.register_once({$had_persisted_distinct_id:!0,$device_id:d},""),a!==d&&a!==this.get_property(af)&&(this.unregister(af),this.register({distinct_id:a}));var e="anonymous"===(this.persistence.get_property(aI)||"anonymous");a!==d&&e?(this.persistence.set_property(aI,"identified"),this.setPersonPropertiesForFlags(T({},c||{},b||{}),!1),this.capture("$identify",{distinct_id:a,$anon_distinct_id:d},{$set:b||{},$set_once:c||{}}),this.cs=dI(a,b,c),this.featureFlags.setAnonymousDistinctId(d)):(b||c)&&this.setPersonProperties(b,c),a!==d&&(this.reloadFeatureFlags(),this.unregister(aH))}}else P.error("Unique user id has not been set in posthog.identify")}setPersonProperties(a,b){if((a||b)&&this.Ps("posthog.setPersonProperties")){var c=dI(this.get_distinct_id(),a,b);this.cs!==c?(this.setPersonPropertiesForFlags(T({},b||{},a||{})),this.capture("$set",{$set:a||{},$set_once:b||{}}),this.cs=c):P.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(a,b,c){if(a&&b){if(this.Ps("posthog.group")){var d=this.getGroups();d[a]!==b&&this.resetGroupPropertiesForFlags(a),this.register({$groups:T({},d,{[a]:b})}),c&&(this.capture("$groupidentify",{$group_type:a,$group_key:b,$group_set:c}),this.setGroupPropertiesForFlags({[a]:c})),d[a]===b||c||this.reloadFeatureFlags()}}else P.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(a,b){void 0===b&&(b=!0),this.featureFlags.setPersonPropertiesForFlags(a,b)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(a,b){void 0===b&&(b=!0),this.Ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(a,b)}resetGroupPropertiesForFlags(a){this.featureFlags.resetGroupPropertiesForFlags(a)}reset(a){if(P.info("reset"),!this.__loaded)return P.uninitializedWarning("posthog.reset");var b,c,d,e,f=this.get_property("$device_id");if(this.consent.reset(),null==(b=this.persistence)||b.clear(),null==(c=this.sessionPersistence)||c.clear(),this.surveys.reset(),null==(d=this.persistence)||d.set_property(aI,"anonymous"),null==(e=this.sessionManager)||e.resetSessionId(),this.cs=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:aQ,$device_id:null},"");else{var g=this.config.get_device_id(bs());this.register_once({distinct_id:g,$device_id:a?g:f},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var a,b;return null!=(a=null==(b=this.sessionManager)?void 0:b.checkAndGetSessionAndWindowId(!0).sessionId)?a:""}get_session_replay_url(a){if(!this.sessionManager)return"";var{sessionId:b,sessionStartTimestamp:c}=this.sessionManager.checkAndGetSessionAndWindowId(!0),d=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+b);if(null!=a&&a.withTimestamp&&c){var e,f=null!=(e=a.timestampLookBack)?e:10;if(!c)return d;d+="?t="+Math.max(Math.floor(((new Date).getTime()-c)/1e3)-f,0)}return d}alias(a,b){return a===this.get_property(ae)?(P.critical("Attempting to create alias for existing People user - aborting."),-2):this.Ps("posthog.alias")?(G(b)&&(b=this.get_distinct_id()),a!==b?(this.Rs(af,a),this.capture("$create_alias",{alias:a,distinct_id:b})):(P.warn("alias matches current distinct_id - skipping api call."),this.identify(a),-1)):void 0}set_config(a){var b,c,d,e,f=T({},this.config);E(a)&&(Y(this.config,fp(a)),null==(b=this.persistence)||b.update_config(this.config,f),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new eT(T({},this.config,{persistence:"sessionStorage"})),by.O()&&"true"===by.A("ph_debug")&&(this.config.debug=!0),this.config.debug&&(q.DEBUG=!0,P.info("set_config",JSON.stringify({config:a,oldConfig:f,newConfig:T({},this.config)},null,2))),null==(c=this.sessionRecording)||c.startIfEnabledOrStop(),null==(d=this.autocapture)||d.startIfEnabled(),null==(e=this.heatmaps)||e.startIfEnabled(),this.surveys.loadIfEnabled(),this.bs())}startSessionRecording(a){var b,c,d,e,f,g=!0===a,h={sampling:g||!(null==a||!a.sampling),linked_flag:g||!(null==a||!a.linked_flag),url_trigger:g||!(null==a||!a.url_trigger),event_trigger:g||!(null==a||!a.event_trigger)};Object.values(h).some(Boolean)&&(null==(b=this.sessionManager)||b.checkAndGetSessionAndWindowId(),h.sampling&&(null==(c=this.sessionRecording)||c.overrideSampling()),h.linked_flag&&(null==(d=this.sessionRecording)||d.overrideLinkedFlag()),h.url_trigger&&(null==(e=this.sessionRecording)||e.overrideTrigger("url")),h.event_trigger&&(null==(f=this.sessionRecording)||f.overrideTrigger("event"))),this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var a;return!(null==(a=this.sessionRecording)||!a.started)}captureException(a,b){var c=Error("PostHog syntheticException");this.exceptions.sendExceptionEvent(T({},function(a,b){var{error:c,event:d}=a,e={$exception_list:[]},f=c||d;if(bR(f)||bQ(f,"DOMException")){if("stack"in f)e=b6(f,b);else{var g=f.name||(bR(f)?"DOMError":"DOMException"),h=f.message?g+": "+f.message:g;e=b7(h,T({},b,{overrideExceptionType:bR(f)?"DOMError":"DOMException",defaultExceptionMessage:h}))}return"code"in f&&(e.$exception_DOMException_code=""+f.code),e}if(bQ(f,"ErrorEvent")&&f.error)return b6(f.error,b);if(bP(f))return b6(f,b);if(bQ(f,"Object")||bN(f))return function(a,b){var c,d,e,f=null==(d=null==b?void 0:b.handled)||d,g=null==(e=null==b?void 0:b.synthetic)||e,h={type:null!=b&&b.overrideExceptionType?b.overrideExceptionType:bN(a)?a.constructor.name:"Error",value:"Non-Error 'exception' captured with keys: "+function(a,b){void 0===b&&(b=40);var c=Object.keys(a);if(c.sort(),!c.length)return"[object has no keys]";for(var d=c.length;d>0;d--){var e=c.slice(0,d).join(", ");if(!(e.length>b))return d===c.length||e.length<=b?e:e.slice(0,b)+"..."}return""}(a),mechanism:{handled:f,synthetic:g}};if(null!=b&&b.syntheticException){var i=b4(null==b?void 0:b.syntheticException,1);i.length&&(h.stacktrace={frames:i,type:"raw"})}return{$exception_list:[h],$exception_level:H(c=a.level)&&!I(c)&&u.indexOf(c)>=0?a.level:"error"}}(f,b);if(G(c)&&H(d)){var i="Error",j=d,k=d.match(b3);return k&&(i=k[1],j=k[2]),b7(j,T({},b,{overrideExceptionType:i,defaultExceptionMessage:j}))}return b7(f,b)}(a instanceof Error?{error:a,event:a.message}:{event:a},{syntheticException:c}),b))}loadToolbar(a){return this.toolbar.loadToolbar(a)}get_property(a){var b;return null==(b=this.persistence)?void 0:b.props[a]}getSessionProperty(a){var b;return null==(b=this.sessionPersistence)?void 0:b.props[a]}toString(){var a,b=null!=(a=this.config.name)?a:fm;return b!==fm&&(b=fm+"."+b),b}_isIdentified(){var a,b;return"identified"===(null==(a=this.persistence)?void 0:a.get_property(aI))||"identified"===(null==(b=this.sessionPersistence)?void 0:b.get_property(aI))}Is(){var a,b;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&F(this.getGroups())&&(null==(a=this.persistence)||null==(a=a.props)||!a[af])&&(null==(b=this.persistence)||null==(b=b.props)||!b[aO]))}ks(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&(!0===this.config.capture_pageview||"history_change"===this.config.capture_pageview)}createPersonProfile(){this.Is()||this.Ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Ps(a){return"never"===this.config.person_profiles?(P.error(a+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.Rs(aO,!0),!0)}bs(){var a,b,c,d,e=this.consent.isOptedOut(),f=this.config.opt_out_persistence_by_default,g=this.config.disable_persistence||e&&!!f;(null==(a=this.persistence)?void 0:a.xe)!==g&&(null==(c=this.persistence)||c.set_disabled(g)),(null==(b=this.sessionPersistence)?void 0:b.xe)!==g&&(null==(d=this.sessionPersistence)||d.set_disabled(g))}opt_in_capturing(a){var b;this.consent.optInOut(!0),this.bs(),(G(null==a?void 0:a.captureEventName)||null!=a&&a.captureEventName)&&this.capture(null!=(b=null==a?void 0:a.captureEventName)?b:"$opt_in",null==a?void 0:a.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.$s()}opt_out_capturing(){this.consent.optInOut(!1),this.bs()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this.bs()}_is_bot(){return i?fe(i,this.config.custom_blocked_useragents):void 0}$s(){j&&("visible"===j.visibilityState?this.hs||(this.hs=!0,this.capture("$pageview",{title:j.title},{send_instantly:!0}),this.ds&&(j.removeEventListener("visibilitychange",this.ds),this.ds=null)):this.ds||(this.ds=this.$s.bind(this),ad(j,"visibilitychange",this.ds)))}debug(a){!1===a?(null==d||d.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(null==d||d.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}Es(a){if(K(this.config.before_send))return a;var b=C(this.config.before_send)?this.config.before_send:[this.config.before_send],c=a;for(var d of b){if(K(c=d(c))){var e="Event '"+a.event+"' was rejected in beforeSend function";return N(a.event)?P.warn(e+". This can cause unexpected behavior."):P.info(e),null}c.properties&&!F(c.properties)||P.warn("Event '"+a.event+"' has no properties after beforeSend function, this is likely an error.")}return c}getPageViewId(){var a;return null==(a=this.pageViewManager.ne)?void 0:a.pageViewId}captureTraceFeedback(a,b){this.capture("$ai_feedback",{$ai_trace_id:String(a),$ai_feedback_text:b})}captureTraceMetric(a,b,c){this.capture("$ai_metric",{$ai_trace_id:String(a),$ai_metric_name:b,$ai_metric_value:String(c)})}}for(var fs=["identify"],ft=0;ft<fs.length;ft++)fr.prototype[fs[ft]]=_(fr.prototype[fs[ft]]);(fx={}).Button="button",fx.Tab="tab",fx.Selector="selector",(fy={}).TopLeft="top_left",fy.TopRight="top_right",fy.TopCenter="top_center",fy.MiddleLeft="middle_left",fy.MiddleRight="middle_right",fy.MiddleCenter="middle_center",fy.Left="left",fy.Center="center",fy.Right="right",fy.NextToTrigger="next_to_trigger",(fz={}).Popover="popover",fz.API="api",fz.Widget="widget",(fA={}).Open="open",fA.MultipleChoice="multiple_choice",fA.SingleChoice="single_choice",fA.Rating="rating",fA.Link="link",(fB={}).NextQuestion="next_question",fB.End="end",fB.ResponseBased="response_based",fB.SpecificQuestion="specific_question",(fC={}).Once="once",fC.Recurring="recurring",fC.Always="always";var fu,fv,fw,fx,fy,fz,fA,fB,fC,fD,fE=(fD=fk[fm]=new fr,function(){function a(){a.done||(a.done=!0,fn=!1,X(fk,function(a){a._dom_loaded()}))}null!=j&&j.addEventListener?"complete"===j.readyState?a():ad(j,"DOMContentLoaded",a,{capture:!1}):d&&P.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),fD);a.s(["default",()=>fE])}];

//# sourceMappingURL=392f8_posthog-js_dist_module_3cd919f9.js.map