module.exports=[248185,(a,b,c)=>{var d={154:(a,b,c)=>{var d=c(781),e=["write","end","destroy"],f=["resume","pause"],g=["data","close"],h=Array.prototype.slice;function i(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c++)b(a[c],c)}a.exports=function(a,b){var c=new d,j=!1;return i(e,function(b){c[b]=function(){return a[b].apply(a,arguments)}}),i(f,function(a){c[a]=function(){c.emit(a);var d=b[a];if(d)return d.apply(b,arguments);b.emit(a)}}),i(g,function(a){b.on(a,function(){var b=h.call(arguments);b.unshift(a),c.emit.apply(c,b)})}),b.on("end",function(){if(!j){j=!0;var a=h.call(arguments);a.unshift("end"),c.emit.apply(c,a)}}),a.on("drain",function(){c.emit("drain")}),a.on("error",k),b.on("error",k),c.writable=a.writable,c.readable=b.readable,c;function k(a){c.emit("error",a)}}},349:(a,b,c)=>{"use strict";let d=c(147),e=c(781),f=c(796),g=c(154),h=c(530),i=a=>Object.assign({level:9},a);a.exports=(a,b)=>a?h(f.gzip)(a,i(b)).then(a=>a.length).catch(a=>0):Promise.resolve(0),a.exports.sync=(a,b)=>f.gzipSync(a,i(b)).length,a.exports.stream=a=>{let b=new e.PassThrough,c=new e.PassThrough,d=g(b,c),h=0,j=f.createGzip(i(a)).on("data",a=>{h+=a.length}).on("error",()=>{d.gzipSize=0}).on("end",()=>{d.gzipSize=h,d.emit("gzip-size",h),c.end()});return b.pipe(j),b.pipe(c,{end:!1}),d},a.exports.file=(b,c)=>new Promise((e,f)=>{let g=d.createReadStream(b);g.on("error",f);let h=g.pipe(a.exports.stream(c));h.on("error",f),h.on("gzip-size",e)}),a.exports.fileSync=(b,c)=>a.exports.sync(d.readFileSync(b),c)},530:a=>{"use strict";let b=(a,b)=>function(...c){return new b.promiseModule((d,e)=>{b.multiArgs?c.push((...a)=>{b.errorFirst?a[0]?e(a):(a.shift(),d(a)):d(a)}):b.errorFirst?c.push((a,b)=>{a?e(a):d(b)}):c.push(d),a.apply(this,c)})};a.exports=(a,c)=>{let d;c=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},c);let e=typeof a;if(null===a||"object"!==e&&"function"!==e)throw TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${null===a?"null":e}\``);let f=a=>{let b=b=>"string"==typeof b?a===b:b.test(a);return c.include?c.include.some(b):!c.exclude.some(b)};for(let g in d="function"===e?function(...d){return c.excludeMain?a(...d):b(a,c).apply(this,d)}:Object.create(Object.getPrototypeOf(a)),a){let e=a[g];d[g]="function"==typeof e&&f(g)?b(e,c):e}return d}},147:b=>{"use strict";b.exports=a.r(522734)},781:b=>{"use strict";b.exports=a.r(688947)},796:b=>{"use strict";b.exports=a.r(406461)}},e={};function f(a){var b=e[a];if(void 0!==b)return b.exports;var c=e[a]={exports:{}},g=!0;try{d[a](c,c.exports,f),g=!1}finally{g&&delete e[a]}return c.exports}f.ab="/ROOT/node_modules/.pnpm/next@16.0.10_@babel+core@7.28.0_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/compiled/gzip-size/",b.exports=f(349)},793583,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BloomFilter",{enumerable:!0,get:function(){return d}});class d{constructor(a,b=1e-4){this.numItems=a,this.errorRate=b,this.numBits=Math.ceil(-(a*Math.log(b))/(Math.log(2)*Math.log(2))),this.numHashes=Math.ceil(this.numBits/a*Math.log(2)),this.bitArray=Array(this.numBits).fill(0)}static from(a,b=1e-4){let c=new d(a.length,b);for(let b of a)c.add(b);return c}export(){let b={numItems:this.numItems,errorRate:this.errorRate,numBits:this.numBits,numHashes:this.numHashes,bitArray:this.bitArray};if(this.errorRate<1e-4){let c=JSON.stringify(b),d=a.r(248185).sync(c);d>1024&&console.warn(`Creating filter with error rate less than 0.1% (0.001) can increase the size dramatically proceed with caution. Received error rate ${this.errorRate} resulted in size ${c.length} bytes, ${d} bytes (gzip)`)}return b}import(a){this.numItems=a.numItems,this.errorRate=a.errorRate,this.numBits=a.numBits,this.numHashes=a.numHashes,this.bitArray=a.bitArray}add(a){this.getHashValues(a).forEach(a=>{this.bitArray[a]=1})}contains(a){return this.getHashValues(a).every(a=>this.bitArray[a])}getHashValues(a){let b=[];for(let c=1;c<=this.numHashes;c++){let d=function(a){let b=0;for(let c=0;c<a.length;c++)b=Math.imul(b^a.charCodeAt(c),0x5bd1e995),b^=b>>>13,b=Math.imul(b,0x5bd1e995);return b>>>0}(`${a}${c}`)%this.numBits;b.push(d)}return b}}},263606,(a,b,c)=>{"use strict";function d(a){return a.replace(/\/$/,"")||"/"}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removeTrailingSlash",{enumerable:!0,get:function(){return d}})},819128,(a,b,c)=>{"use strict";function d(a,b=""){return("/"===a?"/index":/^\/index(\/|$)/.test(a)?`/index${a}`:a)+b}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return d}})},598847,(a,b,c)=>{"use strict";let d;function e(a){return d?.createScriptURL(a)||a}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"__unsafeCreateTrustedScriptURL",{enumerable:!0,get:function(){return e}}),("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},689416,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={cancelIdleCallback:function(){return g},requestIdleCallback:function(){return f}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(a){let b=Date.now();return self.setTimeout(function(){a({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-b))}})},1)},g="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(a){return clearTimeout(a)};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},161276,(a,b,c)=>{"use strict";function d(){return""}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getDeploymentIdQueryOrEmptyString",{enumerable:!0,get:function(){return d}})},305369,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={createRouteLoader:function(){return s},getClientBuildManifest:function(){return q},isAssetError:function(){return m},markAssetError:function(){return l}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});a.r(5218),a.r(819128);let f=a.r(598847),g=a.r(689416),h=a.r(161276),i=a.r(797371);function j(a,b,c){let d,e=b.get(a);if(e)return"future"in e?e.future:Promise.resolve(e);let f=new Promise(a=>{d=a});return b.set(a,{resolve:d,future:f}),c?c().then(a=>(d(a),a)).catch(c=>{throw b.delete(a),c}):f}let k=Symbol("ASSET_LOAD_ERROR");function l(a){return Object.defineProperty(a,k,{})}function m(a){return a&&k in a}let n=function(a){try{return a=document.createElement("link"),!!window.MSInputMethodContext&&!!document.documentMode||a.relList.supports("prefetch")}catch{return!1}}(),o=()=>(0,h.getDeploymentIdQueryOrEmptyString)();function p(a,b,c){return new Promise((d,e)=>{let f=!1;a.then(a=>{f=!0,d(a)}).catch(e),(0,g.requestIdleCallback)(()=>setTimeout(()=>{f||e(c)},b))})}function q(){return self.__BUILD_MANIFEST?Promise.resolve(self.__BUILD_MANIFEST):p(new Promise(a=>{let b=self.__BUILD_MANIFEST_CB;self.__BUILD_MANIFEST_CB=()=>{a(self.__BUILD_MANIFEST),b&&b()}}),3800,l(Object.defineProperty(Error("Failed to load client build manifest"),"__NEXT_ERROR_CODE",{value:"E273",enumerable:!1,configurable:!0})))}function r(a,b){return q().then(c=>{if(!(b in c))throw l(Object.defineProperty(Error(`Failed to lookup route: ${b}`),"__NEXT_ERROR_CODE",{value:"E446",enumerable:!1,configurable:!0}));let d=c[b].map(b=>a+"/_next/"+(0,i.encodeURIPath)(b));return{scripts:d.filter(a=>a.endsWith(".js")).map(a=>(0,f.__unsafeCreateTrustedScriptURL)(a)+o()),css:d.filter(a=>a.endsWith(".css")).map(a=>a+o())}})}function s(a){let b=new Map,c=new Map,d=new Map,e=new Map;function f(a){{var b;let d=c.get(a.toString());return d?d:document.querySelector(`script[src^="${a}"]`)?Promise.resolve():(c.set(a.toString(),d=new Promise((c,d)=>{(b=document.createElement("script")).onload=c,b.onerror=()=>d(l(Object.defineProperty(Error(`Failed to load script: ${a}`),"__NEXT_ERROR_CODE",{value:"E74",enumerable:!1,configurable:!0}))),b.crossOrigin=void 0,b.src=a,document.body.appendChild(b)})),d)}}function h(a){let b=d.get(a);return b||d.set(a,b=fetch(a,{credentials:"same-origin"}).then(b=>{if(!b.ok)throw Object.defineProperty(Error(`Failed to load stylesheet: ${a}`),"__NEXT_ERROR_CODE",{value:"E189",enumerable:!1,configurable:!0});return b.text().then(b=>({href:a,content:b}))}).catch(a=>{throw l(a)})),b}return{whenEntrypoint:a=>j(a,b),onEntrypoint(a,c){(c?Promise.resolve().then(()=>c()).then(a=>({component:a&&a.default||a,exports:a}),a=>({error:a})):Promise.resolve(void 0)).then(c=>{let d=b.get(a);d&&"resolve"in d?c&&(b.set(a,c),d.resolve(c)):(c?b.set(a,c):b.delete(a),e.delete(a))})},loadRoute(c,d){return j(c,e,()=>{let e;return p(r(a,c).then(({scripts:a,css:d})=>Promise.all([b.has(c)?[]:Promise.all(a.map(f)),Promise.all(d.map(h))])).then(a=>this.whenEntrypoint(c).then(b=>({entrypoint:b,styles:a[1]}))),3800,l(Object.defineProperty(Error(`Route did not complete loading: ${c}`),"__NEXT_ERROR_CODE",{value:"E12",enumerable:!1,configurable:!0}))).then(({entrypoint:a,styles:b})=>{let c=Object.assign({styles:b},a);return"error"in a?a:c}).catch(a=>{if(d)throw a;return{error:a}}).finally(()=>e?.())})},prefetch(b){let c;return(c=navigator.connection)&&(c.saveData||/2g/.test(c.effectiveType))?Promise.resolve():r(a,b).then(a=>Promise.all(n?a.scripts.map(a=>{var b,c,d;return b=a.toString(),c="script",new Promise((a,e)=>{let f=`
      link[rel="prefetch"][href^="${b}"],
      link[rel="preload"][href^="${b}"],
      script[src^="${b}"]`;if(document.querySelector(f))return a();d=document.createElement("link"),c&&(d.as=c),d.rel="prefetch",d.crossOrigin=void 0,d.onload=a,d.onerror=()=>e(l(Object.defineProperty(Error(`Failed to prefetch: ${b}`),"__NEXT_ERROR_CODE",{value:"E268",enumerable:!1,configurable:!0}))),d.href=b,document.head.appendChild(d)})}):[])).then(()=>{(0,g.requestIdleCallback)(()=>this.loadRoute(b,!0).catch(()=>{}))}).catch(()=>{})}}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},456195,(a,b,c)=>{b.exports=a.x("react-dom",()=>require("react-dom"))},711544,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"setAttributesFromProps",{enumerable:!0,get:function(){return g}});let d={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"},e=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"];function f(a){return["async","defer","noModule"].includes(a)}function g(a,b){for(let[c,g]of Object.entries(b)){if(!b.hasOwnProperty(c)||e.includes(c)||void 0===g)continue;let h=d[c]||c.toLowerCase();"SCRIPT"===a.tagName&&f(h)?a[h]=!!g:a.setAttribute(h,String(g)),(!1===g||"SCRIPT"===a.tagName&&f(h)&&(!g||"false"===g))&&(a.setAttribute(h,""),a.removeAttribute(h))}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},223054,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={default:function(){return t},handleClientScriptLoad:function(){return q},initScriptLoader:function(){return r}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(5218),g=a.r(522298),h=a.r(508171),i=f._(a.r(456195)),j=g._(a.r(127669)),k=a.r(577087),l=a.r(711544),m=a.r(689416),n=new Map,o=new Set,p=a=>{let{src:b,id:c,onLoad:d=()=>{},onReady:e=null,dangerouslySetInnerHTML:f,children:g="",strategy:h="afterInteractive",onError:j,stylesheets:k}=a,m=c||b;if(m&&o.has(m))return;if(n.has(b)){o.add(m),n.get(b).then(d,j);return}let p=()=>{e&&e(),o.add(m)},q=document.createElement("script"),r=new Promise((a,b)=>{q.addEventListener("load",function(b){a(),d&&d.call(this,b),p()}),q.addEventListener("error",function(a){b(a)})}).catch(function(a){j&&j(a)});f?(q.innerHTML=f.__html||"",p()):g?(q.textContent="string"==typeof g?g:Array.isArray(g)?g.join(""):"",p()):b&&(q.src=b,n.set(b,r)),(0,l.setAttributesFromProps)(q,a),"worker"===h&&q.setAttribute("type","text/partytown"),q.setAttribute("data-nscript",h),k&&(a=>{if(i.default.preinit)return a.forEach(a=>{i.default.preinit(a,{as:"style"})})})(k),document.body.appendChild(q)};function q(a){let{strategy:b="afterInteractive"}=a;"lazyOnload"===b?window.addEventListener("load",()=>{(0,m.requestIdleCallback)(()=>p(a))}):p(a)}function r(a){a.forEach(q),[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(a=>{let b=a.id||a.getAttribute("src");o.add(b)})}function s(a){let{id:b,src:c="",onLoad:d=()=>{},onReady:e=null,strategy:f="afterInteractive",onError:g,stylesheets:l,...n}=a,{updateScripts:q,scripts:r,getIsSsr:s,appDir:t,nonce:u}=(0,j.useContext)(k.HeadManagerContext);u=n.nonce||u;let v=(0,j.useRef)(!1);(0,j.useEffect)(()=>{let a=b||c;v.current||(e&&a&&o.has(a)&&e(),v.current=!0)},[e,b,c]);let w=(0,j.useRef)(!1);if((0,j.useEffect)(()=>{if(!w.current){if("afterInteractive"===f)p(a);else"lazyOnload"===f&&("complete"===document.readyState?(0,m.requestIdleCallback)(()=>p(a)):window.addEventListener("load",()=>{(0,m.requestIdleCallback)(()=>p(a))}));w.current=!0}},[a,f]),("beforeInteractive"===f||"worker"===f)&&(q?(r[f]=(r[f]||[]).concat([{id:b,src:c,onLoad:d,onReady:e,onError:g,...n,nonce:u}]),q(r)):s&&s()?o.add(b||c):s&&!s()&&p({...a,nonce:u})),t){if(l&&l.forEach(a=>{i.default.preinit(a,{as:"style"})}),"beforeInteractive"===f)if(!c)return n.dangerouslySetInnerHTML&&(n.children=n.dangerouslySetInnerHTML.__html,delete n.dangerouslySetInnerHTML),(0,h.jsx)("script",{nonce:u,dangerouslySetInnerHTML:{__html:`(self.__next_s=self.__next_s||[]).push(${JSON.stringify([0,{...n,id:b}])})`}});else return i.default.preload(c,n.integrity?{as:"script",integrity:n.integrity,nonce:u,crossOrigin:n.crossOrigin}:{as:"script",nonce:u,crossOrigin:n.crossOrigin}),(0,h.jsx)("script",{nonce:u,dangerouslySetInnerHTML:{__html:`(self.__next_s=self.__next_s||[]).push(${JSON.stringify([c,{...n,id:b}])})`}});"afterInteractive"===f&&c&&i.default.preload(c,n.integrity?{as:"script",integrity:n.integrity,nonce:u,crossOrigin:n.crossOrigin}:{as:"script",nonce:u,crossOrigin:n.crossOrigin})}return null}Object.defineProperty(s,"__nextScript",{value:!0});let t=s;("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},645181,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"normalizeLocalePath",{enumerable:!0,get:function(){return e}});let d=new WeakMap;function e(a,b){let c;if(!b)return{pathname:a};let e=d.get(b);e||(e=b.map(a=>a.toLowerCase()),d.set(b,e));let f=a.split("/",2);if(!f[1])return{pathname:a};let g=f[1].toLowerCase(),h=e.indexOf(g);return h<0?{pathname:a}:(c=b[h],{pathname:a=a.slice(c.length+1)||"/",detectedLocale:c})}},375248,(a,b,c)=>{"use strict";function d(){let a=Object.create(null);return{on(b,c){(a[b]||(a[b]=[])).push(c)},off(b,c){a[b]&&a[b].splice(a[b].indexOf(c)>>>0,1)},emit(b,...c){(a[b]||[]).slice().map(a=>{a(...c)})}}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return d}})},226903,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={assign:function(){return i},searchParamsToUrlQuery:function(){return f},urlQueryToSearchParams:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){let b={};for(let[c,d]of a.entries()){let a=b[c];void 0===a?b[c]=d:Array.isArray(a)?a.push(d):b[c]=[a,d]}return b}function g(a){return"string"==typeof a?a:("number"!=typeof a||isNaN(a))&&"boolean"!=typeof a?"":String(a)}function h(a){let b=new URLSearchParams;for(let[c,d]of Object.entries(a))if(Array.isArray(d))for(let a of d)b.append(c,g(a));else b.set(c,g(d));return b}function i(a,...b){for(let c of b){for(let b of c.keys())a.delete(b);for(let[b,d]of c.entries())a.append(b,d)}return a}},974309,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"parseRelativeUrl",{enumerable:!0,get:function(){return e}}),a.r(870096);let d=a.r(226903);function e(a,b,c=!0){let f=new URL("http://n"),g=b?new URL(b,f):a.startsWith(".")?new URL("http://n"):f,{pathname:h,searchParams:i,search:j,hash:k,href:l,origin:m}=new URL(a,g);if(m!==f.origin)throw Object.defineProperty(Error(`invariant: invalid relative URL, router received ${a}`),"__NEXT_ERROR_CODE",{value:"E159",enumerable:!1,configurable:!0});return{pathname:h,query:c?(0,d.searchParamsToUrlQuery)(i):void 0,search:j,hash:k,href:l.slice(m.length),slashes:void 0}}},424819,(a,b,c)=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab="/ROOT/node_modules/.pnpm/next@16.0.10_@babel+core@7.28.0_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/compiled/path-to-regexp/");var a={};(()=>{function b(a,b){void 0===b&&(b={});for(var c=function(a){for(var b=[],c=0;c<a.length;){var d=a[c];if("*"===d||"+"===d||"?"===d){b.push({type:"MODIFIER",index:c,value:a[c++]});continue}if("\\"===d){b.push({type:"ESCAPED_CHAR",index:c++,value:a[c++]});continue}if("{"===d){b.push({type:"OPEN",index:c,value:a[c++]});continue}if("}"===d){b.push({type:"CLOSE",index:c,value:a[c++]});continue}if(":"===d){for(var e="",f=c+1;f<a.length;){var g=a.charCodeAt(f);if(g>=48&&g<=57||g>=65&&g<=90||g>=97&&g<=122||95===g){e+=a[f++];continue}break}if(!e)throw TypeError("Missing parameter name at ".concat(c));b.push({type:"NAME",index:c,value:e}),c=f;continue}if("("===d){var h=1,i="",f=c+1;if("?"===a[f])throw TypeError('Pattern cannot start with "?" at '.concat(f));for(;f<a.length;){if("\\"===a[f]){i+=a[f++]+a[f++];continue}if(")"===a[f]){if(0==--h){f++;break}}else if("("===a[f]&&(h++,"?"!==a[f+1]))throw TypeError("Capturing groups are not allowed at ".concat(f));i+=a[f++]}if(h)throw TypeError("Unbalanced pattern at ".concat(c));if(!i)throw TypeError("Missing pattern at ".concat(c));b.push({type:"PATTERN",index:c,value:i}),c=f;continue}b.push({type:"CHAR",index:c,value:a[c++]})}return b.push({type:"END",index:c,value:""}),b}(a),d=b.prefixes,f=void 0===d?"./":d,g=b.delimiter,h=void 0===g?"/#?":g,i=[],j=0,k=0,l="",m=function(a){if(k<c.length&&c[k].type===a)return c[k++].value},n=function(a){var b=m(a);if(void 0!==b)return b;var d=c[k],e=d.type,f=d.index;throw TypeError("Unexpected ".concat(e," at ").concat(f,", expected ").concat(a))},o=function(){for(var a,b="";a=m("CHAR")||m("ESCAPED_CHAR");)b+=a;return b},p=function(a){for(var b=0;b<h.length;b++){var c=h[b];if(a.indexOf(c)>-1)return!0}return!1},q=function(a){var b=i[i.length-1],c=a||(b&&"string"==typeof b?b:"");if(b&&!c)throw TypeError('Must have text between two parameters, missing text after "'.concat(b.name,'"'));return!c||p(c)?"[^".concat(e(h),"]+?"):"(?:(?!".concat(e(c),")[^").concat(e(h),"])+?")};k<c.length;){var r=m("CHAR"),s=m("NAME"),t=m("PATTERN");if(s||t){var u=r||"";-1===f.indexOf(u)&&(l+=u,u=""),l&&(i.push(l),l=""),i.push({name:s||j++,prefix:u,suffix:"",pattern:t||q(u),modifier:m("MODIFIER")||""});continue}var v=r||m("ESCAPED_CHAR");if(v){l+=v;continue}if(l&&(i.push(l),l=""),m("OPEN")){var u=o(),w=m("NAME")||"",x=m("PATTERN")||"",y=o();n("CLOSE"),i.push({name:w||(x?j++:""),pattern:w&&!x?q(u):x,prefix:u,suffix:y,modifier:m("MODIFIER")||""});continue}n("END")}return i}function c(a,b){void 0===b&&(b={});var c=f(b),d=b.encode,e=void 0===d?function(a){return a}:d,g=b.validate,h=void 0===g||g,i=a.map(function(a){if("object"==typeof a)return new RegExp("^(?:".concat(a.pattern,")$"),c)});return function(b){for(var c="",d=0;d<a.length;d++){var f=a[d];if("string"==typeof f){c+=f;continue}var g=b?b[f.name]:void 0,j="?"===f.modifier||"*"===f.modifier,k="*"===f.modifier||"+"===f.modifier;if(Array.isArray(g)){if(!k)throw TypeError('Expected "'.concat(f.name,'" to not repeat, but got an array'));if(0===g.length){if(j)continue;throw TypeError('Expected "'.concat(f.name,'" to not be empty'))}for(var l=0;l<g.length;l++){var m=e(g[l],f);if(h&&!i[d].test(m))throw TypeError('Expected all "'.concat(f.name,'" to match "').concat(f.pattern,'", but got "').concat(m,'"'));c+=f.prefix+m+f.suffix}continue}if("string"==typeof g||"number"==typeof g){var m=e(String(g),f);if(h&&!i[d].test(m))throw TypeError('Expected "'.concat(f.name,'" to match "').concat(f.pattern,'", but got "').concat(m,'"'));c+=f.prefix+m+f.suffix;continue}if(!j){var n=k?"an array":"a string";throw TypeError('Expected "'.concat(f.name,'" to be ').concat(n))}}return c}}function d(a,b,c){void 0===c&&(c={});var d=c.decode,e=void 0===d?function(a){return a}:d;return function(c){var d=a.exec(c);if(!d)return!1;for(var f=d[0],g=d.index,h=Object.create(null),i=1;i<d.length;i++)!function(a){if(void 0!==d[a]){var c=b[a-1];"*"===c.modifier||"+"===c.modifier?h[c.name]=d[a].split(c.prefix+c.suffix).map(function(a){return e(a,c)}):h[c.name]=e(d[a],c)}}(i);return{path:f,index:g,params:h}}}function e(a){return a.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function f(a){return a&&a.sensitive?"":"i"}function g(a,b,c){void 0===c&&(c={});for(var d=c.strict,g=void 0!==d&&d,h=c.start,i=c.end,j=c.encode,k=void 0===j?function(a){return a}:j,l=c.delimiter,m=c.endsWith,n="[".concat(e(void 0===m?"":m),"]|$"),o="[".concat(e(void 0===l?"/#?":l),"]"),p=void 0===h||h?"^":"",q=0;q<a.length;q++){var r=a[q];if("string"==typeof r)p+=e(k(r));else{var s=e(k(r.prefix)),t=e(k(r.suffix));if(r.pattern)if(b&&b.push(r),s||t)if("+"===r.modifier||"*"===r.modifier){var u="*"===r.modifier?"?":"";p+="(?:".concat(s,"((?:").concat(r.pattern,")(?:").concat(t).concat(s,"(?:").concat(r.pattern,"))*)").concat(t,")").concat(u)}else p+="(?:".concat(s,"(").concat(r.pattern,")").concat(t,")").concat(r.modifier);else{if("+"===r.modifier||"*"===r.modifier)throw TypeError('Can not repeat "'.concat(r.name,'" without a prefix and suffix'));p+="(".concat(r.pattern,")").concat(r.modifier)}else p+="(?:".concat(s).concat(t,")").concat(r.modifier)}}if(void 0===i||i)g||(p+="".concat(o,"?")),p+=c.endsWith?"(?=".concat(n,")"):"$";else{var v=a[a.length-1],w="string"==typeof v?o.indexOf(v[v.length-1])>-1:void 0===v;g||(p+="(?:".concat(o,"(?=").concat(n,"))?")),w||(p+="(?=".concat(o,"|").concat(n,")"))}return new RegExp(p,f(c))}function h(a,c,d){if(a instanceof RegExp){var e;if(!c)return a;for(var i=/\((?:\?<(.*?)>)?(?!\?)/g,j=0,k=i.exec(a.source);k;)c.push({name:k[1]||j++,prefix:"",suffix:"",modifier:"",pattern:""}),k=i.exec(a.source);return a}return Array.isArray(a)?(e=a.map(function(a){return h(a,c,d).source}),new RegExp("(?:".concat(e.join("|"),")"),f(d))):g(b(a,d),c,d)}Object.defineProperty(a,"__esModule",{value:!0}),a.pathToRegexp=a.tokensToRegexp=a.regexpToFunction=a.match=a.tokensToFunction=a.compile=a.parse=void 0,a.parse=b,a.compile=function(a,d){return c(b(a,d),d)},a.tokensToFunction=c,a.match=function(a,b){var c=[];return d(h(a,c,b),c,b)},a.regexpToFunction=d,a.tokensToRegexp=g,a.pathToRegexp=h})(),b.exports=a})()},567724,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={PARAM_SEPARATOR:function(){return f},hasAdjacentParameterIssues:function(){return g},normalizeAdjacentParameters:function(){return h},normalizeTokensForRegexp:function(){return i},stripNormalizedSeparators:function(){return j},stripParameterSeparators:function(){return k}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="_NEXTSEP_";function g(a){return"string"==typeof a&&!!(/\/\(\.{1,3}\):[^/\s]+/.test(a)||/:[a-zA-Z_][a-zA-Z0-9_]*:[a-zA-Z_][a-zA-Z0-9_]*/.test(a))}function h(a){let b=a;return(b=b.replace(/(\([^)]*\)):([^/\s]+)/g,`$1${f}:$2`)).replace(/:([^:/\s)]+)(?=:)/g,`:$1${f}`)}function i(a){return a.map(a=>"object"==typeof a&&null!==a&&"modifier"in a&&("*"===a.modifier||"+"===a.modifier)&&"prefix"in a&&"suffix"in a&&""===a.prefix&&""===a.suffix?{...a,prefix:"/"}:a)}function j(a){return a.replace(RegExp(`\\)${f}`,"g"),")")}function k(a){let b={};for(let[c,d]of Object.entries(a))"string"==typeof d?b[c]=d.replace(RegExp(`^${f}`),""):Array.isArray(d)?b[c]=d.map(a=>"string"==typeof a?a.replace(RegExp(`^${f}`),""):a):b[c]=d;return b}},879161,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={safeCompile:function(){return i},safePathToRegexp:function(){return h},safeRegexpToFunction:function(){return j},safeRouteMatcher:function(){return k}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(424819),g=a.r(567724);function h(a,b,c){if("string"!=typeof a)return(0,f.pathToRegexp)(a,b,c);let d=(0,g.hasAdjacentParameterIssues)(a),e=d?(0,g.normalizeAdjacentParameters)(a):a;try{return(0,f.pathToRegexp)(e,b,c)}catch(e){if(!d)try{let d=(0,g.normalizeAdjacentParameters)(a);return(0,f.pathToRegexp)(d,b,c)}catch(a){}throw e}}function i(a,b){let c=(0,g.hasAdjacentParameterIssues)(a),d=c?(0,g.normalizeAdjacentParameters)(a):a;try{let a=(0,f.compile)(d,b);if(c)return b=>(0,g.stripNormalizedSeparators)(a(b));return a}catch(d){if(!c)try{let c=(0,g.normalizeAdjacentParameters)(a),d=(0,f.compile)(c,b);return a=>(0,g.stripNormalizedSeparators)(d(a))}catch(a){}throw d}}function j(a,b){let c=(0,f.regexpToFunction)(a,b||[]);return a=>{let b=c(a);return!!b&&{...b,params:(0,g.stripParameterSeparators)(b.params)}}}function k(a){return b=>{let c=a(b);return!!c&&(0,g.stripParameterSeparators)(c)}}},973057,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getRouteMatcher",{enumerable:!0,get:function(){return f}});let d=a.r(870096),e=a.r(879161);function f({re:a,groups:b}){return(0,e.safeRouteMatcher)(c=>{let e=a.exec(c);if(!e)return!1;let f=a=>{try{return decodeURIComponent(a)}catch{throw Object.defineProperty(new d.DecodeError("failed to decode param"),"__NEXT_ERROR_CODE",{value:"E528",enumerable:!1,configurable:!0})}},g={};for(let[a,c]of Object.entries(b)){let b=e[c.pos];void 0!==b&&(c.repeat?g[a]=b.split("/").map(a=>f(a)):g[a]=f(b))}return g})}},677506,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ACTION_SUFFIX:function(){return r},APP_DIR_ALIAS:function(){return N},CACHE_ONE_YEAR:function(){return D},DOT_NEXT_ALIAS:function(){return L},ESLINT_DEFAULT_DIRS:function(){return af},GSP_NO_RETURNED_VALUE:function(){return _},GSSP_COMPONENT_MEMBER_ERROR:function(){return ac},GSSP_NO_RETURNED_VALUE:function(){return aa},HTML_CONTENT_TYPE_HEADER:function(){return g},INFINITE_CACHE:function(){return E},INSTRUMENTATION_HOOK_FILENAME:function(){return J},JSON_CONTENT_TYPE_HEADER:function(){return h},MATCHED_PATH_HEADER:function(){return k},MIDDLEWARE_FILENAME:function(){return F},MIDDLEWARE_LOCATION_REGEXP:function(){return G},NEXT_BODY_SUFFIX:function(){return u},NEXT_CACHE_IMPLICIT_TAG_ID:function(){return C},NEXT_CACHE_REVALIDATED_TAGS_HEADER:function(){return w},NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER:function(){return x},NEXT_CACHE_SOFT_TAG_MAX_LENGTH:function(){return B},NEXT_CACHE_TAGS_HEADER:function(){return v},NEXT_CACHE_TAG_MAX_ITEMS:function(){return z},NEXT_CACHE_TAG_MAX_LENGTH:function(){return A},NEXT_DATA_SUFFIX:function(){return s},NEXT_INTERCEPTION_MARKER_PREFIX:function(){return j},NEXT_META_SUFFIX:function(){return t},NEXT_QUERY_PARAM_PREFIX:function(){return i},NEXT_RESUME_HEADER:function(){return y},NON_STANDARD_NODE_ENV:function(){return ad},PAGES_DIR_ALIAS:function(){return K},PRERENDER_REVALIDATE_HEADER:function(){return l},PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER:function(){return m},PROXY_FILENAME:function(){return H},PROXY_LOCATION_REGEXP:function(){return I},PUBLIC_DIR_MIDDLEWARE_CONFLICT:function(){return V},ROOT_DIR_ALIAS:function(){return M},RSC_ACTION_CLIENT_WRAPPER_ALIAS:function(){return U},RSC_ACTION_ENCRYPTION_ALIAS:function(){return T},RSC_ACTION_PROXY_ALIAS:function(){return Q},RSC_ACTION_VALIDATE_ALIAS:function(){return P},RSC_CACHE_WRAPPER_ALIAS:function(){return R},RSC_DYNAMIC_IMPORT_WRAPPER_ALIAS:function(){return S},RSC_MOD_REF_PROXY_ALIAS:function(){return O},RSC_PREFETCH_SUFFIX:function(){return n},RSC_SEGMENTS_DIR_SUFFIX:function(){return o},RSC_SEGMENT_SUFFIX:function(){return p},RSC_SUFFIX:function(){return q},SERVER_PROPS_EXPORT_ERROR:function(){return $},SERVER_PROPS_GET_INIT_PROPS_CONFLICT:function(){return X},SERVER_PROPS_SSG_CONFLICT:function(){return Y},SERVER_RUNTIME:function(){return ag},SSG_FALLBACK_EXPORT_ERROR:function(){return ae},SSG_GET_INITIAL_PROPS_CONFLICT:function(){return W},STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR:function(){return Z},TEXT_PLAIN_CONTENT_TYPE_HEADER:function(){return f},UNSTABLE_REVALIDATE_RENAME_ERROR:function(){return ab},WEBPACK_LAYERS:function(){return aj},WEBPACK_RESOURCE_QUERIES:function(){return ak},WEB_SOCKET_MAX_RECONNECTIONS:function(){return ah}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="text/plain",g="text/html; charset=utf-8",h="application/json; charset=utf-8",i="nxtP",j="nxtI",k="x-matched-path",l="x-prerender-revalidate",m="x-prerender-revalidate-if-generated",n=".prefetch.rsc",o=".segments",p=".segment.rsc",q=".rsc",r=".action",s=".json",t=".meta",u=".body",v="x-next-cache-tags",w="x-next-revalidated-tags",x="x-next-revalidate-tag-token",y="next-resume",z=128,A=256,B=1024,C="_N_T_",D=31536e3,E=0xfffffffe,F="middleware",G=`(?:src/)?${F}`,H="proxy",I=`(?:src/)?${H}`,J="instrumentation",K="private-next-pages",L="private-dot-next",M="private-next-root-dir",N="private-next-app-dir",O="private-next-rsc-mod-ref-proxy",P="private-next-rsc-action-validate",Q="private-next-rsc-server-reference",R="private-next-rsc-cache-wrapper",S="private-next-rsc-track-dynamic-import",T="private-next-rsc-action-encryption",U="private-next-rsc-action-client-wrapper",V="You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict",W="You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps",X="You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.",Y="You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps",Z="can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props",$="pages with `getServerSideProps` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export",_="Your `getStaticProps` function did not return an object. Did you forget to add a `return`?",aa="Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?",ab="The `unstable_revalidate` property is available for general use.\nPlease use `revalidate` instead.",ac="can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member",ad='You are using a non-standard "NODE_ENV" value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env',ae="Pages with `fallback` enabled in `getStaticPaths` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export",af=["app","pages","components","lib","src"],ag={edge:"edge",experimentalEdge:"experimental-edge",nodejs:"nodejs"},ah=12,ai={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",apiNode:"api-node",apiEdge:"api-edge",middleware:"middleware",instrument:"instrument",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",pagesDirBrowser:"pages-dir-browser",pagesDirEdge:"pages-dir-edge",pagesDirNode:"pages-dir-node"},aj={...ai,GROUP:{builtinReact:[ai.reactServerComponents,ai.actionBrowser],serverOnly:[ai.reactServerComponents,ai.actionBrowser,ai.instrument,ai.middleware],neutralTarget:[ai.apiNode,ai.apiEdge],clientOnly:[ai.serverSideRendering,ai.appPagesBrowser],bundled:[ai.reactServerComponents,ai.actionBrowser,ai.serverSideRendering,ai.appPagesBrowser,ai.shared,ai.instrument,ai.middleware],appPages:[ai.reactServerComponents,ai.serverSideRendering,ai.appPagesBrowser,ai.actionBrowser]}},ak={edgeSSREntry:"__next_edge_ssr_entry__",metadata:"__next_metadata__",metadataRoute:"__next_metadata_route__",metadataImageMeta:"__next_metadata_image_meta__"}},196923,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"escapeStringRegexp",{enumerable:!0,get:function(){return f}});let d=/[|\\{}()[\]^$+*?.-]/,e=/[|\\{}()[\]^$+*?.-]/g;function f(a){return d.test(a)?a.replace(e,"\\$&"):a}},307498,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"InvariantError",{enumerable:!0,get:function(){return d}});class d extends Error{constructor(a,b){super(`Invariant: ${a.endsWith(".")?a:a+"."} This is a bug in Next.js.`,b),this.name="InvariantError"}}},93285,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"parseLoaderTree",{enumerable:!0,get:function(){return e}});let d=a.r(406598);function e(a){let[b,c,e]=a,{layout:f,template:g}=e,{page:h}=e;h=b===d.DEFAULT_SEGMENT_KEY?e.defaultPage:h;let i=f?.[1]||g?.[1]||h?.[1];return{page:h,segment:b,modules:e,conventionPath:i,parallelRoutes:c}}},147788,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getParamProperties:function(){return i},getSegmentParam:function(){return g},isCatchAll:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(524475);function g(a){let b=f.INTERCEPTION_ROUTE_MARKERS.find(b=>a.startsWith(b));return(b&&(a=a.slice(b.length)),a.startsWith("[[...")&&a.endsWith("]]"))?{type:"optional-catchall",param:a.slice(5,-2)}:a.startsWith("[...")&&a.endsWith("]")?{type:b?`catchall-intercepted-${b}`:"catchall",param:a.slice(4,-1)}:a.startsWith("[")&&a.endsWith("]")?{type:b?`dynamic-intercepted-${b}`:"dynamic",param:a.slice(1,-1)}:null}function h(a){return"catchall"===a||"catchall-intercepted-(..)(..)"===a||"catchall-intercepted-(.)"===a||"catchall-intercepted-(..)"===a||"catchall-intercepted-(...)"===a||"optional-catchall"===a}function i(a){let b=!1,c=!1;switch(a){case"catchall":case"catchall-intercepted-(..)(..)":case"catchall-intercepted-(.)":case"catchall-intercepted-(..)":case"catchall-intercepted-(...)":b=!0;break;case"optional-catchall":b=!0,c=!0}return{repeat:b,optional:c}}},927870,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={PARAMETER_PATTERN:function(){return k},getDynamicParam:function(){return j},interpolateParallelRouteParams:function(){return i},parseMatchedParameter:function(){return m},parseParameter:function(){return l}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(307498),g=a.r(93285),h=a.r(147788);function i(a,b,c,d){let e=structuredClone(b),f=[{tree:a,depth:0}],i=c.split("/").slice(1);for(;f.length>0;){let{tree:a,depth:b}=f.pop(),{segment:c,parallelRoutes:j}=(0,g.parseLoaderTree)(a),k=(0,h.getSegmentParam)(c);if(k&&!e.hasOwnProperty(k.param)&&!d?.has(k.param))switch(k.type){case"catchall":case"optional-catchall":case"catchall-intercepted-(..)(..)":case"catchall-intercepted-(.)":case"catchall-intercepted-(..)":case"catchall-intercepted-(...)":let l=i.slice(b).flatMap(a=>{let b=(0,h.getSegmentParam)(a);return b?e[b.param]:a}).filter(a=>void 0!==a);l.length>0&&(e[k.param]=l);break;case"dynamic":case"dynamic-intercepted-(..)(..)":case"dynamic-intercepted-(.)":case"dynamic-intercepted-(..)":case"dynamic-intercepted-(...)":if(b<i.length){let a=i[b],c=(0,h.getSegmentParam)(a);e[k.param]=c?e[c.param]:a}break;default:k.type}let m=b;for(let a of(!(c.startsWith("(")&&c.endsWith(")"))&&""!==c&&m++,Object.values(j)))f.push({tree:a,depth:m})}return e}function j(a,b,c,d){let e=function(a,b,c){let d=a[b];if(c?.has(b)){let[a]=c.get(b);d=a}else Array.isArray(d)?d=d.map(a=>encodeURIComponent(a)):"string"==typeof d&&(d=encodeURIComponent(d));return d}(a,b,d);if(!e||0===e.length){if("oc"===c)return{param:b,value:null,type:c,treeSegment:[b,"",c]};throw Object.defineProperty(new f.InvariantError(`Missing value for segment key: "${b}" with dynamic param type: ${c}`),"__NEXT_ERROR_CODE",{value:"E864",enumerable:!1,configurable:!0})}return{param:b,value:e,treeSegment:[b,Array.isArray(e)?e.join("/"):e,c],type:c}}let k=/^([^[]*)\[((?:\[[^\]]*\])|[^\]]+)\](.*)$/;function l(a){let b=a.match(k);return b?m(b[2]):m(a)}function m(a){let b=a.startsWith("[")&&a.endsWith("]");b&&(a=a.slice(1,-1));let c=a.startsWith("...");return c&&(a=a.slice(3)),{key:a,repeat:c,optional:b}}},537911,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getNamedMiddlewareRegex:function(){return p},getNamedRouteRegex:function(){return o},getRouteRegex:function(){return l}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(677506),g=a.r(524475),h=a.r(196923),i=a.r(263606),j=a.r(927870);function k(a,b,c){let d={},e=1,f=[];for(let k of(0,i.removeTrailingSlash)(a).slice(1).split("/")){let a=g.INTERCEPTION_ROUTE_MARKERS.find(a=>k.startsWith(a)),i=k.match(j.PARAMETER_PATTERN);if(a&&i&&i[2]){let{key:b,optional:c,repeat:g}=(0,j.parseMatchedParameter)(i[2]);d[b]={pos:e++,repeat:g,optional:c},f.push(`/${(0,h.escapeStringRegexp)(a)}([^/]+?)`)}else if(i&&i[2]){let{key:a,repeat:b,optional:g}=(0,j.parseMatchedParameter)(i[2]);d[a]={pos:e++,repeat:b,optional:g},c&&i[1]&&f.push(`/${(0,h.escapeStringRegexp)(i[1])}`);let k=b?g?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)";c&&i[1]&&(k=k.substring(1)),f.push(k)}else f.push(`/${(0,h.escapeStringRegexp)(k)}`);b&&i&&i[3]&&f.push((0,h.escapeStringRegexp)(i[3]))}return{parameterizedRoute:f.join(""),groups:d}}function l(a,{includeSuffix:b=!1,includePrefix:c=!1,excludeOptionalTrailingSlash:d=!1}={}){let{parameterizedRoute:e,groups:f}=k(a,b,c),g=e;return d||(g+="(?:/)?"),{re:RegExp(`^${g}$`),groups:f}}function m({interceptionMarker:a,getSafeRouteKey:b,segment:c,routeKeys:d,keyPrefix:e,backreferenceDuplicateKeys:f}){let g,{key:i,optional:k,repeat:l}=(0,j.parseMatchedParameter)(c),m=i.replace(/\W/g,"");e&&(m=`${e}${m}`);let n=!1;(0===m.length||m.length>30)&&(n=!0),isNaN(parseInt(m.slice(0,1)))||(n=!0),n&&(m=b());let o=m in d;e?d[m]=`${e}${i}`:d[m]=i;let p=a?(0,h.escapeStringRegexp)(a):"";return g=o&&f?`\\k<${m}>`:l?`(?<${m}>.+?)`:`(?<${m}>[^/]+?)`,{key:i,pattern:k?`(?:/${p}${g})?`:`/${p}${g}`,cleanedKey:m,optional:k,repeat:l}}function n(a,b,c,d,e,k={names:{},intercepted:{}}){let l,o=(l=0,()=>{let a="",b=++l;for(;b>0;)a+=String.fromCharCode(97+(b-1)%26),b=Math.floor((b-1)/26);return a}),p={},q=[],r=[];for(let l of(k=structuredClone(k),(0,i.removeTrailingSlash)(a).slice(1).split("/"))){let a,i=g.INTERCEPTION_ROUTE_MARKERS.some(a=>l.startsWith(a)),n=l.match(j.PARAMETER_PATTERN),s=i?n?.[1]:void 0;if(s&&n?.[2]?(a=b?f.NEXT_INTERCEPTION_MARKER_PREFIX:void 0,k.intercepted[n[2]]=s):a=n?.[2]&&k.intercepted[n[2]]?b?f.NEXT_INTERCEPTION_MARKER_PREFIX:void 0:b?f.NEXT_QUERY_PARAM_PREFIX:void 0,s&&n&&n[2]){let{key:b,pattern:c,cleanedKey:d,repeat:f,optional:g}=m({getSafeRouteKey:o,interceptionMarker:s,segment:n[2],routeKeys:p,keyPrefix:a,backreferenceDuplicateKeys:e});q.push(c),r.push(`/${n[1]}:${k.names[b]??d}${f?g?"*":"+":""}`),k.names[b]??=d}else if(n&&n[2]){d&&n[1]&&(q.push(`/${(0,h.escapeStringRegexp)(n[1])}`),r.push(`/${n[1]}`));let{key:b,pattern:c,cleanedKey:f,repeat:g,optional:i}=m({getSafeRouteKey:o,segment:n[2],routeKeys:p,keyPrefix:a,backreferenceDuplicateKeys:e}),j=c;d&&n[1]&&(j=j.substring(1)),q.push(j),r.push(`/:${k.names[b]??f}${g?i?"*":"+":""}`),k.names[b]??=f}else q.push(`/${(0,h.escapeStringRegexp)(l)}`),r.push(`/${l}`);c&&n&&n[3]&&(q.push((0,h.escapeStringRegexp)(n[3])),r.push(n[3]))}return{namedParameterizedRoute:q.join(""),routeKeys:p,pathToRegexpPattern:r.join(""),reference:k}}function o(a,b){let c=n(a,b.prefixRouteKeys,b.includeSuffix??!1,b.includePrefix??!1,b.backreferenceDuplicateKeys??!1,b.reference),d=c.namedParameterizedRoute;return b.excludeOptionalTrailingSlash||(d+="(?:/)?"),{...l(a,b),namedRegex:`^${d}$`,routeKeys:c.routeKeys,pathToRegexpPattern:c.pathToRegexpPattern,reference:c.reference}}function p(a,b){let{parameterizedRoute:c}=k(a,!1,!1),{catchAll:d=!0}=b;if("/"===c)return{namedRegex:`^/${d?".*":""}$`};let{namedParameterizedRoute:e}=n(a,!1,!1,!1,!1,void 0);return{namedRegex:`^${e}${d?"(?:(/.*)?)":""}$`}}},178227,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={formatUrl:function(){return h},formatWithValidation:function(){return j},urlObjectKeys:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(522298)._(a.r(226903)),g=/https?|ftp|gopher|file/;function h(a){let{auth:b,hostname:c}=a,d=a.protocol||"",e=a.pathname||"",h=a.hash||"",i=a.query||"",j=!1;b=b?encodeURIComponent(b).replace(/%3A/i,":")+"@":"",a.host?j=b+a.host:c&&(j=b+(~c.indexOf(":")?`[${c}]`:c),a.port&&(j+=":"+a.port)),i&&"object"==typeof i&&(i=String(f.urlQueryToSearchParams(i)));let k=a.search||i&&`?${i}`||"";return d&&!d.endsWith(":")&&(d+=":"),a.slashes||(!d||g.test(d))&&!1!==j?(j="//"+(j||""),e&&"/"!==e[0]&&(e="/"+e)):j||(j=""),h&&"#"!==h[0]&&(h="#"+h),k&&"?"!==k[0]&&(k="?"+k),e=e.replace(/[?#]/g,encodeURIComponent),k=k.replace("#","%23"),`${d}${j}${e}${k}${h}`}let i=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function j(a){return h(a)}},272860,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"detectDomainLocale",{enumerable:!0,get:function(){return d}});let d=(...a)=>{};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},913955,(a,b,c)=>{"use strict";function d(a){let b=a.indexOf("#"),c=a.indexOf("?"),d=c>-1&&(b<0||c<b);return d||b>-1?{pathname:a.substring(0,d?c:b),query:d?a.substring(c,b>-1?b:void 0):"",hash:b>-1?a.slice(b):""}:{pathname:a,query:"",hash:""}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"parsePath",{enumerable:!0,get:function(){return d}})},307088,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"normalizePathTrailingSlash",{enumerable:!0,get:function(){return f}});let d=a.r(263606),e=a.r(913955),f=a=>{if(!a.startsWith("/"))return a;let{pathname:b,query:c,hash:f}=(0,e.parsePath)(a);return`${(0,d.removeTrailingSlash)(b)}${c}${f}`};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},496596,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addLocale",{enumerable:!0,get:function(){return d}}),a.r(307088);let d=(a,...b)=>a;("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},540961,(a,b,c)=>{"use strict";function d(a,b){return a}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removeLocale",{enumerable:!0,get:function(){return d}}),a.r(913955),("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},940453,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"pathHasPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(913955);function e(a,b){if("string"!=typeof a)return!1;let{pathname:c}=(0,d.parsePath)(a);return c===b||c.startsWith(b+"/")}},793304,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"hasBasePath",{enumerable:!0,get:function(){return e}});let d=a.r(940453);function e(a){return(0,d.pathHasPrefix)(a,"")}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},852162,(a,b,c)=>{"use strict";function d(a){return a}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removeBasePath",{enumerable:!0,get:function(){return d}}),a.r(793304),("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},431054,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(913955);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${b}${c}${e}${f}`}},917187,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addBasePath",{enumerable:!0,get:function(){return f}});let d=a.r(431054),e=a.r(307088);function f(a,b){return(0,e.normalizePathTrailingSlash)((0,d.addPathPrefix)(a,""))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},192329,(a,b,c)=>{"use strict";function d(a,b){let c={};return Object.keys(a).forEach(d=>{b.includes(d)||(c[d]=a[d])}),c}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"omit",{enumerable:!0,get:function(){return d}})},812025,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isLocalURL",{enumerable:!0,get:function(){return f}});let d=a.r(870096),e=a.r(793304);function f(a){if(!(0,d.isAbsoluteUrl)(a))return!0;try{let b=(0,d.getLocationOrigin)(),c=new URL(a,b);return c.origin===b&&(0,e.hasBasePath)(c.pathname)}catch(a){return!1}}},46818,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"interpolateAs",{enumerable:!0,get:function(){return f}});let d=a.r(973057),e=a.r(537911);function f(a,b,c){let f="",g=(0,e.getRouteRegex)(a),h=g.groups,i=(b!==a?(0,d.getRouteMatcher)(g)(b):"")||c;f=a;let j=Object.keys(h);return j.every(a=>{let b=i[a]||"",{repeat:c,optional:d}=h[a],e=`[${c?"...":""}${a}]`;return d&&(e=`${!b?"/":""}[${e}]`),c&&!Array.isArray(b)&&(b=[b]),(d||a in i)&&(f=f.replace(e,c?b.map(a=>encodeURIComponent(a)).join("/"):encodeURIComponent(b))||"/")})||(f=""),{params:j,result:f}}},599824,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"resolveHref",{enumerable:!0,get:function(){return n}});let d=a.r(226903),e=a.r(178227),f=a.r(192329),g=a.r(870096),h=a.r(307088),i=a.r(812025),j=a.r(614003),k=a.r(46818),l=a.r(537911),m=a.r(973057);function n(a,b,c){let n,o="string"==typeof b?b:(0,e.formatWithValidation)(b),p=o.match(/^[a-z][a-z0-9+.-]*:\/\//i),q=p?o.slice(p[0].length):o;if((q.split("?",1)[0]||"").match(/(\/\/|\\)/)){console.error(`Invalid href '${o}' passed to next/router in page: '${a.pathname}'. Repeated forward-slashes (//) or backslashes \\ are not valid in the href.`);let b=(0,g.normalizeRepeatedSlashes)(q);o=(p?p[0]:"")+b}if(!(0,i.isLocalURL)(o))return c?[o]:o;try{let b=o.startsWith("#")?a.asPath:a.pathname;if(o.startsWith("?")&&(b=a.asPath,(0,j.isDynamicRoute)(a.pathname))){b=a.pathname;let c=(0,l.getRouteRegex)(a.pathname);(0,m.getRouteMatcher)(c)(a.asPath)||(b=a.asPath)}n=new URL(b,"http://n")}catch(a){n=new URL("/","http://n")}try{let a=new URL(o,n);a.pathname=(0,h.normalizePathTrailingSlash)(a.pathname);let b="";if((0,j.isDynamicRoute)(a.pathname)&&a.searchParams&&c){let c=(0,d.searchParamsToUrlQuery)(a.searchParams),{result:g,params:h}=(0,k.interpolateAs)(a.pathname,a.pathname,c);g&&(b=(0,e.formatWithValidation)({pathname:g,hash:a.hash,query:(0,f.omit)(c,h)}))}let g=a.origin===n.origin?a.href.slice(a.origin.length):a.href;return c?[g,b||g]:g}catch(a){return c?[o]:o}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},377306,(a,b,c)=>{"use strict";function d(a){return"/api"===a||!!(null==a?void 0:a.startsWith("/api/"))}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isAPIRoute",{enumerable:!0,get:function(){return d}})},301016,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removePathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(940453);function e(a,b){if(!(0,d.pathHasPrefix)(a,b))return a;let c=a.slice(b.length);return c.startsWith("/")?c:`/${c}`}},517994,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getNextPathnameInfo",{enumerable:!0,get:function(){return g}});let d=a.r(645181),e=a.r(301016),f=a.r(940453);function g(a,b){let{basePath:c,i18n:g,trailingSlash:h}=b.nextConfig??{},i={pathname:a,trailingSlash:"/"!==a?a.endsWith("/"):h};c&&(0,f.pathHasPrefix)(i.pathname,c)&&(i.pathname=(0,e.removePathPrefix)(i.pathname,c),i.basePath=c);let j=i.pathname;if(i.pathname.startsWith("/_next/data/")&&i.pathname.endsWith(".json")){let a=i.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/");i.buildId=a[0],j="index"!==a[1]?`/${a.slice(1).join("/")}`:"/",!0===b.parseData&&(i.pathname=j)}if(g){let a=b.i18nProvider?b.i18nProvider.analyze(i.pathname):(0,d.normalizeLocalePath)(i.pathname,g.locales);i.locale=a.detectedLocale,i.pathname=a.pathname??i.pathname,!a.detectedLocale&&i.buildId&&(a=b.i18nProvider?b.i18nProvider.analyze(j):(0,d.normalizeLocalePath)(j,g.locales)).detectedLocale&&(i.locale=a.detectedLocale)}return i}},827858,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathSuffix",{enumerable:!0,get:function(){return e}});let d=a.r(913955);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${c}${b}${e}${f}`}},635970,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addLocale",{enumerable:!0,get:function(){return f}});let d=a.r(431054),e=a.r(940453);function f(a,b,c,f){if(!b||b===c)return a;let g=a.toLowerCase();return!f&&((0,e.pathHasPrefix)(g,"/api")||(0,e.pathHasPrefix)(g,`/${b.toLowerCase()}`))?a:(0,d.addPathPrefix)(a,`/${b}`)}},800337,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"formatNextPathnameInfo",{enumerable:!0,get:function(){return h}});let d=a.r(263606),e=a.r(431054),f=a.r(827858),g=a.r(635970);function h(a){let b=(0,g.addLocale)(a.pathname,a.locale,a.buildId?void 0:a.defaultLocale,a.ignorePrefix);return(a.buildId||!a.trailingSlash)&&(b=(0,d.removeTrailingSlash)(b)),a.buildId&&(b=(0,f.addPathSuffix)((0,e.addPathPrefix)(b,`/_next/data/${a.buildId}`),"/"===a.pathname?"index.json":".json")),b=(0,e.addPathPrefix)(b,a.basePath),!a.buildId&&a.trailingSlash?b.endsWith("/")?b:(0,f.addPathSuffix)(b,"/"):(0,d.removeTrailingSlash)(b)}},594270,(a,b,c)=>{"use strict";function d(a,b){let c=Object.keys(a);if(c.length!==Object.keys(b).length)return!1;for(let d=c.length;d--;){let e=c[d];if("query"===e){let c=Object.keys(a.query);if(c.length!==Object.keys(b.query).length)return!1;for(let d=c.length;d--;){let e=c[d];if(!b.query.hasOwnProperty(e)||a.query[e]!==b.query[e])return!1}}else if(!b.hasOwnProperty(e)||a[e]!==b[e])return!1}return!0}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"compareRouterStates",{enumerable:!0,get:function(){return d}})},278775,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"HTML_LIMITED_BOT_UA_RE",{enumerable:!0,get:function(){return d}});let d=/[\w-]+-Google|Google-[\w-]+|Chrome-Lighthouse|Slurp|DuckDuckBot|baiduspider|yandex|sogou|bitlybot|tumblr|vkShare|quora link preview|redditbot|ia_archiver|Bingbot|BingPreview|applebot|facebookexternalhit|facebookcatalog|Twitterbot|LinkedInBot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|Yeti|googleweblight/i},407730,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={HTML_LIMITED_BOT_UA_RE:function(){return f.HTML_LIMITED_BOT_UA_RE},HTML_LIMITED_BOT_UA_RE_STRING:function(){return h},getBotType:function(){return k},isBot:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(278775),g=/Googlebot(?!-)|Googlebot$/i,h=f.HTML_LIMITED_BOT_UA_RE.source;function i(a){return f.HTML_LIMITED_BOT_UA_RE.test(a)}function j(a){return g.test(a)||i(a)}function k(a){return g.test(a)?"dom":i(a)?"html":void 0}},691566,(a,b,c)=>{"use strict";function d(a,b={}){if(b.onlyHashChange)return void a();let c=document.documentElement;if("smooth"!==c.dataset.scrollBehavior)return void a();let e=c.style.scrollBehavior;c.style.scrollBehavior="auto",b.dontForceLayout||c.getClientRects(),a(),c.style.scrollBehavior=e}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"disableSmoothScrollDuringRouteTransition",{enumerable:!0,get:function(){return d}}),a.r(734068)},670036,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={createKey:function(){return T},default:function(){return W},matchesMiddleware:function(){return L}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(5218),g=a.r(522298),h=a.r(263606),i=a.r(305369),j=a.r(223054),k=g._(a.r(738072)),l=a.r(719351),m=a.r(645181),n=f._(a.r(375248)),o=a.r(870096),p=a.r(535388),q=a.r(974309),r=a.r(973057),s=a.r(537911),t=a.r(178227);a.r(272860);let u=a.r(913955),v=a.r(496596),w=a.r(540961),x=a.r(852162),y=a.r(917187),z=a.r(793304),A=a.r(599824),B=a.r(377306),C=a.r(517994),D=a.r(800337),E=a.r(594270),F=a.r(812025);a.r(407730);let G=a.r(192329),H=a.r(46818),I=a.r(691566),J=a.r(677506);function K(){return Object.assign(Object.defineProperty(Error("Route Cancelled"),"__NEXT_ERROR_CODE",{value:"E315",enumerable:!1,configurable:!0}),{cancelled:!0})}async function L(a){let b=await Promise.resolve(a.router.pageLoader.getMiddleware());if(!b)return!1;let{pathname:c}=(0,u.parsePath)(a.asPath),d=(0,z.hasBasePath)(c)?(0,x.removeBasePath)(c):c,e=(0,y.addBasePath)((0,v.addLocale)(d,a.locale));return b.some(a=>new RegExp(a.regexp).test(e))}function M(a){let b=(0,o.getLocationOrigin)();return a.startsWith(b)?a.substring(b.length):a}function N(a,b,c){let[d,e]=(0,A.resolveHref)(a,b,!0),f=(0,o.getLocationOrigin)(),g=d.startsWith(f),h=e&&e.startsWith(f);d=M(d),e=e?M(e):e;let i=g?d:(0,y.addBasePath)(d),j=c?M((0,A.resolveHref)(a,c)):e||d;return{url:i,as:h?j:(0,y.addBasePath)(j)}}function O(a,b){let c=(0,h.removeTrailingSlash)((0,l.denormalizePagePath)(a));return"/404"===c||"/_error"===c?a:(b.includes(c)||b.some(b=>{if((0,p.isDynamicRoute)(b)&&(0,s.getRouteRegex)(b).re.test(c))return a=b,!0}),(0,h.removeTrailingSlash)(a))}async function P(a){if(!await L(a)||!a.fetchData)return null;let b=await a.fetchData(),c=await function(a,b,c){let d={basePath:c.router.basePath,i18n:{locales:c.router.locales},trailingSlash:!1},e=b.headers.get("x-nextjs-rewrite"),f=e||b.headers.get("x-nextjs-matched-path"),g=b.headers.get(J.MATCHED_PATH_HEADER);if(!g||f||g.includes("__next_data_catchall")||g.includes("/_error")||g.includes("/404")||(f=g),f){if(f.startsWith("/")){let b=(0,q.parseRelativeUrl)(f),g=(0,C.getNextPathnameInfo)(b.pathname,{nextConfig:d,parseData:!0}),j=(0,h.removeTrailingSlash)(g.pathname);return Promise.all([c.router.pageLoader.getPageList(),(0,i.getClientBuildManifest)()]).then(([f,{__rewrites:h}])=>{let i=(0,v.addLocale)(g.pathname,g.locale);if((0,p.isDynamicRoute)(i)||!e&&f.includes((0,m.normalizeLocalePath)((0,x.removeBasePath)(i),c.router.locales).pathname)){let c=(0,C.getNextPathnameInfo)((0,q.parseRelativeUrl)(a).pathname,{nextConfig:d,parseData:!0});b.pathname=i=(0,y.addBasePath)(c.pathname)}if(!f.includes(j)){let a=O(j,f);a!==j&&(j=a)}let k=f.includes(j)?j:O((0,m.normalizeLocalePath)((0,x.removeBasePath)(b.pathname),c.router.locales).pathname,f);if((0,p.isDynamicRoute)(k)){let a=(0,r.getRouteMatcher)((0,s.getRouteRegex)(k))(i);Object.assign(b.query,a||{})}return{type:"rewrite",parsedAs:b,resolvedHref:k}})}let b=(0,u.parsePath)(a),g=(0,D.formatNextPathnameInfo)({...(0,C.getNextPathnameInfo)(b.pathname,{nextConfig:d,parseData:!0}),defaultLocale:c.router.defaultLocale,buildId:""});return Promise.resolve({type:"redirect-external",destination:`${g}${b.query}${b.hash}`})}let j=b.headers.get("x-nextjs-redirect");if(j){if(j.startsWith("/")){let a=(0,u.parsePath)(j),b=(0,D.formatNextPathnameInfo)({...(0,C.getNextPathnameInfo)(a.pathname,{nextConfig:d,parseData:!0}),defaultLocale:c.router.defaultLocale,buildId:""});return Promise.resolve({type:"redirect-internal",newAs:`${b}${a.query}${a.hash}`,newUrl:`${b}${a.query}${a.hash}`})}return Promise.resolve({type:"redirect-external",destination:j})}return Promise.resolve({type:"next"})}(b.dataHref,b.response,a);return{dataHref:b.dataHref,json:b.json,response:b.response,text:b.text,cacheKey:b.cacheKey,effect:c}}let Q=Symbol("SSG_DATA_NOT_FOUND");function R(a){try{return JSON.parse(a)}catch(a){return null}}function S({dataHref:a,inflightCache:b,isPrefetch:c,hasMiddleware:d,isServerRender:e,parseJSON:f,persistCache:g,isBackground:h,unstable_skipClientCache:j}){let{href:k}=new URL(a,window.location.href),l=h=>(function a(b,c,d){return fetch(b,{credentials:"same-origin",method:d.method||"GET",headers:Object.assign({},d.headers,{"x-nextjs-data":"1"})}).then(e=>!e.ok&&c>1&&e.status>=500?a(b,c-1,d):e)})(a,e?3:1,{headers:Object.assign({},c?{purpose:"prefetch"}:{},c&&d?{"x-middleware-prefetch":"1"}:{},{}),method:h?.method??"GET"}).then(b=>b.ok&&h?.method==="HEAD"?{dataHref:a,response:b,text:"",json:{},cacheKey:k}:b.text().then(c=>{if(!b.ok){if(d&&[301,302,307,308].includes(b.status))return{dataHref:a,response:b,text:c,json:{},cacheKey:k};if(404===b.status&&R(c)?.notFound)return{dataHref:a,json:{notFound:Q},response:b,text:c,cacheKey:k};let f=Object.defineProperty(Error("Failed to load static props"),"__NEXT_ERROR_CODE",{value:"E124",enumerable:!1,configurable:!0});throw e||(0,i.markAssetError)(f),f}return{dataHref:a,json:f?R(c):null,response:b,text:c,cacheKey:k}})).then(a=>(g&&"no-cache"!==a.response.headers.get("x-middleware-cache")||delete b[k],a)).catch(a=>{throw j||delete b[k],("Failed to fetch"===a.message||"NetworkError when attempting to fetch resource."===a.message||"Load failed"===a.message)&&(0,i.markAssetError)(a),a});return j&&g?l({}).then(a=>("no-cache"!==a.response.headers.get("x-middleware-cache")&&(b[k]=Promise.resolve(a)),a)):void 0!==b[k]?b[k]:b[k]=l(h?{method:"HEAD"}:{})}function T(){return Math.random().toString(36).slice(2,10)}function U({url:a,router:b}){if(a===(0,y.addBasePath)((0,v.addLocale)(b.asPath,b.locale)))throw Object.defineProperty(Error(`Invariant: attempted to hard navigate to the same URL ${a} ${location.href}`),"__NEXT_ERROR_CODE",{value:"E282",enumerable:!1,configurable:!0});window.location.href=a}let V=({route:a,router:b})=>{let c=!1,d=b.clc=()=>{c=!0};return()=>{if(c){let b=Object.defineProperty(Error(`Abort fetching component for route: "${a}"`),"__NEXT_ERROR_CODE",{value:"E483",enumerable:!1,configurable:!0});throw b.cancelled=!0,b}d===b.clc&&(b.clc=null)}};class W{static{this.events=(0,n.default)()}constructor(a,b,c,{initialProps:d,pageLoader:e,App:f,wrapApp:g,Component:i,err:j,subscription:k,isFallback:l,locale:m,locales:n,defaultLocale:r,domainLocales:s,isPreview:u}){this.sdc={},this.sbc={},this.isFirstPopStateEvent=!0,this._key=T(),this.onPopState=a=>{let b,{isFirstPopStateEvent:c}=this;this.isFirstPopStateEvent=!1;let d=a.state;if(!d){let{pathname:a,query:b}=this;this.changeState("replaceState",(0,t.formatWithValidation)({pathname:(0,y.addBasePath)(a),query:b}),(0,o.getURL)());return}if(d.__NA)return void window.location.reload();if(!d.__N||c&&this.locale===d.options.locale&&d.as===this.asPath)return;let{url:e,as:f,options:g,key:h}=d;this._key=h;let{pathname:i}=(0,q.parseRelativeUrl)(e);this.isSsr&&f===(0,y.addBasePath)(this.asPath)&&i===(0,y.addBasePath)(this.pathname)||(!this._bps||this._bps(d))&&this.change("replaceState",e,f,Object.assign({},g,{shallow:g.shallow&&this._shallow,locale:g.locale||this.defaultLocale,_h:0}),b)};const v=(0,h.removeTrailingSlash)(a);this.components={},"/_error"!==a&&(this.components[v]={Component:i,initial:!0,props:d,err:j,__N_SSG:d&&d.__N_SSG,__N_SSP:d&&d.__N_SSP}),this.components["/_app"]={Component:f,styleSheets:[]},this.events=W.events,this.pageLoader=e;const w=(0,p.isDynamicRoute)(a)&&self.__NEXT_DATA__.autoExport;this.basePath="",this.sub=k,this.clc=null,this._wrapApp=g,this.isSsr=!0,this.isLocaleDomain=!1,this.isReady=!!(self.__NEXT_DATA__.gssp||self.__NEXT_DATA__.gip||self.__NEXT_DATA__.isExperimentalCompile||self.__NEXT_DATA__.appGip&&!self.__NEXT_DATA__.gsp||!w&&!self.location.search),this.state={route:v,pathname:a,query:b,asPath:w?a:c,isPreview:!!u,locale:void 0,isFallback:l},this._initialMatchesMiddlewarePromise=Promise.resolve(!1)}reload(){window.location.reload()}back(){window.history.back()}forward(){window.history.forward()}push(a,b,c={}){return{url:a,as:b}=N(this,a,b),this.change("pushState",a,b,c)}replace(a,b,c={}){return{url:a,as:b}=N(this,a,b),this.change("replaceState",a,b,c)}async _bfl(b,c,d,e){{if(!this._bfl_s&&!this._bfl_d){let c,f,{BloomFilter:g}=a.r(793583);try{({__routerFilterStatic:c,__routerFilterDynamic:f}=await (0,i.getClientBuildManifest)())}catch(a){if(console.error(a),e)return!0;return U({url:(0,y.addBasePath)((0,v.addLocale)(b,d||this.locale,this.defaultLocale)),router:this}),new Promise(()=>{})}let h={numItems:25,errorRate:1e-4,numBits:480,numHashes:14,bitArray:[1,1,0,1,0,1,1,0,0,1,0,1,0,0,1,1,1,1,0,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,1,0,1,0,1,1,0,0,1,0,0,1,1,1,0,1,1,0,1,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,1,1,1,0,1,0,0,1,0,1,0,0,0,1,1,0,1,1,0,0,0,0,0,1,1,0,0,0,1,1,0,1,1,1,0,0,0,1,1,1,0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,1,1,1,0,0,1,0,0,1,1,1,0,0,0,0,0,1,1,0,1,1,1,0,0,1,1,0,1,0,0,0,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,1,0,0,1,1,1,0,1,1,1,1,0,0,1,0,0,1,0,0,1,1,1,1,1,0,1,0,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,0,1,0,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,0,1,0,1,1,0,1,0,1,0,1,0,0,0,0,1,1,0,1,1,0,1,1,0,0,1,1,1,1,1,1,0,0,1,0,0,1,1,1,0,1,1,0,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,0,1,1,0,1,0,1,1,0,0,1,1,1,0,1,1,0,0,0,1,0,1,0,1,0,1,1,1,1,1,0,0,0,1,0,1,0,1,1,0,0,1,1,0,1,1,0,0,0,1,0,0,1,1,1,0,0,0,0,1,0,1,0,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,0,1,1,0,1,1,0,1,0,1,0,1,0,1,0,1,1,0,0,1,1,1,1,0,0,0,1,0,0,0,0,1,0,1,1,1,1,1,1,1,0,1,1,0,1,0,0,1,1,1,1]};!c&&h&&(c=h||void 0);let j={numItems:0,errorRate:1e-4,numBits:0,numHashes:null,bitArray:[]};!f&&j&&(f=j),c?.numHashes&&(this._bfl_s=new g(c.numItems,c.errorRate),this._bfl_s.import(c)),f?.numHashes&&(this._bfl_d=new g(f.numItems,f.errorRate),this._bfl_d.import(f))}let f=!1,g=!1;for(let{as:a,allowMatchCurrent:i}of[{as:b},{as:c}])if(a){let c=(0,h.removeTrailingSlash)(new URL(a,"http://n").pathname),j=(0,y.addBasePath)((0,v.addLocale)(c,d||this.locale));if(i||c!==(0,h.removeTrailingSlash)(new URL(this.asPath,"http://n").pathname)){for(let a of(f=f||!!this._bfl_s?.contains(c)||!!this._bfl_s?.contains(j),[c,j])){let b=a.split("/");for(let a=0;!g&&a<b.length+1;a++){let c=b.slice(0,a).join("/");if(c&&this._bfl_d?.contains(c)){g=!0;break}}}if(f||g){if(e)return!0;return U({url:(0,y.addBasePath)((0,v.addLocale)(b,d||this.locale,this.defaultLocale)),router:this}),new Promise(()=>{})}}}}return!1}async change(a,b,c,d,e){let f,g;if(!(0,F.isLocalURL)(b))return U({url:b,router:this}),!1;let l=1===d._h;l||d.shallow||await this._bfl(c,void 0,d.locale);let m=l||d._shouldResolveHref||(0,u.parsePath)(b).pathname===(0,u.parsePath)(c).pathname,n={...this.state},A=!0!==this.isReady;this.isReady=!0;let B=this.isSsr;if(l||(this.isSsr=!1),l&&this.clc)return!1;let C=n.locale;o.ST&&performance.mark("routeChange");let{shallow:D=!1,scroll:I=!0}=d,J={shallow:D};this._inFlightRoute&&this.clc&&(B||W.events.emit("routeChangeError",K(),this._inFlightRoute,J),this.clc(),this.clc=null),c=(0,y.addBasePath)((0,v.addLocale)((0,z.hasBasePath)(c)?(0,x.removeBasePath)(c):c,d.locale,this.defaultLocale));let M=(0,w.removeLocale)((0,z.hasBasePath)(c)?(0,x.removeBasePath)(c):c,n.locale);this._inFlightRoute=c;let P=C!==n.locale;if(!l&&this.onlyAHashChange(M)&&!P){n.asPath=M,W.events.emit("hashChangeStart",c,J),this.changeState(a,b,c,{...d,scroll:!1}),I&&this.scrollToHash(M);try{await this.set(n,this.components[n.route],null)}catch(a){throw(0,k.default)(a)&&a.cancelled&&W.events.emit("routeChangeError",a,M,J),a}return W.events.emit("hashChangeComplete",c,J),!0}let R=(0,q.parseRelativeUrl)(b),{pathname:S,query:T}=R;try{[f,{__rewrites:g}]=await Promise.all([this.pageLoader.getPageList(),(0,i.getClientBuildManifest)(),this.pageLoader.getMiddleware()])}catch(a){return U({url:c,router:this}),!1}this.urlIsNew(M)||P||(a="replaceState");let V=c;S=S?(0,h.removeTrailingSlash)((0,x.removeBasePath)(S)):S;let X=(0,h.removeTrailingSlash)(S),Y=c.startsWith("/")&&(0,q.parseRelativeUrl)(c).pathname;if(this.components[S]?.__appRouter)return U({url:c,router:this}),new Promise(()=>{});let Z=!!(Y&&X!==Y&&(!(0,p.isDynamicRoute)(X)||!(0,r.getRouteMatcher)((0,s.getRouteRegex)(X))(Y))),$=!d.shallow&&await L({asPath:c,locale:n.locale,router:this});if(l&&$&&(m=!1),m&&"/_error"!==S&&(d._shouldResolveHref=!0,R.pathname=O(S,f),R.pathname!==S&&(S=R.pathname,R.pathname=(0,y.addBasePath)(S),$||(b=(0,t.formatWithValidation)(R)))),!(0,F.isLocalURL)(c))return U({url:c,router:this}),!1;V=(0,w.removeLocale)((0,x.removeBasePath)(V),n.locale),X=(0,h.removeTrailingSlash)(S);let _=!1;if((0,p.isDynamicRoute)(X)){let a=(0,q.parseRelativeUrl)(V),d=a.pathname,e=(0,s.getRouteRegex)(X);_=(0,r.getRouteMatcher)(e)(d);let f=X===d,g=f?(0,H.interpolateAs)(X,d,T):{};if(_&&(!f||g.result))f?c=(0,t.formatWithValidation)(Object.assign({},a,{pathname:g.result,query:(0,G.omit)(T,g.params)})):Object.assign(T,_);else{let a=Object.keys(e.groups).filter(a=>!T[a]&&!e.groups[a].optional);if(a.length>0&&!$)throw Object.defineProperty(Error((f?`The provided \`href\` (${b}) value is missing query values (${a.join(", ")}) to be interpolated properly. `:`The provided \`as\` value (${d}) is incompatible with the \`href\` value (${X}). `)+`Read more: https://nextjs.org/docs/messages/${f?"href-interpolation-failed":"incompatible-href-as"}`),"__NEXT_ERROR_CODE",{value:"E344",enumerable:!1,configurable:!0})}}l||W.events.emit("routeChangeStart",c,J);let aa="/404"===this.pathname||"/_error"===this.pathname;try{let g=await this.getRouteInfo({route:X,pathname:S,query:T,as:c,resolvedAs:V,routeProps:J,locale:n.locale,isPreview:n.isPreview,hasMiddleware:$,unstable_skipClientCache:d.unstable_skipClientCache,isQueryUpdating:l&&!this.isFallback,isMiddlewareRewrite:Z});if(l||d.shallow||await this._bfl(c,"resolvedAs"in g?g.resolvedAs:void 0,n.locale),"route"in g&&$){X=S=g.route||X,J.shallow||(T=Object.assign({},g.query||{},T));let a=(0,z.hasBasePath)(R.pathname)?(0,x.removeBasePath)(R.pathname):R.pathname;if(_&&S!==a&&Object.keys(_).forEach(a=>{_&&T[a]===_[a]&&delete T[a]}),(0,p.isDynamicRoute)(S)){let a=!J.shallow&&g.resolvedAs?g.resolvedAs:(0,y.addBasePath)((0,v.addLocale)(new URL(c,location.href).pathname,n.locale),!0);(0,z.hasBasePath)(a)&&(a=(0,x.removeBasePath)(a));let b=(0,s.getRouteRegex)(S),d=(0,r.getRouteMatcher)(b)(new URL(a,location.href).pathname);d&&Object.assign(T,d)}}if("type"in g)if("redirect-internal"===g.type)return this.change(a,g.newUrl,g.newAs,d);else return U({url:g.destination,router:this}),new Promise(()=>{});let h=g.Component;if(h&&h.unstable_scriptLoader&&[].concat(h.unstable_scriptLoader()).forEach(a=>{(0,j.handleClientScriptLoad)(a.props)}),(g.__N_SSG||g.__N_SSP)&&g.props){if(g.props.pageProps&&g.props.pageProps.__N_REDIRECT){d.locale=!1;let b=g.props.pageProps.__N_REDIRECT;if(b.startsWith("/")&&!1!==g.props.pageProps.__N_REDIRECT_BASE_PATH){let c=(0,q.parseRelativeUrl)(b);c.pathname=O(c.pathname,f);let{url:e,as:g}=N(this,b,b);return this.change(a,e,g,d)}return U({url:b,router:this}),new Promise(()=>{})}if(n.isPreview=!!g.props.__N_PREVIEW,g.props.notFound===Q){let a;try{await this.fetchComponent("/404"),a="/404"}catch(b){a="/_error"}if(g=await this.getRouteInfo({route:a,pathname:a,query:T,as:c,resolvedAs:V,routeProps:{shallow:!1},locale:n.locale,isPreview:n.isPreview,isNotFound:!0}),"type"in g)throw Object.defineProperty(Error("Unexpected middleware effect on /404"),"__NEXT_ERROR_CODE",{value:"E158",enumerable:!1,configurable:!0})}}l&&"/_error"===this.pathname&&self.__NEXT_DATA__.props?.pageProps?.statusCode===500&&g.props?.pageProps&&(g.props.pageProps.statusCode=500);let i=d.shallow&&n.route===(g.route??X),m=d.scroll??(!l&&!i),o=e??(m?{x:0,y:0}:null),t={...n,route:X,pathname:S,query:T,asPath:M,isFallback:!1};if(l&&aa){if(g=await this.getRouteInfo({route:this.pathname,pathname:this.pathname,query:T,as:c,resolvedAs:V,routeProps:{shallow:!1},locale:n.locale,isPreview:n.isPreview,isQueryUpdating:l&&!this.isFallback}),"type"in g)throw Object.defineProperty(Error(`Unexpected middleware effect on ${this.pathname}`),"__NEXT_ERROR_CODE",{value:"E225",enumerable:!1,configurable:!0});"/_error"===this.pathname&&self.__NEXT_DATA__.props?.pageProps?.statusCode===500&&g.props?.pageProps&&(g.props.pageProps.statusCode=500);try{await this.set(t,g,o)}catch(a){throw(0,k.default)(a)&&a.cancelled&&W.events.emit("routeChangeError",a,M,J),a}return!0}if(W.events.emit("beforeHistoryChange",c,J),this.changeState(a,b,c,d),!(l&&!o&&!A&&!P&&(0,E.compareRouterStates)(t,this.state))){try{await this.set(t,g,o)}catch(a){if(a.cancelled)g.error=g.error||a;else throw a}if(g.error)throw l||W.events.emit("routeChangeError",g.error,M,J),g.error;l||W.events.emit("routeChangeComplete",c,J),m&&/#.+$/.test(c)&&this.scrollToHash(c)}return!0}catch(a){if((0,k.default)(a)&&a.cancelled)return!1;throw a}}changeState(a,b,c,d={}){("pushState"!==a||(0,o.getURL)()!==c)&&(this._shallow=d.shallow,window.history[a]({url:b,as:c,options:d,__N:!0,key:this._key="pushState"!==a?this._key:T()},"",c))}async handleRouteInfoError(a,b,c,d,e,f){if(a.cancelled)throw a;if((0,i.isAssetError)(a)||f)throw W.events.emit("routeChangeError",a,d,e),U({url:d,router:this}),K();console.error(a);try{let d,{page:e,styleSheets:f}=await this.fetchComponent("/_error"),g={props:d,Component:e,styleSheets:f,err:a,error:a};if(!g.props)try{g.props=await this.getInitialProps(e,{err:a,pathname:b,query:c})}catch(a){console.error("Error in error page `getInitialProps`: ",a),g.props={}}return g}catch(a){return this.handleRouteInfoError((0,k.default)(a)?a:Object.defineProperty(Error(a+""),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0}),b,c,d,e,!0)}}async getRouteInfo({route:a,pathname:b,query:c,as:d,resolvedAs:e,routeProps:f,locale:g,hasMiddleware:i,isPreview:j,unstable_skipClientCache:l,isQueryUpdating:n,isMiddlewareRewrite:o,isNotFound:p}){let q=a;try{let a=this.components[q];if(f.shallow&&a&&this.route===q)return a;let k=V({route:q,router:this});i&&(a=void 0);let r=!a||"initial"in a?void 0:a,s={dataHref:this.pageLoader.getDataHref({href:(0,t.formatWithValidation)({pathname:b,query:c}),skipInterpolation:!0,asPath:p?"/404":e,locale:g}),hasMiddleware:!0,isServerRender:this.isSsr,parseJSON:!0,inflightCache:n?this.sbc:this.sdc,persistCache:!j,isPrefetch:!1,unstable_skipClientCache:l,isBackground:n},u=n&&!o?null:await P({fetchData:()=>S(s),asPath:p?"/404":e,locale:g,router:this}).catch(a=>{if(n)return null;throw a});if(u&&("/_error"===b||"/404"===b)&&(u.effect=void 0),n&&(u?u.json=self.__NEXT_DATA__.props:u={json:self.__NEXT_DATA__.props}),k(),u?.effect?.type==="redirect-internal"||u?.effect?.type==="redirect-external")return u.effect;if(u?.effect?.type==="rewrite"){let d=(0,h.removeTrailingSlash)(u.effect.resolvedHref),g=await this.pageLoader.getPageList();if((!n||g.includes(d))&&(q=d,b=u.effect.resolvedHref,c={...c,...u.effect.parsedAs.query},e=(0,x.removeBasePath)((0,m.normalizeLocalePath)(u.effect.parsedAs.pathname,this.locales).pathname),a=this.components[q],f.shallow&&a&&this.route===q&&!i))return{...a,route:q}}if((0,B.isAPIRoute)(q))return U({url:d,router:this}),new Promise(()=>{});let v=r||await this.fetchComponent(q).then(a=>({Component:a.page,styleSheets:a.styleSheets,__N_SSG:a.mod.__N_SSG,__N_SSP:a.mod.__N_SSP})),w=u?.response?.headers.get("x-middleware-skip"),y=v.__N_SSG||v.__N_SSP;w&&u?.dataHref&&delete this.sdc[u.dataHref];let{props:z,cacheKey:A}=await this._getData(async()=>{if(y){if(u?.json&&!w)return{cacheKey:u.cacheKey,props:u.json};let a=u?.dataHref?u.dataHref:this.pageLoader.getDataHref({href:(0,t.formatWithValidation)({pathname:b,query:c}),asPath:e,locale:g}),d=await S({dataHref:a,isServerRender:this.isSsr,parseJSON:!0,inflightCache:w?{}:this.sdc,persistCache:!j,isPrefetch:!1,unstable_skipClientCache:l});return{cacheKey:d.cacheKey,props:d.json||{}}}return{headers:{},props:await this.getInitialProps(v.Component,{pathname:b,query:c,asPath:d,locale:g,locales:this.locales,defaultLocale:this.defaultLocale})}});return v.__N_SSP&&s.dataHref&&A&&delete this.sdc[A],this.isPreview||!v.__N_SSG||n||S(Object.assign({},s,{isBackground:!0,persistCache:!1,inflightCache:this.sbc})).catch(()=>{}),z.pageProps=Object.assign({},z.pageProps),v.props=z,v.route=q,v.query=c,v.resolvedAs=e,this.components[q]=v,v}catch(a){return this.handleRouteInfoError((0,k.getProperError)(a),b,c,d,f)}}set(a,b,c){return this.state=a,this.sub(b,this.components["/_app"].Component,c)}beforePopState(a){this._bps=a}onlyAHashChange(a){if(!this.asPath)return!1;let[b,c]=this.asPath.split("#",2),[d,e]=a.split("#",2);return!!e&&b===d&&c===e||b===d&&c!==e}scrollToHash(a){let[,b=""]=a.split("#",2);(0,I.disableSmoothScrollDuringRouteTransition)(()=>{if(""===b||"top"===b)return void window.scrollTo(0,0);let a=decodeURIComponent(b),c=document.getElementById(a);if(c)return void c.scrollIntoView();let d=document.getElementsByName(a)[0];d&&d.scrollIntoView()},{onlyHashChange:this.onlyAHashChange(a)})}urlIsNew(a){return this.asPath!==a}async prefetch(a,b=a,c={}){let d=(0,q.parseRelativeUrl)(a),e=d.pathname,{pathname:f,query:g}=d,i=f,j=await this.pageLoader.getPageList(),k=b,l=void 0!==c.locale?c.locale||void 0:this.locale,m=await L({asPath:b,locale:l,router:this});d.pathname=O(d.pathname,j),(0,p.isDynamicRoute)(d.pathname)&&(f=d.pathname,d.pathname=f,Object.assign(g,(0,r.getRouteMatcher)((0,s.getRouteRegex)(d.pathname))((0,u.parsePath)(b).pathname)||{}),m||(a=(0,t.formatWithValidation)(d)));let n=await P({fetchData:()=>S({dataHref:this.pageLoader.getDataHref({href:(0,t.formatWithValidation)({pathname:i,query:g}),skipInterpolation:!0,asPath:k,locale:l}),hasMiddleware:!0,isServerRender:!1,parseJSON:!0,inflightCache:this.sdc,persistCache:!this.isPreview,isPrefetch:!0}),asPath:b,locale:l,router:this});if(n?.effect.type==="rewrite"&&(d.pathname=n.effect.resolvedHref,f=n.effect.resolvedHref,g={...g,...n.effect.parsedAs.query},k=n.effect.parsedAs.pathname,a=(0,t.formatWithValidation)(d)),n?.effect.type==="redirect-external")return;let o=(0,h.removeTrailingSlash)(f);await this._bfl(b,k,c.locale,!0)&&(this.components[e]={__appRouter:!0}),await Promise.all([this.pageLoader._isSsg(o).then(b=>!!b&&S({dataHref:n?.json?n?.dataHref:this.pageLoader.getDataHref({href:a,asPath:k,locale:l}),isServerRender:!1,parseJSON:!0,inflightCache:this.sdc,persistCache:!this.isPreview,isPrefetch:!0,unstable_skipClientCache:c.unstable_skipClientCache||c.priority&&!0}).then(()=>!1).catch(()=>!1)),this.pageLoader[c.priority?"loadPage":"prefetch"](o)])}async fetchComponent(a){let b=V({route:a,router:this});try{let c=await this.pageLoader.loadPage(a);return b(),c}catch(a){throw b(),a}}_getData(a){let b=!1,c=()=>{b=!0};return this.clc=c,a().then(a=>{if(c===this.clc&&(this.clc=null),b){let a=Object.defineProperty(Error("Loading initial props cancelled"),"__NEXT_ERROR_CODE",{value:"E405",enumerable:!1,configurable:!0});throw a.cancelled=!0,a}return a})}getInitialProps(a,b){let{Component:c}=this.components["/_app"],d=this._wrapApp(c);return b.AppTree=d,(0,o.loadGetInitialProps)(c,{AppTree:d,Component:a,router:this,ctx:b})}get route(){return this.state.route}get pathname(){return this.state.pathname}get query(){return this.state.query}get asPath(){return this.state.asPath}get locale(){return this.state.locale}get isFallback(){return this.state.isFallback}get isPreview(){return this.state.isPreview}}},269110,(a,b,c)=>{"use strict";b.exports=a.r(772984).vendored.contexts.RouterContext},733668,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return f}}),a.r(5218);let d=a.r(508171);a.r(127669);let e=a.r(770332);function f(a){function b(b){return(0,d.jsx)(a,{router:(0,e.useRouter)(),...b})}return b.getInitialProps=a.getInitialProps,b.origGetInitialProps=a.origGetInitialProps,b}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},770332,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={Router:function(){return h.default},createRouter:function(){return r},default:function(){return p},makePublicRouterInstance:function(){return s},useRouter:function(){return q},withRouter:function(){return k.default}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(5218),g=f._(a.r(127669)),h=f._(a.r(670036)),i=a.r(269110),j=f._(a.r(738072)),k=f._(a.r(733668)),l={router:null,readyCallbacks:[],ready(a){if(this.router)return a()}},m=["pathname","route","query","asPath","components","isFallback","basePath","locale","locales","defaultLocale","isReady","isPreview","isLocaleDomain","domainLocales"],n=["push","replace","reload","back","prefetch","beforePopState"];function o(){if(!l.router)throw Object.defineProperty(Error('No router instance found.\nYou should only use "next/router" on the client side of your app.\n'),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return l.router}Object.defineProperty(l,"events",{get:()=>h.default.events}),m.forEach(a=>{Object.defineProperty(l,a,{get:()=>o()[a]})}),n.forEach(a=>{l[a]=(...b)=>o()[a](...b)}),["routeChangeStart","beforeHistoryChange","routeChangeComplete","routeChangeError","hashChangeStart","hashChangeComplete"].forEach(a=>{l.ready(()=>{h.default.events.on(a,(...b)=>{let c=`on${a.charAt(0).toUpperCase()}${a.substring(1)}`;if(l[c])try{l[c](...b)}catch(a){console.error(`Error when running the Router event: ${c}`),console.error((0,j.default)(a)?`${a.message}
${a.stack}`:a+"")}})})});let p=l;function q(){let a=g.default.useContext(i.RouterContext);if(!a)throw Object.defineProperty(Error("NextRouter was not mounted. https://nextjs.org/docs/messages/next-router-not-mounted"),"__NEXT_ERROR_CODE",{value:"E509",enumerable:!1,configurable:!0});return a}function r(...a){return l.router=new h.default(...a),l.readyCallbacks.forEach(a=>a()),l.readyCallbacks=[],l.router}function s(a){let b={};for(let c of m){if("object"==typeof a[c]){b[c]=Object.assign(Array.isArray(a[c])?[]:{},a[c]);continue}b[c]=a[c]}return b.events=h.default.events,n.forEach(c=>{b[c]=(...b)=>a[c](...b)}),b}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},481592,(a,b,c)=>{b.exports=a.r(770332)},76868,a=>a.a(async(b,c)=>{try{let b=await a.y("clsx");a.n(b),c()}catch(a){c(a)}},!0),788626,(a,b,c)=>{"use strict";b.exports=a.r(772984).vendored.contexts.AppRouterContext},202619,(a,b,c)=>{"use strict";b.exports=a.r(772984).vendored.contexts.HooksClientContext},581376,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ReadonlyURLSearchParams",{enumerable:!0,get:function(){return e}});class d extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class e extends URLSearchParams{append(){throw new d}delete(){throw new d}set(){throw new d}sort(){throw new d}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},317376,(a,b,c)=>{"use strict";b.exports=a.r(772984).vendored.contexts.ServerInsertedHtml},872436,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={UnrecognizedActionError:function(){return f},unstable_isUnrecognizedActionError:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});class f extends Error{constructor(...a){super(...a),this.name="UnrecognizedActionError"}}function g(a){return!!(a&&"object"==typeof a&&a instanceof f)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},408511,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"RedirectStatusCode",{enumerable:!0,get:function(){return e}});var d,e=((d={})[d.SeeOther=303]="SeeOther",d[d.TemporaryRedirect=307]="TemporaryRedirect",d[d.PermanentRedirect=308]="PermanentRedirect",d);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},34338,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={REDIRECT_ERROR_CODE:function(){return h},RedirectType:function(){return i},isRedirectError:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(408511),h="NEXT_REDIRECT";var i=((d={}).push="push",d.replace="replace",d);function j(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,d]=b,e=b.slice(2,-2).join(";"),f=Number(b.at(-2));return c===h&&("replace"===d||"push"===d)&&"string"==typeof e&&!isNaN(f)&&f in g.RedirectStatusCode}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},676451,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getRedirectError:function(){return i},getRedirectStatusCodeFromError:function(){return n},getRedirectTypeFromError:function(){return m},getURLFromRedirectError:function(){return l},permanentRedirect:function(){return k},redirect:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(408511),g=a.r(34338),h=a.r(120635).actionAsyncStorage;function i(a,b,c=f.RedirectStatusCode.TemporaryRedirect){let d=Object.defineProperty(Error(g.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return d.digest=`${g.REDIRECT_ERROR_CODE};${b};${a};${c};`,d}function j(a,b){throw i(a,b??=h?.getStore()?.isAction?g.RedirectType.push:g.RedirectType.replace,f.RedirectStatusCode.TemporaryRedirect)}function k(a,b=g.RedirectType.replace){throw i(a,b,f.RedirectStatusCode.PermanentRedirect)}function l(a){return(0,g.isRedirectError)(a)?a.digest.split(";").slice(2,-2).join(";"):null}function m(a){if(!(0,g.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return a.digest.split(";",2)[1]}function n(a){if(!(0,g.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(a.digest.split(";").at(-2))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},7550,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={HTTPAccessErrorStatus:function(){return f},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return h},getAccessFallbackErrorTypeByStatus:function(){return k},getAccessFallbackHTTPStatus:function(){return j},isHTTPAccessFallbackError:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},g=new Set(Object.values(f)),h="NEXT_HTTP_ERROR_FALLBACK";function i(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===h&&g.has(Number(c))}function j(a){return Number(a.digest.split(";")[1])}function k(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},969349,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"notFound",{enumerable:!0,get:function(){return f}});let d=a.r(7550),e=`${d.HTTP_ERROR_FALLBACK_ERROR_CODE};404`;function f(){let a=Object.defineProperty(Error(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw a.digest=e,a}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},403508,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"forbidden",{enumerable:!0,get:function(){return d}}),a.r(7550).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},806253,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unauthorized",{enumerable:!0,get:function(){return d}}),a.r(7550).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},307326,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isHangingPromiseRejectionError:function(){return f},makeDevtoolsIOAwarePromise:function(){return l},makeHangingPromise:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===g}let g="HANGING_PROMISE_REJECTION";class h extends Error{constructor(a,b){super(`During prerendering, ${b} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${b} to a different context by using \`setTimeout\`, \`after\`, or similar functions you may observe this error and you should handle it in that context. This occurred at route "${a}".`),this.route=a,this.expression=b,this.digest=g}}let i=new WeakMap;function j(a,b,c){if(a.aborted)return Promise.reject(new h(b,c));{let d=new Promise((d,e)=>{let f=e.bind(null,new h(b,c)),g=i.get(a);if(g)g.push(f);else{let b=[f];i.set(a,b),a.addEventListener("abort",()=>{for(let a=0;a<b.length;a++)b[a]()},{once:!0})}});return d.catch(k),d}}function k(){}function l(a,b,c){return b.stagedRendering?b.stagedRendering.delayUntilStage(c,void 0,a):new Promise(b=>{setTimeout(()=>{b(a)},0)})}},596218,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isPostpone",{enumerable:!0,get:function(){return e}});let d=Symbol.for("react.postpone");function e(a){return"object"==typeof a&&null!==a&&a.$$typeof===d}},301321,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={BailoutToCSRError:function(){return g},isBailoutToCSRError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="BAILOUT_TO_CLIENT_SIDE_RENDERING";class g extends Error{constructor(a){super(`Bail out to client-side rendering: ${a}`),this.reason=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===f}},485389,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=a.r(7550),e=a.r(34338);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},262389,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DynamicServerError:function(){return g},isDynamicServerError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="DYNAMIC_SERVER_USAGE";class g extends Error{constructor(a){super(`Dynamic server usage: ${a}`),this.description=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&"string"==typeof a.digest&&a.digest===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},570007,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={StaticGenBailoutError:function(){return g},isStaticGenBailoutError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="NEXT_STATIC_GEN_BAILOUT";class g extends Error{constructor(...a){super(...a),this.code=f}}function h(a){return"object"==typeof a&&null!==a&&"code"in a&&a.code===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},721143,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={METADATA_BOUNDARY_NAME:function(){return f},OUTLET_BOUNDARY_NAME:function(){return h},ROOT_LAYOUT_BOUNDARY_NAME:function(){return i},VIEWPORT_BOUNDARY_NAME:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="__next_metadata_boundary__",g="__next_viewport_boundary__",h="__next_outlet_boundary__",i="__next_root_layout_boundary__"},3278,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={atLeastOneTask:function(){return h},scheduleImmediate:function(){return g},scheduleOnNextTick:function(){return f},waitAtLeastOneReactRenderTask:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a=>{Promise.resolve().then(()=>{process.nextTick(a)})},g=a=>{setImmediate(a)};function h(){return new Promise(a=>g(a))}function i(){return new Promise(a=>setImmediate(a))}},35098,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},865460,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={RenderStage:function(){return i},StagedRenderingController:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(307498),h=a.r(35098);var i=((d={})[d.Static=1]="Static",d[d.Runtime=2]="Runtime",d[d.Dynamic=3]="Dynamic",d);class j{constructor(a=null){this.abortSignal=a,this.currentStage=1,this.runtimeStagePromise=(0,h.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,h.createPromiseWithResolvers)(),a&&a.addEventListener("abort",()=>{let{reason:b}=a;this.currentStage<2&&(this.runtimeStagePromise.promise.catch(k),this.runtimeStagePromise.reject(b)),this.currentStage<3&&(this.dynamicStagePromise.promise.catch(k),this.dynamicStagePromise.reject(b))},{once:!0})}advanceStage(a){!(this.currentStage>=a)&&(this.currentStage=a,a>=2&&this.runtimeStagePromise.resolve(),a>=3&&this.dynamicStagePromise.resolve())}getStagePromise(a){switch(a){case 2:return this.runtimeStagePromise.promise;case 3:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new g.InvariantError(`Invalid render stage: ${a}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(a){return this.getStagePromise(a)}delayUntilStage(a,b,c){var d,e,f;let g,h=(d=this.getStagePromise(a),e=b,f=c,g=new Promise((a,b)=>{d.then(a.bind(null,f),b)}),void 0!==e&&(g.displayName=e),g);return this.abortSignal&&h.catch(k),h}}function k(){}},887289,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={Postpone:function(){return D},PreludeState:function(){return Z},abortAndThrowOnSynchronousRequestDataAccess:function(){return C},abortOnSynchronousPlatformIOAccess:function(){return A},accessedDynamicData:function(){return L},annotateDynamicAccess:function(){return Q},consumeDynamicAccess:function(){return M},createDynamicTrackingState:function(){return t},createDynamicValidationState:function(){return u},createHangingInputAbortSignal:function(){return P},createRenderInBrowserAbortSignal:function(){return O},delayUntilRuntimeStage:function(){return aa},formatDynamicAPIAccesses:function(){return N},getFirstDynamicReason:function(){return v},isDynamicPostpone:function(){return G},isPrerenderInterruptedError:function(){return K},logDisallowedDynamicError:function(){return $},markCurrentScopeAsDynamic:function(){return w},postponeWithTracking:function(){return E},throwIfDisallowedDynamic:function(){return _},throwToInterruptStaticGeneration:function(){return x},trackAllowedDynamicAccess:function(){return Y},trackDynamicDataInDynamicRender:function(){return y},trackSynchronousPlatformIOAccessInDev:function(){return B},useDynamicRouteParams:function(){return R},useDynamicSearchParams:function(){return S}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});let h=(d=a.r(127669))&&d.__esModule?d:{default:d},i=a.r(262389),j=a.r(570007),k=a.r(832319),l=a.r(556704),m=a.r(307326),n=a.r(721143),o=a.r(3278),p=a.r(301321),q=a.r(307498),r=a.r(865460),s="function"==typeof h.default.unstable_postpone;function t(a){return{isDebugDynamicAccesses:a,dynamicAccesses:[],syncDynamicErrorWithStack:null}}function u(){return{hasSuspenseAboveBody:!1,hasDynamicMetadata:!1,hasDynamicViewport:!1,hasAllowedDynamic:!1,dynamicErrors:[]}}function v(a){var b;return null==(b=a.dynamicAccesses[0])?void 0:b.expression}function w(a,b,c){if(b)switch(b.type){case"cache":case"unstable-cache":case"private-cache":return}if(!a.forceDynamic&&!a.forceStatic){if(a.dynamicShouldError)throw Object.defineProperty(new j.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${c}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(b)switch(b.type){case"prerender-ppr":return E(a.route,c,b.dynamicTracking);case"prerender-legacy":b.revalidate=0;let d=Object.defineProperty(new i.DynamicServerError(`Route ${a.route} couldn't be rendered statically because it used ${c}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E550",enumerable:!1,configurable:!0});throw a.dynamicUsageDescription=c,a.dynamicUsageStack=d.stack,d}}}function x(a,b,c){let d=Object.defineProperty(new i.DynamicServerError(`Route ${b.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.revalidate=0,b.dynamicUsageDescription=a,b.dynamicUsageStack=d.stack,d}function y(a){switch(a.type){case"cache":case"unstable-cache":case"private-cache":return}}function z(a,b,c){let d=J(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`);c.controller.abort(d);let e=c.dynamicTracking;e&&e.dynamicAccesses.push({stack:e.isDebugDynamicAccesses?Error().stack:void 0,expression:b})}function A(a,b,c,d){let e=d.dynamicTracking;z(a,b,d),e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}function B(a){a.stagedRendering&&a.stagedRendering.advanceStage(r.RenderStage.Dynamic)}function C(a,b,c,d){if(!1===d.controller.signal.aborted){z(a,b,d);let e=d.dynamicTracking;e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}throw J(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`)}function D({reason:a,route:b}){let c=k.workUnitAsyncStorage.getStore();E(b,a,c&&"prerender-ppr"===c.type?c.dynamicTracking:null)}function E(a,b,c){(function(){if(!s)throw Object.defineProperty(Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E224",enumerable:!1,configurable:!0})})(),c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:b}),h.default.unstable_postpone(F(a,b))}function F(a,b){return`Route ${a} needs to bail out of prerendering at this point because it used ${b}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`}function G(a){return"object"==typeof a&&null!==a&&"string"==typeof a.message&&H(a.message)}function H(a){return a.includes("needs to bail out of prerendering at this point because it used")&&a.includes("Learn more: https://nextjs.org/docs/messages/ppr-caught-error")}if(!1===H(F("%%%","^^^")))throw Object.defineProperty(Error("Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E296",enumerable:!1,configurable:!0});let I="NEXT_PRERENDER_INTERRUPTED";function J(a){let b=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return b.digest=I,b}function K(a){return"object"==typeof a&&null!==a&&a.digest===I&&"name"in a&&"message"in a&&a instanceof Error}function L(a){return a.length>0}function M(a,b){return a.dynamicAccesses.push(...b.dynamicAccesses),a.dynamicAccesses}function N(a){return a.filter(a=>"string"==typeof a.stack&&a.stack.length>0).map(({expression:a,stack:b})=>(b=b.split("\n").slice(4).filter(a=>!(a.includes("node_modules/next/")||a.includes(" (<anonymous>)")||a.includes(" (node:"))).join("\n"),`Dynamic API Usage Debug - ${a}:
${b}`))}function O(){let a=new AbortController;return a.abort(Object.defineProperty(new p.BailoutToCSRError("Render in Browser"),"__NEXT_ERROR_CODE",{value:"E721",enumerable:!1,configurable:!0})),a.signal}function P(a){switch(a.type){case"prerender":case"prerender-runtime":let b=new AbortController;if(a.cacheSignal)a.cacheSignal.inputReady().then(()=>{b.abort()});else{let c=(0,k.getRuntimeStagePromise)(a);c?c.then(()=>(0,o.scheduleOnNextTick)(()=>b.abort())):(0,o.scheduleOnNextTick)(()=>b.abort())}return b.signal;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":return}}function Q(a,b){let c=b.dynamicTracking;c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:a})}function R(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b&&c)switch(c.type){case"prerender-client":case"prerender":{let d=c.fallbackRouteParams;d&&d.size>0&&h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break}case"prerender-ppr":{let d=c.fallbackRouteParams;if(d&&d.size>0)return E(b.route,a,c.dynamicTracking);break}case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called during a runtime prerender. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E771",enumerable:!1,configurable:!0});case"cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0})}}function S(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b)switch(!c&&(0,k.throwForMissingRequestStore)(a),c.type){case"prerender-client":h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break;case"prerender-legacy":case"prerender-ppr":if(b.forceStatic)return;throw Object.defineProperty(new p.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called from a Server Component. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E795",enumerable:!1,configurable:!0});case"cache":case"unstable-cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0});case"request":return}}let T=/\n\s+at Suspense \(<anonymous>\)/,U=RegExp(`\\n\\s+at Suspense \\(<anonymous>\\)(?:(?!\\n\\s+at (?:body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6) \\(<anonymous>\\))[\\s\\S])*?\\n\\s+at ${n.ROOT_LAYOUT_BOUNDARY_NAME} \\([^\\n]*\\)`),V=RegExp(`\\n\\s+at ${n.METADATA_BOUNDARY_NAME}[\\n\\s]`),W=RegExp(`\\n\\s+at ${n.VIEWPORT_BOUNDARY_NAME}[\\n\\s]`),X=RegExp(`\\n\\s+at ${n.OUTLET_BOUNDARY_NAME}[\\n\\s]`);function Y(a,b,c,d){if(!X.test(b)){if(V.test(b)){c.hasDynamicMetadata=!0;return}if(W.test(b)){c.hasDynamicViewport=!0;return}if(U.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(T.test(b)){c.hasAllowedDynamic=!0;return}else{var e,f;let g;if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let h=(e=`Route "${a.route}": Uncached data was accessed outside of <Suspense>. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route`,f=b,(g=Object.defineProperty(Error(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})).stack=g.name+": "+e+f,g);return void c.dynamicErrors.push(h)}}}var Z=((e={})[e.Full=0]="Full",e[e.Empty=1]="Empty",e[e.Errored=2]="Errored",e);function $(a,b){console.error(b),a.dev||(a.hasReadableErrorStacks?console.error(`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.`):console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:
  - Start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.
  - Rerun the production build with \`next build --debug-prerender\` to generate better stack traces.`))}function _(a,b,c,d){if(d.syncDynamicErrorWithStack)throw $(a,d.syncDynamicErrorWithStack),new j.StaticGenBailoutError;if(0!==b){if(c.hasSuspenseAboveBody)return;let d=c.dynamicErrors;if(d.length>0){for(let b=0;b<d.length;b++)$(a,d[b]);throw new j.StaticGenBailoutError}if(c.hasDynamicViewport)throw console.error(`Route "${a.route}" has a \`generateViewport\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`),new j.StaticGenBailoutError;if(1===b)throw console.error(`Route "${a.route}" did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`),new j.StaticGenBailoutError}else if(!1===c.hasAllowedDynamic&&c.hasDynamicMetadata)throw console.error(`Route "${a.route}" has a \`generateMetadata\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`),new j.StaticGenBailoutError}function aa(a,b){return a.runtimeStagePromise?a.runtimeStagePromise.then(()=>b):b}},664460,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return function a(b){if((0,g.isNextRouterError)(b)||(0,f.isBailoutToCSRError)(b)||(0,i.isDynamicServerError)(b)||(0,h.isDynamicPostpone)(b)||(0,e.isPostpone)(b)||(0,d.isHangingPromiseRejectionError)(b)||(0,h.isPrerenderInterruptedError)(b))throw b;b instanceof Error&&"cause"in b&&a(b.cause)}}});let d=a.r(307326),e=a.r(596218),f=a.r(301321),g=a.r(485389),h=a.r(887289),i=a.r(262389);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},817236,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return d}});let d=a.r(664460).unstable_rethrow;("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},102263,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ReadonlyURLSearchParams:function(){return f.ReadonlyURLSearchParams},RedirectType:function(){return h.RedirectType},forbidden:function(){return j.forbidden},notFound:function(){return i.notFound},permanentRedirect:function(){return g.permanentRedirect},redirect:function(){return g.redirect},unauthorized:function(){return k.unauthorized},unstable_isUnrecognizedActionError:function(){return m},unstable_rethrow:function(){return l.unstable_rethrow}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(581376),g=a.r(676451),h=a.r(34338),i=a.r(969349),j=a.r(403508),k=a.r(806253),l=a.r(817236);function m(){throw Object.defineProperty(Error("`unstable_isUnrecognizedActionError` can only be used on the client."),"__NEXT_ERROR_CODE",{value:"E776",enumerable:!1,configurable:!0})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},189640,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ReadonlyURLSearchParams:function(){return m.ReadonlyURLSearchParams},RedirectType:function(){return m.RedirectType},ServerInsertedHTMLContext:function(){return k.ServerInsertedHTMLContext},forbidden:function(){return m.forbidden},notFound:function(){return m.notFound},permanentRedirect:function(){return m.permanentRedirect},redirect:function(){return m.redirect},unauthorized:function(){return m.unauthorized},unstable_isUnrecognizedActionError:function(){return l.unstable_isUnrecognizedActionError},unstable_rethrow:function(){return m.unstable_rethrow},useParams:function(){return s},usePathname:function(){return q},useRouter:function(){return r},useSearchParams:function(){return p},useSelectedLayoutSegment:function(){return u},useSelectedLayoutSegments:function(){return t},useServerInsertedHTML:function(){return k.useServerInsertedHTML}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(522298)._(a.r(127669)),g=a.r(788626),h=a.r(202619),i=a.r(406598),j=a.r(581376),k=a.r(317376),l=a.r(872436),m=a.r(102263),n=a.r(887289).useDynamicRouteParams,o=a.r(887289).useDynamicSearchParams;function p(){o?.("useSearchParams()");let a=(0,f.useContext)(h.SearchParamsContext);return(0,f.useMemo)(()=>a?new j.ReadonlyURLSearchParams(a):null,[a])}function q(){return n?.("usePathname()"),(0,f.useContext)(h.PathnameContext)}function r(){let a=(0,f.useContext)(g.AppRouterContext);if(null===a)throw Object.defineProperty(Error("invariant expected app router to be mounted"),"__NEXT_ERROR_CODE",{value:"E238",enumerable:!1,configurable:!0});return a}function s(){return n?.("useParams()"),(0,f.useContext)(h.PathParamsContext)}function t(a="children"){n?.("useSelectedLayoutSegments()");let b=(0,f.useContext)(g.LayoutRouterContext);return b?(0,i.getSelectedLayoutSegmentPath)(b.parentTree,a):null}function u(a="children"){n?.("useSelectedLayoutSegment()"),(0,f.useContext)(h.NavigationPromisesContext);let b=t(a);return(0,i.computeSelectedLayoutSegment)(b,a)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},667180,(a,b,c)=>{b.exports=a.r(189640)},12382,a=>{"use strict";let b=a=>{let b=navigator.userAgent;if(a?.isAndroidApp){let a=b.match(/Chrome\/([0-9.]+)/);return a?`WebView ${a[1]}`:"Android WebView"}if(a?.isIOSApp){let a=b.match(/AppleWebKit\/([0-9.]+)/);return a?`WebView ${a[1]}`:"iOS WebView"}if(a?.isMacOSApp){let a=b.match(/AppleWebKit\/([0-9.]+)/);return a?`WebView ${a[1]}`:"macOS WebView"}if(a?.appPlatform==="tauri"&&a?.osPlatform==="windows"){let a=b.match(/Edg\/([0-9.]+)/);return a?`Edge ${a[1]}`:"Edge WebView2"}if(a?.appPlatform==="tauri"&&a?.osPlatform==="linux"){let a=b.match(/AppleWebKit\/([0-9.]+)/);return a?`WebView ${a[1]}`:"Linux WebView"}else if(b.includes("CriOS")&&b.includes("Mobile/")&&b.includes("Safari")){let a=b.match(/CriOS\/([0-9.]+)/);return a?`Chrome ${a[1]}`:"iOS Chrome"}else if(b.includes("FxiOS")&&b.includes("Mobile/")&&b.includes("Safari")){let a=b.match(/FxiOS\/([0-9.]+)/);return a?`Firefox ${a[1]}`:"iOS Firefox"}else if(b.includes("Chrome")&&b.includes("AppleWebKit")&&b.includes("Macintosh")){let a=b.match(/Chrome\/([0-9.]+)/);return a?`Chrome ${a[1]}`:"macOS Chrome"}else if(b.includes("Safari")&&b.includes("AppleWebKit")&&b.includes("Macintosh")){let a=b.match(/Safari\/([0-9.]+)/);return a?`Safari ${a[1]}`:"macOS Safari"}else if(b.includes("Edg/")){let a=b.match(/Edg\/([0-9.]+)/);return a?`Edge ${a[1]}`:"Edge WebView"}else if(b.includes("Firefox/")){let a=b.match(/Firefox\/([0-9.]+)/);return a?`Firefox ${a[1]}`:"Firefox Gecko"}else if(b.includes("Chrome/")&&!b.includes("Chromium")){let a=b.match(/Chrome\/([0-9.]+)/);return a?`Chrome ${a[1]}`:"Chrome"}else if(b.includes("Chromium/")){let a=b.match(/Chromium\/([0-9.]+)/);return a?`Chromium ${a[1]}`:"Chromium"}else{if(!b.includes("MSIE "))return"Unknown";let a=b.match(/MSIE ([0-9.]+)/);return a?`IE ${a[1]}`:"Internet Explorer"}};a.s(["parseWebViewInfo",0,b,"parseWebViewVersion",0,a=>{let c=b(a).match(/([0-9]+)\./);return c?parseFloat(c[1]):0}])},786654,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(162650),g=a.i(866736),h=a.i(713551),i=a.i(545251),j=a.i(465863),k=a.i(12382),l=b([f,g,h]);[f,g,h]=l.then?(await l)():l,a.s(["useTheme",0,({systemUIVisible:a=!0,appThemeColor:b="base-100"}={})=>{let{appService:c}=(0,e.useEnv)(),{settings:l}=(0,g.useSettingsStore)(),{themeColor:m,isDarkMode:n,isEinkMode:o,showSystemUI:p,dismissSystemUI:q,updateAppTheme:r,setStatusBarHeight:s,systemUIAlwaysHidden:t,setSystemUIAlwaysHidden:u}=(0,f.useThemeStore)(),v=(0,d.useRef)(!1);(0,d.useEffect)(()=>{r(b),c?.isAndroidApp&&(0,i.getStatusBarHeight)().then(a=>{a.height&&a.height>0&&s(a.height/window.devicePixelRatio)})},[c?.isAndroidApp]);let w=(0,d.useCallback)(()=>{if(!c?.isMobileApp)return;let b=!!(a&&!t);b?p():q(),(0,i.setSystemUIVisibility)({visible:b,darkMode:n})},[c,n,a]);(0,d.useEffect)(()=>{c?.isMobileApp&&w()},[w]),(0,d.useEffect)(()=>{if(!c?.isMobileApp)return;w();let a=()=>{"visible"===document.visibilityState&&w()},b=()=>{if(c?.isIOSApp&&"ios"===(0,j.getOSPlatform)()){let a=screen.orientation?.type.includes("landscape");u(a),w()}};return document.addEventListener("visibilitychange",a),screen.orientation?.addEventListener("change",b),()=>{document.removeEventListener("visibilitychange",a),screen.orientation?.removeEventListener("change",b)}},[w]),(0,d.useEffect)(()=>{c?.isAndroidApp&&(v.current=111>(0,k.parseWebViewVersion)(c))},[c]),(0,d.useEffect)(()=>{m&&h.themes.find(a=>a.name===m)&&v.current&&(0,h.applyCustomTheme)(void 0,m,!0)},[m]),(0,d.useEffect)(()=>{let a=l.globalReadSettings?.customThemes??[];a.forEach(a=>{(0,h.applyCustomTheme)(a,void 0,v.current)}),localStorage.setItem("customThemes",JSON.stringify(a))},[l.globalReadSettings?.customThemes]),(0,d.useEffect)(()=>{let a=n?"dark":"light";document.documentElement.setAttribute("data-theme",`${m}-${a}`),document.documentElement.style.setProperty("color-scheme",a),document.documentElement.style.setProperty("--overlayer-highlight-opacity",o?"1.0":"0.3"),document.documentElement.style.setProperty("--overlayer-highlight-blend-mode",o?"difference":n?"lighten":"normal"),document.documentElement.style.setProperty("--bg-texture-blend-mode",n?"lighten":"multiply")},[m,n,o])}]),c()}catch(a){c(a)}},!1),163759,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=a.i(557469),f=a.i(654617),g=a.i(907105),h=b([d]);[d]=h.then?(await h)():h;let i=(0,d.create)((a,b)=>({library:[],isSyncing:!1,syncProgress:0,currentBookshelf:[],selectedBooks:new Set,groups:{},checkOpenWithBooks:(0,e.isTauriAppPlatform)(),checkLastOpenBooks:(0,e.isTauriAppPlatform)(),setIsSyncing:b=>a({isSyncing:b}),setSyncProgress:b=>a({syncProgress:b}),getVisibleLibrary:()=>b().library.filter(a=>!a.deletedAt),setCurrentBookshelf:b=>{a({currentBookshelf:b})},setCheckOpenWithBooks:b=>a({checkOpenWithBooks:b}),setCheckLastOpenBooks:b=>a({checkLastOpenBooks:b}),setLibrary:c=>{let{refreshGroups:d}=b();a({library:c}),d()},updateBook:async(c,d)=>{let e=await c.getAppService(),{library:f}=b(),g=f.findIndex(a=>a.hash===d.hash);-1!==g&&(f[g]=d),a({library:[...f]}),await e.saveLibraryBooks(f)},updateBooks:async(c,d)=>{if(!d?.length)return;let e=await c.getAppService(),{library:f,refreshGroups:g}=b(),h=Array.from(new Map([...f,...d].map(a=>[a.hash,a])).values());a({library:h}),g(),await e.saveLibraryBooks(h)},setSelectedBooks:b=>{a({selectedBooks:new Set(b)})},getSelectedBooks:()=>Array.from(b().selectedBooks),toggleSelectedBook:b=>{a(a=>{let c=new Set(a.selectedBooks);return c.has(b)?c.delete(b):c.add(b),{selectedBooks:c}})},refreshGroups:()=>{let{library:c}=b(),d={};c.forEach(a=>{if(a.groupName&&a.groupName!==f.BOOK_UNGROUPED_NAME&&!a.deletedAt){d[(0,g.md5Fingerprint)(a.groupName)]=a.groupName;let b=a.groupName.indexOf("/",0);for(;b>0;){let c=a.groupName.substring(0,b);d[(0,g.md5Fingerprint)(c)]=c,b=a.groupName.indexOf("/",b+1)}}}),a({groups:d})},addGroup:c=>{let d=c.trim();if(!d)throw Error("Group name cannot be empty");let e=(0,g.md5Fingerprint)(d),{groups:f}=b();return a({groups:{...f,[e]:d}}),{id:e,name:d}},getGroups:()=>{let{groups:a}=b();return Object.entries(a).map(([a,b])=>({id:a,name:b})).sort((a,b)=>a.name.localeCompare(b.name))},getGroupId:a=>{let{groups:c}=b(),d=Object.entries(c).find(([b,c])=>c===a)?.[0];return d||(0,g.md5Fingerprint)(a)},getGroupName:a=>b().groups[a],getParentPath:a=>{let b=a.lastIndexOf("/");return -1===b?"":a.slice(0,b)},getGroupsByParent:a=>{let{groups:c}=b(),d=[];return Object.entries(c).forEach(([c,e])=>{b().getParentPath(e)===(a||"")&&d.push({id:c,name:e})}),d}}));a.s(["useLibraryStore",0,i]),c()}catch(a){c(a)}},!1),127225,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(163759),g=a.i(866736),h=b([f,g]);[f,g]=h.then?(await h)():h,a.s(["useLibrary",0,()=>{let{envConfig:a}=(0,e.useEnv)(),{setLibrary:b}=(0,f.useLibraryStore)(),{setSettings:c}=(0,g.useSettingsStore)(),[h,i]=(0,d.useState)(!1),j=(0,d.useRef)(!1);return(0,d.useEffect)(()=>{j.current||(j.current=!0,(async()=>{let d=await a.getAppService(),e=await d.loadSettings();c(e),b(await d.loadLibraryBooks()),i(!0)})())},[]),{libraryLoaded:h}}]),c()}catch(a){c(a)}},!1),583840,a=>{"use strict";let b,c=null;function d(){return(null===c||0===c.byteLength)&&(c=new Uint8Array(b.memory.buffer)),c}let e=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});e.decode();let f=0;function g(a,b){var c;return a>>>=0,c=a,(f+=b)>=0x7ff00000&&((e=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0})).decode(),f=b),e.decode(d().subarray(c,c+b))}let h=0,i=new TextEncoder;function j(a,b,c){if(void 0===c){let c=i.encode(a),e=b(c.length,1)>>>0;return d().subarray(e,e+c.length).set(c),h=c.length,e}let e=a.length,f=b(e,1)>>>0,g=d(),j=0;for(;j<e;j++){let b=a.charCodeAt(j);if(b>127)break;g[f+j]=b}if(j!==e){0!==j&&(a=a.slice(j)),f=c(f,e,e=j+3*a.length,1)>>>0;let b=d().subarray(f+j,f+e);j+=i.encodeInto(a,b).written,f=c(f,e,j,1)>>>0}return h=j,f}function k(a,c){let d,e;try{let l=j(a,b.__wbindgen_malloc,b.__wbindgen_realloc),m=h,n=j(c,b.__wbindgen_malloc,b.__wbindgen_realloc),o=h,p=b.simplecc(l,m,n,o);var f,i=p[0],k=p[1];if(p[3]){let a;throw i=0,k=0,f=p[2],a=b.__wbindgen_externrefs.get(f),b.__externref_table_dealloc(f),a}return d=i,e=k,g(i,k)}finally{b.__wbindgen_free(d,e,1)}}"encodeInto"in i||(i.encodeInto=function(a,b){let c=i.encode(a);return b.set(c),{read:a.length,written:c.length}});let l=new Set(["basic","cors","default"]);async function m(a,b){if("function"==typeof Response&&a instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(a,b)}catch(b){if(a.ok&&l.has(a.type)&&"application/wasm"!==a.headers.get("Content-Type"))console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",b);else throw b}let c=await a.arrayBuffer();return await WebAssembly.instantiate(c,b)}{let c=await WebAssembly.instantiate(a,b);return c instanceof WebAssembly.Instance?{instance:c,module:a}:c}}async function n(d){let e;if(void 0!==b)return b;void 0!==d&&(Object.getPrototypeOf(d)===Object.prototype?{module_or_path:d}=d:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===d&&(d=new a.U(a.r(594060)));let f=((e={}).wbg={},e.wbg.__wbindgen_cast_2241b6af4c4b2941=function(a,b){return g(a,b)},e.wbg.__wbindgen_init_externref_table=function(){let a=b.__wbindgen_externrefs,c=a.grow(4);a.set(0,void 0),a.set(c+0,void 0),a.set(c+1,null),a.set(c+2,!0),a.set(c+3,!1)},e);("string"==typeof d||"function"==typeof Request&&d instanceof Request||"function"==typeof URL&&d instanceof URL)&&(d=fetch(d));let{instance:h,module:i}=await m(await d,f);return b=h.exports,n.__wbindgen_wasm_module=i,c=null,b.__wbindgen_start(),b}let o=!1,p=async()=>{o||(await n("/vendor/simplecc/simplecc_wasm_bg.wasm"),o=!0)},q={none:"none",s2t:"t2s",t2s:"s2t",s2tw:"tw2s",s2hk:"hk2s",s2twp:"tw2sp",tw2s:"s2tw",hk2s:"s2hk",tw2sp:"s2twp"},r=(a,b,c=!1)=>c?k(a,q[b]):k(a,b);a.s(["initSimpleCC",()=>p,"runSimpleCC",()=>r],583840)},123588,a=>{"use strict";var b=a.i(762774),c=a.i(583840);let d=(a,b)=>{for(let c of a){if(c.href===b)return[c];if(c.subitems){let a=d(c.subitems,b);if(a.length)return[c,...a]}}return[]},e=(a,c)=>{let d=0,e=a.length-1,g=null;for(;d<=e;){let h=Math.floor((d+e)/2),i=a[h],j=a[h].cfi||"",k=b.CFI.compare(j,c);if(0===k)return f(i,c)??i;k<0?(g=f(i,c)??i,d=h+1):e=h-1}return g},f=(a,b)=>a.subitems?.length?e(a.subitems,b):null,g=async(a,b,d)=>{let e=a?.toc||[];if(!e.length)return;d&&"none"!==d&&(await (0,c.initSimpleCC)(),h(e,d));let f=a?.sections||[];if(!f.length)return;let g=f.map(a=>"no"!=a.linear&&a.size>0?a.size:0),k=0,l=g.reduce((a,b)=>(a.push(k),k+=b,a),[]),m=l[l.length-1]||0;f.forEach((a,b)=>{a.location={current:Math.floor(l[b]/1500),next:Math.floor((l[b]+g[b])/1500),total:Math.floor(m/1500)}});let n=f.reduce((a,b)=>(a[b.id]=b,a),{});i(a,e,f,n),b&&j(e)},h=(a,b)=>{a.forEach(a=>{a.label&&(a.label=(0,c.runSimpleCC)(a.label,b)),a.subitems&&h(a.subitems,b)})},i=(a,b,c,d,e=0)=>(b.forEach(f=>{if(f.id??=e++,f.href){let e=a.splitTOCHref(f.href)[0],g=d[e];g&&(f.cfi=g.cfi,(e===f.href||b.length<=c.length)&&(f.location=g.location))}f.subitems&&(e=i(a,f.subitems,c,d,e))}),e),j=a=>{a.sort((a,b)=>a.location&&b.location?a.location.current-b.location.current:0)};a.s(["findParentPath",0,d,"findTocItemBS",0,e,"updateToc",0,g])},862871,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=a.i(163759),f=b([d,e]);[d,e]=f.then?(await f)():f;let g=(0,d.create)((a,b)=>({booksData:{},getBookData:a=>{let c=a.split("-")[0];return b().booksData[c]||null},clearBookData:b=>{let c=b.split("-")[0];a(a=>{let b={...a.booksData};return delete b[c],{booksData:b}})},getConfig:a=>{if(!a)return null;let c=a.split("-")[0];return b().booksData[c]?.config||null},setConfig:(b,c)=>{a(a=>{let d=b.split("-")[0],e=a.booksData[d]?.config||null;return e?(Object.assign(e,c),{booksData:{...a.booksData,[d]:{...a.booksData[d],config:e}}}):(console.warn("No config found for book",d),a)})},saveConfig:async(a,b,c,d)=>{let f=await a.getAppService(),{library:g,setLibrary:h}=e.useLibraryStore.getState(),i=g.findIndex(a=>a.hash===b.split("-")[0]);if(-1==i)return;let j=g.splice(i,1)[0];j.progress=c.progress,j.updatedAt=Date.now(),j.downloadedAt=j.downloadedAt||Date.now(),g.unshift(j),h([...g]),c.updatedAt=Date.now(),await f.saveBookConfig(j,c,d),await f.saveLibraryBooks(g)},updateBooknotes:(b,c)=>{let d;return a(a=>{let e=b.split("-")[0],f=a.booksData[e];if(!f)return a;let g=Array.from(new Map(c.map(a=>[`${a.id}-${a.type}-${a.cfi}`,a])).values());return d={...f.config,updatedAt:Date.now(),booknotes:g},{booksData:{...a.booksData,[e]:{...f,config:{...f.config,updatedAt:Date.now(),booknotes:g}}}}}),d}}));a.s(["useBookDataStore",0,g]),c()}catch(a){c(a)}},!1),466759,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=a.i(679496),f=a.i(762774),g=a.i(123588),h=a.i(936114),i=a.i(589911),j=a.i(654617),k=a.i(866736),l=a.i(862871),m=a.i(163759),n=a.i(465863),o=b([d,h,k,l,m]);[d,h,k,l,m]=o.then?(await o)():o;let p=(0,d.create)((a,b)=>({viewStates:{},bookKeys:[],hoveredBookKey:null,setBookKeys:b=>a({bookKeys:b}),setHoveredBookKey:b=>a({hoveredBookKey:b}),getView:a=>a&&b().viewStates[a]?.view||null,setView:(b,c)=>a(a=>({viewStates:{...a.viewStates,[b]:{...a.viewStates[b],view:c}}})),getViews:()=>Object.values(b().viewStates).map(a=>a.view),getViewsById:a=>{let{viewStates:c}=b();return Object.values(c).filter(b=>b.key&&b.key.startsWith(a)).map(a=>a.view)},clearViewState:b=>{a(a=>{let c={...a.viewStates};return delete c[b],{viewStates:c}})},getViewState:a=>b().viewStates[a]||null,initViewState:async(b,c,d,o=!0,p=!1)=>{let q=l.useBookDataStore.getState().booksData[c];a(a=>({viewStates:{...a.viewStates,[d]:{key:"",view:null,viewerKey:"",isPrimary:!1,loading:!0,inited:!1,error:null,progress:null,ribbonVisible:!1,ttsEnabled:!1,syncing:!1,gridInsets:null,viewSettings:null}}}));try{let r=await b.getAppService(),{settings:s}=k.useSettingsStore.getState(),{library:t}=m.useLibraryStore.getState(),u=t.find(a=>a.hash===c);if(!u)throw Error("Book not found");let v=q?.bookDoc,w=q?.file;v&&w&&!p||(w=(await r.loadBookContent(u)).file,console.log("Loading book",d),v=(await new f.DocumentLoader(w).open()).book);let x=await r.loadBookConfig(u,s);await (0,g.updateToc)(v,x.viewSettings?.sortedTOC??!1,x.viewSettings?.convertChineseVariant??"none"),v.metadata.title||(v.metadata.title=(0,i.getBaseFilename)(w.name)),u.sourceTitle=(0,h.formatTitle)(v.metadata.title),"string"==typeof v.metadata?.language&&v.metadata.language in j.SUPPORTED_LANGNAMES&&(v.metadata.language=j.SUPPORTED_LANGNAMES[v.metadata.language]);let y=(0,h.getPrimaryLanguage)(v.metadata.language);u.primaryLanguage=u.primaryLanguage??y,u.metadata=u.metadata??v.metadata,u.metaHash=(0,h.getMetadataHash)(v.metadata);let z=e.FIXED_LAYOUT_FORMATS.has(u.format);l.useBookDataStore.setState(a=>({booksData:{...a.booksData,[c]:{id:c,book:u,file:w,config:x,bookDoc:v,isFixedLayout:z}}}));let A=x.viewSettings,B=s.globalViewSettings;a(a=>({viewStates:{...a.viewStates,[d]:{...a.viewStates[d],key:d,view:null,viewerKey:`${d}-${(0,n.uniqueId)()}`,isPrimary:o,loading:!1,inited:!1,error:null,progress:null,ribbonVisible:!1,ttsEnabled:!1,syncing:!1,gridInsets:null,viewSettings:{...B,...A}}}}))}catch(b){throw console.error(b),a(a=>({viewStates:{...a.viewStates,[d]:{...a.viewStates[d],key:"",view:null,viewerKey:"",isPrimary:!1,loading:!1,inited:!1,error:"Failed to load book.",progress:null,ribbonVisible:!1,ttsEnabled:!1,syncing:!1,gridInsets:null,viewSettings:null}}})),b}},getViewSettings:a=>b().viewStates[a]?.viewSettings||null,setViewSettings:(c,d)=>{if(!c)return;let e=c.split("-")[0],f=l.useBookDataStore.getState().booksData[e],g=b().viewStates[c];g&&f&&(g.isPrimary&&l.useBookDataStore.setState(a=>({booksData:{...a.booksData,[e]:{...f,config:{...f.config,updatedAt:Date.now(),viewSettings:d}}}})),a(a=>({viewStates:{...a.viewStates,[c]:{...a.viewStates[c],viewSettings:d}}})))},getProgress:a=>b().viewStates[a]?.progress||null,setProgress:(b,c,d,e,f,g,h)=>a(a=>{let i=b.split("-")[0],j=l.useBookDataStore.getState().booksData[i],k=a.viewStates[b];if(!k||!j)return a;let n=j.isFixedLayout?e:f,o=[n.current+1,n.total],{library:p,setLibrary:q}=m.useLibraryStore.getState(),r=p.findIndex(a=>a.hash===i);if(-1!==r){let a=[...p],b=a[r];a[r]={...b,progress:o,updatedAt:Date.now()},q(a)}let s=j.config,t={...j.config,progress:o,location:c};return l.useBookDataStore.setState(a=>({booksData:{...a.booksData,[i]:{...j,config:k.isPrimary?t:s}}})),{viewStates:{...a.viewStates,[b]:{...k,progress:{...k.progress,location:c,sectionHref:d?.href,sectionLabel:d?.label,sectionId:d?.id,section:e,pageinfo:f,timeinfo:g,range:h}}}}}),setBookmarkRibbonVisibility:(b,c)=>a(a=>({viewStates:{...a.viewStates,[b]:{...a.viewStates[b],ribbonVisible:c}}})),setTTSEnabled:(b,c)=>a(a=>({viewStates:{...a.viewStates,[b]:{...a.viewStates[b],ttsEnabled:c}}})),setIsSyncing:(b,c)=>a(a=>({viewStates:{...a.viewStates,[b]:{...a.viewStates[b],syncing:c}}})),getGridInsets:a=>b().viewStates[a]?.gridInsets||{top:0,right:0,bottom:0,left:0},setGridInsets:(b,c)=>a(a=>({viewStates:{...a.viewStates,[b]:{...a.viewStates[b],gridInsets:c}}})),setViewInited:(b,c)=>a(a=>({viewStates:{...a.viewStates,[b]:{...a.viewStates[b],inited:c}}})),recreateViewer:(c,d)=>{let e=d.split("-")[0];b().initViewState(c,e,d,!0,!0).then(()=>{a(a=>({viewStates:{...a.viewStates,[d]:{...a.viewStates[d],viewerKey:`${d}-${(0,n.uniqueId)()}`}}}))})}}));a.s(["useReaderStore",0,p]),c()}catch(a){c(a)}},!1),715715,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=b([d]);[d]=e.then?(await e)():e;let f={searchTerm:"",searchResults:null,searchResultIndex:0,searchProgress:1},g={activeBooknoteType:null,booknoteResults:null,booknoteIndex:0},h=(0,d.create)((a,b)=>({sideBarBookKey:null,sideBarWidth:"",isSideBarVisible:!1,isSideBarPinned:!1,searchNavStates:{},booknotesNavStates:{},searchStatuses:{},getIsSideBarVisible:()=>b().isSideBarVisible,getSideBarWidth:()=>b().sideBarWidth,setSideBarBookKey:b=>a({sideBarBookKey:b}),setSideBarWidth:b=>a({sideBarWidth:b}),toggleSideBar:()=>a(a=>({isSideBarVisible:!a.isSideBarVisible})),toggleSideBarPin:()=>a(a=>({isSideBarPinned:!a.isSideBarPinned})),setSideBarVisible:b=>a({isSideBarVisible:b}),setSideBarPin:b=>a({isSideBarPinned:b}),getSearchStatus:a=>b().searchStatuses[a]||null,getSearchNavState:a=>b().searchNavStates[a]||f,setSearchTerm:(b,c)=>a(a=>({searchNavStates:{...a.searchNavStates,[b]:{...a.searchNavStates[b]||f,searchTerm:c}}})),setSearchResults:(b,c)=>a(a=>({searchNavStates:{...a.searchNavStates,[b]:{...a.searchNavStates[b]||f,searchResults:c}}})),setSearchResultIndex:(b,c)=>a(a=>({searchNavStates:{...a.searchNavStates,[b]:{...a.searchNavStates[b]||f,searchResultIndex:c}}})),setSearchProgress:(b,c)=>a(a=>({searchNavStates:{...a.searchNavStates,[b]:{...a.searchNavStates[b]||f,searchProgress:c}}})),clearSearch:b=>a(a=>({searchNavStates:{...a.searchNavStates,[b]:{...f}},searchStatuses:{...a.searchStatuses,[b]:"terminated"}})),setSearchStatus:(b,c)=>a(a=>({searchStatuses:{...a.searchStatuses,[b]:c}})),getBooknotesNavState:a=>b().booknotesNavStates[a]||g,setActiveBooknoteType:(b,c)=>a(a=>({booknotesNavStates:{...a.booknotesNavStates,[b]:{...a.booknotesNavStates[b]||g,activeBooknoteType:c}}})),setBooknoteResults:(b,c)=>a(a=>({booknotesNavStates:{...a.booknotesNavStates,[b]:{...a.booknotesNavStates[b]||g,booknoteResults:c}}})),setBooknoteIndex:(b,c)=>a(a=>({booknotesNavStates:{...a.booknotesNavStates,[b]:{...a.booknotesNavStates[b]||g,booknoteIndex:c}}})),clearBooknotesNav:b=>a(a=>({booknotesNavStates:{...a.booknotesNavStates,[b]:{...g}}}))}));a.s(["useSidebarStore",0,h]),c()}catch(a){c(a)}},!1),925426,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=b([d]);[d]=e.then?(await e)():e;let f=(0,d.create)((a,b)=>({notebookWidth:"",isNotebookVisible:!1,isNotebookPinned:!1,notebookNewAnnotation:null,notebookEditAnnotation:null,notebookAnnotationDrafts:{},getIsNotebookVisible:()=>b().isNotebookVisible,getNotebookWidth:()=>b().notebookWidth,setNotebookWidth:b=>a({notebookWidth:b}),toggleNotebook:()=>a(a=>({isNotebookVisible:!a.isNotebookVisible})),toggleNotebookPin:()=>a(a=>({isNotebookPinned:!a.isNotebookPinned})),setNotebookVisible:b=>a({isNotebookVisible:b}),setNotebookPin:b=>a({isNotebookPinned:b}),setNotebookNewAnnotation:b=>a({notebookNewAnnotation:b}),setNotebookEditAnnotation:b=>a({notebookEditAnnotation:b}),saveNotebookAnnotationDraft:(b,c)=>a(a=>({notebookAnnotationDrafts:{...a.notebookAnnotationDrafts,[b]:c}})),getNotebookAnnotationDraft:a=>b().notebookAnnotationDrafts[a]}));a.s(["useNotebookStore",0,f]),c()}catch(a){c(a)}},!1),765918,a=>{"use strict";let b=new class{syncListeners;asyncListeners;constructor(){this.syncListeners=new Map,this.asyncListeners=new Map}on(a,b){this.asyncListeners.has(a)||this.asyncListeners.set(a,new Set),this.asyncListeners.get(a).add(b)}off(a,b){this.asyncListeners.get(a)?.delete(b)}async dispatch(a,b){let c=this.asyncListeners.get(a);if(c){let d=new CustomEvent(a,{detail:b});for(let a of c)await a(d)}}onSync(a,b){this.syncListeners.has(a)||this.syncListeners.set(a,[]),this.syncListeners.get(a).push(b)}offSync(a,b){let c=this.syncListeners.get(a);c&&this.syncListeners.set(a,c.filter(a=>a!==b))}dispatchSync(a,b){let c=this.syncListeners.get(a);if(c){let d=new CustomEvent(a,{detail:b});for(let a of[...c].reverse())if(a(d))return!0}return!1}};a.s(["eventDispatcher",0,b])},108328,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=a.i(545251),f=a.i(765918),g=b([d]);[d]=g.then?(await g)():g;let h=a=>"VolumeUp"===a||"VolumeDown"===a?f.eventDispatcher.dispatch("native-key-down",{keyName:a}):"Back"===a&&f.eventDispatcher.dispatchSync("native-key-down",{keyName:a}),i=(0,d.create)((a,b)=>({volumeKeysIntercepted:!1,backKeyIntercepted:!1,volumeKeysInterceptionCount:0,backKeyInterceptionCount:0,acquireVolumeKeyInterception:()=>{let{volumeKeysInterceptionCount:c}=b();0==c&&(window.onNativeKeyDown=h,(0,e.interceptKeys)({volumeKeys:!0}),a({volumeKeysIntercepted:!0})),a({volumeKeysInterceptionCount:c+1})},releaseVolumeKeyInterception:()=>{let{volumeKeysInterceptionCount:c}=b();c<=1?((0,e.interceptKeys)({volumeKeys:!1}),a({volumeKeysIntercepted:!1,volumeKeysInterceptionCount:0})):a({volumeKeysInterceptionCount:c-1})},acquireBackKeyInterception:()=>{let{backKeyInterceptionCount:c}=b();0==c&&(window.onNativeKeyDown=h,(0,e.interceptKeys)({backKey:!0}),a({backKeyIntercepted:!0})),a({backKeyInterceptionCount:c+1})},releaseBackKeyInterception:()=>{let{backKeyInterceptionCount:c}=b();c<=1?((0,e.interceptKeys)({backKey:!1}),a({backKeyIntercepted:!1,backKeyInterceptionCount:0})):a({backKeyInterceptionCount:c-1})},listenToNativeTouchEvents:()=>{window.onNativeTouch=a=>f.eventDispatcher.dispatch("native-touch",a)},getScreenBrightness:async()=>(await (0,e.getScreenBrightness)()).brightness,setScreenBrightness:async a=>{await (0,e.setScreenBrightness)({brightness:a})}}));a.s(["useDeviceControlStore",0,i]),c()}catch(a){c(a)}},!1),254858,a=>{"use strict";var b=a.i(127669),c=a.i(662210),d=a.i(557469);a.s(["useScreenWakeLock",0,a=>{let e=(0,b.useRef)(null),f=(0,b.useRef)(null);(0,b.useEffect)(()=>{let b=async()=>{try{"wakeLock"in navigator&&(e.current=await navigator.wakeLock.request("screen"),e.current.addEventListener("release",()=>{e.current=null}),console.log("Wake lock acquired"))}catch(a){console.info("Failed to acquire wake lock:",a)}},g=()=>{e.current&&(e.current.release(),e.current=null,console.log("Wake lock released"))},h=()=>{document.hidden?g():b()};return a?b():e.current&&g(),(0,d.isWebAppPlatform)()&&a?document.addEventListener("visibilitychange",h):(0,d.isTauriAppPlatform)()&&a&&(f.current=(0,c.getCurrentWindow)().onFocusChanged(({payload:a})=>{a?b():g()})),()=>{g(),(0,d.isWebAppPlatform)()&&a&&document.removeEventListener("visibilitychange",h),f.current&&f.current.then(a=>a())}},[a])}])},915302,a=>{"use strict";a.i(70521);var b=a.i(127669);a.i(247637);var c=a.i(959805);a.s(["useTranslation",0,(a="translation")=>{let{t:d}=(0,c.useTranslation)(a);return(0,b.useCallback)((a,b={})=>d(a,{defaultValue:a,...b}),[d])}])},151537,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=b([d]);[d]=e.then?(await e)():e;let f=(0,d.create)((a,b)=>({transfers:{},isQueuePaused:!1,isTransferQueueOpen:!1,maxConcurrent:2,activeCount:0,setIsTransferQueueOpen:b=>a({isTransferQueueOpen:b}),addTransfer:(b,c,d,e=10,f=!1)=>{let g=`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,h={id:g,bookHash:b,bookTitle:c,type:d,status:"pending",progress:0,totalBytes:0,transferredBytes:0,transferSpeed:0,retryCount:0,maxRetries:3,createdAt:Date.now(),priority:e,isBackground:f};return a(a=>({transfers:{...a.transfers,[g]:h}})),g},removeTransfer:b=>{a(a=>{let{[b]:c,...d}=a.transfers;return{transfers:d}})},updateTransferProgress:(b,c,d,e,f)=>{a(a=>{let g=a.transfers[b];return g?{transfers:{...a.transfers,[b]:{...g,progress:c,transferredBytes:d,totalBytes:e,transferSpeed:f}}}:a})},setTransferStatus:(b,c,d)=>{a(a=>{let e=a.transfers[b];if(!e)return a;let f={status:c,error:d};return"in_progress"!==c||e.startedAt||(f.startedAt=Date.now()),("completed"===c||"failed"===c||"cancelled"===c)&&(f.completedAt=Date.now()),{transfers:{...a.transfers,[b]:{...e,...f}}}})},retryTransfer:b=>{a(a=>{let c=a.transfers[b];return c?{transfers:{...a.transfers,[b]:{...c,status:"pending",progress:0,transferredBytes:0,transferSpeed:0,error:void 0,startedAt:void 0,completedAt:void 0}}}:a})},incrementRetryCount:b=>{a(a=>{let c=a.transfers[b];return c?{transfers:{...a.transfers,[b]:{...c,retryCount:c.retryCount+1}}}:a})},pauseQueue:()=>a({isQueuePaused:!0}),resumeQueue:()=>a({isQueuePaused:!1}),clearCompleted:()=>{a(a=>{let b={};return Object.entries(a.transfers).forEach(([a,c])=>{"completed"!==c.status&&(b[a]=c)}),{transfers:b}})},clearFailed:()=>{a(a=>{let b={};return Object.entries(a.transfers).forEach(([a,c])=>{"failed"!==c.status&&"cancelled"!==c.status&&(b[a]=c)}),{transfers:b}})},clearAll:()=>a({transfers:{}}),getPendingTransfers:()=>Object.values(b().transfers).filter(a=>"pending"===a.status),getActiveTransfers:()=>Object.values(b().transfers).filter(a=>"in_progress"===a.status),getFailedTransfers:()=>Object.values(b().transfers).filter(a=>"failed"===a.status||"cancelled"===a.status),getCompletedTransfers:()=>Object.values(b().transfers).filter(a=>"completed"===a.status),getTransferByBookHash:(a,c)=>Object.values(b().transfers).find(b=>b.bookHash===a&&b.type===c&&["pending","in_progress"].includes(b.status)),getQueueStats:()=>{let a=Object.values(b().transfers);return{pending:a.filter(a=>"pending"===a.status).length,active:a.filter(a=>"in_progress"===a.status).length,completed:a.filter(a=>"completed"===a.status).length,failed:a.filter(a=>"failed"===a.status||"cancelled"===a.status).length,total:a.length}},setActiveCount:b=>a({activeCount:b}),restoreTransfers:(b,c)=>{let d={};Object.entries(b).forEach(([a,b])=>{"in_progress"===b.status?d[a]={...b,status:"pending",progress:0,transferredBytes:0,transferSpeed:0}:d[a]=b}),a({transfers:d,isQueuePaused:c})}}));a.s(["useTransferStore",0,f]),c()}catch(a){c(a)}},!1),621480,a=>a.a(async(b,c)=>{try{var d=a.i(151537),e=a.i(765918),f=b([d]);[d]=f.then?(await f)():f;let g="readest_transfer_queue";class h{static instance;appService=null;isProcessing=!1;abortControllers=new Map;isInitialized=!1;getLibrary=null;updateBook=null;_=null;constructor(){}static getInstance(){return h.instance||(h.instance=new h),h.instance}async initialize(a,b,c,d){this.isInitialized||(this.appService=a,this.getLibrary=b,this.updateBook=c,this._=d,await this.loadPersistedQueue(),this.isInitialized=!0,this.processQueue())}isReady(){return this.isInitialized&&null!==this.appService}queueUpload(a,b=10){if(!this.isReady())return console.warn("TransferManager not initialized"),null;let c=d.useTransferStore.getState(),e=c.getTransferByBookHash(a.hash,"upload");if(e)return e.id;let f=c.addTransfer(a.hash,a.title,"upload",b);return this.persistQueue(),this.processQueue(),f}queueDownload(a,b=10){if(!this.isReady())return console.warn("TransferManager not initialized"),null;let c=d.useTransferStore.getState(),e=c.getTransferByBookHash(a.hash,"download");if(e)return e.id;let f=c.addTransfer(a.hash,a.title,"download",b);return this.persistQueue(),this.processQueue(),f}queueDelete(a,b=10,c=!1){if(!this.isReady())return console.warn("TransferManager not initialized"),null;let e=d.useTransferStore.getState(),f=e.getTransferByBookHash(a.hash,"delete");if(f)return f.id;let g=e.addTransfer(a.hash,a.title,"delete",b,c);return this.persistQueue(),this.processQueue(),g}queueBatchUploads(a,b=10){return a.map(a=>this.queueUpload(a,b)).filter(a=>null!==a)}cancelTransfer(a){let b=this.abortControllers.get(a);b&&(b.abort(),this.abortControllers.delete(a)),d.useTransferStore.getState().setTransferStatus(a,"cancelled"),this.persistQueue()}retryTransfer(a){d.useTransferStore.getState().retryTransfer(a),this.persistQueue(),this.processQueue()}retryAllFailed(){let a=d.useTransferStore.getState();a.getFailedTransfers().forEach(b=>{a.retryTransfer(b.id)}),this.persistQueue(),this.processQueue()}pauseQueue(){d.useTransferStore.getState().pauseQueue(),this.persistQueue()}resumeQueue(){d.useTransferStore.getState().resumeQueue(),this.processQueue(),this.persistQueue()}async processQueue(){if(!this.isProcessing){this.isProcessing=!0;try{await this._processQueueInternal()}finally{this.isProcessing=!1}}}async _processQueueInternal(){let a=d.useTransferStore.getState();if(a.isQueuePaused)return;let b=a.getPendingTransfers(),c=a.getActiveTransfers().length,e=a.maxConcurrent-c;if(e<=0||0===b.length)return;let f=[...b].sort((a,b)=>a.priority!==b.priority?a.priority-b.priority:a.createdAt-b.createdAt).slice(0,e);await Promise.all(f.map(a=>this.executeTransfer(a)));let g=d.useTransferStore.getState();g.getPendingTransfers().length>0&&!g.isQueuePaused&&setTimeout(()=>this.processQueue(),100)}async executeTransfer(a){if(!this.appService||!this.getLibrary||!this.updateBook)return void console.error("TransferManager not properly initialized");let b=this._,c=d.useTransferStore.getState(),f=new AbortController;this.abortControllers.set(a.id,f),c.setTransferStatus(a.id,"in_progress"),c.setActiveCount(c.getActiveTransfers().length+1);try{let c=this.getLibrary().find(b=>b.hash===a.bookHash);if(!c)throw Error(b("Book not found in library"));if("upload"===a.type)throw Error(b("Upload functionality has been removed"));if("download"===a.type)throw Error(b("Download functionality has been removed"));"delete"===a.type&&(await this.appService.deleteBook(c,"cloud"),await this.updateBook(c));d.useTransferStore.getState().setTransferStatus(a.id,"completed");let f={upload:b("Book uploaded: {{title}}",{title:a.bookTitle}),download:b("Book downloaded: {{title}}",{title:a.bookTitle}),delete:b("Deleted cloud backup of the book: {{title}}",{title:a.bookTitle})};a.isBackground||e.eventDispatcher.dispatch("toast",{type:"info",timeout:2e3,message:f[a.type]})}catch(i){if(f.signal.aborted)return;let c=i instanceof Error?i.message:b("Unknown error"),g=d.useTransferStore.getState(),h=g.transfers[a.id];if(h&&h.retryCount<h.maxRetries){let b=2e3*Math.pow(2,h.retryCount);g.incrementRetryCount(a.id),g.setTransferStatus(a.id,"pending",`Retry ${h.retryCount+1}/${h.maxRetries}`),setTimeout(()=>{this.processQueue()},b)}else{if(c.includes("Not authenticated"))e.eventDispatcher.dispatch("toast",{type:"error",message:b("Please log in to continue")});else if(c.includes("Insufficient storage quota"))e.eventDispatcher.dispatch("toast",{type:"error",message:b("Insufficient storage quota")});else{let c={upload:b("Failed to upload book: {{title}}",{title:a.bookTitle}),download:b("Failed to download book: {{title}}",{title:a.bookTitle}),delete:b("Failed to delete cloud backup of the book: {{title}}",{title:a.bookTitle})};e.eventDispatcher.dispatch("toast",{type:"error",message:c[a.type]})}d.useTransferStore.getState().setTransferStatus(a.id,"failed",c)}}finally{this.abortControllers.delete(a.id);let b=d.useTransferStore.getState();b.setActiveCount(Math.max(0,b.getActiveTransfers().length)),this.persistQueue(),setTimeout(()=>this.processQueue(),100)}}async loadPersistedQueue(){try{if("undefined"==typeof localStorage)return;let a=localStorage.getItem(g);if(!a)return;let b=JSON.parse(a);d.useTransferStore.getState().restoreTransfers(b.transfers,b.isQueuePaused)}catch(a){console.error("Failed to load transfer queue:",a)}}persistQueue(){try{if("undefined"==typeof localStorage)return;let a=d.useTransferStore.getState(),b={transfers:a.transfers,isQueuePaused:a.isQueuePaused};localStorage.setItem(g,JSON.stringify(b))}catch(a){console.error("Failed to persist transfer queue:",a)}}}let i=h.getInstance();a.s(["transferManager",0,i]),c()}catch(a){c(a)}},!1),401798,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(915302),g=a.i(163759),h=a.i(151537),i=a.i(621480),j=b([g,h,i]);function k(a=!0,b=0){let{envConfig:c,appService:j}=(0,e.useEnv)(),l=(0,f.useTranslation)(),m=(0,h.useTransferStore)(a=>a.transfers),n=(0,h.useTransferStore)(a=>a.isQueuePaused),o=(0,h.useTransferStore)(a=>a.setIsTransferQueueOpen);(0,d.useEffect)(()=>{let d=async()=>{if(j&&c){let a=async a=>{await g.useLibraryStore.getState().updateBook(c,a)};await i.transferManager.initialize(j,()=>g.useLibraryStore.getState().library,a,l)}};a&&setTimeout(()=>{d()},b)},[j,c,a,b,l]);let p=(0,d.useCallback)((a,b)=>i.transferManager.queueUpload(a,b),[]),q=(0,d.useCallback)((a,b)=>i.transferManager.queueDownload(a,b),[]),r=(0,d.useCallback)((a,b)=>i.transferManager.queueBatchUploads(a,b),[]),s=(0,d.useCallback)(a=>{i.transferManager.cancelTransfer(a)},[]),t=(0,d.useCallback)(a=>{i.transferManager.retryTransfer(a)},[]),u=(0,d.useCallback)(()=>{i.transferManager.retryAllFailed()},[]),v=(0,d.useCallback)(()=>{i.transferManager.pauseQueue()},[]),w=(0,d.useCallback)(()=>{i.transferManager.resumeQueue()},[]),x=(0,d.useCallback)(()=>{h.useTransferStore.getState().clearCompleted()},[]),y=(0,d.useCallback)(()=>{h.useTransferStore.getState().clearFailed()},[]),z=(0,d.useCallback)(()=>{h.useTransferStore.getState().clearAll()},[]),A=(0,d.useCallback)((a,b)=>h.useTransferStore.getState().getTransferByBookHash(a,b),[]),B=(0,d.useMemo)(()=>{let a=Object.values(m);return{pending:a.filter(a=>"pending"===a.status).length,active:a.filter(a=>"in_progress"===a.status).length,completed:a.filter(a=>"completed"===a.status).length,failed:a.filter(a=>"failed"===a.status||"cancelled"===a.status).length,total:a.length}},[m]),C=(0,d.useMemo)(()=>Object.values(m).filter(a=>"pending"===a.status),[m]),D=(0,d.useMemo)(()=>Object.values(m).filter(a=>"in_progress"===a.status),[m]),E=(0,d.useMemo)(()=>Object.values(m).filter(a=>"failed"===a.status||"cancelled"===a.status),[m]),F=(0,d.useMemo)(()=>Object.values(m).filter(a=>"completed"===a.status),[m]),G=(0,d.useMemo)(()=>C.length>0||D.length>0,[C,D]);return{transfers:Object.values(m),isQueuePaused:n,stats:B,pendingTransfers:C,activeTransfers:D,failedTransfers:E,completedTransfers:F,hasActiveTransfers:G,setIsTransferQueueOpen:o,queueUpload:p,queueDownload:q,queueBatchUploads:r,cancelTransfer:s,retryTransfer:t,retryAllFailed:u,pauseQueue:v,resumeQueue:w,clearCompleted:x,clearFailed:y,clearAll:z,getTransferProgress:A}}[g,h,i]=j.then?(await j)():j,a.s(["useTransferQueue",()=>k]),c()}catch(a){c(a)}},!1),82033,a=>{"use strict";var b=a.i(177898);async function c(a,c){await (0,b.invoke)("plugin:opener|open_url",{url:a,with:c})}a.s(["openUrl",()=>c])},991959,a=>{"use strict";var b=a.i(82033),c=a.i(557469);a.s(["interceptWindowOpen",0,()=>{let a=window.open;globalThis.open=function(d,e,f){return(0,c.isTauriAppPlatform)()?((0,b.openUrl)(d?.toString()||""),null):a(d,e,f)}}])},201993,a=>{"use strict";var b=a.i(465863),c=a.i(589911),d=a.i(907105);let e=[{family:"Bitter",weights:"ital,wght@0,100..900;1,100..900"},{family:"Fira Code",weights:"wght@300..700"},{family:"Literata",weights:"ital,opsz,wght@0,7..72,200..900;1,7..72,200..900"},{family:"Merriweather",weights:"ital,opsz,wght@0,18..144,300..900;1,18..144,300..900"},{family:"Noto Sans",weights:"ital,wght@0,100..900;1,100..900"},{family:"Open Sans",weights:"ital,wght@0,300..800;1,300..800"},{family:"Roboto",weights:"ital,wght@0,100..900;1,100..900"},{family:"Roboto Slab",weights:"ital,wght@0,100..900;1,100..900"},{family:"Vollkorn",weights:"ital,wght@0,400..900;1,400..900"},{family:"PT Sans",weights:"ital,wght@0,400;0,700;1,400;1,700"},{family:"PT Serif",weights:"ital,wght@0,400;0,700;1,400;1,700"},{family:"PT Mono",weights:""}],f=[{family:"LXGW WenKai TC",weights:""},{family:"Noto Sans SC",weights:""},{family:"Noto Sans TC",weights:""},{family:"Noto Serif JP",weights:""}],g=async(a,c=!1)=>{let d=c||(0,b.isCJKEnv)(),g=((a=!1)=>{let b=`
  <!-- Preconnect to Google Fonts for faster DNS resolution and connection -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
`,c=`
  <!-- Preconnect to CJK font CDNs -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://ik.imagekit.io">
  <link rel="preconnect" href="https://db.onlinewebfonts.com">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  <link rel="dns-prefetch" href="https://ik.imagekit.io">
  <link rel="dns-prefetch" href="https://db.onlinewebfonts.com">
`;return a?b+c:b})(d);Array.from(new DOMParser().parseFromString(g,"text/html").head.children).forEach(b=>{if("LINK"===b.tagName){let c=a.createElement("link");c.rel=b.getAttribute("rel")||"",c.href=b.getAttribute("href")||"";let d=b.getAttribute("crossorigin");d&&(c.crossOrigin=d),a.head.firstChild?a.head.insertBefore(c,a.head.firstChild):a.head.appendChild(c)}});let h=`
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?${e.map(({family:a,weights:b})=>`family=${encodeURIComponent(a)}${b?`:${b}`:""}`).join("&")}&display=swap" crossorigin="anonymous">
`,i="";if(d&&(i=`
  @font-face {
    font-family: "FangSong";
    font-display: swap;
    src: local("Fang Song"), local("FangSong"), local("Noto Serif CJK"), local("Source Han Serif SC VF"), url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.eot");
    src: url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.eot?#iefix") format("embedded-opentype"),
    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.woff2") format("woff2"),
    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.woff") format("woff"),
    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.ttf") format("truetype"),
    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.svg#FangSong") format("svg");
  }
  @font-face {
    font-family: "Kaiti";
    font-display: swap;
    src: local("Kai"), local("KaiTi"), local("AR PL UKai"), local("LXGW WenKai GB Screen"), url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.eot");
    src: url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.eot?#iefix")format("embedded-opentype"),
    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.woff2")format("woff2"),
    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.woff")format("woff"),
    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.ttf")format("truetype"),
    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.svg#STKaiti")format("svg");
  }
  @font-face {
    font-family: "Heiti";
    font-display: swap;
    src: local("Hei"), local("SimHei"), local("WenQuanYi Zen Hei"), local("Source Han Sans SC VF"), url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.eot");
    src: url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.eot?#iefix")format("embedded-opentype"),
    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.woff2")format("woff2"),
    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.woff")format("woff"),
    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.ttf")format("truetype"),
    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.svg#WenQuanYi Micro Hei")format("svg");
  }
  @font-face {
    font-family: "XiHeiti";
    font-display: swap;
    src: local("PingFang SC"), local("Microsoft YaHei"), local("WenQuanYi Micro Hei"), local("FZHei-B01"), url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.eot");
    src: url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.eot?#iefix")format("embedded-opentype"),
    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.woff2")format("woff2"),
    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.woff")format("woff"),
    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.ttf")format("truetype"),
    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.svg#STHeiti J Light")format("svg");
}
`,h=`${h}

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/misans-webfont@1.0.4/misans-l3/misans-l3/result.min.css" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lxgw-wenkai-screen-web/1.520.0/lxgwwenkaigbscreen/result.css" crossorigin="anonymous" />
  <link rel='stylesheet' href='https://ik.imagekit.io/fonts131/packages/hwmct/dist/%E6%B1%87%E6%96%87%E6%98%8E%E6%9C%9D%E4%BD%93/result.css' crossorigin="anonymous" />
  <link rel='stylesheet' href='https://ik.imagekit.io/fonts131/packages/jhlst/dist/%E4%BA%AC%E8%8F%AF%E8%80%81%E5%AE%8B%E4%BD%93v2_002/result.css' crossorigin="anonymous" />
  <link rel='stylesheet' href='https://ik.imagekit.io/fonts131/packages/syst/dist/SourceHanSerifCN/result.css' crossorigin="anonymous" />
  <link rel='stylesheet' href='https://ik.imagekit.io/fonts131/packages/GuanKiapTsingKhai/dist/GuanKiapTsingKhai-T/result.css' crossorigin="anonymous" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?${f.map(({family:a,weights:b})=>`family=${encodeURIComponent(a)}${b?`:${b}`:""}`).join("&")}&display=swap" crossorigin="anonymous" />
`),i){let b=a.createElement("style");b.textContent=i,a.head.appendChild(b)}Array.from(new DOMParser().parseFromString(h,"text/html").head.children).forEach(b=>{if("LINK"===b.tagName){let c=a.createElement("link");c.rel=b.getAttribute("rel")||"",c.href=b.getAttribute("href")||"",c.crossOrigin=b.getAttribute("crossorigin")||"",a.head.appendChild(c)}})};function h(a){switch(a.toLowerCase().split(".").pop()){case"ttf":default:return"ttf";case"otf":return"otf";case"woff":return"woff";case"woff2":return"woff2"}}function i(a){return({ttf:"font/ttf",otf:"font/otf",woff:"font/woff",woff2:"font/woff2"})[a]||"font/ttf"}function j(a,b){let e=b?.name||(0,c.getFilename)(a).replace(/\.(ttf|otf|woff|woff2)$/i,"");return{id:(0,d.md5Fingerprint)(e),name:e,family:b?.family,style:b?.style,weight:b?.weight,variable:b?.variable,path:a}}a.s(["createCustomFont",()=>j,"getFontFormat",()=>h,"getMimeType",()=>i,"mountAdditionalFonts",0,g,"mountCustomFont",0,(a,b)=>{let c=`custom-font-${b.id}`,d=a.getElementById(c)||a.createElement("style");d.id=c,d.textContent=function(a){let b={ttf:"truetype",otf:"opentype",woff:"woff",woff2:"woff2"}[h(a.path)]||"truetype",c=(a.family||a.name).replace(/\s+/g," ").trim(),d=a.style||"normal",e=a.weight||400,f=a.variable||!1;if(!a.blobUrl)throw Error(`Blob URL not available for font: ${a.name}`);return`
    @font-face {
      font-family: "${c}";
      ${f?"":`font-style: ${d};`}
      ${f?"":`font-weight: ${e};`}
      src: url("${a.blobUrl}") format("${b}");
      font-display: swap;
    }
  `}(b),d.parentNode||a.head.appendChild(d)}])},521917,(a,b,c)=>{"use strict";function d({widthInt:a,heightInt:b,blurWidth:c,blurHeight:d,blurDataURL:e,objectFit:f}){let g=c?40*c:a,h=d?40*d:b,i=g&&h?`viewBox='0 0 ${g} ${h}'`:"";return`%3Csvg xmlns='http://www.w3.org/2000/svg' ${i}%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='${i?"none":"contain"===f?"xMidYMid":"cover"===f?"xMidYMid slice":"none"}' style='filter: url(%23b);' href='${e}'/%3E%3C/svg%3E`}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getImageBlurSvg",{enumerable:!0,get:function(){return d}})},34040,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={VALID_LOADERS:function(){return f},imageConfigDefault:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=["default","imgix","cloudinary","akamai","custom"],g={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},73252,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getImgProps",{enumerable:!0,get:function(){return i}}),a.r(734068);let d=a.r(521917),e=a.r(34040),f=["-moz-initial","fill","none","scale-down",void 0];function g(a){return void 0!==a.default}function h(a){return void 0===a?a:"number"==typeof a?Number.isFinite(a)?a:NaN:"string"==typeof a&&/^[0-9]+$/.test(a)?parseInt(a,10):NaN}function i({src:a,sizes:b,unoptimized:c=!1,priority:i=!1,preload:j=!1,loading:k,className:l,quality:m,width:n,height:o,fill:p=!1,style:q,overrideSrc:r,onLoad:s,onLoadingComplete:t,placeholder:u="empty",blurDataURL:v,fetchPriority:w,decoding:x="async",layout:y,objectFit:z,objectPosition:A,lazyBoundary:B,lazyRoot:C,...D},E){var F;let G,H,I,{imgConf:J,showAltText:K,blurComplete:L,defaultLoader:M}=E,N=J||e.imageConfigDefault;if("allSizes"in N)G=N;else{let a=[...N.deviceSizes,...N.imageSizes].sort((a,b)=>a-b),b=N.deviceSizes.sort((a,b)=>a-b),c=N.qualities?.sort((a,b)=>a-b);G={...N,allSizes:a,deviceSizes:b,qualities:c}}if(void 0===M)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let O=D.loader||M;delete D.loader,delete D.srcSet;let P="__next_img_default"in O;if(P){if("custom"===G.loader)throw Object.defineProperty(Error(`Image with src "${a}" is missing "loader" prop.
Read more: https://nextjs.org/docs/messages/next-image-missing-loader`),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let a=O;O=b=>{let{config:c,...d}=b;return a(d)}}if(y){"fill"===y&&(p=!0);let a={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[y];a&&(q={...q,...a});let c={responsive:"100vw",fill:"100vw"}[y];c&&!b&&(b=c)}let Q="",R=h(n),S=h(o);if((F=a)&&"object"==typeof F&&(g(F)||void 0!==F.src)){let b=g(a)?a.default:a;if(!b.src)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received ${JSON.stringify(b)}`),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!b.height||!b.width)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received ${JSON.stringify(b)}`),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(H=b.blurWidth,I=b.blurHeight,v=v||b.blurDataURL,Q=b.src,!p)if(R||S){if(R&&!S){let a=R/b.width;S=Math.round(b.height*a)}else if(!R&&S){let a=S/b.height;R=Math.round(b.width*a)}}else R=b.width,S=b.height}let T=!i&&!j&&("lazy"===k||void 0===k);(!(a="string"==typeof a?a:Q)||a.startsWith("data:")||a.startsWith("blob:"))&&(c=!0,T=!1),G.unoptimized&&(c=!0),P&&!G.dangerouslyAllowSVG&&a.split("?",1)[0].endsWith(".svg")&&(c=!0);let U=h(m),V=Object.assign(p?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:z,objectPosition:A}:{},K?{}:{color:"transparent"},q),W=L||"empty"===u?null:"blur"===u?`url("data:image/svg+xml;charset=utf-8,${(0,d.getImageBlurSvg)({widthInt:R,heightInt:S,blurWidth:H,blurHeight:I,blurDataURL:v||"",objectFit:V.objectFit})}")`:`url("${u}")`,X=f.includes(V.objectFit)?"fill"===V.objectFit?"100% 100%":"cover":V.objectFit,Y=W?{backgroundSize:X,backgroundPosition:V.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:W}:{},Z=function({config:a,src:b,unoptimized:c,width:d,quality:e,sizes:f,loader:g}){if(c)return{src:b,srcSet:void 0,sizes:void 0};let{widths:h,kind:i}=function({deviceSizes:a,allSizes:b},c,d){if(d){let c=/(^|\s)(1?\d?\d)vw/g,e=[];for(let a;a=c.exec(d);)e.push(parseInt(a[2]));if(e.length){let c=.01*Math.min(...e);return{widths:b.filter(b=>b>=a[0]*c),kind:"w"}}return{widths:b,kind:"w"}}return"number"!=typeof c?{widths:a,kind:"w"}:{widths:[...new Set([c,2*c].map(a=>b.find(b=>b>=a)||b[b.length-1]))],kind:"x"}}(a,d,f),j=h.length-1;return{sizes:f||"w"!==i?f:"100vw",srcSet:h.map((c,d)=>`${g({config:a,src:b,quality:e,width:c})} ${"w"===i?c:d+1}${i}`).join(", "),src:g({config:a,src:b,quality:e,width:h[j]})}}({config:G,src:a,unoptimized:c,width:R,quality:U,sizes:b,loader:O}),$=T?"lazy":k;return{props:{...D,loading:$,fetchPriority:w,width:R,height:S,decoding:x,className:l,style:{...V,...Y},sizes:Z.sizes,srcSet:Z.srcSet,src:r||Z.src},meta:{unoptimized:c,preload:j||i,placeholder:u,fill:p}}}},326439,(a,b,c)=>{"use strict";b.exports=a.r(772984).vendored.contexts.ImageConfigContext},87547,(a,b,c)=>{"use strict";function d(a,b){let c=a||75;return b?.qualities?.length?b.qualities.reduce((a,b)=>Math.abs(b-c)<Math.abs(a-c)?b:a,0):c}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"findClosestQuality",{enumerable:!0,get:function(){return d}})},113494,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return f}});let d=a.r(87547);function e({config:a,src:b,width:c,quality:e}){if(b.startsWith("/")&&b.includes("?")&&a.localPatterns?.length===1&&"**"===a.localPatterns[0].pathname&&""===a.localPatterns[0].search)throw Object.defineProperty(Error(`Image with src "${b}" is using a query string which is not configured in images.localPatterns.
Read more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns`),"__NEXT_ERROR_CODE",{value:"E871",enumerable:!1,configurable:!0});let f=(0,d.findClosestQuality)(e,a);return`${a.path}?url=${encodeURIComponent(b)}&w=${c}&q=${f}${b.startsWith("/_next/static/media/"),""}`}e.__next_img_default=!0;let f=e},600887,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(127669);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},13438,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"Image",{enumerable:!0,get:function(){return u}});let d=a.r(5218),e=a.r(522298),f=a.r(508171),g=e._(a.r(127669)),h=d._(a.r(456195)),i=d._(a.r(572285)),j=a.r(73252),k=a.r(34040),l=a.r(326439);a.r(734068);let m=a.r(269110),n=d._(a.r(113494)),o=a.r(600887),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0};function q(a,b,c,d,e,f,g){let h=a?.src;a&&a["data-loaded-src"]!==h&&(a["data-loaded-src"]=h,("decode"in a?a.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(a.parentElement&&a.isConnected){if("empty"!==b&&e(!0),c?.current){let b=new Event("load");Object.defineProperty(b,"target",{writable:!1,value:a});let d=!1,e=!1;c.current({...b,nativeEvent:b,currentTarget:a,target:a,isDefaultPrevented:()=>d,isPropagationStopped:()=>e,persist:()=>{},preventDefault:()=>{d=!0,b.preventDefault()},stopPropagation:()=>{e=!0,b.stopPropagation()}})}d?.current&&d.current(a)}}))}function r(a){return g.use?{fetchPriority:a}:{fetchpriority:a}}globalThis.__NEXT_IMAGE_IMPORTED=!0;let s=(0,g.forwardRef)(({src:a,srcSet:b,sizes:c,height:d,width:e,decoding:h,className:i,style:j,fetchPriority:k,placeholder:l,loading:m,unoptimized:n,fill:p,onLoadRef:s,onLoadingCompleteRef:t,setBlurComplete:u,setShowAltText:v,sizesInput:w,onLoad:x,onError:y,...z},A)=>{let B=(0,g.useCallback)(a=>{a&&(y&&(a.src=a.src),a.complete&&q(a,l,s,t,u,n,w))},[a,l,s,t,u,y,n,w]),C=(0,o.useMergedRef)(A,B);return(0,f.jsx)("img",{...z,...r(k),loading:m,width:e,height:d,decoding:h,"data-nimg":p?"fill":"1",className:i,style:j,sizes:c,srcSet:b,src:a,ref:C,onLoad:a=>{q(a.currentTarget,l,s,t,u,n,w)},onError:a=>{v(!0),"empty"!==l&&u(!0),y&&y(a)}})});function t({isAppRouter:a,imgAttributes:b}){let c={as:"image",imageSrcSet:b.srcSet,imageSizes:b.sizes,crossOrigin:b.crossOrigin,referrerPolicy:b.referrerPolicy,...r(b.fetchPriority)};return a&&h.default.preload?(h.default.preload(b.src,c),null):(0,f.jsx)(i.default,{children:(0,f.jsx)("link",{rel:"preload",href:b.srcSet?void 0:b.src,...c},"__nimg-"+b.src+b.srcSet+b.sizes)})}let u=(0,g.forwardRef)((a,b)=>{let c=(0,g.useContext)(m.RouterContext),d=(0,g.useContext)(l.ImageConfigContext),e=(0,g.useMemo)(()=>{let a=p||d||k.imageConfigDefault,b=[...a.deviceSizes,...a.imageSizes].sort((a,b)=>a-b),c=a.deviceSizes.sort((a,b)=>a-b),e=a.qualities?.sort((a,b)=>a-b);return{...a,allSizes:b,deviceSizes:c,qualities:e,localPatterns:d?.localPatterns}},[d]),{onLoad:h,onLoadingComplete:i}=a,o=(0,g.useRef)(h);(0,g.useEffect)(()=>{o.current=h},[h]);let q=(0,g.useRef)(i);(0,g.useEffect)(()=>{q.current=i},[i]);let[r,u]=(0,g.useState)(!1),[v,w]=(0,g.useState)(!1),{props:x,meta:y}=(0,j.getImgProps)(a,{defaultLoader:n.default,imgConf:e,blurComplete:r,showAltText:v});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s,{...x,unoptimized:y.unoptimized,placeholder:y.placeholder,fill:y.fill,onLoadRef:o,onLoadingCompleteRef:q,setBlurComplete:u,setShowAltText:w,sizesInput:a.sizes,ref:b}),y.preload?(0,f.jsx)(t,{isAppRouter:!c,imgAttributes:x}):null]})});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},595907,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={default:function(){return k},getImageProps:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(5218),g=a.r(73252),h=a.r(13438),i=f._(a.r(113494));function j(a){let{props:b}=(0,g.getImgProps)(a,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[a,c]of Object.entries(b))void 0===c&&delete b[a];return{props:b}}let k=h.Image},266602,(a,b,c)=>{b.exports=a.r(595907)},222488,(a,b,c)=>{b.exports=a.x("semver",()=>require("semver"))},471317,a=>{"use strict";var b=a.i(177898);class c extends b.Resource{constructor(a){super(a.rid),this.available=!0,this.currentVersion=a.currentVersion,this.version=a.version,this.date=a.date,this.body=a.body,this.rawJson=a.rawJson}async download(a,c){e(c);let d=new b.Channel;a&&(d.onmessage=a);let f=await (0,b.invoke)("plugin:updater|download",{onEvent:d,rid:this.rid,...c});this.downloadedBytes=new b.Resource(f)}async install(){if(!this.downloadedBytes)throw Error("Update.install called before Update.download");await (0,b.invoke)("plugin:updater|install",{updateRid:this.rid,bytesRid:this.downloadedBytes.rid}),this.downloadedBytes=void 0}async downloadAndInstall(a,c){e(c);let d=new b.Channel;a&&(d.onmessage=a),await (0,b.invoke)("plugin:updater|download_and_install",{onEvent:d,rid:this.rid,...c})}async close(){await this.downloadedBytes?.close(),await super.close()}}async function d(a){e(a);let d=await (0,b.invoke)("plugin:updater|check",{...a});return d?new c(d):null}function e(a){a?.headers&&(a.headers=Array.from(new Headers(a.headers).entries()))}a.s(["check",()=>d])},909551,a=>{"use strict";var b,c,d=a.i(864819),e=a.i(518231),f=a.i(177898),g=a.i(662210);function h(){return new k((0,g.getCurrentWindow)(),window.__TAURI_INTERNALS__.metadata.currentWebview.label,{skip:!0})}async function i(){return(0,f.invoke)("plugin:webview|get_all_webviews").then(a=>a.map(a=>new k(new g.Window(a.windowLabel,{skip:!0}),a.label,{skip:!0})))}let j=["tauri://created","tauri://error"];class k{constructor(a,b,c){this.window=a,this.label=b,this.listeners=Object.create(null),(null==c?void 0:c.skip)||(0,f.invoke)("plugin:webview|create_webview",{windowLabel:a.label,options:{...c,label:b}}).then(async()=>this.emit("tauri://created")).catch(async a=>this.emit("tauri://error",a))}static async getByLabel(a){var b;return null!=(b=(await i()).find(b=>b.label===a))?b:null}static getCurrent(){return h()}static async getAll(){return i()}async listen(a,b){return this._handleTauriEvent(a,b)?()=>{let c=this.listeners[a];c.splice(c.indexOf(b),1)}:(0,e.listen)(a,b,{target:{kind:"Webview",label:this.label}})}async once(a,b){return this._handleTauriEvent(a,b)?()=>{let c=this.listeners[a];c.splice(c.indexOf(b),1)}:(0,e.once)(a,b,{target:{kind:"Webview",label:this.label}})}async emit(a,b){if(j.includes(a)){for(let c of this.listeners[a]||[])c({event:a,id:-1,payload:b});return}return(0,e.emit)(a,b)}async emitTo(a,b,c){if(j.includes(b)){for(let a of this.listeners[b]||[])a({event:b,id:-1,payload:c});return}return(0,e.emitTo)(a,b,c)}_handleTauriEvent(a,b){return!!j.includes(a)&&(a in this.listeners?this.listeners[a].push(b):this.listeners[a]=[b],!0)}async position(){return(0,f.invoke)("plugin:webview|webview_position",{label:this.label}).then(a=>new d.PhysicalPosition(a))}async size(){return(0,f.invoke)("plugin:webview|webview_size",{label:this.label}).then(a=>new d.PhysicalSize(a))}async close(){return(0,f.invoke)("plugin:webview|webview_close",{label:this.label})}async setSize(a){return(0,f.invoke)("plugin:webview|set_webview_size",{label:this.label,value:a instanceof d.Size?a:new d.Size(a)})}async setPosition(a){return(0,f.invoke)("plugin:webview|set_webview_position",{label:this.label,value:a instanceof d.Position?a:new d.Position(a)})}async setFocus(){return(0,f.invoke)("plugin:webview|set_webview_focus",{label:this.label})}async setAutoResize(a){return(0,f.invoke)("plugin:webview|set_webview_auto_resize",{label:this.label,value:a})}async hide(){return(0,f.invoke)("plugin:webview|webview_hide",{label:this.label})}async show(){return(0,f.invoke)("plugin:webview|webview_show",{label:this.label})}async setZoom(a){return(0,f.invoke)("plugin:webview|set_webview_zoom",{label:this.label,value:a})}async reparent(a){return(0,f.invoke)("plugin:webview|reparent",{label:this.label,window:"string"==typeof a?a:a.label})}async clearAllBrowsingData(){return(0,f.invoke)("plugin:webview|clear_all_browsing_data")}async setBackgroundColor(a){return(0,f.invoke)("plugin:webview|set_webview_background_color",{color:a})}async onDragDropEvent(a){let b=await this.listen(e.TauriEvent.DRAG_ENTER,b=>{a({...b,payload:{type:"enter",paths:b.payload.paths,position:new d.PhysicalPosition(b.payload.position)}})}),c=await this.listen(e.TauriEvent.DRAG_OVER,b=>{a({...b,payload:{type:"over",position:new d.PhysicalPosition(b.payload.position)}})}),f=await this.listen(e.TauriEvent.DRAG_DROP,b=>{a({...b,payload:{type:"drop",paths:b.payload.paths,position:new d.PhysicalPosition(b.payload.position)}})}),g=await this.listen(e.TauriEvent.DRAG_LEAVE,b=>{a({...b,payload:{type:"leave"}})});return()=>{b(),f(),c(),g()}}}async function l(){return(0,f.invoke)("plugin:window|get_all_windows").then(a=>a.map(a=>new m(a,{skip:!0})))}class m{constructor(a,b={}){var c;this.label=a,this.listeners=Object.create(null),(null==b?void 0:b.skip)||(0,f.invoke)("plugin:webview|create_webview_window",{options:{...b,parent:"string"==typeof b.parent?b.parent:null==(c=b.parent)?void 0:c.label,label:a}}).then(async()=>this.emit("tauri://created")).catch(async a=>this.emit("tauri://error",a))}static async getByLabel(a){var b;let c=null!=(b=(await l()).find(b=>b.label===a))?b:null;return c?new m(c.label,{skip:!0}):null}static getCurrent(){return new m(h().label,{skip:!0})}static async getAll(){return l()}async listen(a,b){return this._handleTauriEvent(a,b)?()=>{let c=this.listeners[a];c.splice(c.indexOf(b),1)}:(0,e.listen)(a,b,{target:{kind:"WebviewWindow",label:this.label}})}async once(a,b){return this._handleTauriEvent(a,b)?()=>{let c=this.listeners[a];c.splice(c.indexOf(b),1)}:(0,e.once)(a,b,{target:{kind:"WebviewWindow",label:this.label}})}async setBackgroundColor(a){return(0,f.invoke)("plugin:window|set_background_color",{color:a}).then(()=>(0,f.invoke)("plugin:webview|set_webview_background_color",{color:a}))}}b=m,(Array.isArray(c=[g.Window,k])?c:[c]).forEach(a=>{Object.getOwnPropertyNames(a.prototype).forEach(c=>{var d;"object"==typeof b.prototype&&b.prototype&&c in b.prototype||Object.defineProperty(b.prototype,c,null!=(d=Object.getOwnPropertyDescriptor(a.prototype,c))?d:Object.create(null))})}),a.s(["WebviewWindow",()=>m],909551)},317841,a=>{"use strict";var b=a.i(177898);async function c(a=0){await (0,b.invoke)("plugin:process|exit",{code:a})}async function d(){await (0,b.invoke)("plugin:process|restart")}a.s(["exit",()=>c,"relaunch",()=>d])},826788,a=>{"use strict";var b=a.i(177898);class c{constructor(){this.eventListeners=Object.create(null)}addListener(a,b){return this.on(a,b)}removeListener(a,b){return this.off(a,b)}on(a,b){return a in this.eventListeners?this.eventListeners[a].push(b):this.eventListeners[a]=[b],this}once(a,b){let c=d=>{this.removeListener(a,c),b(d)};return this.addListener(a,c)}off(a,b){return a in this.eventListeners&&(this.eventListeners[a]=this.eventListeners[a].filter(a=>a!==b)),this}removeAllListeners(a){return a?delete this.eventListeners[a]:this.eventListeners=Object.create(null),this}emit(a,b){if(a in this.eventListeners){for(let c of this.eventListeners[a])c(b);return!0}return!1}listenerCount(a){return a in this.eventListeners?this.eventListeners[a].length:0}prependListener(a,b){return a in this.eventListeners?this.eventListeners[a].unshift(b):this.eventListeners[a]=[b],this}prependOnceListener(a,b){let c=d=>{this.removeListener(a,c),b(d)};return this.prependListener(a,c)}}class d{constructor(a){this.pid=a}async write(a){await (0,b.invoke)("plugin:shell|stdin_write",{pid:this.pid,buffer:a})}async kill(){await (0,b.invoke)("plugin:shell|kill",{cmd:"killChild",pid:this.pid})}}class e extends c{constructor(a,b=[],d){super(),this.stdout=new c,this.stderr=new c,this.program=a,this.args="string"==typeof b?[b]:b,this.options=d??{}}static create(a,b=[],c){return new e(a,b,c)}static sidecar(a,b=[],c){let d=new e(a,b,c);return d.options.sidecar=!0,d}async spawn(){let a=this.program,c=this.args,e=this.options;"object"==typeof c&&Object.freeze(c);let f=new b.Channel;return f.onmessage=a=>{switch(a.event){case"Error":this.emit("error",a.payload);break;case"Terminated":this.emit("close",a.payload);break;case"Stdout":this.stdout.emit("data",a.payload);break;case"Stderr":this.stderr.emit("data",a.payload)}},await (0,b.invoke)("plugin:shell|spawn",{program:a,args:c,options:e,onEvent:f}).then(a=>new d(a))}async execute(){let a=this.program,c=this.args,d=this.options;return"object"==typeof c&&Object.freeze(c),await (0,b.invoke)("plugin:shell|execute",{program:a,args:c,options:d})}}a.s(["Command",()=>e])},331554,a=>{"use strict";a.s(["ErrorCodes",0,{UNAUTHORIZED:"Unauthorized",DEEPL_API_ERROR:"DeepL API Error",DAILY_QUOTA_EXCEEDED:"Daily Quota Exceeded",INTERNAL_SERVER_ERROR:"Internal Server Error"}])},486736,a=>{"use strict";let b="translations",c={},d={},e=()=>new Promise((a,c)=>{if(!window.indexedDB){console.warn("IndexedDB not supported. Using in-memory cache only."),c(Error("IndexedDB not supported"));return}let d=indexedDB.open("TranslationCache",1);d.onerror=a=>{console.error("IndexedDB error:",a),c(Error("Could not open IndexedDB"))},d.onsuccess=b=>{a(b.target.result)},d.onupgradeneeded=a=>{let c=a.target.result;if(!c.objectStoreNames.contains(b)){let a=c.createObjectStore(b,{keyPath:"key"});a.createIndex("provider","provider",{unique:!1}),a.createIndex("timestamp","timestamp",{unique:!1})}}}),f=(a,b,c,d)=>`${d}:${b}:${c}:${a}`,g=async(a,g,h,i)=>{if(!a?.trim())return null;let j=f(a,g,h,i);if(c[j])return c[j];try{let a=await e(),f=a.transaction(b,"readonly"),g=f.objectStore(b).get(j);return new Promise(b=>{g.onsuccess=()=>{let a=g.result;a?(c[j]=a.translation,d[j]=a.timestamp,b(a.translation)):b(null)},g.onerror=()=>{b(null)},f.oncomplete=()=>{a.close()}})}catch(a){return console.error("Error accessing IndexedDB:",a),null}},h=async(a,g,h,i,j)=>{if(!a?.trim()||!g)return;let k=f(a,h,i,j),l=Date.now();c[k]=g,d[k]=l;try{let c=await e(),d=c.transaction(b,"readwrite");return d.objectStore(b).put({key:k,translation:g,timestamp:l,provider:j,sourceLang:h,targetLang:i,originalText:a}),new Promise((a,b)=>{d.oncomplete=()=>{c.close(),a()},d.onerror=a=>{console.error("Error storing in IndexedDB:",a),b(Error("Failed to store in IndexedDB"))}})}catch(a){console.error("Error accessing IndexedDB:",a)}};a.s(["getFromCache",0,g,"storeInCache",0,h])},243974,a=>{"use strict";let b={zh:a=>a.replace(/--/g,"").replace(/\s+([])/g,"$1").replace(/([])\s+/g,"$1"),es:a=>a.replace(/\?([A-Z])/g,"? $1").replace(/\!([A-Z])/g,"! $1"),fr:a=>a.replace(/\s+([!?:;])/g," $1").replace(/([!?:;])\s+/g,"$1 "),ja:a=>a.replace(/\s+([])/g,"$1").replace(/([])\s+/g,"$1")},c=a=>a.replace(/\s+/g," ").replace(/\s+([.,!?;:])/g,"$1").trim();function d(a,d){let e,f=(e=b[d.split("-")[0].toLowerCase()])?a=>e(c(a)):c;return a.map(f)}a.s(["polish",()=>d])},165638,a=>{"use strict";let b={Cover:"The Cover",Dedication:"Dedication Page",Acknowledgements:"The Acknowledgements"};function c(a,d={}){let e=function(a={}){return c=>{let d;return 0===Object.keys(d={...b,...a}).length?c:d[c]?d[c]:c}}(d);return a.map(e)}a.s(["preprocess",()=>c])},880021,a=>a.a(async(b,c)=>{try{var d=a.i(160745),e=b([d]);[d]=e.then?(await e)():e;let g=process.env.AUTH_SECRET||"dev-secret";process.env.AUTH_PASSWORD||Math.random().toString(36).substring(2,15);let h=new TextEncoder().encode(g);async function f(a){try{return(await (0,d.jwtVerify)(a,h)).payload}catch{return null}}a.s(["verifyJWT",()=>f]),c()}catch(a){c(a)}},!1),95114,a=>a.a(async(b,c)=>{try{var d=a.i(890392),e=a.i(465863),f=b([d]);[d]=f.then?(await f)():f,a.s(["getDailyUsage",0,a=>null,"isTranslationAvailable",0,(a,b)=>{if(!a||"PDF"===a.format)return!1;let c=a.primaryLanguage||"";return!(!c||"und"===c.toLowerCase()||b&&(0,d.isSameLang)(c,b)||!b&&(0,d.isSameLang)(c,(0,e.getLocale)()))},"saveDailyUsage",0,(a,b)=>{}]),c()}catch(a){c(a)}},!1),866816,a=>a.a(async(b,c)=>{try{var d=a.i(457492),e=a.i(880021);a.i(654617);var f=a.i(557469),g=a.i(95114),h=b([d,e,g]);[d,e,g]=h.then?(await h)():h;let i=async()=>(0,f.isWebAppPlatform)()?localStorage.getItem("token")??null:null;a.s(["getAccessToken",0,i,"getSubscriptionPlan",0,a=>((0,d.jwtDecode)(a)||{}).plan||"free"]),c()}catch(a){c(a)}},!1),276708,a=>a.a(async(b,c)=>{try{var d=a.i(557469),e=a.i(465863),f=a.i(331554),g=a.i(866816),h=a.i(890392),i=a.i(654617),j=a.i(95114),k=b([g,h,j]);[g,h,j]=k.then?(await k)():k;let l=(0,d.getAPIBaseUrl)()+"/deepl/translate",m={name:"deepl",label:(0,e.stubTranslation)("DeepL"),authRequired:!0,quotaExceeded:!1,translate:async(a,b,c,d,e=!1)=>{let k=m.authRequired,n={"Content-Type":"application/json"},o="free";if(d&&(o=(0,g.getSubscriptionPlan)(d),n.Authorization=`Bearer ${d}`),k&&!d)throw Error("Authentication token is required for DeepL translation");let p=JSON.stringify({text:a,source_lang:(0,h.normalizeToShortLang)(b).toUpperCase(),target_lang:(0,h.normalizeToShortLang)(c).toUpperCase(),use_cache:e}),q=i.DEFAULT_DAILY_TRANSLATION_QUOTA[o];try{let b=await fetch(l,{method:"POST",headers:n,body:p});if(!b.ok){let a=await b.json();if(a&&a.error&&a.error===f.ErrorCodes.DAILY_QUOTA_EXCEEDED)throw(0,j.saveDailyUsage)(q),m.quotaExceeded=!0,Error(f.ErrorCodes.DAILY_QUOTA_EXCEEDED);throw Error(`Translation failed with status ${b.status}`)}let c=await b.json();if(!c||!c.translations)throw Error("Invalid response from translation service");return a.map((a,b)=>{if(!a?.trim().length)return a;let d=c.translations?.[b];return d?.daily_usage&&((0,j.saveDailyUsage)(d.daily_usage),m.quotaExceeded=c.daily_usage>=q),d?.text||a})}catch(a){throw a}}};a.s(["deeplProvider",0,m]),c()}catch(a){c(a)}},!1),15275,a=>a.a(async(b,c)=>{try{var d=a.i(465863),e=a.i(579950),f=a.i(557469),g=a.i(890392),h=b([g]);[g]=h.then?(await h)():h;let i=null,j=async()=>{let a=Date.now();if(i&&i.expiresAt>a)return i.token;try{let b=(0,f.isTauriAppPlatform)()?e.fetch:window.fetch,c=await b("https://edge.microsoft.com/translate/auth",{method:"GET",headers:{"User-Agent":"Mozilla/5.0"}});if(!c.ok)throw Error(`Failed to get auth token: ${c.status}`);let d=await c.text();return i={token:d,expiresAt:a+48e4},d}catch(a){throw console.error("Error getting Microsoft translation auth token:",a),a}},k={name:"azure",label:(0,d.stubTranslation)("Azure Translator"),translate:async(a,b,c)=>{if(!a.length)return[];let d=[],h=b?(0,g.normalizeToFullLang)(b):"",i=(0,g.normalizeToFullLang)(c),k=a.map(async(a,b)=>{if(!a?.trim().length){d[b]=a;return}let c=new URLSearchParams({to:i,"api-version":"3.0"});h&&"auto"!==h.toLowerCase()&&c.append("from",h);let g=await j(),k=(0,f.isTauriAppPlatform)()?e.fetch:window.fetch,l=await k(`https://api-edge.cognitive.microsofttranslator.com/translate?${c.toString()}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify([{Text:a}])});if(!l.ok)throw Error(`Translation failed with status ${l.status}`);let m=await l.json();Array.isArray(m)&&m.length>0&&m[0].translations?d[b]=m[0].translations[0].text||a:d[b]=a});return await Promise.all(k),d}};a.s(["azureProvider",0,k]),c()}catch(a){c(a)}},!1),389668,a=>a.a(async(b,c)=>{try{var d=a.i(465863),e=a.i(579950),f=a.i(557469),g=a.i(890392),h=b([g]);[g]=h.then?(await h)():h;let i={name:"google",label:(0,d.stubTranslation)("Google Translate"),translate:async(a,b,c)=>{if(!a.length)return[];let d=[],h=a.map(async(a,h)=>{if(!a?.trim().length){d[h]=a;return}let i=new URL("https://translate.googleapis.com/translate_a/single");i.searchParams.append("client","gtx"),i.searchParams.append("dt","t"),i.searchParams.append("sl",(0,g.normalizeToShortLang)(b).toLowerCase()||"auto"),i.searchParams.append("tl",(0,g.normalizeToShortLang)(c).toLowerCase()),i.searchParams.append("q",a);let j=(0,f.isTauriAppPlatform)()?e.fetch:window.fetch,k=await j(i.toString());if(!k.ok)throw Error(`Translation failed with status ${k.status}`);let l=await k.json();if(Array.isArray(l)&&Array.isArray(l[0])){let b=l[0].filter(a=>Array.isArray(a)&&a[0]).map(a=>a[0]).join("");d[h]=b||a}else d[h]=a});return await Promise.all(h),d}};a.s(["googleProvider",0,i]),c()}catch(a){c(a)}},!1),362510,a=>a.a(async(b,c)=>{try{var d=a.i(465863),e=a.i(579950),f=a.i(557469),g=a.i(890392),h=b([g]);async function i(a,b,c){let d=(0,f.isTauriAppPlatform)()?e.fetch:window.fetch,g={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lang:b,service:c,text:a})},h=await d("https://translate.toil.cc/v2/translate/",g);if(!h.ok){let b=JSON.stringify(await h.json());throw Error(`${c} failed with status ${h.status}
${a.length}
${JSON.stringify(g)}
${b}`)}let i=await h.json();return i&&Array.isArray(i.translations)?i.translations:[a]}[g]=h.then?(await h)():h;let j={name:"yandex",label:(0,d.stubTranslation)("Yandex Translate"),authRequired:!1,translate:async(a,b,c)=>{if(!a.length)return[];let d="AUTO"==b?"en":(0,g.normalizeToShortLang)(b).toLowerCase(),e=(0,g.normalizeToShortLang)(c).toLowerCase(),f=`${d}-${e}`;return(await Promise.all(a.map(async a=>await i(a,f,"yandexgpt")))).flat()}};a.s(["yandexProvider",0,j]),c()}catch(a){c(a)}},!1),947334,a=>a.a(async(b,c)=>{try{var d=a.i(276708),e=a.i(15275),f=a.i(389668),g=a.i(362510),h=b([d,e,f,g]);function i(a,b){if(a!==b.name)throw Error(`Translator name "${a}" does not match implementation name "${b.name}"`);return b}[d,e,f,g]=h.then?(await h)():h;let j=i("deepl",d.deeplProvider),k=i("azure",e.azureProvider),l=i("google",f.googleProvider),m=i("yandex",g.yandexProvider),n=[j,k,l,m];a.s(["getTranslator",0,a=>n.find(b=>b.name===a),"getTranslators",0,()=>n]),c()}catch(a){c(a)}},!1),81402,a=>a.a(async(b,c)=>{try{a.i(331554),a.i(486736),a.i(243974),a.i(165638);var d=a.i(947334),e=b([d]);[d]=e.then?(await e)():e,a.s([]),c()}catch(a){c(a)}},!1),665647,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(77946),f=a.i(81402),g=a.i(331554),h=a.i(947334),i=a.i(486736),j=a.i(243974),k=a.i(165638),l=a.i(765918),m=a.i(465863),n=a.i(915302),o=b([f,h]);function p({provider:a="deepl",sourceLang:b="AUTO",targetLang:c="EN",enablePolishing:f=!0,enablePreprocessing:o=!0}={}){let q=(0,n.useTranslation)(),{token:r}=(0,e.useAuth)(),[s,t]=(0,d.useState)(!1),[u,v]=(0,d.useState)(a),[w,x]=(0,d.useState)(()=>(0,h.getTranslator)(a)),[y]=(0,d.useState)(()=>(0,h.getTranslators)());return(0,d.useEffect)(()=>{t(!1)},[a,b,c]),(0,d.useEffect)(()=>{let b=(0,h.getTranslators)().filter(a=>(!a.authRequired||!!r)&&!a.quotaExceeded),c=(b.find(b=>b.name===a)||b[0]).name;x((0,h.getTranslator)(c)),v(c)},[a]),{translate:(0,d.useCallback)(async(a,d)=>{let e=d?.source||b,h=d?.target||c||(0,m.getLocale)(),n=d?.useCache??!1,p=o?(0,k.preprocess)(a):a;if(0===p.length||p.every(a=>!a?.trim()))return p;let s=[],w=[];if(await Promise.all(p.map(async(a,b)=>{!a?.trim()||await (0,i.getFromCache)(a,e,h,u)||(s.push(a),w.push(b))})),0===s.length){let a=await Promise.all(p.map(a=>(0,i.getFromCache)(a,e,h,u).then(b=>b||a)));return f?(0,j.polish)(a,h):a}t(!0);try{let a=y.find(a=>a.name===u);if(!a)throw Error(`No translator found for provider: ${u}`);let b=await a.translate(s,e,h,r,n);await Promise.all(s.map(async(a,c)=>(0,i.storeInCache)(a,b[c]||"",e,h,u)));let c=[...p];return w.forEach((a,d)=>{c[a]=b[d]||""}),await Promise.all(c.map(async(a,b)=>{if(!w.includes(b)){let a=p[b];if(!a?.trim())return;let d=await (0,i.getFromCache)(a,e,h,u);d&&(c[b]=d)}})),t(!1),f?(0,j.polish)(c,h):c}catch(a){throw a instanceof Error&&a.message.includes(g.ErrorCodes.DAILY_QUOTA_EXCEEDED)&&(l.eventDispatcher.dispatch("toast",{timeout:5e3,message:q("Daily translation quota reached. Upgrade your plan to continue using AI translations."),type:"error"}),v("azure")),t(!1),a instanceof Error?a:Error(String(a))}},[u,b,c,w,r]),translator:w,translators:y,loading:s}}[f,h]=o.then?(await o)():o,a.s(["useTranslator",()=>p]),c()}catch(a){c(a)}},!1),268105,a=>{"use strict";var b=a.i(177898);let c=async(a,c,d,e,f,g,h)=>{let i=new Uint32Array(1);window.crypto.getRandomValues(i);let j=i[0],k=new b.Channel;return d&&(k.onmessage=d),await (0,b.invoke)("download_file",{id:j,url:a,filePath:c,headers:e??{},onProgress:k,body:f,singleThreaded:g,skipSslVerification:h})};a.s(["tauriDownload",0,c])},591509,a=>{"use strict";var b=a.i(127669),c={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},d=b.default.createContext&&b.default.createContext(c),e=["attr","size","title"];function f(){return(f=Object.assign.bind()).apply(this,arguments)}function g(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function h(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?g(Object(c),!0).forEach(function(b){var d,e,f;d=a,e=b,f=c[b],(e=function(a){var b=function(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==typeof b?b:b+""}(e))in d?Object.defineProperty(d,e,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[e]=f}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):g(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function i(a){return c=>b.default.createElement(j,f({attr:h({},a.attr)},c),function a(c){return c&&c.map((c,d)=>b.default.createElement(c.tag,h({key:d},c.attr),a(c.child)))}(a.child))}function j(a){var g=c=>{var d,{attr:g,size:i,title:j}=a,k=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){if(b.indexOf(d)>=0)continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(a,e),l=i||c.size||"1em";return c.className&&(d=c.className),a.className&&(d=(d?d+" ":"")+a.className),b.default.createElement("svg",f({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},c.attr,g,k,{className:d,style:h(h({color:a.color||c.color},c.style),a.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),j&&b.default.createElement("title",null,j),a.children)};return void 0!==d?b.default.createElement(d.Consumer,null,a=>g(a)):g(c)}a.s(["GenIcon",()=>i],591509)},547274,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9a9 9 0 0 0 0-18zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2zm0 15-5-2.18L7 18V5h10v13z"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(a)}function g(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M11 7h2v2h-2V7zm0 4h2v6h-2v-6zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"},child:[]}]})(a)}function h(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"},child:[]}]})(a)}function i(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"},child:[]}]})(a)}function j(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"},child:[]}]})(a)}function k(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.75 5h-1.5L9.5 16h2.1l.9-2.2h5l.9 2.2h2.1L15.75 5zm-2.62 7L15 6.98 16.87 12h-3.74zM6 19.75l3-3H7V4.25H5v12.5H3l3 3z"},child:[]}]})(a)}function l(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"},child:[]},{tag:"path",attr:{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"},child:[]}]})(a)}function m(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"},child:[]}]})(a)}function n(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"},child:[]}]})(a)}function o(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m4 18 8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"},child:[]}]})(a)}function p(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11 18V6l-8.5 6 8.5 6zm.5-6 8.5 6V6l-8.5 6z"},child:[]}]})(a)}function q(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"},child:[]}]})(a)}function r(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M8 5v14l11-7z"},child:[]}]})(a)}function s(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9.5 16.5v-9l7 4.5-7 4.5z"},child:[]}]})(a)}function t(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m6 18 8.5-6L6 6v12zM16 6v12h2V6h-2z"},child:[]}]})(a)}function u(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 6h2v12H6zm3.5 6 8.5 6V6z"},child:[]}]})(a)}function v(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(a)}function w(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3z"},child:[]}]})(a)}function x(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67 2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"},child:[]}]})(a)}function y(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(a)}function z(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"},child:[]}]})(a)}function A(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"},child:[]}]})(a)}function B(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},child:[]}]})(a)}function C(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(a)}function D(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 12c0 2.21.91 4.2 2.36 5.64L3 20h6v-6l-2.24 2.24A6.003 6.003 0 0 1 5 12a5.99 5.99 0 0 1 4-5.65V4.26C5.55 5.15 3 8.27 3 12zm8 5h2v-2h-2v2zM21 4h-6v6l2.24-2.24A6.003 6.003 0 0 1 19 12a5.99 5.99 0 0 1-4 5.65v2.09c3.45-.89 6-4.01 6-7.74 0-2.21-.91-4.2-2.36-5.64L21 4zm-10 9h2V7h-2v6z"},child:[]}]})(a)}function E(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46A7.93 7.93 0 0 0 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74A7.93 7.93 0 0 0 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"},child:[]}]})(a)}function F(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"},child:[]}]})(a)}function G(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"},child:[]}]})(a)}function H(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 11v6.97l-5-2.14-5 2.14V5h6V3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V11h-2zm4-4h-2v2h-2V7h-2V5h2V3h2v2h2v2z"},child:[]}]})(a)}function I(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"},child:[]}]})(a)}function J(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"},child:[]}]})(a)}function K(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"},child:[]}]})(a)}function L(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"},child:[]}]})(a)}function M(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m21 18-3-3v2H5v2h13v2l3-3zM9.5 11.8h5l.9 2.2h2.1L12.75 3h-1.5L6.5 14h2.1l.9-2.2zM12 4.98 13.87 10h-3.74L12 4.98z"},child:[]}]})(a)}function N(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},child:[]}]})(a)}function O(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M14 4v5c0 1.12.37 2.16 1 3H9c.65-.86 1-1.9 1-3V4h4m3-2H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3V4h1c.55 0 1-.45 1-1s-.45-1-1-1z"},child:[]}]})(a)}function P(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9.37 5.51A7.35 7.35 0 0 0 9.1 7.5c0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27A7.014 7.014 0 0 1 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"},child:[]}]})(a)}function Q(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 9c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3m0-2c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 0 0 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"},child:[]}]})(a)}function R(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M16.48 2.52c3.27 1.55 5.61 4.72 5.97 8.48h1.5C23.44 4.84 18.29 0 12 0l-.66.03 3.81 3.81 1.33-1.32zm-6.25-.77a1.49 1.49 0 0 0-2.12 0L1.75 8.11a1.49 1.49 0 0 0 0 2.12l12.02 12.02c.59.59 1.54.59 2.12 0l6.36-6.36c.59-.59.59-1.54 0-2.12L10.23 1.75zm4.6 19.44L2.81 9.17l6.36-6.36 12.02 12.02-6.36 6.36zm-7.31.29A10.487 10.487 0 0 1 1.55 13H.05C.56 19.16 5.71 24 12 24l.66-.03-3.81-3.81-1.33 1.32z"},child:[]}]})(a)}function S(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.11.5-.95A5.469 5.469 0 0 1 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5 1.53.11A2.98 2.98 0 0 1 22 15c0 1.65-1.35 3-3 3zm-5.55-8h-2.9v3H8l4 4 4-4h-2.55z"},child:[]}]})(a)}function T(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.11.5-.95A5.469 5.469 0 0 1 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5 1.53.11A2.98 2.98 0 0 1 22 15c0 1.65-1.35 3-3 3zM8 13h2.55v3h2.9v-3H16l-4-4z"},child:[]}]})(a)}function U(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 3a9 9 0 0 0-9 9v7c0 1.1.9 2 2 2h4v-8H5v-1c0-3.87 3.13-7 7-7s7 3.13 7 7v1h-4v8h4c1.1 0 2-.9 2-2v-7a9 9 0 0 0-9-9zM7 15v4H5v-4h2zm12 4h-2v-4h2v4z"},child:[]}]})(a)}function V(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19.03 3.56c-1.67-1.39-3.74-2.3-6.03-2.51v2.01c1.73.19 3.31.88 4.61 1.92l1.42-1.42zM11 3.06V1.05c-2.29.2-4.36 1.12-6.03 2.51l1.42 1.42A8.928 8.928 0 0 1 11 3.06zM4.98 6.39 3.56 4.97C2.17 6.64 1.26 8.71 1.05 11h2.01c.19-1.73.88-3.31 1.92-4.61zM20.94 11h2.01c-.21-2.29-1.12-4.36-2.51-6.03l-1.42 1.42A8.928 8.928 0 0 1 20.94 11zM7 12l3.44 1.56L12 17l1.56-3.44L17 12l-3.44-1.56L12 7l-1.56 3.44z"},child:[]},{tag:"path",attr:{d:"M12 21a8.96 8.96 0 0 1-7.46-4H7v-2H1v6h2v-2.7c1.99 2.84 5.27 4.7 9 4.7 4.87 0 9-3.17 10.44-7.56l-1.96-.45C19.25 18.48 15.92 21 12 21z"},child:[]}]})(a)}function W(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m14.06 9.02.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83a.996.996 0 0 0 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"},child:[]}]})(a)}function X(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},child:[]}]})(a)}function Y(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},child:[]}]})(a)}a.s(["MdAdd",()=>v,"MdAlarm",()=>c,"MdArrowBackIosNew",()=>z,"MdArrowForwardIos",()=>A,"MdBookmarkBorder",()=>d,"MdCheck",()=>B,"MdClose",()=>C,"MdDelete",()=>f,"MdDeleteOutline",()=>e,"MdEdit",()=>y,"MdError",()=>n,"MdFastForward",()=>o,"MdFastRewind",()=>p,"MdInfoOutline",()=>g,"MdLock",()=>i,"MdLockOpen",()=>h,"MdOutlineAutoMode",()=>V,"MdOutlineBookmark",()=>I,"MdOutlineBookmarkAdd",()=>H,"MdOutlineCheck",()=>X,"MdOutlineCloudDownload",()=>S,"MdOutlineCloudUpload",()=>T,"MdOutlineDarkMode",()=>P,"MdOutlineDelete",()=>J,"MdOutlineEdit",()=>W,"MdOutlineHeadphones",()=>U,"MdOutlineInfo",()=>K,"MdOutlineLightMode",()=>Q,"MdOutlineMenu",()=>Y,"MdOutlinePause",()=>N,"MdOutlinePushPin",()=>O,"MdOutlineScreenRotation",()=>R,"MdOutlineSearch",()=>L,"MdOutlineTextRotationNone",()=>M,"MdPauseCircle",()=>q,"MdPlayArrow",()=>r,"MdPlayCircle",()=>s,"MdPushPin",()=>w,"MdRadioButtonChecked",()=>F,"MdRadioButtonUnchecked",()=>G,"MdSaveAlt",()=>x,"MdSettings",()=>j,"MdSkipNext",()=>t,"MdSkipPrevious",()=>u,"MdSync",()=>E,"MdSyncProblem",()=>D,"MdTextRotateVertical",()=>k,"MdZoomIn",()=>l,"MdZoomOut",()=>m])},847656,a=>{"use strict";var b=a.i(127669);a.s(["useDrag",0,(a,c,d)=>{let e=(0,b.useRef)(!1),f=(0,b.useRef)(0),g=(0,b.useRef)(0),h=(0,b.useRef)(0),i=(0,b.useRef)(0),j=(0,b.useRef)(0);return{handleDragStart:(0,b.useCallback)(b=>{e.current=!0,"touches"in b?(g.current=b.touches[0].clientY,f.current=b.touches[0].clientX):(g.current=b.clientY,f.current=b.clientX),j.current=performance.now(),document.body.style.pointerEvents="none",document.body.style.userSelect="none",document.documentElement.style.cursor="col-resize";let c=b=>{if(e.current){let c=0,d=0,e=0,f=0;if("touches"in b&&b.touches.length>0){let a=b.touches[0];e=a.clientX,f=a.clientY}else e=b.clientX,f=b.clientY;c=e-h.current,d=f-i.current,h.current=e,i.current=f,a({clientX:e,clientY:f,deltaX:c,deltaY:d})}},k=a=>{e.current=!1,document.body.style.pointerEvents="",document.body.style.userSelect="",document.documentElement.style.cursor="";let b=0,h=0,i=0,l=0,m=performance.now()-j.current;if("touches"in a){let b=a.changedTouches[0];i=b.clientX,l=b.clientY}else i=a.clientX,l=a.clientY;b=i-f.current;let n=(h=l-g.current)/m;d&&d({velocity:n,deltaT:m,clientX:i,clientY:l,deltaX:b,deltaY:h}),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",k),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",k)};window.addEventListener("mousemove",c,{passive:!0}),window.addEventListener("mouseup",k),window.addEventListener("touchmove",c,{passive:!0}),window.addEventListener("touchend",k)},[a,d]),handleDragKeyDown:(0,b.useCallback)(a=>{switch(a.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":c({key:a.key,step:.02});break;default:return}a.preventDefault(),a.stopPropagation()},[c])}}])},556266,a=>{"use strict";var b=a.i(177898);a.i(518231);let{vibrate:c,impactFeedback:d,notificationFeedback:e,selectionFeedback:f}={async vibrate(a){try{return{status:"ok",data:await (0,b.invoke)("plugin:haptics|vibrate",{duration:a})}}catch(a){if(!(a instanceof Error))return{status:"error",error:a};throw a}},async impactFeedback(a){try{return{status:"ok",data:await (0,b.invoke)("plugin:haptics|impact_feedback",{style:a})}}catch(a){if(!(a instanceof Error))return{status:"error",error:a};throw a}},async notificationFeedback(a){try{return{status:"ok",data:await (0,b.invoke)("plugin:haptics|notification_feedback",{type:a})}}catch(a){if(!(a instanceof Error))return{status:"error",error:a};throw a}},async selectionFeedback(){try{return{status:"ok",data:await (0,b.invoke)("plugin:haptics|selection_feedback")}}catch(a){if(!(a instanceof Error))return{status:"error",error:a};throw a}}};a.s(["impactFeedback",()=>d])},240009,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=b([e]);[e]=f.then?(await f)():f,a.s(["Overlay",0,({onDismiss:a,className:b})=>(0,d.jsx)("div",{className:(0,e.default)("overlay fixed inset-0 cursor-default",b),role:"none",tabIndex:-1,onClick:a,onContextMenu:a,onKeyDown:b=>{("Escape"===b.key||"Enter"===b.key||" "===b.key)&&(b.preventDefault(),a())}})]),c()}catch(a){c(a)}},!1),381322,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(547274),h=a.i(178552),i=a.i(847656),j=a.i(162650),k=a.i(915302),l=a.i(108328),m=a.i(106865),n=a.i(556266),o=a.i(773288),p=a.i(765918),q=a.i(240009),r=b([e,j,l,q]);[e,j,l,q]=r.then?(await r)():r,a.s(["default",0,({id:a,isOpen:b,children:c,snapHeight:r,header:s,title:t,className:u,bgClassName:v,boxClassName:w,contentClassName:x,onClose:y})=>{let z=(0,k.useTranslation)(),{appService:A}=(0,h.useEnv)(),{systemUIVisible:B,statusBarHeight:C,safeAreaInsets:D}=(0,j.useThemeStore)(),{acquireBackKeyInterception:E,releaseBackKeyInterception:F}=(0,l.useDeviceControlStore)(),[G,H]=(0,f.useState)(!r),[I]=(0,f.useState)(()=>"rtl"===(0,o.getDirFromUILanguage)()),J=(0,f.useRef)(null),K=(0,f.useRef)(null),L=(0,m.useResponsiveSize)(22),M=window.innerWidth<640||window.innerHeight<640,N=a=>{if(a instanceof CustomEvent){if("Back"===a.detail.keyName)return y(),!0}else"Escape"===a.key&&y(),a.stopPropagation();return!1};(0,f.useEffect)(()=>{if(!b){K.current&&(K.current.focus(),K.current=null);return}K.current=document.activeElement,H(!r&&M),window.addEventListener("keydown",N),J.current&&J.current.addEventListener("keydown",N),A?.isAndroidApp&&(E(),p.eventDispatcher.onSync("native-key-down",N));let a=setTimeout(()=>{J.current&&J.current.focus()},100);return()=>{clearTimeout(a),window.removeEventListener("keydown",N),A?.isAndroidApp&&(F(),p.eventDispatcher.offSync("native-key-down",N))}},[b]);let{handleDragStart:O}=(0,i.useDrag)(a=>{if(!M||!J.current)return;let b=J.current.querySelector(".modal-box"),c=J.current.querySelector(".overlay"),d=a.clientY/window.innerHeight,e=Math.max(0,Math.min(1,d));b&&c&&(b.style.height="100%",b.style.transform=`translateY(${100*e}%)`,c.style.opacity=`${1-d}`,H(a.clientY<44),b.style.transition="padding-top 0.3s ease-out")},()=>{},a=>{if(!M||!J.current)return;let b=J.current.querySelector(".modal-box"),c=J.current.querySelector(".overlay");if(!b||!c)return;let d=r?1-r+.2:.5;if(a.velocity>.5||a.velocity>=0&&a.clientY>=window.innerHeight*d){let d=.15/Math.max(a.velocity,.5);b.style.height="100%",b.style.transition=`transform ${d}s ease-out`,b.style.transform="translateY(100%)",c.style.transition=`opacity ${d}s ease-out`,c.style.opacity="0",y(),setTimeout(()=>{b.style.transform="translateY(0%)"},300)}else r&&a.clientY>window.innerHeight*(r?1-r-.2:.5)&&a.clientY<window.innerHeight*d?(c.style.transition="opacity 0.3s ease-out",c.style.opacity=`${1-r}`,b.style.height=`${100*r}%`,b.style.bottom="0",b.style.transition="transform 0.3s ease-out",b.style.transform=""):(H(!0),b.style.height="100%",b.style.transition="transform 0.3s ease-out",b.style.transform="translateY(0%)",c.style.opacity="0");A?.hasHaptics&&(0,n.impactFeedback)("medium")});return(0,d.jsxs)("dialog",{ref:J,id:a??"dialog",tabIndex:-1,open:b,"aria-hidden":!b,className:(0,e.default)("modal sm:min-w-90 z-50 h-full w-full !items-start !bg-transparent sm:w-full sm:!items-center",u),dir:I?"rtl":void 0,children:[(0,d.jsx)(q.Overlay,{className:(0,e.default)("dialog-overlay z-10 bg-black/50 sm:bg-black/50",A?.hasRoundedWindow&&"rounded-window",v),onDismiss:y}),(0,d.jsxs)("div",{className:(0,e.default)("modal-box settings-content absolute z-20 flex flex-col rounded-none rounded-tl-2xl rounded-tr-2xl p-0 sm:rounded-2xl","h-full max-h-full w-full max-w-full",window.innerWidth<window.innerHeight?"sm:h-[50%] sm:w-3/4":"sm:h-[65%] sm:w-1/2 sm:max-w-[600px]",w),style:{paddingTop:A?.hasSafeAreaInset&&G?`${Math.max(D?.top||0,B?C:0)}px`:"0px",...M?{height:r?`${100*r}%`:"100%",bottom:0}:{}},children:[(0,d.jsx)("div",{className:(0,e.default)("drag-handle h-10 max-h-10 min-h-10 w-full cursor-row-resize items-center justify-center","transition-padding-top flex duration-300 ease-out sm:hidden"),onMouseDown:O,onTouchStart:O,children:(0,d.jsx)("div",{className:"bg-base-content/50 h-1 w-10 rounded-full"})}),(0,d.jsx)("div",{className:"dialog-header sticky top-1 z-10 flex items-center justify-between px-2 sm:px-4",children:s||(0,d.jsxs)("div",{className:"flex h-11 w-full items-center justify-between",children:[(0,d.jsx)("button",{"aria-label":z("Close"),onClick:y,className:"btn btn-ghost btn-circle flex h-8 min-h-8 w-8 hover:bg-transparent focus:outline-none sm:hidden",children:I?(0,d.jsx)(g.MdArrowForwardIos,{size:L}):(0,d.jsx)(g.MdArrowBackIosNew,{size:L})}),(0,d.jsx)("div",{className:"z-15 pointer-events-none absolute inset-0 flex h-11 items-center justify-center",children:(0,d.jsx)("span",{className:"line-clamp-1 text-center font-bold",children:t??""})}),(0,d.jsx)("button",{"aria-label":z("Close"),onClick:y,className:"bg-base-300/65 btn btn-ghost btn-circle ml-auto hidden h-6 min-h-6 w-6 focus:outline-none sm:flex",children:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})})})]})}),(0,d.jsx)("div",{className:(0,e.default)("text-base-content my-2 flex-grow overflow-y-auto px-6 sm:px-[10%]",x),children:c})]})]})}]),c()}catch(a){c(a)}},!1),975871,a=>{"use strict";var b=a.i(508171),c=a.i(557469),d=a.i(82033);a.s(["default",0,({href:a,children:e,...f})=>{let g=async b=>{(0,c.isTauriAppPlatform)()&&(b.preventDefault(),await (0,d.openUrl)(a))};return(0,b.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",onClick:g,...f,children:e})}])},142125,a=>a.a(async(b,c)=>{try{a.s(["UpdaterWindow",()=>F,"setUpdaterWindowVisible",()=>E]);var d=a.i(508171),e=a.i(76868),f=a.i(222488),g=a.i(266602),h=a.i(178552),i=a.i(127669),j=a.i(607032),k=a.i(471317),l=a.i(317841),m=a.i(579950),n=a.i(826788),o=a.i(177898),p=a.i(557469),q=a.i(665647),r=a.i(915302),s=a.i(667180),t=a.i(704977),u=a.i(268105),v=a.i(545251),w=a.i(138559),x=a.i(465863),y=a.i(870743),z=a.i(654617),A=a.i(381322),B=a.i(975871),C=b([e,q,y,A]);[e,q,y,A]=C.then?(await C)():C;let D=({latestVersion:a,lastVersion:b,checkUpdate:c=!0})=>{let A=(0,r.useTranslation)(),[C,D]=(0,i.useState)("EN"),{translate:E}=(0,q.useTranslator)({provider:"azure",sourceLang:"AUTO",targetLang:C}),{appService:F}=(0,h.useEnv)(),G=(0,s.useSearchParams)(),H=(0,t.getAppVersion)(),[I,J]=(0,i.useState)(a??G?.get("latestVersion")??""),[K,L]=(0,i.useState)(b??G?.get("lastVersion")??""),[M,N]=(0,i.useState)(null),[O,P]=(0,i.useState)([]),[Q,R]=(0,i.useState)(null),[S,T]=(0,i.useState)(null),[U,V]=(0,i.useState)(!1),[W,X]=(0,i.useState)(null),[Y,Z]=(0,i.useState)(!1);(0,i.useEffect)(()=>{D((0,x.getLocale)())},[]),(0,i.useEffect)(()=>{let a=async()=>{let a=await (0,k.check)();a&&N(a)},b=async()=>{if(!F)return;let a=(0,p.isTauriAppPlatform)()?m.fetch:window.fetch,b=await a(z.READEST_UPDATER_FILE),c=await b.json();if(f.default.gt(c.version,H)){let a=(0,j.arch)(),b=c.platforms["aarch64"===a?"android-arm64":"android-universal"]?.url,d=await F.resolveFilePath(`Readest_${c.version}_${"aarch64"===a?"arm64":"universal"}.apk`,"Cache");N({currentVersion:H,version:c.version,date:c.pub_date,body:c.notes,downloadAndInstall:async a=>{await new Promise(async(c,e)=>{let f=0,g=0;await (0,u.tauriDownload)(b,d,b=>{a&&(!g&&b.total?(g=b.total,a({event:"Started",data:{contentLength:g}})):f>0&&b.progress===b.total&&(console.log("APK downloaded to",d),a?.({event:"Finished"}),setTimeout(()=>{c()},1e3)),a({event:"Progress",data:{chunkLength:b.progress-f}}),f=b.progress)}).catch(a=>{console.error("Download failed:",a),e(a)})});let c=await (0,v.installPackage)({path:d});c.success?console.log("APK installed successfully"):console.error("Failed to install APK:",c.error)}})}},d=async()=>{if(!F)return;let a=(0,p.isTauriAppPlatform)()?m.fetch:window.fetch,b=await a(z.READEST_UPDATER_FILE),c=await b.json();if(f.default.gt(c.version,H)){let a=(0,j.arch)(),b=c.platforms["x86_64"===a?"windows-x86_64-portable":"windows-aarch64-portable"]?.url,d=await (0,o.invoke)("get_executable_dir"),e=`Readest_${c.version}_${"x86_64"===a?"x64":"arm64"}-portable.exe`,f=await (0,w.join)(d,e);N({currentVersion:H,version:c.version,date:c.pub_date,body:c.notes,downloadAndInstall:async a=>{await new Promise(async(c,d)=>{let e=0,g=0;await (0,u.tauriDownload)(b,f,b=>{a&&(!g&&b.total?(g=b.total,a({event:"Started",data:{contentLength:g}})):e>0&&b.progress===b.total&&(console.log("Portable EXE downloaded to",f),a?.({event:"Finished"}),setTimeout(()=>{c()},1e3)),a({event:"Progress",data:{chunkLength:b.progress-e}}),e=b.progress)}).catch(a=>{console.error("Download failed:",a),d(a)})});try{console.log("Launching new executable:",f);let a=n.Command.create("start-readest",["/C","start","",f]);await a.spawn(),console.log("New executable launched, exiting current app..."),setTimeout(async()=>{await (0,l.exit)(0)},500)}catch(a){console.error("Failed to launch new executable:",a)}}})}},e=async()=>{let c=(0,j.type)();F?.isPortableApp&&"windows"===c?d():["macos","windows","linux"].includes(c)?a():"android"===c&&b()};F?.hasUpdater&&c&&e()},[F?.hasUpdater]),(0,i.useEffect)(()=>{a&&J(a),b&&L(b),c||N({currentVersion:H,version:a,date:"",body:""})},[a,b,c]),(0,i.useEffect)(()=>{let a=async a=>{try{let b=(0,p.isTauriAppPlatform)()?m.fetch:window.fetch,c=await b(z.READEST_CHANGELOG_FILE),d=(await c.json()).releases,e=Object.entries(d).filter(([b])=>f.default.gt(b,a)).sort(([a],[b])=>f.default.rcompare(a,b));return(e=e.length?e:Object.entries(d).slice(0,3)).map(([a,b])=>({version:a,date:new Date(b.date).toLocaleDateString(),notes:b.notes}))}catch(a){return console.error("Failed to fetch changelog:",a),[]}},b=async b=>{J(b.version);let c=await a(K||H);if(0===c.length&&b.date&&b.body&&(c=[{version:b.version,date:new Date(b.date).toLocaleDateString(),notes:(b.body??"").split(/(?:^|\s)\d+\.\s/).map(a=>a.trim()).filter(a=>a.length>0)}]),!C.toLowerCase().startsWith("en"))for(let a of c)try{a.notes=await E(a.notes,{useCache:!0})}catch(a){console.log("Failed to translate changelog:",a)}P(c),(0,y.setLastShownReleaseNotesVersion)(I)};M&&b(M)},[M]),(0,i.useEffect)(()=>{Z(!0)},[]);let $=async()=>{if(!M)return;let a=0,b=0,c=0;R(0),V(!0),await M.downloadAndInstall?.(d=>{switch(d.event){case"Started":b=d.data.contentLength,T(b);break;case"Progress":a+=d.data.chunkLength,X(a);let e=Math.floor(a/b*100);R(e),a-c>=1048576&&(console.log(`downloaded ${a} bytes from ${b}`),c=a);break;case"Finished":console.log("download finished"),R(100)}}),console.log("package installed"),F?.isAndroidApp||await (0,l.relaunch)()};return Y&&I?(0,d.jsx)("div",{className:"bg-base-100 flex min-h-screen justify-center",children:(0,d.jsxs)("div",{className:"flex w-full max-w-2xl flex-col gap-4",children:[(0,d.jsxs)("div",{className:"flex flex-col justify-center gap-4 sm:flex-row sm:items-start",children:[(0,d.jsx)("div",{className:"flex items-center justify-center",children:(0,d.jsx)(g.default,{src:"/icon.png",alt:"Logo",className:"h-20 w-20",width:64,height:64})}),c?(0,d.jsxs)("div",{className:"text-base-content flex-grow text-sm",children:[(0,d.jsx)("h2",{className:"mb-4 text-center font-bold sm:text-start",children:A("A new version of Readest is available!")}),(0,d.jsx)("p",{className:"mb-2",children:A("Readest {{newVersion}} is available (installed version {{currentVersion}}).",{newVersion:I,currentVersion:H})}),(0,d.jsx)("p",{className:"mb-2",children:A("Download and install now?")}),(0,d.jsxs)("div",{className:"flex w-full flex-row items-center justify-end gap-4",children:[null!==Q&&(0,d.jsxs)("div",{className:"flex flex-grow flex-col",children:[(0,d.jsx)("progress",{className:"progress my-1 h-4 w-full",value:Q,max:"100"}),(0,d.jsx)("p",{className:"text-base-content/75 flex items-center justify-center text-sm",children:Q<100?A("Downloading {{downloaded}} of {{contentLength}}",{downloaded:W?`${Math.floor(W/1024/1024)} MB`:"0 MB",contentLength:S?`${Math.floor(S/1024/1024)} MB`:"0 MB"}):A("Download finished")})]}),(0,d.jsx)("div",{className:"card-actions",children:(0,d.jsx)("button",{className:(0,e.default)("btn btn-warning text-base-100 px-6 font-bold",(!M||U)&&"btn-disabled"),onClick:$,children:A("DOWNLOAD & INSTALL")})})]})]}):(0,d.jsx)("div",{className:"text-base-content flex h-full flex-grow flex-col text-sm sm:flex-row",children:(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-1 sm:items-start sm:gap-2",children:[(0,d.jsx)("h2",{className:"text-center font-bold sm:text-start",children:A("Version {{version}}",{version:H})}),O.length>0&&f.default.gt(O[0].version,H)?(0,d.jsxs)("div",{className:"flex gap-2",children:[(F?.isIOSApp||F?.isMacOSApp)&&(0,d.jsx)(B.default,{href:"https://apps.apple.com/app/id6738622779",target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary btn-sm",children:A("Check Update")}),F?.isAndroidApp&&(0,d.jsx)(B.default,{href:"https://play.google.com/store/apps/details?id=com.bilingify.readest",target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary btn-sm",children:A("Check Update")})]}):(0,d.jsx)("div",{className:"flex",children:(0,d.jsx)("p",{className:"text-sm font-bold",children:A("Already the latest version")})})]})})]}),(0,d.jsxs)("div",{className:"text-base-content text-sm",children:[(0,d.jsx)("h3",{className:"mb-2 font-bold",children:A("Changelog")}),(0,d.jsx)("div",{className:"not-eink:bg-base-200 not-eink:px-4 mb-4 rounded-lg pb-2 pt-4",children:O.length>0?O.map(a=>(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsxs)("h4",{className:"mb-2 font-bold",children:[a.version," (",a.date,")"]}),(0,d.jsx)("ul",{className:"list-disc space-y-1 ps-6 text-sm",children:a.notes.map((a,b)=>(0,d.jsx)("li",{children:a},b))})]},a.version)):(0,d.jsxs)("div",{className:"flex h-56 w-full flex-col gap-4",children:[(0,d.jsx)("div",{className:"skeleton h-4 w-28"}),(0,d.jsx)("div",{className:"skeleton h-4 w-full"}),(0,d.jsx)("div",{className:"skeleton h-4 w-full"})]})})]})]})}):null},E=(a,b,c,d=!0)=>{let e=document.getElementById("updater_window");if(e){let f=new CustomEvent("setDialogVisibility",{detail:{visible:a,latestVersion:b,lastVersion:c,checkUpdate:d}});e.dispatchEvent(f)}},F=()=>{let a=(0,r.useTranslation)(),[b,c]=(0,i.useState)(""),[e,f]=(0,i.useState)(""),[g,h]=(0,i.useState)(!0),[j,k]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let a=a=>{let{visible:b,latestVersion:d,lastVersion:e,checkUpdate:g}=a.detail;k(b),h(g),d&&c(d),e&&f(e)},b=document.getElementById("updater_window");return b&&b.addEventListener("setDialogVisibility",a),()=>{b&&b.removeEventListener("setDialogVisibility",a)}},[]),(0,d.jsx)(A.default,{id:"updater_window",isOpen:j,title:a(g?"Software Update":"What's New in Readest"),onClose:()=>k(!1),boxClassName:"sm:!w-[75%] sm:h-auto sm:!max-h-[85vh] sm:!max-w-2xl",children:j&&(0,d.jsx)(D,{latestVersion:b??void 0,lastVersion:e??void 0,checkUpdate:g})})};c()}catch(a){c(a)}},!1),870743,a=>a.a(async(b,c)=>{try{a.s(["checkAppReleaseNotes",()=>r,"checkForAppUpdates",()=>o,"setLastShownReleaseNotesVersion",()=>q]);var d=a.i(222488),e=a.i(471317),f=a.i(607032),g=a.i(579950),h=a.i(909551),i=a.i(142125),j=a.i(557469),k=a.i(704977),l=a.i(654617),m=b([i]);[i]=m.then?(await m)():m;let n="lastAppUpdateCheck",o=async(a,b=!0)=>{let c=localStorage.getItem(n),j=Date.now();if(b&&c&&j-parseInt(c,10)<1e3*l.CHECK_UPDATE_INTERVAL_SEC)return!1;localStorage.setItem(n,j.toString()),console.log("Checking for updates");let m=(0,f.type)();if(["macos","windows","linux"].includes(m)){var o;let a,b=await (0,e.check)();return b&&(o=b.version,(a=new h.WebviewWindow("updater",{url:`/updater?latestVersion=${o}`,title:"Software Update",width:626,height:406,center:!0,resizable:!0})).once("tauri://created",()=>{console.log("new window created")}),a.once("tauri://error",a=>{console.error("error creating window",a)})),!!b}if("android"===m)try{let a=await (0,g.fetch)(l.READEST_UPDATER_FILE,{connectTimeout:5e3}),b=await a.json(),c=d.default.gt(b.version,(0,k.getAppVersion)());return c&&("android-arm64"in b.platforms||"android-universal"in b.platforms)&&(0,i.setUpdaterWindowVisible)(!0,b.version,(0,k.getAppVersion)()),c}catch(a){throw console.warn("Failed to fetch Android update info",a),Error("Failed to fetch Android update info")}return!1},p="lastShownReleaseNotesVersion",q=a=>{localStorage.setItem(p,a)},r=async(a=!0)=>{let b=(0,k.getAppVersion)(),c=localStorage.getItem(p)||"";if(c&&d.default.gt(b,c)||!a)try{let a=(0,j.isTauriAppPlatform)()?g.fetch:window.fetch;if((await a(l.READEST_CHANGELOG_FILE)).ok)return(0,i.setUpdaterWindowVisible)(!0,b,c,!1),!0}catch(a){console.warn("Failed to fetch release notes",a)}else c||q(b);return!1};c()}catch(a){c(a)}},!1),929058,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M640 51.2l-.3 12.2c-28.1.8-45 15.8-55.8 40.3-25 57.8-103.3 240-155.3 358.6H415l-81.9-193.1c-32.5 63.6-68.3 130-99.2 193.1-.3.3-15 0-15-.3C172 352.3 122.8 243.4 75.8 133.4 64.4 106.7 26.4 63.4.2 63.7c0-3.1-.3-10-.3-14.2h161.9v13.9c-19.2 1.1-52.8 13.3-43.3 34.2 21.9 49.7 103.6 240.3 125.6 288.6 15-29.7 57.8-109.2 75.3-142.8-13.9-28.3-58.6-133.9-72.8-160-9.7-17.8-36.1-19.4-55.8-19.7V49.8l142.5.3v13.1c-19.4.6-38.1 7.8-29.4 26.1 18.9 40 30.6 68.1 48.1 104.7 5.6-10.8 34.7-69.4 48.1-100.8 8.9-20.6-3.9-28.6-38.6-29.4.3-3.6 0-10.3.3-13.6 44.4-.3 111.1-.3 123.1-.6v13.6c-22.5.8-45.8 12.8-58.1 31.7l-59.2 122.8c6.4 16.1 63.3 142.8 69.2 156.7L559.2 91.8c-8.6-23.1-36.4-28.1-47.2-28.3V49.6l127.8 1.1.2.5z"},child:[]}]})(a)}function g(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(a)}function h(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(a)}function i(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(a)}function j(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(a)}a.s(["FaCheckCircle",()=>g,"FaChevronDown",()=>h,"FaDiscord",()=>c,"FaGithub",()=>d,"FaReddit",()=>e,"FaSearch",()=>i,"FaTimes",()=>j,"FaWikipediaW",()=>f])},67365,a=>{"use strict";var b=a.i(508171),c=a.i(929058),d=a.i(915302),e=a.i(106865),f=a.i(975871);a.s(["default",0,()=>{let a=(0,d.useTranslation)(),g=(0,e.useResponsiveSize)(24);return(0,b.jsxs)("div",{className:"my-2 flex flex-col items-center gap-2",children:[(0,b.jsx)("p",{className:"text-neutral-content text-sm",children:a("Get Help from the Readest Community")}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(f.default,{href:"https://github.com/readest/readest",className:"flex items-center gap-2 rounded-full bg-gray-800 p-1.5 text-white transition-colors hover:bg-gray-700",title:"GitHub","aria-label":"GitHub",children:(0,b.jsx)(c.FaGithub,{size:g})}),(0,b.jsx)(f.default,{href:"https://discord.gg/gntyVNk3BJ",className:"flex items-center gap-2 rounded-full bg-indigo-600 p-1.5 text-white transition-colors hover:bg-indigo-500",title:"Discord","aria-label":"Discord",children:(0,b.jsx)(c.FaDiscord,{size:g})}),(0,b.jsx)(f.default,{href:"https://reddit.com/r/readest/",className:"flex items-center gap-2 rounded-full bg-orange-600 p-1.5 text-white transition-colors hover:bg-orange-500",title:"Reddit","aria-label":"Reddit",children:(0,b.jsx)(c.FaReddit,{size:g})})]})]})}])},617661,a=>{"use strict";var b=a.i(508171),c=a.i(178552),d=a.i(915302),e=a.i(975871);a.s(["default",0,()=>{let a=(0,d.useTranslation)(),{appService:f}=(0,c.useEnv)(),g=f?.isIOSApp||f?.isMacOSApp?"https://www.apple.com/legal/internet-services/itunes/dev/stdeula/":"https://readest.com/terms-of-service";return(0,b.jsxs)("div",{className:"my-2 flex flex-wrap justify-center gap-4 text-sm sm:text-xs",children:[(0,b.jsx)(e.default,{href:g,className:"text-blue-500 underline hover:text-blue-600",children:a("Terms of Service")}),(0,b.jsx)(e.default,{href:"https://readest.com/privacy-policy",className:"text-blue-500 underline hover:text-blue-600",children:a("Privacy Policy")})]})}])},645760,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(266602),g=a.i(178552),h=a.i(915302),i=a.i(870743),j=a.i(12382),k=a.i(704977),l=a.i(67365),m=a.i(617661),n=a.i(381322),o=a.i(975871),p=b([i,n]);[i,n]=p.then?(await p)():p,a.s(["AboutWindow",0,()=>{let a=(0,h.useTranslation)(),{appService:b}=(0,g.useEnv)(),[c,p]=(0,e.useState)(null),[q,r]=(0,e.useState)(""),[s,t]=(0,e.useState)(!1);(0,e.useEffect)(()=>{r((0,j.parseWebViewInfo)(b));let a=a=>{t(a.detail.visible)},c=document.getElementById("about_window");return c&&c.addEventListener("setDialogVisibility",a),()=>{c&&c.removeEventListener("setDialogVisibility",a)}},[]);let u=async()=>{p("checking");try{await (0,i.checkForAppUpdates)(a,!1)?w():p("updated")}catch(a){console.info("Error checking for updates:",a),p("error")}},v=async()=>{await (0,i.checkAppReleaseNotes)(!1)?w():p("error")},w=()=>{t(!1),p(null)};return(0,d.jsx)(n.default,{id:"about_window",isOpen:s,title:a("About Readest"),onClose:w,boxClassName:"sm:!w-[480px] sm:!max-w-screen-sm sm:h-auto",children:s&&(0,d.jsxs)("div",{className:"about-content flex flex-col items-center justify-center gap-4 pb-10 sm:pb-0",children:[(0,d.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-end gap-2 px-8 py-2",children:[(0,d.jsx)("div",{className:"mb-2 mt-6",children:(0,d.jsx)(f.default,{src:"/icon.png",alt:"App Logo",className:"h-20 w-20",width:64,height:64})}),(0,d.jsxs)("div",{className:"flex select-text flex-col items-center",children:[(0,d.jsx)("h2",{className:"mb-2 text-2xl font-bold",children:"Readest"}),(0,d.jsxs)("p",{className:"text-neutral-content text-center text-sm",children:[a("Version {{version}}",{version:(0,k.getAppVersion)()})," ",`(${q})`]})]}),(0,d.jsxs)("div",{className:"my-1 h-5",children:[!c&&(0,d.jsx)("button",{className:"btn btn-sm btn-primary cursor-pointer p-1 text-xs",onClick:b?.hasUpdater?u:v,children:a("Check Update")}),"updated"===c&&(0,d.jsx)("p",{className:"text-neutral-content mt-2 text-xs",children:a("Already the latest version")}),"checking"===c&&(0,d.jsx)("p",{className:"text-neutral-content mt-2 text-xs",children:a("Checking for updates...")}),"error"===c&&(0,d.jsx)("p",{className:"text-error mt-2 text-xs",children:a("Error checking for updates")})]})]}),(0,d.jsx)("hr",{className:"border-base-300 my-12 w-full sm:my-4"}),(0,d.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-start gap-2 px-4 text-center",dir:"ltr",children:[(0,d.jsxs)("p",{className:"text-neutral-content text-sm",children:[" ",new Date().getFullYear()," Bilingify LLC. All rights reserved."]}),(0,d.jsxs)("p",{className:"text-neutral-content text-xs",children:["This software is licensed under the"," ",(0,d.jsx)(o.default,{href:"https://www.gnu.org/licenses/agpl-3.0.html",className:"text-blue-500 underline",children:"GNU Affero General Public License v3.0"}),". You are free to use, modify, and distribute this software under the terms of the AGPL v3 license. Please see the license for more details."]}),(0,d.jsxs)("p",{className:"text-neutral-content text-xs",children:["Source code is available at"," ",(0,d.jsx)(o.default,{href:"https://github.com/readest/readest",className:"text-blue-500 underline",children:"GitHub"}),"."]}),(0,d.jsx)(m.default,{})]}),(0,d.jsx)(l.default,{})]})})},"setAboutDialogVisible",0,a=>{let b=document.getElementById("about_window");if(b){let c=new CustomEvent("setDialogVisibility",{detail:{visible:a}});b.dispatchEvent(c)}}]),c()}catch(a){c(a)}},!1),393224,a=>{"use strict";var b=a.i(399577),c=a.i(579950),d=a.i(557469);class e{config;isLanServer;constructor(a){this.config=a,this.config.serverUrl=a.serverUrl.replace(/\/$/,""),this.isLanServer=(a=>{try{let b=new URL(a).hostname;if("localhost"===b||"127.0.0.1"===b)return!0;let c=b.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);if(c){let[,a,b,d,e]=c.map(Number);if(void 0===a||void 0===b||void 0===d||void 0===e||a>255||b>255||d>255||e>255)return!1;if(10===a||172===a&&b>=16&&b<=31||192===a&&168===b||169===a&&254===b||100===a&&b>=64&&b<=127)return!0}if(b.includes(":")&&(b.startsWith("::1")||b.startsWith("fe80:")||b.startsWith("fc00:")||b.startsWith("fd00:")))return!0;return!1}catch{return!1}})(this.config.serverUrl)}async request(a,b={}){let{method:e="GET",body:f,headers:g,useAuth:h=!0}=b,i=new Headers(g||{});return(h&&(i.set("X-Auth-User",this.config.username),i.set("X-Auth-Key",this.config.userkey)),this.isLanServer||(0,d.isTauriAppPlatform)())?((0,d.isTauriAppPlatform)()?c.fetch:window.fetch)(`${this.config.serverUrl}${a}`,{method:e,headers:{accept:"application/vnd.koreader.v1+json",..."GET"===e?{}:{"Content-Type":"application/json"},...Object.fromEntries(i.entries())},body:f,danger:{acceptInvalidCerts:!0,acceptInvalidHostnames:!0}}):fetch(`${(0,d.getAPIBaseUrl)()}/kosync`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serverUrl:this.config.serverUrl,endpoint:a,method:e,headers:Object.fromEntries(i.entries()),body:f?JSON.parse(f):void 0})})}async connect(a,c){let d=(0,b.md5)(c);try{let b=await this.request("/users/auth",{method:"GET",headers:{"X-Auth-User":a,"X-Auth-Key":d}});if(b.ok)return{success:!0,message:"Login successful."};if(401===b.status){let b=await this.request("/users/create",{method:"POST",useAuth:!1,body:JSON.stringify({username:a,password:d})});if(b.ok)return{success:!0,message:"Registration successful."};let c=await b.json().catch(()=>({}));if(402===b.status)return{success:!1,message:"Invalid credentials."};return{success:!1,message:c.message||"Registration failed."}}let c=await b.json().catch(()=>({}));return{success:!1,message:c.message||`Authorization failed with status: ${b.status}`}}catch(a){return console.error("KOSync connection failed",a),{success:!1,message:a.message||"Connection error."}}}async getProgress(a){if(!this.config.userkey)return null;let b=this.getDocumentDigest(a);if(!b)return null;try{let c=await this.request(`/syncs/progress/${b}`);if(!c.ok)return console.error(`KOSync: Failed to get progress for ${a.title}. Status: ${c.status}`),null;let d=await c.json();return d.document?d:null}catch(a){return console.error("KOSync getProgress failed",a),null}}async updateProgress(a,b,c){if(!this.config.userkey)return!1;let d=this.getDocumentDigest(a);if(!d)return!1;let e={document:d,progress:b,percentage:c,device:this.config.deviceName,device_id:this.config.deviceId};try{let b=await this.request("/syncs/progress",{method:"PUT",body:JSON.stringify(e)});if(!b.ok)return console.error(`KOSync: Failed to update progress for ${a.title}. Status: ${b.status}`),!1;return!0}catch(a){return console.error("KOSync updateProgress failed",a),!1}}getDocumentDigest(a){return"filename"===this.config.checksumMethod&&console.warn("This is not possible anymore, using md5 instead."),a.hash}}a.s(["KOSyncClient",()=>e],393224)},951790,a=>{"use strict";a.s(["debounce",0,(a,b,c={emitLast:!0})=>{let d=null,e=null,f=(...f)=>{e=f,d&&clearTimeout(d),d=c.emitLast?setTimeout(()=>{e&&(a(...e),e=null),d=null},b):setTimeout(()=>{a(...f),d=null},b)};return f.flush=()=>{d&&(clearTimeout(d),d=null,e&&(a(...e),e=null))},f.cancel=()=>{d&&(clearTimeout(d),d=null,e=null)},f}])},953365,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(399577),h=a.i(607032),i=a.i(178552),j=a.i(915302),k=a.i(866736),l=a.i(765918),m=a.i(393224),n=a.i(951790),o=a.i(465863),p=a.i(381322),q=b([e,k,p]);[e,k,p]=q.then?(await q)():q;let r=({value:a,onChange:b,options:c,className:f,disabled:g=!1})=>(0,d.jsx)("select",{value:a,onChange:b,className:(0,e.default)("select select-bordered h-12 w-full text-sm focus:outline-none focus:ring-0",f),disabled:g,children:c.map(({value:a,label:b,disabled:c=!1})=>(0,d.jsx)("option",{value:a,disabled:c,children:b},a))});a.s(["KOSyncSettingsWindow",0,()=>{let a=(0,j.useTranslation)(),{settings:b,setSettings:c,saveSettings:e}=(0,k.useSettingsStore)(),{envConfig:q,appService:s}=(0,i.useEnv)(),[t,u]=(0,f.useState)(!1),[v,w]=(0,f.useState)(b.kosync.serverUrl||""),[x,y]=(0,f.useState)(b.kosync.username||""),[z,A]=(0,f.useState)(""),[B,C]=(0,f.useState)(!1),[D,E]=(0,f.useState)(""),[F,G]=(0,f.useState)(""),[H,I]=(0,f.useState)("");(0,f.useEffect)(()=>{(async()=>{var a;let b="";if(s?.appPlatform==="tauri")b=await (0,h.type)();else{let a=(0,o.getOSPlatform)();"unknown"!==a&&(b=a)}I((a=b)?"macos"===a.toLowerCase()?"macOS":"ios"===a.toLowerCase()?"iOS":a.charAt(0).toUpperCase()+a.slice(1):"")})()},[s]),(0,f.useEffect)(()=>{let a=H?`Readest (${H})`:"Readest";G(b.kosync.deviceName||a)},[b.kosync.deviceName,H]);let J=(0,f.useMemo)(()=>!!b.kosync.userkey,[b.kosync.userkey]),K=(0,f.useCallback)((0,n.debounce)(a=>{let d={...b,koreaderSyncDeviceName:a};c(d),e(q,d)},500),[b,c,e,q]);(0,f.useEffect)(()=>{let a=a=>{u(a.detail.visible),a.detail.visible&&(w(b.kosync.serverUrl||""),y(b.kosync.username||""),A(""),E(""))},c=document.getElementById("kosync_settings_window");return c?.addEventListener("setKOSyncSettingsVisibility",a),()=>{c?.removeEventListener("setKOSyncSettingsVisibility",a)}},[b.kosync.serverUrl,b.kosync.username]);let L=async()=>{C(!0);let d={...b.kosync,serverUrl:v,username:x,userkey:(0,g.md5)(z),deviceName:F,enabled:!0},f=new m.KOSyncClient(d),h=await f.connect(x,z);if(h.success){let a={...b,kosync:d};c(a),await e(q,a)}else E(""),l.eventDispatcher.dispatch("toast",{message:`${a("Failed to connect")}: ${a(h.message||"Connection error")}`,type:"error"});C(!1),A("")},M=async()=>{let d={...b.kosync,userkey:"",enabled:!1},f={...b,kosync:d};c(f),await e(q,f),y(""),l.eventDispatcher.dispatch("toast",{message:a("Disconnected"),type:"info"})},N=async a=>{let d={...b.kosync,strategy:a.target.value},f={...b,kosync:d};c(f),await e(q,f)},O=async a=>{let d={...b.kosync,checksumMethod:a.target.value},f={...b,kosync:d};c(f),await e(q,f)};return(0,d.jsx)(p.default,{id:"kosync_settings_window",isOpen:t,onClose:()=>u(!1),title:a("KOReader Sync Settings"),boxClassName:"sm:!min-w-[520px] sm:h-auto",children:t&&(0,d.jsx)("div",{className:"mb-4 mt-0 flex flex-col gap-4 p-2 sm:p-4",children:J?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("p",{className:"text-base-content/80 text-sm",children:a("Sync as {{userDisplayName}}",{userDisplayName:b.kosync.username})})}),(0,d.jsxs)("div",{className:"flex h-14 items-center justify-between",children:[(0,d.jsx)("span",{className:"text-base-content/80",children:a("Sync Server Connected")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:b.kosync.enabled,onChange:()=>M()})]}),(0,d.jsxs)("div",{className:"form-control w-full",children:[(0,d.jsx)("label",{className:"label py-1",children:(0,d.jsx)("span",{className:"label-text font-medium",children:a("Sync Strategy")})}),(0,d.jsx)(r,{value:b.kosync.strategy,onChange:N,options:[{value:"prompt",label:a("Ask on conflict")},{value:"silent",label:a("Always use latest")},{value:"send",label:a("Send changes only")},{value:"receive",label:a("Receive changes only")}]})]}),(0,d.jsxs)("div",{className:"form-control w-full",children:[(0,d.jsx)("label",{className:"label py-1",children:(0,d.jsx)("span",{className:"label-text font-medium",children:a("Checksum Method")})}),(0,d.jsx)(r,{value:b.kosync.checksumMethod,onChange:O,options:[{value:"binary",label:a("File Content (recommended)")},{value:"filename",label:a("File Name"),disabled:!0}]})]}),(0,d.jsxs)("div",{className:"form-control w-full",children:[(0,d.jsx)("label",{className:"label py-1",children:(0,d.jsx)("span",{className:"label-text font-medium",children:a("Device Name")})}),(0,d.jsx)("input",{type:"text",placeholder:H?`Readest (${H})`:"Readest",className:"input input-bordered h-12 w-full focus:outline-none focus:ring-0",value:F,onChange:a=>{let b=a.target.value;G(b),K(b)}})]})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:"text-base-content/70 text-center text-sm",children:a("Connect to your KOReader Sync server.")}),(0,d.jsxs)("div",{className:"form-control w-full",children:[(0,d.jsx)("label",{className:"label py-1",children:(0,d.jsx)("span",{className:"label-text font-medium",children:a("Server URL")})}),(0,d.jsx)("input",{type:"text",placeholder:"https://koreader.sync.server",className:"input input-bordered h-12 w-full focus:outline-none focus:ring-0",spellCheck:"false",value:v,onChange:a=>w(a.target.value)})]}),(0,d.jsxs)("form",{className:"flex flex-col gap-4",children:[(0,d.jsxs)("div",{className:"form-control w-full",children:[(0,d.jsx)("label",{className:"label py-1",children:(0,d.jsx)("span",{className:"label-text font-medium",children:a("Username")})}),(0,d.jsx)("input",{type:"text",placeholder:a("Your Username"),className:"input input-bordered h-12 w-full focus:outline-none focus:ring-0",spellCheck:"false",value:x,onChange:a=>y(a.target.value),autoComplete:"username"})]}),(0,d.jsxs)("div",{className:"form-control w-full",children:[(0,d.jsx)("label",{className:"label py-1",children:(0,d.jsx)("span",{className:"label-text font-medium",children:a("Password")})}),(0,d.jsx)("input",{type:"password",placeholder:a("Your Password"),className:"input input-bordered h-12 w-full focus:outline-none focus:ring-0",value:z,onChange:a=>A(a.target.value),autoComplete:"current-password"})]})]}),(0,d.jsx)("button",{className:"btn btn-primary mt-2 h-12 min-h-12 w-full",onClick:L,disabled:B||!v||!x||!z,children:B?(0,d.jsx)("span",{className:"loading loading-spinner"}):a("Connect")}),D&&(0,d.jsx)("div",{className:"text-error h-4 text-center text-sm",children:D})]})})})},"setKOSyncSettingsWindowVisible",0,a=>{let b=document.getElementById("kosync_settings_window");if(b){let c=new CustomEvent("setKOSyncSettingsVisibility",{detail:{visible:a}});b.dispatchEvent(c)}}]),c()}catch(a){c(a)}},!1),540438,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5.82843 6.99955L8.36396 9.53509L6.94975 10.9493L2 5.99955L6.94975 1.0498L8.36396 2.46402L5.82843 4.99955H13C17.4183 4.99955 21 8.58127 21 12.9996C21 17.4178 17.4183 20.9996 13 20.9996H4V18.9996H13C16.3137 18.9996 19 16.3133 19 12.9996C19 9.68584 16.3137 6.99955 13 6.99955H5.82843Z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.1716 6.99955H11C7.68629 6.99955 5 9.68584 5 12.9996C5 16.3133 7.68629 18.9996 11 18.9996H20V20.9996H11C6.58172 20.9996 3 17.4178 3 12.9996C3 8.58127 6.58172 4.99955 11 4.99955H18.1716L15.636 2.46402L17.0503 1.0498L22 5.99955L17.0503 10.9493L15.636 9.53509L18.1716 6.99955Z"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4.83582 12L11.0429 18.2071L12.4571 16.7929L7.66424 12L12.4571 7.20712L11.0429 5.79291L4.83582 12ZM10.4857 12L16.6928 18.2071L18.107 16.7929L13.3141 12L18.107 7.20712L16.6928 5.79291L10.4857 12Z"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"},child:[]}]})(a)}function g(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M19.1642 12L12.9571 5.79291L11.5429 7.20712L16.3358 12L11.5429 16.7929L12.9571 18.2071L19.1642 12ZM13.5143 12L7.30722 5.79291L5.89301 7.20712L10.6859 12L5.89301 16.7929L7.30722 18.2071L13.5143 12Z"},child:[]}]})(a)}function h(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13.1717 12.0007L8.22192 7.05093L9.63614 5.63672L16.0001 12.0007L9.63614 18.3646L8.22192 16.9504L13.1717 12.0007Z"},child:[]}]})(a)}function i(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6.41421 15.89L16.5563 5.74785L15.1421 4.33363L5 14.4758V15.89H6.41421ZM7.24264 17.89H3V13.6473L14.435 2.21231C14.8256 1.82179 15.4587 1.82179 15.8492 2.21231L18.6777 5.04074C19.0682 5.43126 19.0682 6.06443 18.6777 6.45495L7.24264 17.89ZM3 19.89H21V21.89H3V19.89Z"},child:[]}]})(a)}function j(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5.55397 22H3.3999L10.9999 3H12.9999L20.5999 22H18.4458L16.0458 16H7.95397L5.55397 22ZM8.75397 14H15.2458L11.9999 5.88517L8.75397 14Z"},child:[]}]})(a)}function k(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M11.246 15H4.75416L2.75416 20H0.600098L7.0001 4H9.0001L15.4001 20H13.246L11.246 15ZM10.446 13L8.0001 6.88516L5.55416 13H10.446ZM21.0001 12.5351V12H23.0001V20H21.0001V19.4649C20.4118 19.8052 19.7287 20 19.0001 20C16.791 20 15.0001 18.2091 15.0001 16C15.0001 13.7909 16.791 12 19.0001 12C19.7287 12 20.4118 12.1948 21.0001 12.5351ZM19.0001 18C20.1047 18 21.0001 17.1046 21.0001 16C21.0001 14.8954 20.1047 14 19.0001 14C17.8955 14 17.0001 14.8954 17.0001 16C17.0001 17.1046 17.8955 18 19.0001 18Z"},child:[]}]})(a)}function l(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M19.7134 8.12811L19.4668 8.69379C19.2864 9.10792 18.7136 9.10792 18.5331 8.69379L18.2866 8.12811C17.8471 7.11947 17.0555 6.31641 16.0677 5.87708L15.308 5.53922C14.8973 5.35653 14.8973 4.75881 15.308 4.57612L16.0252 4.25714C17.0384 3.80651 17.8442 2.97373 18.2761 1.93083L18.5293 1.31953C18.7058 0.893489 19.2942 0.893489 19.4706 1.31953L19.7238 1.93083C20.1558 2.97373 20.9616 3.80651 21.9748 4.25714L22.6919 4.57612C23.1027 4.75881 23.1027 5.35653 22.6919 5.53922L21.9323 5.87708C20.9445 6.31641 20.1529 7.11947 19.7134 8.12811ZM5 17V15H3V17C3 19.2091 4.79086 21 7 21H10V19H7L6.85074 18.9945C5.81588 18.9182 5 18.0544 5 17ZM22.4 21L18 10H16L11.601 21H13.755L14.954 18H19.044L20.245 21H22.4ZM15.753 16L17 12.8852L18.245 16H15.753ZM8 4V2H6V4H2V11H6V14H8V11H12V4H8ZM4 6H6V9H4V6ZM8 6H10V9H8V6Z"},child:[]}]})(a)}function m(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 15V17C5 18.0544 5.81588 18.9182 6.85074 18.9945L7 19H10V21H7C4.79086 21 3 19.2091 3 17V15H5ZM18 10L22.4 21H20.245L19.044 18H14.954L13.755 21H11.601L16 10H18ZM17 12.8852L15.753 16H18.245L17 12.8852ZM8 2V4H12V11H8V14H6V11H2V4H6V2H8ZM17 3C19.2091 3 21 4.79086 21 7V9H19V7C19 5.89543 18.1046 5 17 5H14V3H17ZM6 6H4V9H6V6ZM10 6H8V9H10V6Z"},child:[]}]})(a)}function n(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M20.7134 7.12811L20.4668 7.69379C20.2864 8.10792 19.7136 8.10792 19.5331 7.69379L19.2866 7.12811C18.8471 6.11947 18.0555 5.31641 17.0677 4.87708L16.308 4.53922C15.8973 4.35653 15.8973 3.75881 16.308 3.57612L17.0252 3.25714C18.0384 2.80651 18.8442 1.97373 19.2761 0.930828L19.5293 0.319534C19.7058 -0.106511 20.2942 -0.106511 20.4706 0.319534L20.7238 0.930828C21.1558 1.97373 21.9616 2.80651 22.9748 3.25714L23.6919 3.57612C24.1027 3.75881 24.1027 4.35653 23.6919 4.53922L22.9323 4.87708C21.9445 5.31641 21.1529 6.11947 20.7134 7.12811ZM8.5 6H6.5V18H8.5V6ZM4 10H2V14H4V10ZM13 2H11V22H13V2ZM17.5 8H15.5V18H17.5V8ZM22 10H20V14H22V10Z"},child:[]}]})(a)}function o(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M14 21C13.4477 21 13 20.5523 13 20V12C13 11.4477 13.4477 11 14 11H20C20.5523 11 21 11.4477 21 12V20C21 20.5523 20.5523 21 20 21H14ZM4 13C3.44772 13 3 12.5523 3 12V4C3 3.44772 3.44772 3 4 3H10C10.5523 3 11 3.44772 11 4V12C11 12.5523 10.5523 13 10 13H4ZM9 11V5H5V11H9ZM4 21C3.44772 21 3 20.5523 3 20V16C3 15.4477 3.44772 15 4 15H10C10.5523 15 11 15.4477 11 16V20C11 20.5523 10.5523 21 10 21H4ZM5 19H9V17H5V19ZM15 19H19V13H15V19ZM13 4C13 3.44772 13.4477 3 14 3H20C20.5523 3 21 3.44772 21 4V8C21 8.55228 20.5523 9 20 9H14C13.4477 9 13 8.55228 13 8V4ZM15 5V7H19V5H15Z"},child:[]}]})(a)}function p(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 4V6H15V4H9Z"},child:[]}]})(a)}function q(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 11H11V17H9V11ZM13 11H15V17H13V11ZM9 4V6H15V4H9Z"},child:[]}]})(a)}a.s(["RiArrowGoBackLine",()=>c,"RiArrowGoForwardLine",()=>d,"RiArrowLeftDoubleLine",()=>e,"RiArrowLeftSLine",()=>f,"RiArrowRightDoubleLine",()=>g,"RiArrowRightSLine",()=>h,"RiDashboardLine",()=>o,"RiDeleteBin7Line",()=>p,"RiDeleteBinLine",()=>q,"RiEditLine",()=>i,"RiFontFamily",()=>j,"RiFontSize",()=>k,"RiTranslate",()=>m,"RiTranslateAi",()=>l,"RiVoiceAiFill",()=>n])},200104,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=a.i(466759),f=a.i(866736),g=a.i(862871),h=a.i(465863),i=b([d,e,f,g]);[d,e,f,g]=i.then?(await i)():i;let r=(0,d.create)(()=>({getBookRules:a=>{let{getViewSettings:b}=e.useReaderStore.getState(),c=b(a);return c?.proofreadRules||[]},getGlobalRules:()=>{let{settings:a}=f.useSettingsStore.getState();return a.globalViewSettings.proofreadRules||[]},getMergedRules:a=>{var b,c;let d,{settings:g}=f.useSettingsStore.getState(),{getViewSettings:h}=e.useReaderStore.getState(),i=h(a);return b=g.globalViewSettings.proofreadRules,c=i?.proofreadRules,d=new Map,(b??[]).forEach(a=>d.set(a.id,a)),(c??[]).forEach(a=>d.set(a.id,a)),[...d.values()].sort((a,b)=>(a.order??0)-(b.order??0))},addRule:async(a,b,c)=>{let d={id:(0,h.uniqueId)(),scope:c.scope,pattern:c.pattern,replacement:c.replacement,cfi:c.cfi,sectionHref:c.sectionHref,isRegex:c.isRegex??!1,enabled:c.enabled??!0,caseSensitive:c.caseSensitive??!0,order:c.order??1e3,wholeWord:c.wholeWord??!0,onlyForTTS:c.onlyForTTS??!1};return"library"===c.scope?await n(a,d):await j(a,b,d,c.scope),d},updateRule:async(a,b,c,d)=>{"library"===d.scope?await o(a,c,d):await k(a,b,c,d)},removeRule:async(a,b,c,d)=>{"library"===d?await p(a,c):await l(a,b,c)},toggleRule:async(a,b,c)=>{let{getMergedRules:d}=r.getState(),e=d(b).find(a=>a.id===c);if(!e)throw Error(`Rule not found: ${c}`);let{updateRule:f}=r.getState();await f(a,b,c,{enabled:!e.enabled})}}));async function j(a,b,c,d){let{getViewSettings:f}=e.useReaderStore.getState(),g=f(b);if(!g)return;let h=g.proofreadRules||[];if("selection"===d)h.push(c);else{let a=h.find(a=>a.pattern===c.pattern&&a.isRegex===c.isRegex&&"selection"!==a.scope);a?Object.assign(a,{replacement:c.replacement,enabled:c.enabled,order:c.order}):h.push(c)}await m(a,b,h)}async function k(a,b,c,d){let{getViewSettings:f}=e.useReaderStore.getState(),g=f(b);if(!g)throw Error(`No viewSettings found for book: ${b}`);let h=(g.proofreadRules||[]).map(a=>a.id===c?{...a,...d}:a);await m(a,b,h)}async function l(a,b,c){let{getViewSettings:d}=e.useReaderStore.getState(),f=d(b);if(!f)throw Error(`No viewSettings found for book: ${b}`);let g=(f.proofreadRules||[]).filter(a=>a.id!==c);await m(a,b,g)}async function m(a,b,c){let{getViewSettings:d,setViewSettings:h}=e.useReaderStore.getState(),{getConfig:i,saveConfig:j}=g.useBookDataStore.getState(),{settings:k}=f.useSettingsStore.getState(),l=d(b);if(!l)throw Error(`No viewSettings found for book: ${b}`);let m={...l,proofreadRules:c};h(b,m);let n=i(b);n&&await j(a,b,{...n,viewSettings:m,updatedAt:Date.now()},k)}async function n(a,b){let{settings:c}=f.useSettingsStore.getState();if(!c||!c.globalViewSettings)return;let d=c.globalViewSettings.proofreadRules||[],e=d.find(a=>a.pattern===b.pattern&&a.isRegex===b.isRegex);e?(Object.assign(e,{replacement:b.replacement,enabled:b.enabled,order:b.order}),await q(a,d)):await q(a,[...d,b])}async function o(a,b,c){let{settings:d}=f.useSettingsStore.getState(),e=(d.globalViewSettings.proofreadRules||[]).map(a=>a.id===b?{...a,...c}:a);await q(a,e)}async function p(a,b){let{settings:c}=f.useSettingsStore.getState(),d=(c.globalViewSettings.proofreadRules||[]).filter(a=>a.id!==b);await q(a,d)}async function q(a,b){let{settings:c,setSettings:d,saveSettings:e}=f.useSettingsStore.getState(),g={...c,globalViewSettings:{...c.globalViewSettings,proofreadRules:b}};d(g),await e(a,g)}a.s(["useProofreadStore",0,r]),c()}catch(a){c(a)}},!1),175416,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(540438),h=a.i(178552),i=a.i(915302),j=a.i(866736),k=a.i(466759),l=a.i(715715),m=a.i(862871),n=a.i(200104),o=a.i(765918),p=a.i(381322),q=b([e,j,k,l,m,n,p]);[e,j,k,l,m,n,p]=q.then?(await q)():q;let r="proofread_rules_window",s=({rule:a,scope:b,isEditing:c,editingData:f,onEdit:h,onDelete:j,onSave:m,onCancel:n,onEditChange:p})=>{let q=(0,i.useTranslation)(),{sideBarBookKey:r}=(0,l.useSidebarStore)(),{getView:s}=(0,k.useReaderStore)();return c?(0,d.jsxs)("div",{className:"flex flex-col gap-3 p-3",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,d.jsx)("label",{className:"text-base-content/70 text-xs font-medium",children:q("Selected text:")}),(0,d.jsx)("input",{className:"input input-sm bg-base-200 text-sm opacity-60",value:f.pattern,disabled:!0})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,d.jsx)("label",{className:"text-base-content/70 text-xs font-medium",children:q("Replace with:")}),(0,d.jsx)("input",{className:"input input-sm text-sm",value:f.replacement,onChange:a=>p("replacement",a.target.value)})]}),(0,d.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,d.jsx)("button",{className:"btn btn-primary btn-sm flex-1",onClick:m,children:q("Save")}),(0,d.jsx)("button",{className:"btn btn-sm flex-1",onClick:n,children:q("Cancel")})]})]}):(0,d.jsxs)("div",{className:"relative flex items-start justify-between gap-3 p-3",children:[(0,d.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-1.5",children:[(0,d.jsx)("div",{className:"break-words pe-20 text-base font-medium leading-snug",children:a.pattern}),(0,d.jsxs)("div",{className:"text-base-content/70 break-words text-sm",children:[(0,d.jsx)("span",{className:"text-base-content/80 mr-1.5 text-xs font-medium",children:q("Replace with:")}),(0,d.jsx)("span",{className:"text-base-content/90 text-xs",children:"'"+a.replacement+"'"})]}),(0,d.jsxs)("div",{className:"text-base-content/60 flex flex-wrap items-center gap-x-2 gap-y-1 text-xs",children:[(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,d.jsx)("span",{className:"text-base-content/50",children:q("Scope:")}),(0,d.jsx)("span",{role:"none",className:(0,e.default)("text-base-content/70 font-medium","selection"===b&&"cursor-pointer text-blue-400 hover:text-blue-500"),onClick:"selection"===b?()=>{r&&a.cfi&&(o.eventDispatcher.dispatch("navigate",{bookKey:r,cfi:a.cfi}),s(r)?.goTo(a.cfi))}:void 0,children:q("selection"===b?"Selection":"book"===b?"Book":"Library")})]}),(0,d.jsx)("span",{className:"text-base-content/30",children:""}),(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,d.jsx)("span",{className:"text-base-content/50",children:q("Case sensitive:")}),(0,d.jsx)("span",{className:"text-base-content/70 font-medium",children:q(!1!==a.caseSensitive?"Yes":"No")})]}),(0,d.jsx)("span",{className:"text-base-content/30",children:""}),(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,d.jsx)("span",{className:"text-base-content/50",children:q("Only for TTS:")}),(0,d.jsx)("span",{className:"text-base-content/70 font-medium",children:q(!0===a.onlyForTTS?"Yes":"No")})]})]})]}),(0,d.jsxs)("div",{className:"absolute right-2 top-2 flex items-center gap-1",children:[(0,d.jsx)("button",{className:"btn btn-ghost btn-sm h-8 w-8 p-0",onClick:h,"aria-label":q("Edit"),children:(0,d.jsx)(g.RiEditLine,{className:"h-4 w-4"})}),(0,d.jsx)("button",{className:"btn btn-ghost btn-sm h-8 w-8 p-0",onClick:j,"aria-label":q("Delete"),children:(0,d.jsx)(g.RiDeleteBin7Line,{className:"h-4 w-4"})})]})]})};a.s(["ProofreadRulesManager",0,()=>{let a=(0,i.useTranslation)(),{envConfig:b}=(0,h.useEnv)(),{recreateViewer:c}=(0,k.useReaderStore)(),{sideBarBookKey:e}=(0,l.useSidebarStore)(),{updateRule:g,removeRule:o}=(0,n.useProofreadStore)(),[q,t]=(0,f.useState)(!1),[u,v]=(0,f.useState)({id:null,scope:null,pattern:"",replacement:"",enabled:!0,onlyForTTS:!1}),{singleRules:w,bookRules:x}=(a=>{let{settings:b}=(0,j.useSettingsStore)(),{getViewSettings:c}=(0,k.useReaderStore)(),{getConfig:d}=(0,m.useBookDataStore)(),e=a?c(a):null,f=e?.proofreadRules||[],g=a?d(a):null,h=g?.viewSettings?.proofreadRules||[],i=h.length?h:f,l=i.filter(a=>"selection"===a.scope),n=i.filter(a=>"book"===a.scope),o=b?.globalViewSettings?.proofreadRules||[],p=new Set(o.map(a=>a.id)),q=n.filter(a=>!1!==a.enabled||p.has(a.id)),r=q.concat(o.filter(a=>!q.find(b=>b.id===a.id)));return{singleRules:l,bookRules:r}})(e);(0,f.useEffect)(()=>{let a=a=>t(!!a.detail?.visible),b=document.getElementById(r);return b?.addEventListener("setProofreadRulesVisibility",a),()=>b?.removeEventListener("setProofreadRulesVisibility",a)},[]);let y=()=>{v({id:null,scope:null,pattern:"",replacement:"",enabled:!0,onlyForTTS:!1})},z=async()=>{u.id&&u.scope&&e&&(await g(b,e,u.id,{scope:u.scope,pattern:u.pattern,replacement:u.replacement,enabled:u.enabled,onlyForTTS:u.onlyForTTS}),y(),u.onlyForTTS||c(b,e))},A=async a=>{e&&(await o(b,e,a.id,a.scope),a.onlyForTTS||c(b,e))},B=(a,b,c,e)=>(0,d.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,d.jsx)("h3",{className:"text-base-content/90 text-sm font-semibold",children:c}),0===a.length?(0,d.jsx)("div",{className:"border-base-content/10 bg-base-200/30 rounded-lg border border-dashed p-6 text-center",children:(0,d.jsx)("p",{className:"text-base-content/50 text-sm",children:e})}):(0,d.jsx)("ul",{className:"flex flex-col gap-2",children:a.map(a=>(0,d.jsx)("li",{className:"border-base-content/10 bg-base-100 hover:border-base-content/20 rounded-lg border transition-colors",children:(0,d.jsx)(s,{rule:a,scope:"selection"===b?"selection":a.scope,isEditing:u.id===a.id&&u.scope===("selection"===b?"selection":a.scope),editingData:u,onEdit:()=>{v({id:a.id,scope:a.scope,pattern:a.pattern,replacement:a.replacement,enabled:!!a.enabled,onlyForTTS:!!a.onlyForTTS})},onDelete:()=>A(a),onSave:z,onCancel:y,onEditChange:(a,b)=>v({...u,replacement:b})})},a.id))})]});return(0,d.jsx)(p.default,{id:r,isOpen:q,onClose:()=>t(!1),title:a("Proofread Replacement Rules"),boxClassName:"sm:!min-w-[560px] sm:!max-w-[640px] sm:h-auto",children:q&&(0,d.jsxs)("div",{className:"flex max-h-[70vh] flex-col gap-6 p-4 sm:p-6",children:[B(w,"selection",a("Selected Text Rules"),a("No selected text replacement rules")),B(x,"book",a("Book Specific Rules"),a("No book-level replacement rules")),(0,d.jsx)("div",{className:"p-1"})]})})},"setProofreadRulesVisibility",0,a=>{let b=document.getElementById(r);b&&b.dispatchEvent(new CustomEvent("setProofreadRulesVisibility",{detail:{visible:a}}))}]),c()}catch(a){c(a)}},!1),330528,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(162650),h=a.i(765918),i=b([e,g]);[e,g]=i.then?(await i)():i,a.s(["Toast",0,()=>{let{safeAreaInsets:a}=(0,g.useThemeStore)(),[b,c]=(0,f.useState)(""),[i,j]=(0,f.useState)("info"),[k,l]=(0,f.useState)(5e3),[m,n]=(0,f.useState)(""),[o,p]=(0,f.useState)(!1),q=(0,f.useRef)(null),r={info:"toast-info toast-center toast-middle",success:"toast-success toast-top sm:toast-end toast-center",warning:"toast-warning toast-top sm:toast-end toast-center",error:"toast-error toast-top sm:toast-end toast-center"},s={info:(0,d.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),success:(0,d.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),warning:(0,d.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),error:(0,d.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})};(0,f.useEffect)(()=>{b&&setTimeout(()=>{p(!0)},0)},[b]),(0,f.useEffect)(()=>{if(q.current&&clearTimeout(q.current),b){let a=setTimeout(()=>{p(!1),setTimeout(()=>c(""),300)},k);return q.current=a,()=>{a&&clearTimeout(a)}}},[b,k]);let t=async a=>{let{message:b,type:d="info",timeout:e,className:f="",callback:g=null}=a.detail;c(b),j(d),e&&l(e),g&&"function"==typeof g&&setTimeout(()=>g(),e||5e3),n(f)};return(0,f.useEffect)(()=>(h.eventDispatcher.on("toast",t),()=>{h.eventDispatcher.off("toast",t)}),[]),b&&(0,d.jsx)("div",{className:(0,e.default)("toast z-50 w-auto max-w-screen-sm transition-all duration-300",r[i],o?"scale-100 opacity-100":"scale-95 opacity-0"),style:{top:r[i].includes("toast-top")?`${(a?.top||0)+44}px`:void 0},children:(0,d.jsxs)("div",{className:(0,e.default)("alert flex items-center gap-3 shadow-2xl backdrop-blur-sm","min-h-0 rounded-2xl px-5 py-4","not-eink:bg-gradient-to-r border-0",{info:"alert-primary border-base-300",success:"alert-success not-eink:from-green-500 not-eink:to-emerald-500",warning:"alert-warning not-eink:from-amber-500 not-eink:to-orange-500",error:"alert-error not-eink:from-red-500 not-eink:to-rose-500"}[i],"eink:bg-base-100 eink:border eink:border-base-content","info"!==i&&"text-white"),children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:s[i]}),(0,d.jsx)("span",{className:(0,e.default)("max-h-[50vh] flex-1 overflow-y-auto","font-sans text-base font-medium leading-snug sm:text-sm","info"===i?"max-w-[60vw] truncate sm:max-w-[80vw]":"min-w-[60vw] max-w-[80vw] whitespace-normal break-words sm:min-w-40 sm:max-w-80",m),children:b.split("\n").map((a,c)=>(0,d.jsxs)(f.default.Fragment,{children:[a||(0,d.jsx)(d.Fragment,{children:""}),c<b.split("\n").length-1&&(0,d.jsx)("br",{})]},c))}),(0,d.jsx)("button",{onClick:()=>{p(!1),setTimeout(()=>c(""),300),q.current&&clearTimeout(q.current)},className:(0,e.default)("flex-shrink-0 rounded-lg p-1 transition-colors","info"===i?"hover:bg-base-300":"hover:bg-white/20 active:bg-white/30"),"aria-label":"Dismiss",children:(0,d.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})}]),c()}catch(a){c(a)}},!1),792410,a=>{"use strict";var b=a.i(557469),c=a.i(177898);async function d(){return await (0,c.invoke)("plugin:deep-link|get_current")}a.i(518231);let e=async()=>{let{getMatches:b}=await a.A(840105),c=await b(),d=c?.args,e=[];if(d)for(let a of["file1","file2","file3","file4"]){let b=d[a];b&&b.occurrences>0&&e.push(b.value)}return e},f=async a=>{let b=await d();return b&&b.length>0?(console.log("Intent Open with URL:",b),b.map(b=>{if(b.startsWith("file://"))if(a?.isIOSApp)return decodeURI(b);else return decodeURI(b.replace("file://",""));return b.startsWith("content://")?b:(console.info("Skip non-file URL:",b),null)}).filter(a=>null!==a)):null},g=async a=>{let c;if((0,b.isWebAppPlatform)())return[];let d=(c=new URLSearchParams(window.location.search).getAll("file")).length>0?c:window.OPEN_WITH_FILES;return(!d||0===d.length)&&(0,b.hasCli)()&&(d=await e()),d&&0!==d.length||(d=await f(a)),d};a.s(["parseOpenWithFiles",0,g],792410)},756009,a=>{"use strict";var b=a.i(662210),c=a.i(518231),d=a.i(317841),e=a.i(607032),f=a.i(765918);let g=async()=>{let a=(0,b.getCurrentWindow)(),c=await a.scaleFactor(),d=await a.outerPosition();return{x:d.x/c,y:d.y/c}},h=async()=>{(0,b.getCurrentWindow)().minimize()},i=async()=>{let a=await (0,b.getCurrentWindow)().innerSize();a.width-=1,a.height-=1,await (0,b.getCurrentWindow)().setSize(a),setTimeout(async()=>{let a=await (0,b.getCurrentWindow)().innerSize();a.width+=1,a.height+=1,await (0,b.getCurrentWindow)().setSize(a)},100)},j=async()=>{let a=(0,b.getCurrentWindow)();await a.isFullscreen()?(await a.setFullscreen(!1),await a.unmaximize()):await a.toggleMaximize(),await (0,e.type)()==="linux"&&i()},k=async()=>{(0,b.getCurrentWindow)().close()},l=async a=>{let d=(0,b.getCurrentWindow)();return await d.onCloseRequested(async b=>{b.preventDefault(),await a(),d.label.startsWith("reader")?(await (0,c.emitTo)("main","close-reader-window",{label:d.label}),setTimeout(()=>d.destroy(),300)):"main"===d.label&&await d.destroy()})},m=async()=>{let a=(0,b.getCurrentWindow)(),c=await a.isFullscreen();await a.isMaximized()?await a.unmaximize():await a.setFullscreen(!c),await (0,e.type)()==="linux"&&i()},n=async()=>{await f.eventDispatcher.dispatch("quit-app"),await (0,d.exit)(0)};a.s(["tauriGetWindowLogicalPosition",0,g,"tauriHandleClose",0,k,"tauriHandleMinimize",0,h,"tauriHandleOnCloseWindow",0,l,"tauriHandleToggleFullScreen",0,m,"tauriHandleToggleMaximize",0,j,"tauriQuitApp",0,n])},452125,a=>{"use strict";a.s(["throttle",0,(a,b,c={emitLast:!0})=>{let d=0,e=null,f=null;return(...g)=>{let h=b-(Date.now()-d);h<=0?(e&&(clearTimeout(e),e=null),d=Date.now(),e=null,a(...g)):(f=g,e||(e=setTimeout(()=>{e=null,f&&c.emitLast&&(a(...f),f=null)},h)))}}])},187897,a=>{"use strict";a.i(667180),a.i(662210),a.i(909551);var b=a.i(557469),c=a.i(654617);a.s(["navigateToLibrary",0,(a,b,c,d)=>{a.replace(`/library${b?`?${b}`:""}`,c)},"navigateToLogin",0,a=>{let b=window.location.pathname,c=window.location.search;a.push(`/auth?redirect=${encodeURIComponent("/auth"!==b?b+c:"/")}`)},"navigateToReader",0,(a,d,e,f)=>{let g=d.join(c.BOOK_IDS_SEPARATOR);if((0,b.isWebAppPlatform)()&&!(0,b.isPWA)())a.push(`/reader/${g}${e?`?${e}`:""}`,f);else{let b=new URLSearchParams(e||"");b.set("ids",g),a.push(`/reader?${b.toString()}`,f)}}])},107218,a=>{"use strict";async function b(a,b){try{let c=await fetch(a),d=await c.blob(),e=new Image;e.crossOrigin="anonymous";let f=await fetch(b),g=await f.blob(),h=new Image;return h.crossOrigin="anonymous",new Promise((a,b)=>{let c=!1,f=!1,i=()=>{if(c&&f)try{let c,d,f,g,i=document.createElement("canvas"),j=i.getContext("2d");if(!j)return void b(Error("Failed to get canvas context"));i.width=512,i.height=512;let k=e.width/e.height;k>1?(c=512,d=512/k,f=0,g=(512-d)/2):(d=512,c=512*k,f=(512-c)/2,g=0),j.imageSmoothingEnabled=!0,j.imageSmoothingQuality="high",j.drawImage(e,f,g,c,d),j.drawImage(h,278,320,224,182),i.toBlob(c=>{c?a(c):b(Error("Failed to create blob"))},"image/jpeg",.9)}catch(a){b(Error(`Failed to process cover: ${a}`))}};e.onload=()=>{c=!0,i()},h.onload=()=>{f=!0,i()},e.onerror=()=>b(Error("Failed to load cover image")),h.onerror=()=>b(Error("Failed to load icon image"));let j=URL.createObjectURL(d),k=URL.createObjectURL(g);e.src=j,h.src=k,e.onload=function(){URL.revokeObjectURL(j),c=!0,i()},h.onload=function(){URL.revokeObjectURL(k),f=!0,i()}})}catch(a){throw console.error("Error processing Discord cover:",a),a}}async function c(a,b={}){let{targetWidth:d=256,format:e="image/jpeg",quality:f=.85}=b;try{let b=await fetch(a);if(!b.ok)throw Error(`Failed to fetch image: ${b.status} ${b.statusText}`);let c=await b.blob(),g=new Image;return g.crossOrigin="anonymous",new Promise((a,b)=>{g.onload=()=>{try{let c=g.height/g.width,h=Math.round(d*c),i=document.createElement("canvas"),j=i.getContext("2d");if(!j)return void b(Error("Failed to get canvas context"));i.width=d,i.height=h,j.imageSmoothingEnabled=!0,j.imageSmoothingQuality="high",j.drawImage(g,0,0,d,h);let k=i.toDataURL(e,f);a(k)}catch(a){b(Error(`Failed to scale image: ${a}`))}},g.onerror=()=>b(Error("Failed to load image for scaling"));let h=URL.createObjectURL(c);g.src=h;let i=g.onload,j=g.onerror;g.onload=function(a){URL.revokeObjectURL(h),i&&i.call(this,a)},g.onerror=function(a){URL.revokeObjectURL(h),j&&j.call(this,a)}})}catch(a){throw console.error("Error fetching and encoding image:",a),a}}a.s(["fetchImageAsBase64",()=>c,"processDiscordCover",()=>b])},687323,a=>a.a(async(b,c)=>{try{var d=a.i(177898),e=a.i(936114),f=a.i(107218),g=b([e]);[e]=g.then?(await g)():g;let h=new Map,i=async(a,b)=>{let c=h.get(a.hash);if(c){if(!(Date.now()-c.timestamp>36e5))return c.url??void 0;c.url||h.delete(a.hash)}try{let c=(0,e.getCoverFilename)(a);if(!await b.exists(c,"Books"))return void h.set(a.hash,{url:null,timestamp:Date.now()});let d=await b.resolveFilePath(c,"Books"),g=await b.getImageURL(d);await (0,f.processDiscordCover)(g,"/icon-tiny.png"),console.log("Processed Discord cover for book:",a.title),h.set(a.hash,{url:null,timestamp:Date.now()});return}catch(b){console.warn("Failed to process cover for Discord:",b),h.set(a.hash,{url:null,timestamp:Date.now()});return}},j=async(a,b,c)=>{if(c?.isDesktopApp)try{let e=await i(a,c),f={bookHash:a.hash,title:a.title,author:a.author||null,coverUrl:e||null,sessionStart:b};await (0,d.invoke)("update_book_presence",{presence:f})}catch(a){console.warn("Failed to update Discord presence:",a)}},k=async a=>{if(a?.isDesktopApp)try{await (0,d.invoke)("clear_book_presence")}catch(a){console.warn("Failed to clear Discord presence:",a)}};a.s(["clearDiscordPresence",0,k,"updateDiscordPresence",0,j]),c()}catch(a){c(a)}},!1),975494,a=>{"use strict";let b=new Set(["aa","ab","ae","af","ak","am","an","ar","as","av","ay","az","ba","be","bg","bh","bi","bm","bn","bo","br","bs","ca","ce","ch","co","cr","cs","cu","cv","cy","da","de","dv","dz","ee","el","en","eo","es","et","eu","fa","ff","fi","fj","fo","fr","fy","ga","gd","gl","gn","gu","gv","ha","he","hi","ho","hr","ht","hu","hy","hz","ia","id","ie","ig","ii","ik","io","is","it","iu","ja","jv","ka","kg","ki","kj","kk","kl","km","kn","ko","kr","ks","ku","kv","kw","ky","la","lb","lg","li","ln","lo","lt","lu","lv","mg","mh","mi","mk","ml","mn","mr","ms","mt","my","na","nb","nd","ne","ng","nl","nn","no","nr","nv","ny","oc","oj","om","or","os","pa","pi","pl","ps","pt","qu","rm","rn","ro","ru","rw","sa","sc","sd","se","sg","si","sk","sl","sm","sn","so","sq","sr","ss","st","su","sv","sw","ta","te","tg","th","ti","tk","tl","tn","to","tr","ts","tt","tw","ty","ug","uk","ur","uz","ve","vi","vo","wa","wo","xh","yi","yo","za","zh","zu"]);a.s(["validateAndNormalizeDate",0,a=>{if(!a)return{isValid:!0,value:""};let b=a.trim();if(![{pattern:/^\d{4}$/,format:"YYYY"},{pattern:/^\d{4}-\d{2}$/,format:"YYYY-MM"},{pattern:/^\d{4}-\d{2}-\d{2}$/,format:"YYYY-MM-DD"}].find(({pattern:a})=>a.test(b)))return{isValid:!1,value:null,error:"Invalid date format. Use YYYY, YYYY-MM, or YYYY-MM-DD"};try{let a;if(a=new Date(4===b.length?`${b}-01-01`:7===b.length?`${b}-01`:b),isNaN(a.getTime()))return{isValid:!1,value:null,error:"Invalid date"};let c=a.getFullYear(),d=new Date().getFullYear();if(c<1e3||c>d+10)return{isValid:!1,value:null,error:`Year must be between 1000 and ${d+10}`};if(b.length>=7){let a=parseInt(b.substring(5,7));if(a<1||a>12)return{isValid:!1,value:null,error:"Month must be between 01 and 12"}}if(10===b.length){let a=parseInt(b.substring(8,10));if(a<1||a>31)return{isValid:!1,value:null,error:"Day must be between 01 and 31"}}return{isValid:!0,value:a.toISOString()}}catch{return{isValid:!1,value:null,error:"Failed to parse date"}}},"validateAndNormalizeLanguage",0,a=>{if(!a)return{isValid:!0,value:"unknown"};let c=a.trim().toLowerCase();if(!/^[a-z]{2}(-[a-z]{2,4})?$/i.test(c))return{isValid:!1,value:null,error:"Invalid language format. Use ISO 639-1 codes (e.g., en, zh-CN)"};let d=c.substring(0,2);return b.has(d)?{isValid:!0,value:c}:{isValid:!1,value:null,error:`Invalid language code: ${d}. Must be a valid ISO 639-1 code`}},"validateAndNormalizeSubjects",0,a=>{if(!a)return{isValid:!0,value:[]};let b=a.split(",").map(a=>a.trim());if(b.length>20)return{isValid:!1,value:null,error:"Too many subjects (max 20)"};let c=b.find(a=>a.length>100);return c?{isValid:!1,value:null,error:`Subject too long (max 100 characters): ${c}`}:{isValid:!0,value:b}},"validateISBN",0,a=>{if(!a)return{isValid:!0,value:""};let b=a.replace(/[-\s]/g,"");if(10!==b.length&&13!==b.length)return{isValid:!1,value:null,error:"ISBN must be 10 or 13 digits"};if(10===b.length){let a=(a=>{let b=0;for(let c=0;c<9;c++){let d=parseInt(a[c]);if(isNaN(d))return!1;b+=d*(10-c)}let c=a[9],d="X"===c?10:parseInt(c);return!isNaN(d)&&(b+=d)%11==0})(b);return{isValid:a,value:a?b:null,error:a?void 0:"Invalid ISBN-10 checksum"}}if(13===b.length){let a=(a=>{let b=0;for(let c=0;c<12;c++){let d=parseInt(a[c]);if(isNaN(d))return!1;b+=d*(c%2==0?1:3)}let c=parseInt(a[12]);return!isNaN(c)&&c===(10-b%10)%10})(b);return{isValid:a,value:a?b:null,error:a?void 0:"Invalid ISBN-13 checksum"}}return{isValid:!1,value:null,error:"Invalid ISBN format"}}])},75788,a=>a.a(async(b,c)=>{try{var d=a.i(866816),e=b([d]);[d]=e.then?(await e)():e;let f=async(a,b)=>{let c=await (0,d.getAccessToken)();if(!c)throw Error("Not authenticated");let e={...b.headers,Authorization:`Bearer ${c}`},f=await fetch(a,{...b,headers:e});if(!f.ok){let a=await f.json();throw console.error("Error:",a.error||f.statusText),Error(a.error||"Request failed")}return f};a.s(["fetchWithAuth",0,f]),c()}catch(a){c(a)}},!1),317071,a=>a.a(async(b,c)=>{try{var d=a.i(557469),e=a.i(75788),f=b([e]);[e]=f.then?(await f)():f;let g=(0,d.getAPIBaseUrl)()+"/metadata/search",h=async a=>{let b=await (0,e.fetchWithAuth)(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),c=await b.json();if(!c.success)throw Error(c.error||"Search failed");return c.data||[]};a.s(["searchMetadata",0,h]),c()}catch(a){c(a)}},!1),364893,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(975494),f=a.i(317071),g=a.i(936114),h=b([f,g]);[f,g]=h.then?(await h)():h,a.s(["useMetadataEdit",0,a=>{let[b,c]=(0,d.useState)({}),[h,i]=(0,d.useState)({}),[j,k]=(0,d.useState)({}),[l,m]=(0,d.useState)({}),[n,o]=(0,d.useState)(!1),[p,q]=(0,d.useState)(!1),[r,s]=(0,d.useState)([]),t=["title","author","publisher","published","language","identifier","subject","description","subtitle","series","seriesIndex","seriesTotal","coverImageUrl"];(0,d.useEffect)(()=>{a&&c({...a})},[a]),(0,d.useEffect)(()=>{let a={};t.forEach(b=>{a[b]=!1}),k(a)},[]);let u=(a,b)=>{let c;if(j[a])return!0;switch(a){case"title":case"author":if(!b.trim())return console.warn(`Field ${a} cannot be empty`),m(b=>({...b,[a]:"This field is required"})),!1;break;case"published":if(b.trim()&&!(c=(0,e.validateAndNormalizeDate)(b)).isValid)return console.warn(`Invalid date for field ${a}:`,c.error),m(b=>({...b,[a]:c.error||""})),!1;break;case"language":if(b.trim()&&!(c=(0,e.validateAndNormalizeLanguage)(b)).isValid)return console.warn(`Invalid language for field ${a}:`,c.error),m(b=>({...b,[a]:c.error||""})),!1;break;case"subject":if(b.trim()&&!(c=(0,e.validateAndNormalizeSubjects)(b)).isValid)return console.warn(`Invalid subjects for field ${a}:`,c.error),m(b=>({...b,[a]:c.error||""})),!1}return m(b=>{let c={...b};return delete c[a],c}),!0},v=()=>{let a={};t.forEach(b=>{a[b]=!1}),k(a)},w=async()=>{o(!0);try{let a=(0,e.validateISBN)(b.identifier||""),c=(await (0,f.searchMetadata)({title:(0,g.formatTitle)(b.title),author:(0,g.formatAuthors)(b.author),isbn:a.isValid?b.identifier:void 0,language:(0,g.getPrimaryLanguage)(b.language)})).map(a=>({sourceName:a.providerName,sourceLabel:a.providerLabel,confidence:a.confidence,data:a.metadata}));s(c),q(!0)}catch(a){console.error("Failed to retrieve metadata:",a)}finally{o(!1)}};return{editedMeta:b,fieldSources:h,lockedFields:j,fieldErrors:l,searchLoading:n,showSourceSelection:p,availableSources:r,handleFieldChange:(a,b)=>{!j[a]&&(c(c=>{let d={...c};return"subject"===a?d.subject=b?b.split(/,|;||/).map(a=>a.trim()):[]:d[a]=b,d}),void 0!==b&&u(a,b),h[a]&&i(b=>{let c={...b};return delete c[a],c}))},handleFieldValidation:u,handleToggleFieldLock:a=>{k(b=>({...b,[a]:!b[a]}))},handleLockAll:()=>{let a={};t.forEach(b=>{a[b]=!0}),k(a)},handleUnlockAll:v,handleAutoRetrieve:w,handleSourceSelection:a=>{let d={...b},e={...h};Object.entries(a.data).forEach(([b,c])=>{!j[b]&&c&&(d[b]=c,e[b]=`${a.sourceName}-${a.confidence}`)}),c(d),i(e),q(!1)},handleCloseSourceSelection:()=>{q(!1)},resetToOriginal:()=>{a&&c({...a}),i({}),q(!1),v()}}}]),c()}catch(a){c(a)}},!1),629474,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(108328),g=a.i(765918),h=b([f]);[f]=h.then?(await h)():h,a.s(["useKeyDownActions",0,({onCancel:a,onConfirm:b,enabled:c=!0,elementRef:h})=>{let{appService:i}=(0,e.useEnv)(),{acquireBackKeyInterception:j,releaseBackKeyInterception:k}=(0,f.useDeviceControlStore)(),l=(0,d.useRef)(null),m=h||l;return(0,d.useEffect)(()=>{if(!c)return;let d=c=>{if(c instanceof CustomEvent){if("Back"===c.detail.keyName)return a?.(),!0}else"Escape"===c.key?a?.():"Enter"===c.key&&b?.(),c.stopPropagation();return!1};return window.addEventListener("keydown",d),m.current&&m.current.addEventListener("keydown",d),i?.isAndroidApp&&(j?.(),g.eventDispatcher.onSync("native-key-down",d)),()=>{window.removeEventListener("keydown",d),i?.isAndroidApp&&(k?.(),g.eventDispatcher.offSync("native-key-down",d))}},[c,i?.isAndroidApp]),l}]),c()}catch(a){c(a)}},!1),408124,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(915302),h=a.i(629474),i=b([e,h]);[e,h]=i.then?(await i)():i,a.s(["default",0,({title:a,message:b,onCancel:c,onConfirm:i})=>{let j=(0,g.useTranslation)(),[k,l]=f.default.useState(!1),m=(0,h.useKeyDownActions)({onCancel:c,onConfirm:i});return(0,d.jsx)("div",{className:(0,e.default)("z-[100] flex justify-center px-4"),children:(0,d.jsxs)("div",{ref:m,role:"alert",className:(0,e.default)("alert flex items-center justify-between","bg-base-300 rounded-lg border-none p-4 shadow-2xl","w-full max-w-[90vw] sm:max-w-[70vw] md:max-w-[50vw] lg:max-w-[40vw] xl:max-w-[40vw]","min-w-[70vw] flex-col sm:min-w-[40vw] sm:flex-row"),children:[(0,d.jsxs)("div",{className:"labels flex items-center space-x-2 self-start sm:space-x-4 sm:self-center",children:[(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-info h-6 w-6 shrink-0",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,d.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,d.jsx)("h3",{className:"text-start text-sm font-medium sm:text-center",children:a}),(0,d.jsx)("div",{className:"text-start text-sm sm:text-center",children:b})]})]}),(0,d.jsxs)("div",{className:"buttons flex flex-wrap items-center justify-end gap-2 self-end sm:max-w-[20vw] sm:self-center",children:[(0,d.jsx)("button",{className:"btn btn-sm btn-neutral",onClick:c,children:j("Cancel")}),(0,d.jsx)("button",{className:(0,e.default)("btn btn-sm btn-warning",{"btn-disabled":k}),onClick:()=>{l(!0),i()},children:j("Confirm")})]})]})})}]),c()}catch(a){c(a)}},!1),340980,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(266602),g=a.i(127669),h=a.i(936114),i=b([e,h]);[e,h]=i.then?(await i)():i;let j=(0,g.memo)(({book:a,mode:b="grid",coverFit:c="crop",showSpine:i=!1,className:j,imageClassName:k,isPreview:l,onImageError:m})=>{let n=(0,g.useRef)(null),[o,p]=(0,g.useState)(!1),[q,r]=(0,g.useState)(!1),s=i&&o&&!q,t=a=>{if(n.current){let b=n.current.querySelector(".cover-image"),c=n.current.querySelector(".fallback-cover");b&&b.classList.toggle("invisible",!a),c&&c.classList.toggle("invisible",a)}},u=()=>{p(!0),r(!1),t(!0)},v=()=>{p(!1),r(!0),t(!1),m?.()};return(0,g.useEffect)(()=>{t(!0)},[a.metadata?.coverImageUrl,a.coverImageUrl]),(0,d.jsxs)("div",{ref:n,className:(0,e.default)("book-cover-container relative flex h-full w-full",j),children:["crop"===c?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f.default,{src:a.metadata?.coverImageUrl||a.coverImageUrl,alt:a.title,fill:!0,className:(0,e.default)("cover-image crop-cover-img object-cover",k),onLoad:u,onError:v}),(0,d.jsx)("div",{className:`book-spine absolute inset-0 ${s?"visible":"invisible"}`})]}):(0,d.jsx)("div",{className:(0,e.default)("flex h-full w-full justify-start"),children:(0,d.jsxs)("div",{className:(0,e.default)("flex h-full max-h-full items-end","grid"===b?"items-end":"items-center"),children:[(0,d.jsx)(f.default,{src:a.metadata?.coverImageUrl||a.coverImageUrl,alt:a.title,width:0,height:0,sizes:"100vw",className:(0,e.default)("cover-image fit-cover-img h-auto max-h-full w-auto max-w-full shadow-md",k),onLoad:u,onError:v}),(0,d.jsx)("div",{className:`book-spine absolute inset-0 ${s?"visible":"invisible"}`})]})}),(0,d.jsxs)("div",{className:(0,e.default)("fallback-cover invisible absolute inset-0 p-2","text-neutral-content text-center font-serif font-medium",l?"bg-base-200/50":"bg-base-100",k),children:[(0,d.jsx)("div",{className:"flex h-1/2 items-center justify-center",children:(0,d.jsx)("span",{className:(0,e.default)(l?"line-clamp-2":"grid"===b?"line-clamp-3":"line-clamp-2",l?"text-[0.5em]":"grid"===b?"text-lg":"text-sm"),children:(0,h.formatTitle)(a.title)})}),(0,d.jsx)("div",{className:"h-1/6"}),(0,d.jsx)("div",{className:"flex h-1/3 items-center justify-center",children:(0,d.jsx)("span",{className:(0,e.default)("text-neutral-content/50 line-clamp-1",l?"text-[0.4em]":"grid"===b?"text-base":"text-xs"),children:(0,h.formatAuthors)(a.author)})})]})]})},(a,b)=>a.book.coverImageUrl===b.book.coverImageUrl&&a.book.metadata?.coverImageUrl===b.book.metadata?.coverImageUrl&&a.book.updatedAt===b.book.updatedAt&&a.mode===b.mode&&a.coverFit===b.coverFit&&a.isPreview===b.isPreview&&a.showSpine===b.showSpine&&a.className===b.className&&a.imageClassName===b.imageClassName);j.displayName="BookCover",a.s(["default",0,j]),c()}catch(a){c(a)}},!1),937065,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(547274),g=a.i(915302),h=a.i(106865),i=b([e]);[e]=i.then?(await i)():i,a.s(["default",0,({label:a,toggled:b,description:c,tooltip:i,buttonClass:j,labelClass:k,shortcut:l,disabled:m,noIcon:n=!1,transient:o=!1,Icon:p,iconClassName:q,children:r,siblings:s,onClick:t,setIsDropdownOpen:u})=>{let v=(0,g.useTranslation)(),w=(0,h.useResponsiveSize)(16),x=p||(void 0!==b&&b?f.MdCheck:void 0),y=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex min-w-0 items-center",children:[!n&&(0,d.jsx)("span",{style:{minWidth:`${w}px`},children:"function"==typeof x?(0,d.jsx)(x,{className:(0,e.default)(m?"text-gray-400":"text-base-content",q),size:w}):x}),(0,d.jsx)("span",{className:(0,e.default)("mx-2 flex-1 truncate text-base sm:text-sm",k),style:{minWidth:0},children:a})]}),l&&(0,d.jsx)("kbd",{className:(0,e.default)("border-base-300/40 bg-base-300/75 hidden rounded-md border shadow-sm sm:flex","shrink-0 px-1.5 py-0.5 text-xs font-medium",m?"text-gray-400":"text-neutral-content"),children:l})]}),(0,d.jsx)("div",{className:"flex w-full",children:c&&(0,d.jsx)("span",{className:"mt-1 truncate text-start text-xs text-gray-500",style:{minWidth:0,paddingInlineStart:n?"0":`${w+8}px`},children:c})})]});return r?(0,d.jsx)("ul",{className:"menu rounded-box m-0 p-0",role:"menuitem",tabIndex:-1,children:(0,d.jsx)("li",{"aria-label":a,children:(0,d.jsxs)("details",{children:[(0,d.jsx)("summary",{className:(0,e.default)("hover:bg-base-300 text-base-content cursor-pointer rounded-md p-1 py-[10px] pr-3",m&&"btn-disabled cursor-not-allowed text-gray-400",j),title:i||"",children:y}),r]})})}):(0,d.jsxs)("div",{className:"flex",children:[(0,d.jsx)("button",{role:m?"none":"menuitem","aria-label":void 0!==b?`${a} - ${v(b?"ON":"OFF")}`:void 0,"aria-live":void 0===b?"polite":"off",tabIndex:m?-1:0,className:(0,e.default)("hover:bg-base-300 text-base-content flex w-full flex-col items-center justify-center rounded-md p-1 py-[10px]",m&&"btn-disabled text-gray-400",j),title:i||"",onClick:()=>{t?.(),o&&u?.(!1)},disabled:m,children:y}),s]})}]),c()}catch(a){c(a)}},!1),320776,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(240009),h=a.i(937065),i=b([e,g,h]);[e,g,h]=i.then?(await i)():i,a.s(["default",0,({label:a,className:b,menuClassName:c,buttonClassName:i,toggleButton:j,children:k,disabled:l,onToggle:m})=>{var n;let o,[p,q]=(0,f.useState)(!1),[r,s]=(0,f.useState)(!1),t=(0,f.useRef)(!1),u=(0,f.useRef)(null),v=a=>{l||(q(a),m?.(a))},w=()=>{t.current=!0,setTimeout(()=>t.current=!1,200)},x=(0,f.isValidElement)(k)?f.default.cloneElement(k,{..."string"!=typeof k.type&&{setIsDropdownOpen:v,menuClassName:c},children:(n=k.props?.children,o=a=>{if(!(0,f.isValidElement)(a))return a;let b=a.type===h.default||"function"==typeof a.type&&"MenuItem"===a.type.name?f.default.cloneElement(a,{setIsDropdownOpen:v,...a.props}):a;return b.props?.children?f.default.cloneElement(b,{...b.props,children:f.default.Children.map(b.props.children,o)}):b},f.default.Children.map(n,o))}):k;return(0,d.jsxs)("div",{className:"dropdown-container flex",children:[p&&(0,d.jsx)(g.Overlay,{onDismiss:()=>v(!1)}),(0,d.jsxs)("div",{ref:u,role:"menu",tabIndex:-1,onBlur:a=>{u.current&&(u.current.contains(a.relatedTarget)||(s(!1),v(!1)))},onKeyDown:a=>{"Enter"===a.key||" "===a.key?(p||v(!0),a.stopPropagation()):"Escape"===a.key&&(v(!1),a.stopPropagation())},className:(0,e.default)("dropdown flex flex-col",b),children:[(0,d.jsx)("button",{"aria-haspopup":"menu","aria-expanded":p,"aria-label":a,title:a,className:(0,e.default)("dropdown-toggle touch-target",r&&p&&"bg-base-300/50",i),onTouchStart:w,onPointerDown:w,onFocus:()=>{s(!0),t.current||v(!0)},onClick:()=>{s(!p),v(!p)},children:j}),(0,d.jsx)("div",{role:"none",className:(0,e.default)("flex items-center justify-center"),children:p&&x})]})]})}]),c()}catch(a){c(a)}},!1),221938,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(547274),g=a.i(915302),h=a.i(936114),i=a.i(340980),j=a.i(320776),k=a.i(937065),l=b([e,h,i,j,k]);[e,h,i,j,k]=l.then?(await l)():l,a.s(["default",0,({book:a,metadata:b,fileSize:c,onEdit:l,onDelete:m,onDeleteCloudBackup:n,onDeleteLocalCopy:o,onDownload:p,onUpload:q,onExport:r})=>{let s=(0,g.useTranslation)();return(0,d.jsxs)("div",{className:"relative w-full rounded-lg",children:[(0,d.jsxs)("div",{className:"mb-6 me-4 flex h-32 items-start",children:[(0,d.jsx)("div",{className:"me-6 aspect-[28/41] h-32 shadow-lg sm:me-10",children:(0,d.jsx)(i.default,{mode:"list",book:a})}),(0,d.jsxs)("div",{className:"title-author flex h-32 flex-col justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-base-content mb-2 line-clamp-2 break-words text-lg font-bold",children:(0,h.formatTitle)(a.title).replace(/\u00A0/g," ")||s("Untitled")}),(0,d.jsx)("p",{className:"text-neutral-content line-clamp-1",children:(0,h.formatAuthors)(a.author,a.primaryLanguage)||s("Unknown")})]}),(0,d.jsxs)("div",{className:"flex flex-nowrap items-center gap-3 sm:gap-x-4",children:[l&&(0,d.jsx)("button",{onClick:l,className:b?"":"btn-disabled opacity-50",title:s("Edit Metadata"),children:(0,d.jsx)(f.MdOutlineEdit,{className:"hover:fill-blue-500"})}),m&&(0,d.jsx)(j.default,{label:s("Delete Book Options"),className:"dropdown-bottom flex justify-center",buttonClassName:"btn btn-ghost h-8 min-h-8 w-8 p-0",toggleButton:(0,d.jsx)(f.MdOutlineDelete,{className:"fill-red-500"}),children:(0,d.jsxs)("div",{className:(0,e.default)("delete-menu dropdown-content dropdown-center no-triangle","border-base-300 !bg-base-200 z-20 mt-1 max-w-[90vw] shadow-2xl"),children:[(0,d.jsx)(k.default,{noIcon:!0,transient:!0,label:s("Remove from Cloud & Device"),onClick:m}),(0,d.jsx)(k.default,{noIcon:!0,transient:!0,label:s("Remove from Cloud Only"),onClick:n,disabled:!a.uploadedAt}),(0,d.jsx)(k.default,{noIcon:!0,transient:!0,label:s("Remove from Device Only"),onClick:o,disabled:!a.downloadedAt})]})}),a.uploadedAt&&p&&(0,d.jsx)("button",{onClick:p,title:s("Download from Cloud"),children:(0,d.jsx)(f.MdOutlineCloudDownload,{className:"fill-base-content"})}),a.downloadedAt&&q&&(0,d.jsx)("button",{onClick:q,title:s("Upload to Cloud"),children:(0,d.jsx)(f.MdOutlineCloudUpload,{className:"fill-base-content"})}),a.downloadedAt&&r&&(0,d.jsx)("button",{onClick:r,title:s("Export Book"),children:(0,d.jsx)(f.MdSaveAlt,{className:"fill-base-content"})})]})]})]}),(0,d.jsxs)("div",{className:"text-base-content my-4",children:[(0,d.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4 sm:grid-cols-3",children:[(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("Publisher")}),(0,d.jsx)("p",{className:"text-neutral-content text-sm",children:(0,h.formatPublisher)(b?.publisher||"")||s("Unknown")})]}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("Published")}),(0,d.jsx)("p",{className:"text-neutral-content text-sm",children:(0,h.formatDate)(b?.published,!0)||s("Unknown")})]}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("Updated")}),(0,d.jsx)("p",{className:"text-neutral-content text-sm",children:(0,h.formatDate)(a.updatedAt)||""})]}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("Added")}),(0,d.jsx)("p",{className:"text-neutral-content text-sm",children:(0,h.formatDate)(a.createdAt)||""})]}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("Language")}),(0,d.jsx)("p",{className:"text-neutral-content text-sm",children:(0,h.formatLanguage)(b?.language)||s("Unknown")})]}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("Subjects")}),(0,d.jsx)("p",{className:"text-neutral-content line-clamp-3 text-sm",children:(0,h.formatAuthors)(b?.subject||"")||s("Unknown")})]}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("Format")}),(0,d.jsx)("p",{className:"text-neutral-content text-sm",children:a.format||s("Unknown")})]}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[(0,d.jsx)("span",{className:"font-bold",children:s("File Size")}),(0,d.jsx)("p",{className:"text-neutral-content text-sm",children:(0,h.formatBytes)(c)||s("Unknown")})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-bold",children:s("Description")}),(0,d.jsx)("p",{className:"text-neutral-content prose prose-sm max-w-full whitespace-pre-line text-sm",dangerouslySetInnerHTML:{__html:b?.description||s("No description available")}})]})]})]})}]),c()}catch(a){c(a)}},!1),495697,a=>{"use strict";var b=a.i(557469),c=a.i(138559),d=a.i(465863),e=a.i(654617);let f=async(a,b,d)=>{let e=b?.isIOSApp||b?.isAndroidApp&&"books"===a.type,f=e?[]:a.extensions||[],g=a.dialogTitle||d("Select Files"),h=await b?.selectFiles(d(g),f)||[];return e&&a.extensions&&(h=await Promise.all(h.map(async d=>{let e=d;b?.isAndroidApp&&d.startsWith("content://")&&(e=await (0,c.basename)(d));let f=e.split(".").pop()?.toLowerCase()||"unknown",g=a.extensions;return g.includes(f)||g.includes("*")?d:null})).then(a=>a.filter(a=>null!==a))),h},g={generic:{accept:"*/*",extensions:["*"],dialogTitle:(0,d.stubTranslation)("Select Files")},images:{accept:"image/*",extensions:["jpg","jpeg","png","gif","webp","svg"],dialogTitle:(0,d.stubTranslation)("Select Image")},videos:{accept:"video/*",extensions:["mp4","avi","mov","wmv","flv","webm"],dialogTitle:(0,d.stubTranslation)("Select Video")},audio:{accept:"audio/*",extensions:["mp3","wav","ogg","flac","m4a"],dialogTitle:(0,d.stubTranslation)("Select Audio")},books:{accept:e.BOOK_ACCEPT_FORMATS,extensions:e.SUPPORTED_BOOK_EXTS,dialogTitle:(0,d.stubTranslation)("Select Books")},fonts:{accept:".ttf, .otf, .woff, .woff2",extensions:["ttf","otf","woff","woff2"],dialogTitle:(0,d.stubTranslation)("Select Fonts")},covers:{accept:".png, .jpg, .jpeg, .gif",extensions:["png","jpg","jpeg","gif"],dialogTitle:(0,d.stubTranslation)("Select Image")}};a.s(["useFileSelector",0,(a,c)=>({selectFiles:async(d={type:"generic"})=>{if(d={...g[d.type],...d},!a)return{files:[],error:"App service is not available"};try{if((0,b.isTauriAppPlatform)()){let b=await f(d,a,c);return{files:await b.map(a=>({path:a}))}}{let a;return{files:(await (a=d,new Promise(b=>{let c=document.createElement("input");c.type="file",c.accept=a.accept||"*/*",c.multiple=a.multiple||!1,c.click(),c.onchange=()=>{b(Array.from(c.files||[]))}}))).map(a=>({file:a}))}}}catch(a){return{files:[],error:a instanceof Error?a.message:"Unknown error occurred"}}}})])},437544,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(547274),g=a.i(915302),h=b([e]);[e]=h.then?(await h)():h;let i="w-full rounded-md px-3 py-2 focus:outline-none focus:ring-1 focus:ring-blue-500",j="bg-base-200/50",k=({source:a})=>{if(!a)return null;let[b,c]=a.split("-"),g=parseInt(c),h="text-green-500";return g<90&&(h="text-yellow-500"),g<70&&(h="text-red-500"),(0,d.jsxs)("div",{className:"flex items-center justify-end gap-1 text-xs",children:[(0,d.jsx)(f.MdOutlineInfo,{className:(0,e.default)("h-3 w-3",h)}),(0,d.jsxs)("span",{className:(0,e.default)("capitalize",h),children:[b," (",c,"%)"]})]})},l=({isLocked:a,onToggle:b,disabled:c=!1})=>(0,d.jsx)("button",{type:"button",onClick:b,disabled:c,className:(0,e.default)("focus:outline-non absolute right-2 top-1/2 -translate-y-1/2 rounded p-1 transition-colors",c&&"cursor-not-allowed opacity-50",a?"bg-green-100 text-green-500 hover:bg-green-200":"text-base-content"),title:a?"Unlock field":"Lock field",children:a?(0,d.jsx)(f.MdLock,{className:"h-4 w-4"}):(0,d.jsx)(f.MdLockOpen,{className:"h-4 w-4"})}),m=({type:a="input",field:b,label:c,fieldSources:h,lockedFields:m,fieldErrors:n,isNumber:o=!1,required:p=!1,lockable:q=!0,disabled:r=!1,onToggleFieldLock:s,value:t,onFieldChange:u,placeholder:v,rows:w,className:x})=>{let y=(0,g.useTranslation)(),z=m[b],A=h[b],B=n[b];return(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,d.jsxs)("div",{className:(0,e.default)("text-base-content block text-sm font-medium","flex items-center justify-between"),children:[(0,d.jsxs)("span",{children:[c," ",p&&"*"]}),z&&(0,d.jsxs)("span",{className:"flex items-center gap-1 text-xs text-green-500",children:[(0,d.jsx)(f.MdLock,{className:"h-3 w-3"}),y("Locked")]})]}),(0,d.jsxs)("div",{className:"relative",children:["input"===a?(0,d.jsx)("input",{type:o?"number":"text",min:1,value:t,onChange:a=>u(b,a.target.value),placeholder:z?"":v,disabled:r||z,className:(0,e.default)(i,j,q&&"pe-10",z?"cursor-not-allowed":"bg-gray-100 text-gray-500",B&&"border-red-500 focus:ring-red-500",x)}):(0,d.jsx)("textarea",{value:t,onChange:a=>u(b,a.target.value),placeholder:z?"":v,rows:w||4,disabled:r||z,className:(0,e.default)(i,j,q&&"pe-10",z?"cursor-not-allowed":"bg-gray-100 text-gray-500",B&&"border-red-500 focus:ring-red-500",x)}),q&&(0,d.jsx)(l,{isLocked:z,onToggle:()=>s(b)})]}),B&&(0,d.jsxs)("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[(0,d.jsx)(f.MdError,{className:"h-3 w-3"}),(0,d.jsx)("span",{children:B})]}),!B&&(0,d.jsx)(k,{source:A})]})};a.s(["FormField",()=>m]),c()}catch(a){c(a)}},!1),728131,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(547274),h=a.i(178552),i=a.i(915302),j=a.i(936114),k=a.i(495697),l=a.i(437544),m=a.i(340980),n=b([e,j,l,m]);[e,j,l,m]=n.then?(await n)():n;let o="_blank";a.s(["default",0,({book:a,metadata:b,fieldSources:c,lockedFields:n,fieldErrors:p,searchLoading:q,onFieldChange:r,onToggleFieldLock:s,onAutoRetrieve:t,onLockAll:u,onUnlockAll:v,onCancel:w,onReset:x,onSave:y})=>{let z=(0,i.useTranslation)(),{appService:A}=(0,h.useEnv)(),{selectFiles:B}=(0,k.useFileSelector)(A,z),C=Object.values(n).some(a=>a),D=Object.values(n).every(a=>a),E=n.coverImageUrl||!1,F=b.coverImageUrl||null,[G,H]=(0,f.useState)(F),I=[{field:"title",label:z("Title"),required:!0,value:(0,j.formatTitle)(b.title),placeholder:z("Enter book title")},{field:"subtitle",label:z("Subtitle"),required:!1,value:(0,j.formatTitle)(b.subtitle||""),placeholder:z("Enter book subtitle")},{field:"author",label:z("Author"),required:!0,value:(0,j.formatAuthors)(b.author),placeholder:z("Enter author name")}],J=[{field:"series",label:z("Series"),value:b.series||"",placeholder:z("Enter series name")},{field:"seriesIndex",label:z("Series Index"),isNumber:!0,value:String(b.seriesIndex||""),placeholder:z("Enter series index")},{field:"seriesTotal",label:z("Total in Series"),isNumber:!0,value:String(b.seriesTotal||""),placeholder:z("Enter total books in series")},{field:"publisher",label:z("Publisher"),value:(0,j.formatPublisher)(b.publisher||""),placeholder:z("Enter publisher")},{field:"published",label:z("Publication Date"),value:b.published||"",placeholder:z("YYYY or YYYY-MM-DD")},{field:"language",label:z("Language"),value:Array.isArray(b.language)?b.language.join(", "):b.language||"",placeholder:"en, zh, fr"},{field:"identifier",label:z("Identifier"),value:b.identifier||"",placeholder:"978-0123456789"}],K=[{field:"subject",label:z("Subjects"),value:(0,j.flattenContributors)(b.subject||[]),placeholder:z("Fiction, Science, History")},{field:"description",label:z("Description"),type:"textarea",rows:4,value:b.description||"",placeholder:z("Enter book description")}],L=async()=>{B({type:"covers",multiple:!1}).then(async a=>{if(a.error||0===a.files.length)return;let b=a.files[0];if(b.path&&A){let a=b.path,c=await A.getCachedImageUrl(a);r("coverImageFile",a),r("coverImageUrl",c),H(c)}else if(b.file){let a=URL.createObjectURL(b.file);r("coverImageBlobUrl",a),H(a)}})};return(0,d.jsxs)("div",{className:"bg-base-100 relative w-full rounded-lg",children:[(0,d.jsxs)("div",{className:"mb-6 flex items-stretch gap-4",children:[(0,d.jsxs)("div",{className:"cover-field flex w-[30%] max-w-32 flex-col gap-2",children:[(0,d.jsx)("button",{className:"aspect-[28/41] h-full shadow-md",onClick:E?void 0:L,children:(0,d.jsx)(m.default,{mode:"list",book:{...a,metadata:{...b,coverImageUrl:G||b.coverImageUrl},...G?{coverImageUrl:G}:{}}})}),(0,d.jsxs)("div",{className:"flex w-full justify-between gap-1",children:[(0,d.jsxs)("button",{onClick:L,disabled:E,className:(0,e.default)("flex w-1/2 min-w-0 items-center justify-center gap-1 rounded p-1 sm:w-3/5","text-sm hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 sm:text-xs",E?"!text-base-content bg-base-200":"bg-gray-100 !text-gray-500"),title:z("Change cover image"),children:[(0,d.jsx)(g.MdEdit,{className:(0,e.default)("h-5 w-5 flex-shrink-0 sm:h-4 sm:w-4",E?"fill-base-content":"fill-gray-600")}),(0,d.jsx)("span",{className:"hidden truncate sm:inline",children:z("Replace")})]}),(0,d.jsx)("button",{onClick:()=>{H(o),r("coverImageUrl",o),r("coverImageFile",void 0),r("coverImageBlobUrl",void 0)},disabled:E,className:(0,e.default)("flex w-1/4 items-center justify-center rounded p-1 sm:w-1/5","disabled:cursor-not-allowed disabled:opacity-50","text-red-500 hover:bg-red-50 hover:text-red-600",E?"!text-base-content bg-base-200":"bg-gray-100"),title:z("Remove cover image"),children:(0,d.jsx)(g.MdDelete,{className:"h-5 w-5 sm:h-4 sm:w-4"})}),(0,d.jsx)("button",{onClick:()=>s("coverImageUrl"),className:(0,e.default)("flex w-1/4 items-center justify-center rounded p-1 hover:bg-gray-50 sm:w-1/5",E?"bg-green-100 text-green-500 hover:bg-green-200":"bg-gray-100 text-gray-500"),title:z(E?"Unlock cover":"Lock cover"),children:E?(0,d.jsx)(g.MdLock,{className:"h-5 w-5 sm:h-4 sm:w-4"}):(0,d.jsx)(g.MdLockOpen,{className:"h-5 w-5 sm:h-4 sm:w-4"})})]})]}),(0,d.jsx)("div",{className:"title-fields flex flex-1 flex-col justify-between",children:I.map(({field:a,label:b,required:e,value:f,placeholder:g})=>(0,d.jsx)(l.FormField,{field:a,label:b,required:e,value:f,onFieldChange:r,fieldSources:c,lockedFields:n,fieldErrors:p,onToggleFieldLock:s,placeholder:g},a))})]}),(0,d.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,d.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:J.map(({field:a,label:b,value:e,isNumber:f,placeholder:g})=>(0,d.jsx)(l.FormField,{field:a,label:b,value:e,isNumber:f,onFieldChange:r,fieldSources:c,lockedFields:n,fieldErrors:p,onToggleFieldLock:s,placeholder:g},a))}),K.map(({field:a,label:b,type:e="input",rows:f,value:g,placeholder:h})=>(0,d.jsx)(l.FormField,{field:a,label:b,type:e,rows:f,value:g,onFieldChange:r,fieldSources:c,lockedFields:n,fieldErrors:p,onToggleFieldLock:s,placeholder:h},a))]}),(0,d.jsxs)("div",{className:"flex flex-col items-center justify-between gap-4",children:[(0,d.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,d.jsxs)("button",{onClick:t,disabled:q,className:"flex items-center gap-2 rounded-md bg-blue-500 px-4 py-2 text-sm text-white hover:bg-blue-600 disabled:opacity-50",title:z("Auto-Retrieve Metadata"),children:[q?(0,d.jsx)("span",{className:"loading loading-spinner h-4 w-4"}):(0,d.jsx)(g.MdOutlineSearch,{className:"mt-[1px] h-4 w-4"}),(0,d.jsx)("span",{className:"sm:hidden",children:z("Auto")}),(0,d.jsx)("span",{className:"hidden sm:inline",children:z("Auto-Retrieve")})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:[(0,d.jsxs)("button",{onClick:v,disabled:!C,className:(0,e.default)("hover:bg-base-200 flex items-center gap-1 rounded px-2 py-1 text-sm","disabled:cursor-not-allowed disabled:opacity-80","text-yellow-600 hover:text-yellow-700"),title:z("Unlock all fields"),children:[(0,d.jsx)(g.MdLockOpen,{className:"h-3 w-3"}),z("Unlock All")]}),(0,d.jsxs)("button",{onClick:u,disabled:D,className:(0,e.default)("hover:bg-base-200 flex items-center gap-1 rounded px-2 py-1 text-sm","disabled:cursor-not-allowed disabled:opacity-80","text-green-600 hover:text-green-700"),title:z("Lock all fields"),children:[(0,d.jsx)(g.MdLock,{className:"h-3 w-3"}),z("Lock All")]})]})]}),(0,d.jsxs)("div",{className:"flex w-full justify-end gap-4",children:[(0,d.jsx)("button",{onClick:w,className:"hover:bg-base-200 rounded-md border-neutral-300 px-4 py-2",children:z("Cancel")}),(0,d.jsx)("button",{onClick:x,className:"hover:bg-base-200 rounded-md border-neutral-300 px-4 py-2",children:z("Reset")}),(0,d.jsx)("button",{onClick:y,disabled:p&&Object.keys(p).length>0,className:"rounded-md bg-green-500 px-4 py-2 text-white hover:bg-green-600 disabled:opacity-50",children:z("Save")})]})]})]})}]),c()}catch(a){c(a)}},!1),175373,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(547274),g=a.i(915302),h=a.i(936114),i=a.i(340980),j=b([h,i]);[h,i]=j.then?(await j)():j,a.s(["default",0,({sources:a,isOpen:b,onSelect:c,onClose:j})=>{let k=(0,g.useTranslation)(),l=(0,e.useRef)(null);return((0,e.useEffect)(()=>{b&&l.current&&l.current.focus()},[b]),b)?(0,d.jsx)("div",{className:"source-selector fixed inset-0 z-[60] flex items-center justify-center bg-black/50",children:(0,d.jsxs)("div",{ref:l,tabIndex:-1,role:"dialog","aria-modal":"true",className:"bg-base-100 mx-4 max-h-[80vh] w-full max-w-md overflow-y-auto rounded-lg p-6",children:[(0,d.jsx)("h3",{className:"mb-4 text-lg font-semibold",children:k("Select Metadata Source")}),(0,d.jsxs)("div",{className:"space-y-3",children:[a.map((a,b)=>{var e;return(0,d.jsx)("button",{tabIndex:0,onClick:()=>c(a),className:"hover:bg-base-300/75 bg-base-200 border-base-200 w-full cursor-pointer rounded-md border p-3 transition-colors",children:(0,d.jsxs)("div",{className:"flex items-start gap-4",children:[(0,d.jsx)("div",{className:"aspect-[28/41] h-full w-[40%] max-w-32 shadow-md",children:(0,d.jsx)(i.default,{mode:"list",book:{title:(0,h.formatTitle)(a.data.title),author:(0,h.formatAuthors)(a.data.author),coverImageUrl:a.data.coverImageUrl||"_blank"}})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"font-medium capitalize",children:a.sourceLabel}),(e=a.confidence)>=90?(0,d.jsx)(f.MdOutlineCheck,{className:"text-green-500"}):e>=70?(0,d.jsx)("span",{className:"text-yellow-500",children:""}):(0,d.jsx)("span",{className:"text-red-500",children:""})]}),(0,d.jsxs)("span",{className:"text-sm text-gray-500",children:[a.confidence,"%"]})]}),(0,d.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,d.jsx)("div",{className:"font-medium",children:(0,h.formatTitle)(a.data.title)}),(0,d.jsx)("div",{className:"text-gray-600",children:(0,h.formatAuthors)(a.data.author)}),(0,d.jsxs)("div",{className:"text-gray-500",children:[a.data.language?`${(0,h.getPrimaryLanguage)(a.data.language)}  `:"",a.data.publisher?`${a.data.publisher}  `:"",a.data.published]}),a.data.identifier&&(0,d.jsxs)("div",{className:"text-gray-500",children:["Identifier: ",a.data.identifier]}),a.data.description&&(0,d.jsx)("div",{className:"line-clamp-3 text-xs text-gray-500",children:a.data.description})]})]})]})},b)}),(0,d.jsx)("button",{tabIndex:0,onClick:j,className:"hover:bg-base-300/75 border-base-200 bg-base-200 cursor-pointer rounded-md border p-3 transition-colors",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(f.MdOutlineEdit,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"font-medium",children:k("Keep manual input")})]})})]}),(0,d.jsx)("div",{className:"mt-6 flex justify-end gap-2",children:(0,d.jsx)("button",{onClick:j,className:"hover:bg-base-200 rounded-md px-4 py-2",children:k("Cancel")})})]})}):null}]),c()}catch(a){c(a)}},!1),793179,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(162650),g=a.i(915302),h=b([e,f]);[e,f]=h.then?(await h)():h,a.s(["default",0,({loading:a,className:b})=>{let c=(0,g.useTranslation)(),{safeAreaInsets:h}=(0,f.useThemeStore)();return a?(0,d.jsxs)("div",{className:(0,e.default)("absolute left-1/2 top-4 -translate-x-1/2 transform text-center"),style:{paddingTop:`${(h?.top||0)+64}px`},role:"status",children:[(0,d.jsx)("span",{className:(0,e.default)("loading loading-lg not-eink:loading-dots eink:loading-spinner",b)}),(0,d.jsx)("span",{className:"sr-only",children:c("Loading...")})]}):null}]),c()}catch(a){c(a)}},!1),121103,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(162650),i=a.i(915302),j=a.i(364893),k=a.i(765918),l=a.i(557469),m=a.i(408124),n=a.i(381322),o=a.i(221938),p=a.i(728131),q=a.i(175373),r=a.i(793179),s=b([e,h,j,m,n,o,p,q,r]);[e,h,j,m,n,o,p,q,r]=s.then?(await s)():s,a.s(["default",0,({book:a,isOpen:b,onClose:c,handleBookDownload:s,handleBookUpload:t,handleBookDelete:u,handleBookDeleteCloudBackup:v,handleBookDeleteLocalCopy:w,handleBookMetadataUpdate:x})=>{let y=(0,i.useTranslation)(),{envConfig:z,appService:A}=(0,g.useEnv)(),{safeAreaInsets:B}=(0,h.useThemeStore)(),[C,D]=(0,f.useState)(null),[E,F]=(0,f.useState)(!1),[G,H]=(0,f.useState)(!1),[I,J]=(0,f.useState)(null),[K,L]=(0,f.useState)(null),{editedMeta:M,fieldSources:N,lockedFields:O,fieldErrors:P,searchLoading:Q,showSourceSelection:R,availableSources:S,handleFieldChange:T,handleToggleFieldLock:U,handleLockAll:V,handleUnlockAll:W,handleAutoRetrieve:X,handleSourceSelection:Y,handleCloseSourceSelection:Z,resetToOriginal:$}=(0,j.useMetadataEdit)(I),_={both:{title:y("Confirm Deletion"),message:y("Are you sure to delete the selected book?"),handler:u},cloud:{title:y("Confirm Deletion"),message:y("Are you sure to delete the cloud backup of the selected book?"),handler:v},local:{title:y("Confirm Deletion"),message:y("Are you sure to delete the local copy of the selected book?"),handler:w}};(0,f.useEffect)(()=>{(async()=>{let b=await z.getAppService();{let c=a.metadata||null;!c&&a.downloadedAt&&(c=await b.fetchBookDetails(a)),J(c);let d=await b.getBookFileSize(a);L(d)}})()},[a]);let aa=()=>{J(null),H(!1),D(null),c()},ab=a=>{D(a)},ac=async()=>{if(!C)return;let b=_[C];aa(),b.handler&&b.handler(a)},ad=async()=>{aa(),s&&s(a,{redownload:!0,queued:!1})},ae=async()=>{aa(),t&&t(a)},af=async()=>{F(!0),setTimeout(async()=>{let b=await A?.exportBook(a);F(!1),(0,l.isWebAppPlatform)()||k.eventDispatcher.dispatch("toast",{type:b?"info":"error",message:b?y("Book exported successfully."):y("Failed to export the book.")})},0)},ag=C?_[C]:null;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,d.jsx)(n.default,{title:G?y("Edit Metadata"):y("Book Details"),isOpen:b,onClose:aa,boxClassName:(0,e.default)(G?"sm:min-w-[600px] sm:max-w-[600px]":"sm:min-w-[480px] sm:max-w-[480px]","sm:h-auto sm:max-h-[90%]"),contentClassName:"!px-6 !py-4",children:(0,d.jsx)("div",{className:"flex w-full select-text items-start justify-center",children:G&&I?(0,d.jsx)(p.default,{book:a,metadata:M,fieldSources:N,lockedFields:O,fieldErrors:P,searchLoading:Q,onFieldChange:T,onToggleFieldLock:U,onAutoRetrieve:X,onLockAll:V,onUnlockAll:W,onCancel:()=>{$(),H(!1)},onReset:$,onSave:()=>{M&&x&&(J({...M}),x(a,M),H(!1))}}):(0,d.jsx)(o.default,{book:a,metadata:I,fileSize:K,onEdit:x?()=>{H(!0)}:void 0,onDelete:u?()=>ab("both"):void 0,onDeleteCloudBackup:v?()=>ab("cloud"):void 0,onDeleteLocalCopy:w?()=>ab("local"):void 0,onDownload:s?ad:void 0,onUpload:t?ae:void 0,onExport:af})})}),R&&(0,d.jsx)(q.default,{sources:S,isOpen:R,onSelect:Y,onClose:Z}),E&&(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:(0,d.jsx)(r.default,{loading:!0})}),C&&ag&&(0,d.jsx)("div",{className:(0,e.default)("fixed bottom-0 left-0 right-0 z-50 flex justify-center"),style:{paddingBottom:`${(B?.bottom||0)+16}px`},children:(0,d.jsx)(m.default,{title:ag.title,message:ag.message,onCancel:()=>{D(null)},onConfirm:ac})})]})})}]),c()}catch(a){c(a)}},!1),166185,a=>a.a(async(b,c)=>{try{var d=a.i(121103),e=a.i(221938),f=a.i(728131),g=a.i(175373),h=a.i(364893),i=b([d,e,f,g,h]);[d,e,f,g,h]=i.then?(await i)():i,a.s([]),c()}catch(a){c(a)}},!1),136635,a=>a.a(async(b,c)=>{try{var d=a.i(121103),e=b([d]);[d]=e.then?(await e)():e,a.s(["BookDetailModal",()=>d.default]),c()}catch(a){c(a)}},!1),954885,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=b([d]);[d]=e.then?(await e)():e;let f=(0,d.create)((a,b)=>({parallelViews:[],setParallel:b=>{a(a=>{let c,d=[...new Set(b.filter(a=>""!==a.trim()))];if(d.length<2)return a;let e=[...a.parallelViews],f=e.filter(a=>d.some(b=>a.has(b)));return 0===f.length?(c=new Set(d),e.push(c)):1===f.length?(c=f[0],d.forEach(a=>c.add(a))):(c=f[0],f.slice(1).forEach(a=>{a.forEach(a=>c.add(a));let b=e.indexOf(a);b>-1&&e.splice(b,1)}),d.forEach(a=>c.add(a))),console.log("Set parallel groups:",e),{parallelViews:e}})},unsetParallel:b=>{a(a=>{let c=[...new Set(b.filter(a=>""!==a.trim()))];if(0===c.length)return a;let d=[...a.parallelViews];return d.filter(a=>c.some(b=>a.has(b))).forEach(a=>{if(c.forEach(b=>a.delete(b)),a.size<=1){let b=d.indexOf(a);b>-1&&d.splice(b,1)}}),console.log("Unset parallel groups:",d),{parallelViews:d}})},areParallels(a,c){let{parallelViews:d}=b();return d.some(b=>b.has(a)&&b.has(c))},getParallels(a){let{parallelViews:c}=b();return c.find(b=>b.has(a))||null}}));a.s(["useParallelViewStore",0,f]),c()}catch(a){c(a)}},!1),956099,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(667180),f=a.i(178552),g=a.i(466759),h=a.i(715715),i=a.i(465863),j=a.i(954885),k=a.i(187897),l=b([g,h,j]);[g,h,j]=l.then?(await l)():l,a.s(["default",0,()=>{let a=(0,e.useRouter)(),b=(0,e.useSearchParams)(),{envConfig:c}=(0,f.useEnv)(),{bookKeys:l}=(0,g.useReaderStore)(),{setBookKeys:m,initViewState:n}=(0,g.useReaderStore)(),{sideBarBookKey:o,setSideBarBookKey:p}=(0,h.useSidebarStore)(),[q,r]=(0,d.useState)(!1),{setParallel:s}=(0,j.useParallelViewStore)();(0,d.useEffect)(()=>{if(q){let c=l.map(a=>a.split("-")[0]);c&&(0,k.navigateToReader)(a,c,b?.toString()||"",{scroll:!1}),r(!1)}},[l,q]);let t=(a,b,d)=>{let e=`${a}-${(0,i.uniqueId)()}`;if(n(c,a,e,b),!l.includes(e)){let a=[...l,e];m(a)}d&&s([o,e]),p(e),r(!0)};return{bookKeys:l,appendBook:t,dismissBook:a=>{let b=l.filter(b=>b!==a);m(b),r(!0)},getNextBookKey:a=>{let b=(l.findIndex(b=>b===a)+1)%l.length;return l[b]},openParallelView:a=>{let b=o?.split("-")[0];t(a,b!=a,!0)}}}]),c()}catch(a){c(a)}},!1),288413,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(466759),g=a.i(862871),h=a.i(108328),i=a.i(765918),j=a.i(557469),k=a.i(756009),l=b([f,g,h]);[f,g,h]=l.then?(await l)():l;let m=(a,b)=>!!a&&!!b&&a.book.rendition?.layout==="pre-paginated"&&(b.zoomLevel>100||"fit-page"!==b.zoomMode),n=(a,b,c,d="page",e=50)=>{var f;if(!a||!b)return;let g=a.renderer;if("rtl"===a.book.dir&&(f=c,c="left"===f?"right":"right"===f?"left":f),g.scrolled){let{size:e}=g,f=b.showHeader&&b.showBarsOnScroll,h=b.showFooter&&b.showBarsOnScroll,i=b.scrollingOverlap,j=e-i-44*!!f-44*!!h;return"section"!==d?"left"===c||"up"===c?a.prev(j):a.next(j):"left"===c||"up"===c?a.renderer.prevSection?.():a.renderer.nextSection?.()}if("pan"===d&&m(a,b))return a&&b&&m(a,b)&&a.isOverflowX()&&("left"===c||"right"===c)?a.pan("left"===c?-e:e,0):a&&b&&m(a,b)&&a.isOverflowY()&&("up"===c||"down"===c)?a.pan(0,"up"===c?-e:e):"left"===c||"up"===c?a.prev():a.next();return"section"!==d?"left"===c||"up"===c?a.prev():a.next():"left"===c||"up"===c?a.renderer.prevSection?.():a.renderer.nextSection?.()};a.s(["usePagination",0,(a,b,c)=>{let{appService:l}=(0,e.useEnv)(),{getBookData:o}=(0,g.useBookDataStore)(),{getViewSettings:p,getViewState:q}=(0,f.useReaderStore)(),{hoveredBookKey:r,setHoveredBookKey:s}=(0,f.useReaderStore)(),{acquireVolumeKeyInterception:t,releaseVolumeKeyInterception:u}=(0,h.useDeviceControlStore)(),v=async d=>{let e=q(a),f=o(a);if(e?.inited&&f){if(d instanceof MessageEvent){if(d.data&&d.data.bookKey===a){let e=p(a);if("iframe-single-click"===d.data.type){let f=c.current;if(f){let{screenX:c}=d.data,g=f.getBoundingClientRect(),h=((0,j.isTauriAppPlatform)()?l?.isMobile?0:(await (0,k.tauriGetWindowLogicalPosition)()).x:window.screenX)+g.left,m=h+g.width/2;if(!i.eventDispatcher.dispatchSync("iframe-single-click")){let d=h+.375*g.width,f=h+.625*g.width;if(e.disableClick||c>=d&&c<=f)s(r?null:a);else{if(r)return void s(null);!e.disableClick&&c>=m?e.fullscreenClickArea?n(b.current,e,"down"):e.swapClickArea?n(b.current,e,"left"):n(b.current,e,"right"):!e.disableClick&&c<m&&(e.fullscreenClickArea?n(b.current,e,"down"):e.swapClickArea?n(b.current,e,"right"):n(b.current,e,"left"))}}}}else if("iframe-wheel"!==d.data.type||e.scrolled||m(b.current,e))"iframe-mouseup"===d.data.type&&(3===d.data.button?b.current?.history.back():4===d.data.button&&b.current?.history.forward());else{let{deltaY:a}=d.data;a>0?b.current?.next(1):a<0&&b.current?.prev(1)}}}else if(d instanceof CustomEvent){let c=p(a);if("native-key-down"===d.type&&c?.volumeKeysToFlip){let{keyName:a}=d.detail;s(""),"VolumeUp"===a?n(b.current,c,"up"):"VolumeDown"===a&&n(b.current,c,"down")}else if("touch-swipe"===d.type&&f.isFixedLayout&&!m(b.current,c)){let{deltaX:a,deltaY:e,deltaT:f}=d.detail,g=Math.abs(a/f);Math.abs(a)>Math.abs(e)&&Math.abs(a)>30&&g>.2&&(a>0?n(b.current,c,"left"):n(b.current,c,"right"))}}else if("click"===d.type){let{clientX:c}=d,e=window.innerWidth,f=p(a);c<.5*e?n(b.current,f,"left"):c>.5*e&&n(b.current,f,"right")}}};return(0,d.useEffect)(()=>{if(!l?.isMobileApp)return;let b=p(a);return b?.volumeKeysToFlip?t():u(),i.eventDispatcher.on("native-key-down",v),()=>{u(),i.eventDispatcher.off("native-key-down",v)}},[]),{handlePageFlip:v,handleContinuousScroll:(c,d,e)=>{let f=b.current?.renderer,g=p(a),h=o(a);if(h.bookDoc?.rendition?.layout!=="pre-paginated"&&f&&g.scrolled&&g.continuousScroll){let a=()=>{f.start<=d&&d>e?setTimeout(()=>{b.current?.prev(f.start+1)},100):Math.ceil(f.end)-d>=f.viewSize&&d<-e&&setTimeout(()=>{b.current?.next(f.viewSize-Math.floor(f.end)+1)},100)};"mouse"===c?a():"touch"===c&&(f.size>=f.viewSize?a():f.addEventListener("relocate",()=>a(),{once:!0}))}}}},"viewPagination",0,n]),c()}catch(a){c(a)}},!1),551524,a=>{"use strict";var b=a.i(127669);let c={onSwitchSideBar:["ctrl+Tab","opt+Tab","alt+Tab"],onToggleSideBar:["s"],onToggleNotebook:["n"],onShowSearchBar:["ctrl+f","cmd+f"],onToggleScrollMode:["shift+j"],onToggleSelectMode:["shift+s"],onToggleBookmark:["ctrl+d","cmd+d"],onToggleTTS:["t"],onHighlightSelection:["ctrl+h","cmd+h"],onUnderlineSelection:["ctrl+u","cmd+u"],onAnnotateSelection:["ctrl+n","cmd+n"],onSearchSelection:["ctrl+f","cmd+f"],onCopySelection:["ctrl+c","cmd+c"],onTranslateSelection:["ctrl+t","cmd+t"],onDictionarySelection:["ctrl+d","cmd+d"],onWikipediaSelection:["ctrl+w","cmd+w"],onReadAloudSelection:["ctrl+r","cmd+r"],onProofreadSelection:["ctrl+p","cmd+p"],onOpenFontLayoutSettings:["shift+f","ctrl+,","cmd+,"],onOpenBooks:["ctrl+o"],onReloadPage:["shift+r"],onToggleFullscreen:["F11"],onCloseWindow:["ctrl+w","cmd+w"],onQuitApp:["ctrl+q","cmd+q"],onGoLeft:["ArrowLeft","h","shift+ "],onGoRight:["ArrowRight","l"," "],onGoUp:["ArrowUp","k"],onGoDown:["ArrowDown","j"],onGoNext:["shift+j","shift+ArrowRight","shift+ArrowDown","PageDown"],onGoPrev:["shift+k","shift+ArrowLeft","shift+ArrowUp","PageUp"],onGoLeftSection:["opt+ArrowLeft","alt+ArrowLeft"],onGoRightSection:["opt+ArrowRight","alt+ArrowRight"],onGoPrevSection:["opt+ArrowUp","alt+ArrowUp"],onGoNextSection:["opt+ArrowDown","alt+ArrowDown"],onGoHalfPageDown:["shift+ArrowDown","d"],onGoHalfPageUp:["shift+ArrowUp","u"],onGoBack:["shift+ArrowLeft","shift+h","alt+ArrowLeft"],onGoForward:["shift+ArrowRight","shift+l","alt+ArrowRight"],onZoomIn:["ctrl+=","cmd+=","shift+="],onZoomOut:["ctrl+-","cmd+-","shift+-"],onResetZoom:["ctrl+0","cmd+0"],onSaveNote:["ctrl+Enter"],onEscape:["Escape"]},d=()=>{if("undefined"==typeof localStorage)return c;let a=JSON.parse(localStorage.getItem("customShortcuts")||"{}");return{...c,...a}};a.s(["default",0,(a,c=[])=>{let[e,f]=(0,b.useState)(d);(0,b.useEffect)(()=>{let a=()=>{f(d())};return window.addEventListener("shortcutUpdate",a),()=>window.removeEventListener("shortcutUpdate",a)},[]);let g=(a,b,c,d,e,f)=>{let g,h={ctrlKey:(g=a.toLowerCase().split("+")).includes("ctrl"),altKey:g.includes("alt")||g.includes("opt"),metaKey:g.includes("meta")||g.includes("cmd"),shiftKey:g.includes("shift"),key:g.find(a=>!["ctrl","alt","opt","meta","cmd","shift"].includes(a))};return h.key===b.toLowerCase()&&h.ctrlKey===c&&h.altKey===d&&h.metaKey===e&&h.shiftKey===f},h=(b,c,d,f,h,i)=>{if("backspace"===b)return!0;for(let[j,k]of Object.entries(a)){let a=e[j];if(k&&a?.some(a=>g(a,b,c,d,f,h))&&k(i))return!0}return!1},i=a=>{let b=document.activeElement,c="INPUT"===b.tagName||"TEXTAREA"===b.tagName||b.isContentEditable,d="TEXTAREA"===b.tagName&&b.classList.contains("note-editor");if(!c||d){if(a instanceof KeyboardEvent){let{key:b,ctrlKey:c,altKey:e,metaKey:f,shiftKey:g}=a;if(d&&!("Enter"===b&&c||"Escape"==b))return;h(b.toLowerCase(),c,e,f,g,a)&&a.preventDefault()}else if(a instanceof MessageEvent&&a.data&&"iframe-keydown"===a.data.type){let{key:b,ctrlKey:c,altKey:d,metaKey:e,shiftKey:f}=a.data;h(b.toLowerCase(),c,d,e,f,a)}}};(0,b.useEffect)(()=>(window.addEventListener("keydown",i),window.addEventListener("message",i),()=>{window.removeEventListener("keydown",i),window.removeEventListener("message",i)}),[e,...c])}],551524)},44406,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(466759),f=a.i(925426),g=a.i(557469),h=a.i(715715),i=a.i(866736),j=a.i(862871),k=a.i(173947),l=a.i(756009),m=a.i(765918),n=a.i(654617),o=a.i(288413),p=a.i(551524),q=a.i(956099),r=b([e,f,h,i,j,k,o,q]);[e,f,h,i,j,k,o,q]=r.then?(await r)():r,a.s(["default",0,({sideBarBookKey:a,bookKeys:b})=>{let{getView:c,getViewState:r,getViewSettings:s,setViewSettings:t}=(0,e.useReaderStore)(),{toggleSideBar:u,setSideBarBookKey:v}=(0,h.useSidebarStore)(),{setSettingsDialogOpen:w}=(0,i.useSettingsStore)(),{getBookData:x}=(0,j.useBookDataStore)(),{toggleNotebook:y}=(0,f.useNotebookStore)(),{getNextBookKey:z}=(0,q.default)(),A=s(a??""),B=A?.defaultFontSize??16,C=A?.lineHeight??1.6,D=B*C*3,E=async()=>{(0,g.isTauriAppPlatform)()&&await (0,l.tauriHandleToggleFullScreen)()},F=async()=>{(0,g.isTauriAppPlatform)()&&await (0,l.tauriHandleClose)()},G=async()=>{(0,g.isTauriAppPlatform)()&&await (0,l.tauriQuitApp)()},H=b=>{if(!a)return;let d=c(a),e=x(a),f=s(a);f.zoomLevel=b,t(a,f),d?.renderer.setStyles?.((0,k.getStyles)(f)),e?.bookDoc?.rendition?.layout==="pre-paginated"&&d?.renderer.setAttribute("scale-factor",b)},I=(b=1)=>{if(!a)return;let c=s(a).zoomLevel+n.ZOOM_STEP*b;H(Math.min(c,n.MAX_ZOOM_LEVEL))},J=(b=1)=>{if(!a)return;let c=s(a).zoomLevel-n.ZOOM_STEP*b;H(Math.max(c,n.MIN_ZOOM_LEVEL))},K=a=>{let b=a.detail?.factor||1;I(b)},L=a=>{let b=a.detail?.factor||1;J(b)},M=()=>{a&&H(100)};(0,d.useEffect)(()=>(m.eventDispatcher.on("zoom-in",K),m.eventDispatcher.on("zoom-out",L),m.eventDispatcher.on("reset-zoom",M),()=>{m.eventDispatcher.off("zoom-in",K),m.eventDispatcher.off("zoom-out",L),m.eventDispatcher.off("reset-zoom",M)}),[a]),(0,p.default)({onSwitchSideBar:()=>{a&&v(z(a))},onToggleSideBar:u,onToggleNotebook:y,onToggleScrollMode:()=>{let b=s(a??"");if(b&&a){b.scrolled=!b.scrolled,t(a,b);let d=b.scrolled?"scrolled":"paginated";c(a)?.renderer.setAttribute("flow",d)}},onToggleBookmark:()=>{a&&m.eventDispatcher.dispatch("toggle-bookmark",{bookKey:a})},onOpenFontLayoutSettings:()=>w(!0),onShowSearchBar:()=>{setTimeout(()=>{m.eventDispatcher.dispatch("search-term",{term:null,bookKey:a})},100)},onToggleFullscreen:E,onToggleTTS:()=>{if(!a)return;let b=r(a);m.eventDispatcher.dispatch(b?.ttsEnabled?"tts-stop":"tts-speak",{bookKey:a})},onReloadPage:()=>{window.location.reload()},onCloseWindow:F,onQuitApp:G,onGoLeft:()=>{let b=s(a??"");(0,o.viewPagination)(c(a),b,"left","pan",D)},onGoRight:()=>{let b=s(a??"");(0,o.viewPagination)(c(a),b,"right","pan",D)},onGoUp:b=>{let d=c(a),e=s(a??"");d?.renderer.scrolled&&b instanceof MessageEvent||(0,o.viewPagination)(d,e,"up","pan",D)},onGoDown:b=>{let d=c(a),e=s(a??"");d?.renderer.scrolled&&b instanceof MessageEvent||(0,o.viewPagination)(d,e,"down","pan",D)},onGoPrev:()=>{c(a)?.prev(D)},onGoNext:()=>{c(a)?.next(D)},onGoHalfPageDown:()=>{let b=c(a),d=s(a??"");b&&d&&d.scrolled&&b.next(b.renderer.size/2)},onGoHalfPageUp:()=>{let b=c(a),d=s(a??"");b&&d&&d.scrolled&&b.prev(b.renderer.size/2)},onGoPrevSection:()=>{let b=s(a??"");(0,o.viewPagination)(c(a),b,"up","section")},onGoNextSection:()=>{let b=s(a??"");(0,o.viewPagination)(c(a),b,"down","section")},onGoLeftSection:()=>{let b=s(a??"");(0,o.viewPagination)(c(a),b,"left","section")},onGoRightSection:()=>{let b=s(a??"");(0,o.viewPagination)(c(a),b,"right","section")},onGoBack:()=>{c(a)?.history.back()},onGoForward:()=>{c(a)?.history.forward()},onZoomIn:()=>{I()},onZoomOut:()=>{J()},onResetZoom:M},[a,b])}]),c()}catch(a){c(a)}},!1),402093,(a,b,c)=>{b.exports=a.x("styled-jsx/style.js",()=>require("styled-jsx/style.js"))},142760,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M169 57v430h78V57h-78zM25 105v190h46V105H25zm158 23h18v320h-18V128zm128.725 7.69l-45.276 8.124 61.825 344.497 45.276-8.124-61.825-344.497zM89 153v270h62V153H89zm281.502 28.68l-27.594 11.773 5.494 12.877 27.594-11.773-5.494-12.877zm12.56 29.433l-27.597 11.772 5.494 12.877 27.593-11.772-5.492-12.877zm12.555 29.434l-27.594 11.77 99.674 233.628 27.594-11.773-99.673-233.625zM25 313v30h46v-30H25zm190 7h18v128h-18V320zM25 361v126h46V361H25zm64 80v46h62v-46H89z"},child:[]}]})(a)}a.s(["GiBookshelf",()=>c])},687134,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(a)}function g(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(a)}function h(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(a)}a.s(["FiChevronLeft",()=>c,"FiChevronUp",()=>d,"FiCopy",()=>e,"FiMinus",()=>f,"FiPlus",()=>g,"FiSearch",()=>h])},646233,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=a.i(177898),f=b([d]);[d]=f.then?(await f)():f;let g=(0,d.create)((b,c)=>({appService:void 0,isTrafficLightVisible:!1,shouldShowTrafficLight:!1,trafficLightInFullscreen:!1,initializeTrafficLightStore:a=>{b({appService:a,isTrafficLightVisible:a.hasTrafficLight,shouldShowTrafficLight:a.hasTrafficLight})},setTrafficLightVisibility:async(c,d)=>{let{getCurrentWindow:f}=await a.A(31225),g=f(),h=await g.isFullscreen();b({isTrafficLightVisible:!h&&c,shouldShowTrafficLight:c,trafficLightInFullscreen:h}),(0,e.invoke)("set_traffic_lights",{visible:c,x:d?.x??10,y:d?.y??22})},initializeTrafficLightListeners:async()=>{let{getCurrentWindow:d}=await a.A(31225),e=d(),f=await e.listen("will-enter-fullscreen",()=>{b({isTrafficLightVisible:!1,trafficLightInFullscreen:!0})}),g=await e.listen("will-exit-fullscreen",()=>{let{shouldShowTrafficLight:a}=c();b({isTrafficLightVisible:a,trafficLightInFullscreen:!1})});b({unlistenEnterFullScreen:f,unlistenExitFullScreen:g})},cleanupTrafficLightListeners:()=>{let{unlistenEnterFullScreen:a,unlistenExitFullScreen:d}=c();a&&a(),d&&d(),b({unlistenEnterFullScreen:void 0,unlistenExitFullScreen:void 0})}}));a.s(["useTrafficLightStore",0,g]),c()}catch(a){c(a)}},!1),993289,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(646233),g=b([f]);[f]=g.then?(await g)():g,a.s(["useTrafficLight",0,()=>{let{appService:a}=(0,e.useEnv)(),{isTrafficLightVisible:b,initializeTrafficLightStore:c,initializeTrafficLightListeners:g,setTrafficLightVisibility:h,cleanupTrafficLightListeners:i}=(0,f.useTrafficLightStore)();return(0,d.useEffect)(()=>{if(a?.hasTrafficLight)return c(a),g(),h(!0),()=>{i()}},[a?.hasTrafficLight]),{isTrafficLightVisible:b}}]),c()}catch(a){c(a)}},!1),937944,a=>a.a(async(b,c)=>{try{var d=a.i(862871),e=a.i(466759),f=a.i(866736),g=a.i(173947),h=b([d,e,f,g]);[d,e,f,g]=h.then?(await h)():h;let i=async(a,b,c,h,i=!1,j=!0)=>{let{settings:k,isSettingsGlobal:l,setSettings:m,saveSettings:n}=f.useSettingsStore.getState(),{bookKeys:o,getView:p,getViewState:q,getViewSettings:r,setViewSettings:s}=e.useReaderStore.getState(),{getConfig:t,saveConfig:u}=d.useBookDataStore.getState(),v=async b=>{let d=r(b),e=q(b);if(b&&d&&d[c]!==h){if(d[c]=h,s(b,d),j){let a=p(b);a?.renderer.setStyles?.((0,g.getStyles)(d))}let f=t(b);e?.isPrimary&&f&&await u(a,b,f,k)}};if(l&&!i){for(let a of(k.globalViewSettings[c]=h,m(k),o))await v(a);await n(a,k)}else b&&await v(b)},j=async(a,b,c)=>{let{settings:d,setSettings:e,saveSettings:g}=f.useSettingsStore.getState();d[b]!==c&&(d[b]=c,e(d),await g(a,d))};a.s(["saveSysSettings",0,j,"saveViewSettings",0,i]),c()}catch(a){c(a)}},!1),964855,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(629474),h=b([e,g]);[e,g]=h.then?(await h)():h,a.s(["default",0,({children:a,className:b,style:c,onCancel:h})=>{let i=(0,f.useRef)(null);return(0,g.useKeyDownActions)({onCancel:h,elementRef:i}),(0,f.useEffect)(()=>{setTimeout(()=>{if(i.current){let a=i.current.querySelector('[role="menuitem"]');a&&a.focus()}},200)},[]),(0,d.jsx)("div",{ref:i,role:"none",className:(0,e.default)("menu-container max-h-[calc(100vh-96px)] overflow-y-auto border-0",b),style:c,children:a})}]),c()}catch(a){c(a)}},!1),516723,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(266602),h=a.i(547274),i=a.i(667180),j=a.i(178552),k=a.i(77946),l=a.i(466759),m=a.i(163759),n=a.i(715715),o=a.i(915302),p=a.i(866736),q=a.i(954885),r=a.i(557469),s=a.i(765918),t=a.i(679496),u=a.i(654617),v=a.i(187897),w=a.i(937944),x=a.i(953365),y=a.i(175416),z=a.i(645760),A=a.i(956099),B=a.i(937065),C=a.i(964855),D=b([e,l,m,n,p,q,w,x,y,z,A,B,C]);[e,l,m,n,p,q,w,x,y,z,A,B,C]=D.then?(await D)():D,a.s(["default",0,({menuClassName:a,setIsDropdownOpen:b})=>{let c=(0,o.useTranslation)(),D=(0,i.useRouter)(),{envConfig:E,appService:F}=(0,j.useEnv)(),{user:G}=(0,k.useAuth)(),{settings:H}=(0,p.useSettingsStore)(),{bookKeys:I,recreateViewer:J,getViewSettings:K,setViewSettings:L}=(0,l.useReaderStore)(),{getVisibleLibrary:M}=(0,m.useLibraryStore)(),{openParallelView:N}=(0,A.default)(),{sideBarBookKey:O}=(0,n.useSidebarStore)(),{parallelViews:P,setParallel:Q,unsetParallel:R}=(0,q.useParallelViewStore)(),S=K(O),[T,U]=f.default.useState(S?.sortedTOC||!1),V=()=>{Q(I),b?.(!1)},W=()=>{R(I),b?.(!1)};return(0,d.jsxs)(C.default,{className:(0,e.default)("book-menu dropdown-content z-20 shadow-2xl",a),onCancel:()=>b?.(!1),children:[(0,d.jsx)(B.default,{label:c("Parallel Read"),buttonClass:I.length>1?"lg:tooltip lg:tooltip-bottom":"",tooltip:P.length>0?c("Disable"):I.length>1?c("Enable"):"",Icon:P.length>0&&I.length>1?h.MdCheck:void 0,onClick:P.length>0?W:I.length>1?V:void 0,children:(0,d.jsx)("ul",{className:"max-h-60 overflow-y-auto",children:M().filter(a=>!t.FIXED_LAYOUT_FORMATS.has(a.format)).filter(a=>!!a.downloadedAt).slice(0,20).map(a=>(0,d.jsx)(B.default,{Icon:(0,d.jsx)(g.default,{src:a.coverImageUrl,alt:a.title,width:56,height:80,className:"aspect-auto max-h-8 max-w-4 rounded-sm shadow-md",onError:a=>{a.target.style.display="none"}}),label:a.title,labelClass:"max-w-36",onClick:()=>{var c;return c=a.hash,void(N(c),b?.(!1))}},a.hash))})}),I.length>1&&(P.length>0?(0,d.jsx)(B.default,{label:c("Exit Parallel Read"),onClick:W}):(0,d.jsx)(B.default,{label:c("Enter Parallel Read"),onClick:V})),(0,d.jsx)("hr",{className:"border-base-200 my-1"}),(0,d.jsx)(B.default,{label:c("KOReader Sync"),onClick:()=>{(0,x.setKOSyncSettingsWindowVisible)(!0),b?.(!1)}}),H.kosync.enabled&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(B.default,{label:c("Push Progress"),onClick:()=>{s.eventDispatcher.dispatch("push-kosync",{bookKey:O}),b?.(!1)}}),(0,d.jsx)(B.default,{label:c("Pull Progress"),onClick:()=>{s.eventDispatcher.dispatch("pull-kosync",{bookKey:O}),b?.(!1)}})]}),F?.isDesktopApp&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("hr",{className:"border-base-200 my-1"}),(0,d.jsx)(B.default,{label:c("Show on Discord"),tooltip:c("Display what I'm reading on Discord"),toggled:H.discordRichPresenceEnabled,onClick:()=>{let a=!H.discordRichPresenceEnabled;(0,w.saveSysSettings)(E,"discordRichPresenceEnabled",a),b?.(!1),a&&!G&&(0,v.navigateToLogin)(D)}})]}),(0,d.jsx)("hr",{className:"border-base-200 my-1"}),(0,d.jsx)(B.default,{label:c("Proofread"),onClick:()=>{(0,y.setProofreadRulesVisibility)(!0),b?.(!1)}}),(0,d.jsx)("hr",{className:"border-base-200 my-1"}),(0,d.jsx)(B.default,{label:c("Export Annotations"),onClick:()=>{s.eventDispatcher.dispatch("export-annotations",{bookKey:O}),b?.(!1)}}),(0,d.jsx)(B.default,{label:c("Sort TOC by Page"),Icon:T?h.MdCheck:void 0,onClick:()=>{if(U(a=>!a),b?.(!1),O){let a=K(O);a.sortedTOC=!T,L(O,a),J(E,O)}}}),(0,d.jsx)(B.default,{label:c("Reload Page"),shortcut:"Shift+R",onClick:()=>{window.location.reload(),b?.(!1)}}),(0,d.jsx)("hr",{className:"border-base-200 my-1"}),(0,r.isWebAppPlatform)()&&(0,d.jsx)(B.default,{label:c("Download Readest"),onClick:()=>{window.open(u.DOWNLOAD_READEST_URL,"_blank"),b?.(!1)}}),(0,d.jsx)(B.default,{label:c("About Readest"),onClick:()=>{(0,z.setAboutDialogVisible)(!0),b?.(!1)}})]})}]),c()}catch(a){c(a)}},!1),936449,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(142760),g=a.i(687134),h=a.i(547274),i=a.i(915302),j=a.i(993289),k=a.i(106865),l=a.i(320776),m=a.i(516723),n=b([e,j,l,m]);[e,j,l,m]=n.then?(await n)():n,a.s(["default",0,({isPinned:a,isSearchBarVisible:b,onGoToLibrary:c,onClose:n,onTogglePin:o,onToggleSearchBar:p})=>{let q=(0,i.useTranslation)(),{isTrafficLightVisible:r}=(0,j.useTrafficLight)(),s=(0,k.useResponsiveSize)(14),t=(0,k.useResponsiveSize)(18),u=(0,k.useResponsiveSize)(22);return(0,d.jsxs)("div",{className:(0,e.default)("sidebar-header flex h-11 items-center justify-between pe-2",r?"ps-1.5 sm:ps-20":"ps-1.5"),dir:"ltr",children:[(0,d.jsxs)("div",{className:"flex items-center gap-x-8",children:[(0,d.jsx)("button",{title:q("Close"),onClick:n,className:"btn btn-ghost btn-circle flex h-6 min-h-6 w-6 hover:bg-transparent sm:hidden",children:(0,d.jsx)(h.MdArrowBackIosNew,{size:u})}),(0,d.jsx)("button",{title:q("Go to Library"),className:"btn btn-ghost hidden h-8 min-h-8 w-8 p-0 sm:flex",onClick:c,children:(0,d.jsx)(f.GiBookshelf,{className:"fill-base-content"})})]}),(0,d.jsxs)("div",{className:"flex min-w-24 max-w-32 items-center justify-between sm:size-[70%]",children:[(0,d.jsx)("button",{title:q(b?"Hide Search Bar":"Show Search Bar"),onClick:p,className:(0,e.default)("btn btn-ghost left-0 h-8 min-h-8 w-8 p-0",b?"bg-base-300":""),children:(0,d.jsx)(g.FiSearch,{size:t,className:"text-base-content"})}),(0,d.jsx)(l.default,{label:q("Book Menu"),className:(0,e.default)(window.innerWidth<640&&"dropdown-end","dropdown-bottom flex justify-center"),menuClassName:window.innerWidth<640?"no-triangle mt-1":"dropdown-center mt-1",buttonClassName:"btn btn-ghost h-8 min-h-8 w-8 p-0",toggleButton:(0,d.jsx)(h.MdOutlineMenu,{className:"fill-base-content"}),children:(0,d.jsx)(m.default,{})}),(0,d.jsx)("div",{className:"right-0 hidden h-8 w-8 items-center justify-center sm:flex",children:(0,d.jsx)("button",{title:q(a?"Unpin Sidebar":"Pin Sidebar"),onClick:o,className:(0,e.default)("sidebar-pin-btn btn btn-ghost btn-circle hidden h-6 min-h-6 w-6 sm:flex",a?"bg-base-300":"bg-base-300/65"),children:a?(0,d.jsx)(h.MdPushPin,{size:s}):(0,d.jsx)(h.MdOutlinePushPin,{size:s})})})]})]})}]),c()}catch(a){c(a)}},!1),191585,a=>a.a(async(b,c)=>{try{let b=await a.y("overlayscrollbars-react");a.n(b),c()}catch(a){c(a)}},!0),508479,(a,b,c)=>{b.exports=a.x("react-window",()=>require("react-window"))},518258,a=>{"use strict";a.s(["walkTextNodes",0,(a,b=[])=>{let c=[],d=(a,e=0)=>{if(!(e>15))for(let f of(a instanceof HTMLElement&&a.shadowRoot&&d(a.shadowRoot,e+1),"children"in a?Array.from(a.children):[])){if("STYLE"===f.tagName||"LINK"===f.tagName||b.includes(f.tagName.toLowerCase()))continue;if(f.shadowRoot&&d(f.shadowRoot,e+1),"IFRAME"===f.tagName){let a=f.contentDocument||f.contentWindow?.document;a&&a.body&&d(a.body,e+1)}let a=f.childNodes&&Array.from(f.childNodes).some(a=>!!(a.nodeType===Node.TEXT_NODE&&a.textContent?.trim()||a.nodeType===Node.ELEMENT_NODE&&"SPAN"===a.tagName&&a.textContent?.trim()));0===f.children.length&&f.textContent?.trim()||a?c.push(f):f.children.length>0&&d(f,e+1)}};return d(a),c}])},52529,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(466759),f=a.i(665647),g=a.i(518258),h=a.i(951790),i=a.i(465863),j=b([e,f]);function k(a,b,c=!1,j="translation-target-block"){let{getViewSettings:l,getProgress:m}=(0,e.useReaderStore)(),n=l(a),o=m(a),p=(0,d.useRef)(n?.translationEnabled),[q,r]=(0,d.useState)(n?.translationProvider),[s,t]=(0,d.useState)(n?.translateTargetLang),u=(0,d.useRef)(n?.showTranslateSource),{translate:v}=(0,f.useTranslator)({provider:q,targetLang:s||(0,i.getLocale)()}),w=(0,d.useRef)(v),x=(0,d.useRef)(null),y=(0,d.useRef)([]),z=(0,d.useRef)([]);(0,d.useEffect)(()=>{w.current=v},[v]);let A=()=>{if(!b||!p.current)return;let a=B();x.current=a;let c=(0,g.walkTextNodes)(b,["pre","code","math"]);console.log("Observing text nodes for translation:",c.length),z.current=c,c.forEach(b=>a.observe(b))},B=()=>new IntersectionObserver(a=>{let b=null,c=null;for(let d of a){if(!d.isIntersecting){c||(b=d.target);continue}let a=d.target;D(a),c=a}b&&D(b),c&&C(c,2)},{rootMargin:"1280px",threshold:0}),C=(a,b)=>{if(!z.current||b<=0)return;let c=z.current.indexOf(a);-1===c||z.current.slice(c+1,c+1+b).forEach((a,b)=>{setTimeout(()=>{D(a)},500*b)})},D=async a=>{if(!p.current)return;let b=a.textContent?.replaceAll("\n","").trim();if(!b||a.classList.contains("translation-target"))return;let d=a=>{if(Array.from(a.childNodes).some(a=>a.nodeType===Node.TEXT_NODE&&a.textContent?.trim()!=="")){a.classList.add("translation-source");let b=Array.from(a.childNodes).filter(a=>a.nodeType===Node.TEXT_NODE&&a.textContent?.trim()!=="");a.hasAttribute("original-text-stored")||(a.setAttribute("original-text-nodes",JSON.stringify(b.map(a=>a.textContent))),a.setAttribute("original-text-stored","true"))}if(a.classList.contains("translation-source")){let b=Array.from(a.childNodes).filter(a=>a.nodeType===Node.TEXT_NODE);if(u.current){let c=JSON.parse(a.getAttribute("original-text-nodes")||"[]");b.forEach((a,b)=>{void 0!==c[b]&&(a.textContent=c[b])})}else b.forEach(a=>{a.textContent=""})}for(let b of Array.from(a.childNodes))b.nodeType===Node.ELEMENT_NODE&&(b.classList.contains("translation-target")||d(b))};d(a);try{let d=(await w.current([b]))[0];if(!d||b===d)return;let e=document.createElement("font");e.className=`translation-target ${!p.current?"hidden":""}`,e.setAttribute("translation-element-mark","1"),e.setAttribute("lang",s||(0,i.getLocale)()),c&&e.appendChild(document.createElement("br"));let f=document.createElement("font");f.className=`translation-target ${j}`;let g=document.createElement("font");if(g.className="translation-target target-inner target-inner-theme-none",g.textContent=d,f.appendChild(g),e.appendChild(f),a.querySelector(".translation-target"))return;a.appendChild(e),y.current.push(a)}catch(a){console.warn("Translation failed:",a)}},E=(0,d.useCallback)((0,h.debounce)(a=>{let b=z.current;if(0===b.length)return void console.warn("No text nodes available for translation.");let{startIndex:c,endIndex:d}=((a,b)=>{let c=a.startContainer,d=a.endContainer,e=-1,f=-1;for(let a=0;a<b.length;a++){let g=b[a];(g===c||g.contains(c))&&-1===e&&(e=a),(g===d||g.contains(d))&&(f=a)}return -1!==e&&-1===f&&(f=e),{startIndex:e,endIndex:f}})(a,b);if(-1===c)return void console.log("Range not found in text nodes");let e=Math.max(0,c-2),f=Math.min(b.length-1,d+5);for(let a=e;a<=f;a++){let c=b[a];c&&D(c)}},500),[D]);(0,d.useEffect)(()=>{if(p.current&&o){let{range:a}=o;E(a)}},[o]),(0,d.useEffect)(()=>{if(!n)return;let a=p.current!==n.translationEnabled,c=q!==n.translationProvider,d=s!==n.translateTargetLang,e=u.current!==n.showTranslateSource;if(a&&(p.current=n.translationEnabled),c&&r(n.translationProvider),d&&t(n.translateTargetLang),e&&(u.current=n.showTranslateSource),a){var f;f=n.translationEnabled,y.current.forEach(a=>{a.querySelectorAll(".translation-target").forEach(a=>{f?a.classList.remove("hidden"):a.classList.add("hidden")})}),p.current&&A()}else{let a;(c||d||e)&&(y.current.forEach(a=>{a.querySelectorAll(".translation-target").forEach(a=>a.remove())}),y.current=[],n?.translationEnabled&&b&&(a=B(),x.current?.disconnect(),x.current=a,z.current.forEach(b=>a.observe(b))))}},[a,n,q,s]),(0,d.useEffect)(()=>{if(b&&p.current)return"renderer"in b?b.addEventListener("load",A):A(),()=>{"renderer"in b&&b.removeEventListener("load",A),x.current?.disconnect(),y.current=[]}},[b])}[e,f]=j.then?(await j)():j,a.s(["useTextTranslation",()=>k]),c()}catch(a){c(a)}},!1),916404,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(465863),h=b([e]);[e]=h.then?(await h)():h;let i=f.default.memo(({flatItem:a,itemSize:b,isActive:c,onToggleExpand:h,onItemClick:i})=>{let j,{item:k,depth:l}=a,m=(0,f.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),h(k)},[k,h]),n=(0,f.useCallback)(a=>{a.preventDefault(),i(k)},[k,i]);return(0,d.jsxs)("div",{tabIndex:0,role:"treeitem",onClick:k.href?n:void 0,onKeyDown:k.href?a=>"Enter"===a.key&&n(a):void 0,"aria-expanded":a.isExpanded?"true":"false","aria-selected":c?"true":"false","data-href":k.href?(0,g.getContentMd5)(k.href):void 0,className:(0,e.default)("flex w-full cursor-pointer items-center rounded-md py-4 sm:py-2",c?"text-bold-in-eink sm:bg-base-300/65 sm:hover:bg-base-300/75 sm:text-base-content text-blue-500":"sm:hover:bg-base-300/75"),style:{height:b?`${b}px`:"auto",paddingInlineStart:`${(l+1)*12}px`},children:[k.subitems&&(0,d.jsx)("button",{onClick:m,onKeyDown:a=>{a.stopPropagation()},className:"inline-block cursor-pointer",style:{padding:"12px",margin:"-12px"},children:(j=a.isExpanded||!1,(0,d.jsx)("svg",{viewBox:"0 0 8 10",width:"8",height:"10",className:(0,e.default)("text-base-content transform transition-transform",j?"rotate-90":"rotate-0"),style:{transformOrigin:"center"},fill:"currentColor",children:(0,d.jsx)("polygon",{points:"0 0, 8 5, 0 10"})}))}),(0,d.jsx)("div",{className:"ms-2 truncate text-ellipsis",style:{maxWidth:"calc(100% - 24px)",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:k.label}),k.location&&(0,d.jsx)("div",{className:"text-base-content/50 ms-auto ps-1 text-xs sm:pe-1",children:k.location.current+1})]})});i.displayName="TOCItemView";let j=({bookKey:a,flatItem:b,itemSize:c,activeHref:f,onToggleExpand:g,onItemClick:h})=>{let j=f===b.item.href;return(0,d.jsx)("div",{className:(0,e.default)("border-base-300 w-full border-b sm:border-none","pe-4 ps-2 pt-[1px] sm:pe-2"),title:b.item.label||"",children:(0,d.jsx)(i,{bookKey:a,flatItem:b,itemSize:c,isActive:j,onToggleExpand:g,onItemClick:h})})};a.s(["StaticListRow",0,j,"VirtualListRow",0,({index:a,style:b,data:c})=>{let{flatItems:e,bookKey:f,activeHref:g,itemSize:h,onToggleExpand:i,onItemClick:k}=c,l=e[a];return(0,d.jsx)("div",{style:b,title:l.item.label||"",children:(0,d.jsx)(j,{bookKey:f,flatItem:l,itemSize:h-1,activeHref:g,onToggleExpand:i,onItemClick:k})})}]),c()}catch(a){c(a)}},!1),744793,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(508479),g=a.i(191585),h=a.i(178552),i=a.i(466759),j=a.i(715715),k=a.i(123588),l=a.i(765918),m=a.i(465863),n=a.i(52529),o=a.i(916404),p=b([g,i,j,n,o]);[g,i,j,n,o]=p.then?(await p)():p;let q=a=>{let b=a.href||"";return`toc-item-${a.id}-${b}`};a.s(["default",0,({bookKey:a,toc:b,sections:c})=>{let{appService:p}=(0,h.useEnv)(),{getView:r,getProgress:s,getViewSettings:t}=(0,i.useReaderStore)(),{sideBarBookKey:u,isSideBarVisible:v}=(0,j.useSidebarStore)(),w=t(a),x=s(a),[y,z]=(0,e.useState)(new Set),[A,B]=(0,e.useState)(400),C=(0,e.useRef)(!1),D=(0,e.useRef)(0),E=(0,e.useRef)(null),F=(0,e.useRef)(null),G=(0,e.useRef)(null),H=(0,e.useRef)(null),[I]=(0,g.useOverlayScrollbars)({defer:!0,options:{scrollbars:{autoHide:"scroll"},showNativeOverlaidScrollbars:!1},events:{initialized(a){let{viewport:b}=a.elements();b.style.overflowX="var(--os-viewport-overflow-x)",b.style.overflowY="var(--os-viewport-overflow-y)"}}}),J=(0,e.useCallback)(()=>!!C.current&&(!(Date.now()-D.current>=1e4)||(C.current=!1,!1)),[]),K=(0,e.useCallback)(()=>{setTimeout(()=>{C.current=!0,D.current=Date.now()},500)},[]);(0,e.useEffect)(()=>{let{current:a}=E,{current:b}=F;if(a&&b)return I({target:a,elements:{viewport:b}}),b.addEventListener("scroll",K),()=>{b.removeEventListener("scroll",K)}},[I,K]),(0,n.useTextTranslation)(a,E.current||H.current,!1,"translation-target-toc"),(0,e.useEffect)(()=>{let a=()=>{if(E.current){let a=E.current.getBoundingClientRect(),b=E.current.closest(".scroll-container");if(b){let c=b.getBoundingClientRect(),d=c.height-(a.top-c.top);B(Math.max(400,d))}}};a(),window.addEventListener("resize",a);let b=null;if(E.current){let c=E.current.closest(".scroll-container");c&&(b=new ResizeObserver(a)).observe(c)}let c=H.current,d=null;return c&&(d=c.parentElement)&&d.addEventListener("scroll",K),()=>{window.removeEventListener("resize",a),b&&b.disconnect(),d&&d.removeEventListener("scroll",K)}},[y,K]);let L=(0,e.useMemo)(()=>x?.sectionHref||null,[x?.sectionHref]),M=(0,e.useMemo)(()=>{let a=(b,c=0)=>{let d=[];return b.forEach((b,e)=>{let f=y.has(q(b));d.push({item:b,depth:c,index:e,isExpanded:f}),b.subitems&&f&&d.push(...a(b.subitems,c+1))}),d};return a(b)},[b,y]),N=(0,e.useMemo)(()=>M.findIndex(a=>a.item.href===L),[M,L]),O=(0,e.useCallback)(a=>{let b=q(a);K(),z(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})},[K]),P=(0,e.useCallback)(b=>{l.eventDispatcher.dispatch("navigate",{bookKey:a,href:b.href}),b.href&&r(a)?.goTo(b.href)},[a,r]),Q=(0,e.useCallback)((a,b)=>{let c=(0,k.findParentPath)(a,b).map(a=>q(a)).filter(Boolean);z(new Set(c))},[]),R=(0,e.useCallback)(()=>{if(L){if(G.current){let a=M.findIndex(a=>a.item.href===L);-1!==a&&G.current.scrollToItem(a,"center")}if(H.current){let a=L?(0,m.getContentMd5)(L):"",b=H.current?.querySelector(`[data-href="${a}"]`);if(b){let a=H.current.parentElement.getBoundingClientRect(),c=b.getBoundingClientRect();c.top>=a.top&&c.bottom<=a.bottom||b.scrollIntoView({behavior:"instant",block:"center"}),b.setAttribute("aria-current","page")}}}},[M,L]),S=(0,e.useMemo)(()=>window.innerWidth>=640&&!w?.translationEnabled?37:57,[w?.translationEnabled]),T=(0,e.useMemo)(()=>({flatItems:M,itemSize:S,bookKey:a,activeHref:L,onToggleExpand:O,onItemClick:P}),[M,S,a,L,O,P]);return(0,e.useEffect)(()=>{if(!x||!v||u!==a||J())return;let{sectionHref:c}=x;c&&Q(b,c)},[b,x,u,v,a,Q,J]),(0,e.useEffect)(()=>{!J()&&M.length>0&&setTimeout(R,p?.isAndroidApp?300:100)},[x,R,J]),c&&c.length>256?(0,d.jsx)("div",{className:"virtual-list mt-2 rounded","data-overlayscrollbars-initialize":"",ref:E,children:(0,d.jsx)(f.FixedSizeList,{ref:G,outerRef:F,width:"100%",height:A,itemCount:M.length,itemSize:S,itemData:T,overscanCount:20,initialScrollOffset:p?.isAndroidApp&&N>=0?Math.max(0,N*S-A/2):void 0,children:o.VirtualListRow})}):(0,d.jsx)("div",{className:"static-list mt-2 rounded",ref:H,children:M.map((b,c)=>(0,d.jsx)(o.StaticListRow,{bookKey:a,flatItem:b,activeHref:L,onToggleExpand:O,onItemClick:P},`static-row-${c}`))})}]),c()}catch(a){c(a)}},!1),852835,a=>{"use strict";function b(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var c=b(),d={exec:()=>null};function e(a,b=""){let c="string"==typeof a?a:a.source,d={replace:(a,b)=>{let e="string"==typeof b?b:b.source;return e=e.replace(f.caret,"$1"),c=c.replace(a,e),d},getRegex:()=>new RegExp(c,b)};return d}var f={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:a=>RegExp(`^( {0,3}${a})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:a=>RegExp(`^ {0,${Math.min(3,a-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:a=>RegExp(`^ {0,${Math.min(3,a-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:a=>RegExp(`^ {0,${Math.min(3,a-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:a=>RegExp(`^ {0,${Math.min(3,a-1)}}#`),htmlBeginRegex:a=>RegExp(`^ {0,${Math.min(3,a-1)}}<(?:[a-z].*>|!--)`,"i")},g=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,h=/(?:[*+-]|\d{1,9}[.)])/,i=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,j=e(i).replace(/bull/g,h).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),k=e(i).replace(/bull/g,h).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),l=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,m=/(?!\s*\])(?:\\.|[^\[\]\\])+/,n=e(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",m).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),o=e(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,h).getRegex(),p="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",q=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,r=e("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",q).replace("tag",p).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),s=e(l).replace("hr",g).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",p).getRegex(),t={blockquote:e(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",s).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:n,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:g,html:r,lheading:j,list:o,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:s,table:d,text:/^[^\n]+/},u=e("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",g).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",p).getRegex(),v={...t,lheading:k,table:u,paragraph:e(l).replace("hr",g).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",u).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",p).getRegex()},w={...t,html:e(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",q).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:d,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:e(l).replace("hr",g).replace("heading"," *#{1,6} *[^\n]").replace("lheading",j).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},x=/^( {2,}|\\)\n(?!\s*$)/,y=/[\p{P}\p{S}]/u,z=/[\s\p{P}\p{S}]/u,A=/[^\s\p{P}\p{S}]/u,B=e(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,z).getRegex(),C=/(?!~)[\p{P}\p{S}]/u,D=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,E=e(D,"u").replace(/punct/g,y).getRegex(),F=e(D,"u").replace(/punct/g,C).getRegex(),G="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",H=e(G,"gu").replace(/notPunctSpace/g,A).replace(/punctSpace/g,z).replace(/punct/g,y).getRegex(),I=e(G,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,C).getRegex(),J=e("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,A).replace(/punctSpace/g,z).replace(/punct/g,y).getRegex(),K=e(/\\(punct)/,"gu").replace(/punct/g,y).getRegex(),L=e(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),M=e(q).replace("(?:-->|$)","-->").getRegex(),N=e("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",M).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),O=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,P=e(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",O).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Q=e(/^!?\[(label)\]\[(ref)\]/).replace("label",O).replace("ref",m).getRegex(),R=e(/^!?\[(ref)\](?:\[\])?/).replace("ref",m).getRegex(),S=e("reflink|nolink(?!\\()","g").replace("reflink",Q).replace("nolink",R).getRegex(),T={_backpedal:d,anyPunctuation:K,autolink:L,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:x,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:d,emStrongLDelim:E,emStrongRDelimAst:H,emStrongRDelimUnd:J,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:P,nolink:R,punctuation:B,reflink:Q,reflinkSearch:S,tag:N,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:d},U={...T,link:e(/^!?\[(label)\]\((.*?)\)/).replace("label",O).getRegex(),reflink:e(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",O).getRegex()},V={...T,emStrongRDelimAst:I,emStrongLDelim:F,url:e(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},W={...V,br:e(x).replace("{2,}","*").getRegex(),text:e(V.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},X={normal:t,gfm:v,pedantic:w},Y={normal:T,gfm:V,breaks:W,pedantic:U},Z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$=a=>Z[a];function _(a,b){if(b){if(f.escapeTest.test(a))return a.replace(f.escapeReplace,$)}else if(f.escapeTestNoEncode.test(a))return a.replace(f.escapeReplaceNoEncode,$);return a}function aa(a){try{a=encodeURI(a).replace(f.percentDecode,"%")}catch{return null}return a}function ab(a,b){let c=a.replace(f.findPipe,(a,b,c)=>{let d=!1,e=b;for(;--e>=0&&"\\"===c[e];)d=!d;return d?"|":" |"}).split(f.splitPipe),d=0;if(c[0].trim()||c.shift(),c.length>0&&!c.at(-1)?.trim()&&c.pop(),b)if(c.length>b)c.splice(b);else for(;c.length<b;)c.push("");for(;d<c.length;d++)c[d]=c[d].trim().replace(f.slashPipe,"|");return c}function ac(a,b,c){let d=a.length;if(0===d)return"";let e=0;for(;e<d;){let f=a.charAt(d-e-1);if(f!==b||c)if(f!==b&&c)e++;else break;else e++}return a.slice(0,d-e)}function ad(a,b,c,d,e){let f=b.href,g=b.title||null,h=a[1].replace(e.other.outputLinkReplace,"$1");d.state.inLink=!0;let i={type:"!"===a[0].charAt(0)?"image":"link",raw:c,href:f,title:g,text:h,tokens:d.inlineTokens(h)};return d.state.inLink=!1,i}var ae=class{options;rules;lexer;constructor(a){this.options=a||c}space(a){let b=this.rules.block.newline.exec(a);if(b&&b[0].length>0)return{type:"space",raw:b[0]}}code(a){let b=this.rules.block.code.exec(a);if(b){let a=b[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:b[0],codeBlockStyle:"indented",text:this.options.pedantic?a:ac(a,"\n")}}}fences(a){let b=this.rules.block.fences.exec(a);if(b){let a=b[0],c=function(a,b,c){let d=a.match(c.other.indentCodeCompensation);if(null===d)return b;let e=d[1];return b.split("\n").map(a=>{let b=a.match(c.other.beginningSpace);if(null===b)return a;let[d]=b;return d.length>=e.length?a.slice(e.length):a}).join("\n")}(a,b[3]||"",this.rules);return{type:"code",raw:a,lang:b[2]?b[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):b[2],text:c}}}heading(a){let b=this.rules.block.heading.exec(a);if(b){let a=b[2].trim();if(this.rules.other.endingHash.test(a)){let b=ac(a,"#");this.options.pedantic?a=b.trim():(!b||this.rules.other.endingSpaceChar.test(b))&&(a=b.trim())}return{type:"heading",raw:b[0],depth:b[1].length,text:a,tokens:this.lexer.inline(a)}}}hr(a){let b=this.rules.block.hr.exec(a);if(b)return{type:"hr",raw:ac(b[0],"\n")}}blockquote(a){let b=this.rules.block.blockquote.exec(a);if(b){let a=ac(b[0],"\n").split("\n"),c="",d="",e=[];for(;a.length>0;){let b,f=!1,g=[];for(b=0;b<a.length;b++)if(this.rules.other.blockquoteStart.test(a[b]))g.push(a[b]),f=!0;else if(f)break;else g.push(a[b]);a=a.slice(b);let h=g.join("\n"),i=h.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");c=c?`${c}
${h}`:h,d=d?`${d}
${i}`:i;let j=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(i,e,!0),this.lexer.state.top=j,0===a.length)break;let k=e.at(-1);if(k?.type==="code")break;if(k?.type==="blockquote"){let b=k.raw+"\n"+a.join("\n"),f=this.blockquote(b);e[e.length-1]=f,c=c.substring(0,c.length-k.raw.length)+f.raw,d=d.substring(0,d.length-k.text.length)+f.text;break}if(k?.type==="list"){let b=k.raw+"\n"+a.join("\n"),f=this.list(b);e[e.length-1]=f,c=c.substring(0,c.length-k.raw.length)+f.raw,d=d.substring(0,d.length-k.raw.length)+f.raw,a=b.substring(e.at(-1).raw.length).split("\n");continue}}return{type:"blockquote",raw:c,tokens:e,text:d}}}list(a){let b=this.rules.block.list.exec(a);if(b){let c=b[1].trim(),d=c.length>1,e={type:"list",raw:"",ordered:d,start:d?+c.slice(0,-1):"",loose:!1,items:[]};c=d?`\\d{1,9}\\${c.slice(-1)}`:`\\${c}`,this.options.pedantic&&(c=d?c:"[*+-]");let f=this.rules.other.listItemRegex(c),g=!1;for(;a;){let c,d=!1,h="",i="";if(!(b=f.exec(a))||this.rules.block.hr.test(a))break;h=b[0],a=a.substring(h.length);let j=b[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,a=>" ".repeat(3*a.length)),k=a.split("\n",1)[0],l=!j.trim(),m=0;if(this.options.pedantic?(m=2,i=j.trimStart()):l?m=b[1].length+1:(m=(m=b[2].search(this.rules.other.nonSpaceChar))>4?1:m,i=j.slice(m),m+=b[1].length),l&&this.rules.other.blankLine.test(k)&&(h+=k+"\n",a=a.substring(k.length+1),d=!0),!d){let b=this.rules.other.nextBulletRegex(m),c=this.rules.other.hrRegex(m),d=this.rules.other.fencesBeginRegex(m),e=this.rules.other.headingBeginRegex(m),f=this.rules.other.htmlBeginRegex(m);for(;a;){let g,n=a.split("\n",1)[0];if(k=n,g=this.options.pedantic?k=k.replace(this.rules.other.listReplaceNesting,"  "):k.replace(this.rules.other.tabCharGlobal,"    "),d.test(k)||e.test(k)||f.test(k)||b.test(k)||c.test(k))break;if(g.search(this.rules.other.nonSpaceChar)>=m||!k.trim())i+="\n"+g.slice(m);else{if(l||j.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||d.test(j)||e.test(j)||c.test(j))break;i+="\n"+k}l||k.trim()||(l=!0),h+=n+"\n",a=a.substring(n.length+1),j=g.slice(m)}}!e.loose&&(g?e.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(g=!0));let n=null;this.options.gfm&&(n=this.rules.other.listIsTask.exec(i))&&(c="[ ] "!==n[0],i=i.replace(this.rules.other.listReplaceTask,"")),e.items.push({type:"list_item",raw:h,task:!!n,checked:c,loose:!1,text:i,tokens:[]}),e.raw+=h}let h=e.items.at(-1);if(!h)return;h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd(),e.raw=e.raw.trimEnd();for(let a=0;a<e.items.length;a++)if(this.lexer.state.top=!1,e.items[a].tokens=this.lexer.blockTokens(e.items[a].text,[]),!e.loose){let b=e.items[a].tokens.filter(a=>"space"===a.type);e.loose=b.length>0&&b.some(a=>this.rules.other.anyLine.test(a.raw))}if(e.loose)for(let a=0;a<e.items.length;a++)e.items[a].loose=!0;return e}}html(a){let b=this.rules.block.html.exec(a);if(b)return{type:"html",block:!0,raw:b[0],pre:"pre"===b[1]||"script"===b[1]||"style"===b[1],text:b[0]}}def(a){let b=this.rules.block.def.exec(a);if(b){let a=b[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),c=b[2]?b[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",d=b[3]?b[3].substring(1,b[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):b[3];return{type:"def",tag:a,raw:b[0],href:c,title:d}}}table(a){let b=this.rules.block.table.exec(a);if(!b||!this.rules.other.tableDelimiter.test(b[2]))return;let c=ab(b[1]),d=b[2].replace(this.rules.other.tableAlignChars,"").split("|"),e=b[3]?.trim()?b[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],f={type:"table",raw:b[0],header:[],align:[],rows:[]};if(c.length===d.length){for(let a of d)this.rules.other.tableAlignRight.test(a)?f.align.push("right"):this.rules.other.tableAlignCenter.test(a)?f.align.push("center"):this.rules.other.tableAlignLeft.test(a)?f.align.push("left"):f.align.push(null);for(let a=0;a<c.length;a++)f.header.push({text:c[a],tokens:this.lexer.inline(c[a]),header:!0,align:f.align[a]});for(let a of e)f.rows.push(ab(a,f.header.length).map((a,b)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:f.align[b]})));return f}}lheading(a){let b=this.rules.block.lheading.exec(a);if(b)return{type:"heading",raw:b[0],depth:"="===b[2].charAt(0)?1:2,text:b[1],tokens:this.lexer.inline(b[1])}}paragraph(a){let b=this.rules.block.paragraph.exec(a);if(b){let a="\n"===b[1].charAt(b[1].length-1)?b[1].slice(0,-1):b[1];return{type:"paragraph",raw:b[0],text:a,tokens:this.lexer.inline(a)}}}text(a){let b=this.rules.block.text.exec(a);if(b)return{type:"text",raw:b[0],text:b[0],tokens:this.lexer.inline(b[0])}}escape(a){let b=this.rules.inline.escape.exec(a);if(b)return{type:"escape",raw:b[0],text:b[1]}}tag(a){let b=this.rules.inline.tag.exec(a);if(b)return!this.lexer.state.inLink&&this.rules.other.startATag.test(b[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(b[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(b[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(b[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:b[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:b[0]}}link(a){let b=this.rules.inline.link.exec(a);if(b){let a=b[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(a)){if(!this.rules.other.endAngleBracket.test(a))return;let b=ac(a.slice(0,-1),"\\");if((a.length-b.length)%2==0)return}else{let a=function(a,b){if(-1===a.indexOf(")"))return -1;let c=0;for(let b=0;b<a.length;b++)if("\\"===a[b])b++;else if("("===a[b])c++;else if(")"===a[b]&&--c<0)return b;return c>0?-2:-1}(b[2],0);if(-2===a)return;if(a>-1){let c=(0===b[0].indexOf("!")?5:4)+b[1].length+a;b[2]=b[2].substring(0,a),b[0]=b[0].substring(0,c).trim(),b[3]=""}}let c=b[2],d="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(c);a&&(c=a[1],d=a[3])}else d=b[3]?b[3].slice(1,-1):"";return c=c.trim(),this.rules.other.startAngleBracket.test(c)&&(c=this.options.pedantic&&!this.rules.other.endAngleBracket.test(a)?c.slice(1):c.slice(1,-1)),ad(b,{href:c?c.replace(this.rules.inline.anyPunctuation,"$1"):c,title:d?d.replace(this.rules.inline.anyPunctuation,"$1"):d},b[0],this.lexer,this.rules)}}reflink(a,b){let c;if((c=this.rules.inline.reflink.exec(a))||(c=this.rules.inline.nolink.exec(a))){let a=b[(c[2]||c[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!a){let a=c[0].charAt(0);return{type:"text",raw:a,text:a}}return ad(c,a,c[0],this.lexer,this.rules)}}emStrong(a,b,c=""){let d=this.rules.inline.emStrongLDelim.exec(a);if(!(!d||d[3]&&c.match(this.rules.other.unicodeAlphaNumeric))&&(!(d[1]||d[2])||!c||this.rules.inline.punctuation.exec(c))){let c=[...d[0]].length-1,e,f,g=c,h=0,i="*"===d[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(i.lastIndex=0,b=b.slice(-1*a.length+c);null!=(d=i.exec(b));){if(!(e=d[1]||d[2]||d[3]||d[4]||d[5]||d[6]))continue;if(f=[...e].length,d[3]||d[4]){g+=f;continue}if((d[5]||d[6])&&c%3&&!((c+f)%3)){h+=f;continue}if((g-=f)>0)continue;f=Math.min(f,f+g+h);let b=[...d[0]][0].length,i=a.slice(0,c+d.index+b+f);if(Math.min(c,f)%2){let a=i.slice(1,-1);return{type:"em",raw:i,text:a,tokens:this.lexer.inlineTokens(a)}}let j=i.slice(2,-2);return{type:"strong",raw:i,text:j,tokens:this.lexer.inlineTokens(j)}}}}codespan(a){let b=this.rules.inline.code.exec(a);if(b){let a=b[2].replace(this.rules.other.newLineCharGlobal," "),c=this.rules.other.nonSpaceChar.test(a),d=this.rules.other.startingSpaceChar.test(a)&&this.rules.other.endingSpaceChar.test(a);return c&&d&&(a=a.substring(1,a.length-1)),{type:"codespan",raw:b[0],text:a}}}br(a){let b=this.rules.inline.br.exec(a);if(b)return{type:"br",raw:b[0]}}del(a){let b=this.rules.inline.del.exec(a);if(b)return{type:"del",raw:b[0],text:b[2],tokens:this.lexer.inlineTokens(b[2])}}autolink(a){let b=this.rules.inline.autolink.exec(a);if(b){let a,c;return c="@"===b[2]?"mailto:"+(a=b[1]):a=b[1],{type:"link",raw:b[0],text:a,href:c,tokens:[{type:"text",raw:a,text:a}]}}}url(a){let b;if(b=this.rules.inline.url.exec(a)){let a,c;if("@"===b[2])c="mailto:"+(a=b[0]);else{let d;do d=b[0],b[0]=this.rules.inline._backpedal.exec(b[0])?.[0]??"";while(d!==b[0])a=b[0],c="www."===b[1]?"http://"+b[0]:b[0]}return{type:"link",raw:b[0],text:a,href:c,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(a){let b=this.rules.inline.text.exec(a);if(b){let a=this.lexer.state.inRawBlock;return{type:"text",raw:b[0],text:b[0],escaped:a}}}},af=class a{tokens;options;state;tokenizer;inlineQueue;constructor(a){this.tokens=[],this.tokens.links=Object.create(null),this.options=a||c,this.options.tokenizer=this.options.tokenizer||new ae,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const b={other:f,block:X.normal,inline:Y.normal};this.options.pedantic?(b.block=X.pedantic,b.inline=Y.pedantic):this.options.gfm&&(b.block=X.gfm,this.options.breaks?b.inline=Y.breaks:b.inline=Y.gfm),this.tokenizer.rules=b}static get rules(){return{block:X,inline:Y}}static lex(b,c){return new a(c).lex(b)}static lexInline(b,c){return new a(c).inlineTokens(b)}lex(a){a=a.replace(f.carriageReturn,"\n"),this.blockTokens(a,this.tokens);for(let a=0;a<this.inlineQueue.length;a++){let b=this.inlineQueue[a];this.inlineTokens(b.src,b.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(a,b=[],c=!1){for(this.options.pedantic&&(a=a.replace(f.tabCharGlobal,"    ").replace(f.spaceLine,""));a;){let d;if(this.options.extensions?.block?.some(c=>!!(d=c.call({lexer:this},a,b))&&(a=a.substring(d.raw.length),b.push(d),!0)))continue;if(d=this.tokenizer.space(a)){a=a.substring(d.raw.length);let c=b.at(-1);1===d.raw.length&&void 0!==c?c.raw+="\n":b.push(d);continue}if(d=this.tokenizer.code(a)){a=a.substring(d.raw.length);let c=b.at(-1);c?.type==="paragraph"||c?.type==="text"?(c.raw+="\n"+d.raw,c.text+="\n"+d.text,this.inlineQueue.at(-1).src=c.text):b.push(d);continue}if((d=this.tokenizer.fences(a))||(d=this.tokenizer.heading(a))||(d=this.tokenizer.hr(a))||(d=this.tokenizer.blockquote(a))||(d=this.tokenizer.list(a))||(d=this.tokenizer.html(a))){a=a.substring(d.raw.length),b.push(d);continue}if(d=this.tokenizer.def(a)){a=a.substring(d.raw.length);let c=b.at(-1);c?.type==="paragraph"||c?.type==="text"?(c.raw+="\n"+d.raw,c.text+="\n"+d.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title});continue}if((d=this.tokenizer.table(a))||(d=this.tokenizer.lheading(a))){a=a.substring(d.raw.length),b.push(d);continue}let e=a;if(this.options.extensions?.startBlock){let b,c=1/0,d=a.slice(1);this.options.extensions.startBlock.forEach(a=>{"number"==typeof(b=a.call({lexer:this},d))&&b>=0&&(c=Math.min(c,b))}),c<1/0&&c>=0&&(e=a.substring(0,c+1))}if(this.state.top&&(d=this.tokenizer.paragraph(e))){let f=b.at(-1);c&&f?.type==="paragraph"?(f.raw+="\n"+d.raw,f.text+="\n"+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):b.push(d),c=e.length!==a.length,a=a.substring(d.raw.length);continue}if(d=this.tokenizer.text(a)){a=a.substring(d.raw.length);let c=b.at(-1);c?.type==="text"?(c.raw+="\n"+d.raw,c.text+="\n"+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):b.push(d);continue}if(a){let b="Infinite loop on byte: "+a.charCodeAt(0);if(this.options.silent){console.error(b);break}throw Error(b)}}return this.state.top=!0,b}inline(a,b=[]){return this.inlineQueue.push({src:a,tokens:b}),b}inlineTokens(a,b=[]){let c=a,d=null;if(this.tokens.links){let a=Object.keys(this.tokens.links);if(a.length>0)for(;null!=(d=this.tokenizer.rules.inline.reflinkSearch.exec(c));)a.includes(d[0].slice(d[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,d.index)+"["+"a".repeat(d[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(d=this.tokenizer.rules.inline.anyPunctuation.exec(c));)c=c.slice(0,d.index)+"++"+c.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;null!=(d=this.tokenizer.rules.inline.blockSkip.exec(c));)c=c.slice(0,d.index)+"["+"a".repeat(d[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let e=!1,f="";for(;a;){let d;if(e||(f=""),e=!1,this.options.extensions?.inline?.some(c=>!!(d=c.call({lexer:this},a,b))&&(a=a.substring(d.raw.length),b.push(d),!0)))continue;if((d=this.tokenizer.escape(a))||(d=this.tokenizer.tag(a))||(d=this.tokenizer.link(a))){a=a.substring(d.raw.length),b.push(d);continue}if(d=this.tokenizer.reflink(a,this.tokens.links)){a=a.substring(d.raw.length);let c=b.at(-1);"text"===d.type&&c?.type==="text"?(c.raw+=d.raw,c.text+=d.text):b.push(d);continue}if((d=this.tokenizer.emStrong(a,c,f))||(d=this.tokenizer.codespan(a))||(d=this.tokenizer.br(a))||(d=this.tokenizer.del(a))||(d=this.tokenizer.autolink(a))||!this.state.inLink&&(d=this.tokenizer.url(a))){a=a.substring(d.raw.length),b.push(d);continue}let g=a;if(this.options.extensions?.startInline){let b,c=1/0,d=a.slice(1);this.options.extensions.startInline.forEach(a=>{"number"==typeof(b=a.call({lexer:this},d))&&b>=0&&(c=Math.min(c,b))}),c<1/0&&c>=0&&(g=a.substring(0,c+1))}if(d=this.tokenizer.inlineText(g)){a=a.substring(d.raw.length),"_"!==d.raw.slice(-1)&&(f=d.raw.slice(-1)),e=!0;let c=b.at(-1);c?.type==="text"?(c.raw+=d.raw,c.text+=d.text):b.push(d);continue}if(a){let b="Infinite loop on byte: "+a.charCodeAt(0);if(this.options.silent){console.error(b);break}throw Error(b)}}return b}},ag=class{options;parser;constructor(a){this.options=a||c}space(a){return""}code({text:a,lang:b,escaped:c}){let d=(b||"").match(f.notSpaceStart)?.[0],e=a.replace(f.endingNewline,"")+"\n";return d?'<pre><code class="language-'+_(d)+'">'+(c?e:_(e,!0))+"</code></pre>\n":"<pre><code>"+(c?e:_(e,!0))+"</code></pre>\n"}blockquote({tokens:a}){let b=this.parser.parse(a);return`<blockquote>
${b}</blockquote>
`}html({text:a}){return a}heading({tokens:a,depth:b}){return`<h${b}>${this.parser.parseInline(a)}</h${b}>
`}hr(a){return"<hr>\n"}list(a){let b=a.ordered,c=a.start,d="";for(let b=0;b<a.items.length;b++){let c=a.items[b];d+=this.listitem(c)}let e=b?"ol":"ul";return"<"+e+(b&&1!==c?' start="'+c+'"':"")+">\n"+d+"</"+e+">\n"}listitem(a){let b="";if(a.task){let c=this.checkbox({checked:!!a.checked});a.loose?a.tokens[0]?.type==="paragraph"?(a.tokens[0].text=c+" "+a.tokens[0].text,a.tokens[0].tokens&&a.tokens[0].tokens.length>0&&"text"===a.tokens[0].tokens[0].type&&(a.tokens[0].tokens[0].text=c+" "+_(a.tokens[0].tokens[0].text),a.tokens[0].tokens[0].escaped=!0)):a.tokens.unshift({type:"text",raw:c+" ",text:c+" ",escaped:!0}):b+=c+" "}return b+=this.parser.parse(a.tokens,!!a.loose),`<li>${b}</li>
`}checkbox({checked:a}){return"<input "+(a?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:a}){return`<p>${this.parser.parseInline(a)}</p>
`}table(a){let b="",c="";for(let b=0;b<a.header.length;b++)c+=this.tablecell(a.header[b]);b+=this.tablerow({text:c});let d="";for(let b=0;b<a.rows.length;b++){let e=a.rows[b];c="";for(let a=0;a<e.length;a++)c+=this.tablecell(e[a]);d+=this.tablerow({text:c})}return d&&(d=`<tbody>${d}</tbody>`),"<table>\n<thead>\n"+b+"</thead>\n"+d+"</table>\n"}tablerow({text:a}){return`<tr>
${a}</tr>
`}tablecell(a){let b=this.parser.parseInline(a.tokens),c=a.header?"th":"td";return(a.align?`<${c} align="${a.align}">`:`<${c}>`)+b+`</${c}>
`}strong({tokens:a}){return`<strong>${this.parser.parseInline(a)}</strong>`}em({tokens:a}){return`<em>${this.parser.parseInline(a)}</em>`}codespan({text:a}){return`<code>${_(a,!0)}</code>`}br(a){return"<br>"}del({tokens:a}){return`<del>${this.parser.parseInline(a)}</del>`}link({href:a,title:b,tokens:c}){let d=this.parser.parseInline(c),e=aa(a);if(null===e)return d;let f='<a href="'+(a=e)+'"';return b&&(f+=' title="'+_(b)+'"'),f+=">"+d+"</a>"}image({href:a,title:b,text:c,tokens:d}){d&&(c=this.parser.parseInline(d,this.parser.textRenderer));let e=aa(a);if(null===e)return _(c);a=e;let f=`<img src="${a}" alt="${c}"`;return b&&(f+=` title="${_(b)}"`),f+=">"}text(a){return"tokens"in a&&a.tokens?this.parser.parseInline(a.tokens):"escaped"in a&&a.escaped?a.text:_(a.text)}},ah=class{strong({text:a}){return a}em({text:a}){return a}codespan({text:a}){return a}del({text:a}){return a}html({text:a}){return a}text({text:a}){return a}link({text:a}){return""+a}image({text:a}){return""+a}br(){return""}},ai=class a{options;renderer;textRenderer;constructor(a){this.options=a||c,this.options.renderer=this.options.renderer||new ag,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ah}static parse(b,c){return new a(c).parse(b)}static parseInline(b,c){return new a(c).parseInline(b)}parse(a,b=!0){let c="";for(let d=0;d<a.length;d++){let e=a[d];if(this.options.extensions?.renderers?.[e.type]){let a=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==a||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){c+=a||"";continue}}switch(e.type){case"space":c+=this.renderer.space(e);continue;case"hr":c+=this.renderer.hr(e);continue;case"heading":c+=this.renderer.heading(e);continue;case"code":c+=this.renderer.code(e);continue;case"table":c+=this.renderer.table(e);continue;case"blockquote":c+=this.renderer.blockquote(e);continue;case"list":c+=this.renderer.list(e);continue;case"html":c+=this.renderer.html(e);continue;case"paragraph":c+=this.renderer.paragraph(e);continue;case"text":{let f=e,g=this.renderer.text(f);for(;d+1<a.length&&"text"===a[d+1].type;)f=a[++d],g+="\n"+this.renderer.text(f);b?c+=this.renderer.paragraph({type:"paragraph",raw:g,text:g,tokens:[{type:"text",raw:g,text:g,escaped:!0}]}):c+=g;continue}default:{let a='Token with "'+e.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw Error(a)}}}return c}parseInline(a,b=this.renderer){let c="";for(let d=0;d<a.length;d++){let e=a[d];if(this.options.extensions?.renderers?.[e.type]){let a=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==a||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(e.type)){c+=a||"";continue}}switch(e.type){case"escape":case"text":c+=b.text(e);break;case"html":c+=b.html(e);break;case"link":c+=b.link(e);break;case"image":c+=b.image(e);break;case"strong":c+=b.strong(e);break;case"em":c+=b.em(e);break;case"codespan":c+=b.codespan(e);break;case"br":c+=b.br(e);break;case"del":c+=b.del(e);break;default:{let a='Token with "'+e.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw Error(a)}}}return c}},aj=class{options;block;constructor(a){this.options=a||c}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(a){return a}postprocess(a){return a}processAllTokens(a){return a}provideLexer(){return this.block?af.lex:af.lexInline}provideParser(){return this.block?ai.parse:ai.parseInline}},ak=new class{defaults=b();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=ai;Renderer=ag;TextRenderer=ah;Lexer=af;Tokenizer=ae;Hooks=aj;constructor(...a){this.use(...a)}walkTokens(a,b){let c=[];for(let d of a)switch(c=c.concat(b.call(this,d)),d.type){case"table":for(let a of d.header)c=c.concat(this.walkTokens(a.tokens,b));for(let a of d.rows)for(let d of a)c=c.concat(this.walkTokens(d.tokens,b));break;case"list":c=c.concat(this.walkTokens(d.items,b));break;default:{let a=d;this.defaults.extensions?.childTokens?.[a.type]?this.defaults.extensions.childTokens[a.type].forEach(d=>{let e=a[d].flat(1/0);c=c.concat(this.walkTokens(e,b))}):a.tokens&&(c=c.concat(this.walkTokens(a.tokens,b)))}}return c}use(...a){let b=this.defaults.extensions||{renderers:{},childTokens:{}};return a.forEach(a=>{let c={...a};if(c.async=this.defaults.async||c.async||!1,a.extensions&&(a.extensions.forEach(a=>{if(!a.name)throw Error("extension name required");if("renderer"in a){let c=b.renderers[a.name];c?b.renderers[a.name]=function(...b){let d=a.renderer.apply(this,b);return!1===d&&(d=c.apply(this,b)),d}:b.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||"block"!==a.level&&"inline"!==a.level)throw Error("extension level must be 'block' or 'inline'");let c=b[a.level];c?c.unshift(a.tokenizer):b[a.level]=[a.tokenizer],a.start&&("block"===a.level?b.startBlock?b.startBlock.push(a.start):b.startBlock=[a.start]:"inline"===a.level&&(b.startInline?b.startInline.push(a.start):b.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(b.childTokens[a.name]=a.childTokens)}),c.extensions=b),a.renderer){let b=this.defaults.renderer||new ag(this.defaults);for(let c in a.renderer){if(!(c in b))throw Error(`renderer '${c}' does not exist`);if(["options","parser"].includes(c))continue;let d=a.renderer[c],e=b[c];b[c]=(...a)=>{let c=d.apply(b,a);return!1===c&&(c=e.apply(b,a)),c||""}}c.renderer=b}if(a.tokenizer){let b=this.defaults.tokenizer||new ae(this.defaults);for(let c in a.tokenizer){if(!(c in b))throw Error(`tokenizer '${c}' does not exist`);if(["options","rules","lexer"].includes(c))continue;let d=a.tokenizer[c],e=b[c];b[c]=(...a)=>{let c=d.apply(b,a);return!1===c&&(c=e.apply(b,a)),c}}c.tokenizer=b}if(a.hooks){let b=this.defaults.hooks||new aj;for(let c in a.hooks){if(!(c in b))throw Error(`hook '${c}' does not exist`);if(["options","block"].includes(c))continue;let d=a.hooks[c],e=b[c];aj.passThroughHooks.has(c)?b[c]=a=>{if(this.defaults.async)return Promise.resolve(d.call(b,a)).then(a=>e.call(b,a));let c=d.call(b,a);return e.call(b,c)}:b[c]=(...a)=>{let c=d.apply(b,a);return!1===c&&(c=e.apply(b,a)),c}}c.hooks=b}if(a.walkTokens){let b=this.defaults.walkTokens,d=a.walkTokens;c.walkTokens=function(a){let c=[];return c.push(d.call(this,a)),b&&(c=c.concat(b.call(this,a))),c}}this.defaults={...this.defaults,...c}}),this}setOptions(a){return this.defaults={...this.defaults,...a},this}lexer(a,b){return af.lex(a,b??this.defaults)}parser(a,b){return ai.parse(a,b??this.defaults)}parseMarkdown(a){return(b,c)=>{let d={...c},e={...this.defaults,...d},f=this.onError(!!e.silent,!!e.async);if(!0===this.defaults.async&&!1===d.async)return f(Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==b)return f(Error("marked(): input parameter is undefined or null"));if("string"!=typeof b)return f(Error("marked(): input parameter is of type "+Object.prototype.toString.call(b)+", string expected"));e.hooks&&(e.hooks.options=e,e.hooks.block=a);let g=e.hooks?e.hooks.provideLexer():a?af.lex:af.lexInline,h=e.hooks?e.hooks.provideParser():a?ai.parse:ai.parseInline;if(e.async)return Promise.resolve(e.hooks?e.hooks.preprocess(b):b).then(a=>g(a,e)).then(a=>e.hooks?e.hooks.processAllTokens(a):a).then(a=>e.walkTokens?Promise.all(this.walkTokens(a,e.walkTokens)).then(()=>a):a).then(a=>h(a,e)).then(a=>e.hooks?e.hooks.postprocess(a):a).catch(f);try{e.hooks&&(b=e.hooks.preprocess(b));let a=g(b,e);e.hooks&&(a=e.hooks.processAllTokens(a)),e.walkTokens&&this.walkTokens(a,e.walkTokens);let c=h(a,e);return e.hooks&&(c=e.hooks.postprocess(c)),c}catch(a){return f(a)}}}onError(a,b){return c=>{if(c.message+="\nPlease report this to https://github.com/markedjs/marked.",a){let a="<p>An error occurred:</p><pre>"+_(c.message+"",!0)+"</pre>";return b?Promise.resolve(a):a}if(b)return Promise.reject(c);throw c}}};function al(a,b){return ak.parse(a,b)}al.options=al.setOptions=function(a){return ak.setOptions(a),al.defaults=ak.defaults,c=al.defaults,al},al.getDefaults=b,al.defaults=c,al.use=function(...a){return ak.use(...a),al.defaults=ak.defaults,c=al.defaults,al},al.walkTokens=function(a,b){return ak.walkTokens(a,b)},al.parseInline=ak.parseInline,al.Parser=ai,al.parser=ai.parse,al.Renderer=ag,al.TextRenderer=ah,al.Lexer=af,al.lexer=af.lex,al.Tokenizer=ae,al.Hooks=aj,al.parse=al,al.options,al.setOptions,al.use,al.walkTokens,al.parseInline,ai.parse,af.lex,a.s(["marked",()=>al])},201716,a=>{"use strict";a.s(["NOTE_PREFIX",0,"foliate-note:","wrappedFoliateView",0,a=>{let b=a.addAnnotation.bind(a);return a.addAnnotation=(a,c=!1)=>b({value:a.cfi,...a},c),a}])},609027,a=>{"use strict";var b=a.i(887287);function c(a,c){if(!c)return!1;let d=b.collapse(c),e=b.collapse(c,!0);return b.compare(a,d)>=0&&0>=b.compare(a,e)}a.s(["isCfiInLocation",()=>c])},651828,a=>{"use strict";var b=a.i(127669),c=a.i(609027);a.s(["default",0,(a,d)=>{let e=(0,b.useRef)(null),f=(0,b.useMemo)(()=>(0,c.isCfiInLocation)(a,d?.location),[a,d]);return(0,b.useEffect)(()=>{if(!e.current||!f)return;let a=e.current,b=a.getBoundingClientRect();b.top>=0&&b.bottom<=window.innerHeight||a.scrollIntoView({behavior:"smooth",block:"center"}),a.setAttribute("aria-current","page")},[f]),{isCurrent:f,viewRef:e}}])},760196,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=b([e]);[e]=f.then?(await f)():f,a.s(["default",0,({children:a,onClick:b,disabled:c=!1,className:f,variant:g="primary",size:h="sm",type:i="button"})=>{let j={sm:"font-size-sm h-[1.3em] min-h-[1.3em]",md:"font-size-md h-[1.5em] min-h-[1.5em]",lg:"font-size-lg h-[1.8em] min-h-[1.8em]"};return(0,d.jsx)("button",{type:i,className:(0,e.default)("content settings-content btn btn-ghost hover:bg-transparent","flex items-end p-0",j[h],c?"btn-disabled !bg-opacity-0":"",f),onClick:b,disabled:c,children:(0,d.jsx)("div",{className:(0,e.default)("align-bottom",j[h].split(" ")[0],{primary:"text-blue-500 hover:text-blue-600",secondary:"text-gray-500 hover:text-gray-600",danger:"text-red-500 hover:text-red-600",success:"text-green-500 hover:text-green-600"}[g]),children:a})})}]),c()}catch(a){c(a)}},!1),307803,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=b([e]);[e]=g.then?(await g)():g;let h=(0,f.forwardRef)(({value:a,onChange:b,onBlur:c,onSave:g,onEscape:h,placeholder:i,className:j,autoFocus:k=!1,spellCheck:l=!1,disabled:m=!1,maxRows:n,minRows:o=1},p)=>{let q=(0,f.useRef)(null);(0,f.useImperativeHandle)(p,()=>({focus:()=>{q.current?.focus()},blur:()=>{q.current?.blur()},getValue:()=>q.current?.value||"",setValue:a=>{q.current&&(q.current.value=a,r())},getElement:()=>q.current})),(0,f.useEffect)(()=>{k&&q.current&&q.current.focus()},[k]),(0,f.useEffect)(()=>{q.current&&(q.current.value=a,r())},[a]);let r=()=>{if(q.current){q.current.style.height="auto";let a=q.current.scrollHeight,b=1/0;n&&(b=parseInt(getComputedStyle(q.current).lineHeight)*n);let c=(parseInt(getComputedStyle(q.current).lineHeight)||20)*o,d=Math.min(Math.max(a,c),b);q.current.style.height=`${d}px`}};return(0,d.jsx)("textarea",{ref:q,className:(0,e.default)("textarea textarea-ghost min-h-[1em] resize-none !outline-none","inset-0 w-full rounded-none border-0 bg-transparent p-0","content font-size-sm",j),dir:"auto",rows:o,spellCheck:l,disabled:m,onChange:a=>{r(),b(a.target.value)},onBlur:c,onKeyDown:a=>{if("Escape"===a.key&&h)return void h();if("Enter"===a.key&&(a.metaKey||a.ctrlKey)&&g){a.preventDefault(),g();return}},placeholder:i||""})});h.displayName="TextEditor",a.s(["default",0,h]),c()}catch(a){c(a)}},!1),10662,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(800587),g=a.i(127669),h=a.i(852835),i=a.i(178552),j=a.i(866736),k=a.i(466759),l=a.i(925426),m=a.i(862871),n=a.i(915302),o=a.i(106865),p=a.i(765918),q=a.i(201716),r=a.i(651828),s=a.i(760196),t=a.i(307803),u=b([e,j,k,l,m,s,t]);[e,j,k,l,m,s,t]=u.then?(await u)():u,a.s(["default",0,({bookKey:a,item:b,onClick:c})=>{let u=(0,n.useTranslation)(),{envConfig:v}=(0,i.useEnv)(),{settings:w}=(0,j.useSettingsStore)(),{getConfig:x,saveConfig:y,updateBooknotes:z}=(0,m.useBookDataStore)(),{getProgress:A,getView:B,getViewsById:C}=(0,k.useReaderStore)(),{setNotebookEditAnnotation:D,setNotebookVisible:E}=(0,l.useNotebookStore)(),{text:F,cfi:G,note:H}=b,I=(0,g.useRef)(null),[J,K]=(0,g.useState)(F||""),[L,M]=(0,g.useState)(!1),N=(0,o.useResponsiveSize)(3),O=A(a),{isCurrent:P,viewRef:Q}=(0,r.default)(G,O),R=b=>{b.preventDefault(),p.eventDispatcher.dispatch("navigate",{bookKey:a,cfi:G}),c?.(),B(a)?.goTo(G),H&&E(!0)},S=()=>{M(!1);let c=x(a);if(!c||!J)return;let{booknotes:d=[]}=c,e=d.findIndex(a=>b.id===a.id);if(-1===e)return;d[e].updatedAt=Date.now(),d[e].text=J;let f=z(a,d);f&&y(v,a,f,w)};return L?(0,d.jsxs)("div",{className:(0,e.default)("border-base-300 content group relative my-2 cursor-pointer rounded-lg p-2",P?"bg-base-300/85 hover:bg-base-300":"hover:bg-base-300/55 bg-base-100","transition-all duration-300 ease-in-out"),children:[(0,d.jsx)("div",{className:"flex w-full",children:(0,d.jsx)(t.default,{className:"!leading-normal",ref:I,value:J,onChange:K,onSave:S,onEscape:()=>M(!1),spellCheck:!1})}),(0,d.jsxs)("div",{className:"flex justify-end space-x-3 p-2",dir:"ltr",children:[(0,d.jsx)(s.default,{onClick:()=>M(!1),children:u("Cancel")}),(0,d.jsx)(s.default,{onClick:S,disabled:!J,children:u("Save")})]})]}):(0,d.jsxs)("li",{role:"button",ref:Q,className:(0,e.default)("booknote-item border-base-300 content group relative my-2 cursor-pointer rounded-lg p-2",P?"bg-base-300/85 hover:bg-base-300 focus:bg-base-300":"hover:bg-base-300/55 focus:bg-base-300/55 bg-base-100","transition-all duration-300 ease-in-out"),tabIndex:0,onClick:R,onKeyDown:a=>{"Enter"===a.key||" "===a.key?R(a):a.stopPropagation()},children:[(0,d.jsxs)("div",{className:(0,e.default)("min-h-4 p-0 transition-all duration-300 ease-in-out"),style:{"--top-override":"0.7rem","--end-override":"0.3rem"},children:[b.note&&(0,d.jsx)("div",{className:"content prose prose-sm font-size-sm",dir:"auto",dangerouslySetInnerHTML:{__html:h.marked.parse(b.note)}}),(0,d.jsxs)("div",{className:"flex items-start",children:[b.note&&(0,d.jsx)("div",{className:"me-2 mt-2.5 min-h-full self-stretch rounded-xl bg-gray-300",style:{minWidth:`${N}px`}}),(0,d.jsx)("div",{className:(0,e.default)("content font-size-sm line-clamp-3",b.note&&"mt-2"),children:(0,d.jsx)("span",{className:(0,e.default)("booknote-text inline leading-normal",b.note&&"content font-size-xs text-gray-500",("underline"===b.style||"squiggly"===b.style)&&"underline decoration-2","highlight"===b.style&&`bg-${b.color}-500 bg-opacity-40`,"underline"===b.style&&`decoration-${b.color}-400`,"squiggly"===b.style&&`decoration-wavy decoration-${b.color}-400`),children:F||""})})]})]}),(0,d.jsx)("div",{className:(0,e.default)("max-h-0 overflow-hidden p-0","transition-[max-height] duration-300 ease-in-out","group-hover:max-h-8 group-hover:overflow-visible","group-focus-within:max-h-8 group-focus-within:overflow-visible"),style:{"--bottom-override":0},onClick:a=>a.stopPropagation(),children:(0,d.jsxs)("div",{className:"flex cursor-default items-center justify-between",children:[(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsx)("span",{className:"text-sm text-gray-500 sm:text-xs",children:(0,f.default)(b.createdAt).fromNow()})}),(0,d.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-2",dir:"ltr",children:[(b.note||"bookmark"===b.type)&&(0,d.jsx)(s.default,{onClick:"bookmark"===b.type?()=>{K(F||""),M(!0)}:(a=>{E(!0),D(a)}).bind(null,b),variant:"primary",className:"opacity-0 transition duration-300 ease-in-out group-focus-within:opacity-100 group-hover:opacity-100",children:u("Edit")}),(0,d.jsx)(s.default,{onClick:(b=>{if(!a)return;let c=x(a);if(!c)return;let{booknotes:d=[]}=c;d.forEach(c=>{c.id===b.id&&(c.deletedAt=Date.now(),C(a.split("-")[0]).forEach(a=>a?.addAnnotation({...c,value:`${q.NOTE_PREFIX}${c.cfi}`},!0)))});let e=z(a,d);e&&y(v,a,e,w)}).bind(null,b),variant:"danger",className:"opacity-0 transition duration-300 ease-in-out group-focus-within:opacity-100 group-hover:opacity-100",children:u("Delete")})]})]})})]})}]),c()}catch(a){c(a)}},!1),862719,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(887287),f=a.i(862871),g=a.i(715715),h=a.i(123588),i=a.i(10662),j=b([f,g,i]);[f,g,i]=j.then?(await j)():j,a.s(["default",0,({type:a,bookKey:b,toc:c})=>{let{getConfig:j}=(0,f.useBookDataStore)(),{setActiveBooknoteType:k,setBooknoteResults:l}=(0,g.useSidebarStore)(),{booknotes:m=[]}=j(b),n=m.filter(b=>b.type===a&&!b.deletedAt),o={};for(let a of n){let b=(0,h.findTocItemBS)(c??[],a.cfi),d=b?.href||"",e=b?.label||"",f=b?.id||0;o[d]||(o[d]={id:f,href:d,label:e,booknotes:[]}),o[d].booknotes.push(a)}Object.values(o).forEach(a=>{a.booknotes.sort((a,b)=>e.compare(a.cfi,b.cfi))});let p=Object.values(o).sort((a,b)=>a.id-b.id),q=()=>{if(0===n.length)return;let c=[...n].sort((a,b)=>e.compare(a.cfi,b.cfi));k(b,a),l(b,c)};return(0,d.jsx)("div",{className:"rounded pt-2",children:(0,d.jsx)("ul",{role:"tree",className:"px-2",children:p.map(a=>(0,d.jsxs)("li",{className:"p-2",children:[(0,d.jsx)("h3",{className:"content font-size-base line-clamp-1 font-normal",children:a.label}),(0,d.jsx)("ul",{children:a.booknotes.map((a,c)=>(0,d.jsx)(i.default,{bookKey:b,item:a,onClick:q},`${c}-${a.cfi}`))})]},a.href))})})}]),c()}catch(a){c(a)}},!1),950678,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M441.1 131.1l-44.9 45.1c-.9.9-2.3 1.3-3.5 1.1l-46.4-8.4c-1.6-.3-2.9-1.6-3.2-3.2l-8.3-46.4c-.2-1.3.2-2.6 1.1-3.5l44.8-45c3.5-3.5 3-9.3-1-12.1-10.1-7.2-22.1-10.7-31.8-10.7-.7 0-1.4 0-2 .1-12.5.7-39.3 7.7-60 29.7-20.1 21.2-41.1 60.6-22.5 104.5 2.2 5.3 4.7 12.3-2.7 19.7C253.1 209.4 61 390.3 61 390.3c-18 15.5-16.7 44.2-.1 60.9 8.5 8.4 20 12.8 31.3 12.8 11.1 0 21.9-4.2 29.6-13.1 0 0 179.4-191.1 188.2-199.8 4-3.9 7.7-5.1 11.1-5.1 3.3 0 6.3 1.2 8.6 2.4 9.9 5.1 21 7.4 32.4 7.4 26.8 0 55-12.4 72.2-29.6 24.4-24.4 28.9-48 29.6-60.1.6-9.9-2.2-22.6-10.7-34.2-2.9-3.8-8.6-4.2-12.1-.8zM102.5 429.3c-5.5 5.4-14.4 5.4-19.9 0-5.4-5.5-5.4-14.4 0-19.9 5.5-5.4 14.4-5.4 19.9 0 5.4 5.6 5.4 14.5 0 19.9z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"92",cy:"256",r:"28"},child:[]},{tag:"circle",attr:{cx:"92",cy:"132",r:"28"},child:[]},{tag:"circle",attr:{cx:"92",cy:"380",r:"28"},child:[]},{tag:"path",attr:{d:"M432 240H191.5c-8.8 0-16 7.2-16 16s7.2 16 16 16H432c8.8 0 16-7.2 16-16s-7.2-16-16-16zM432 364H191.5c-8.8 0-16 7.2-16 16s7.2 16 16 16H432c8.8 0 16-7.2 16-16s-7.2-16-16-16zM191.5 148H432c8.8 0 16-7.2 16-16s-7.2-16-16-16H191.5c-8.8 0-16 7.2-16 16s7.2 16 16 16z"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 90c44.3 0 86 17.3 117.4 48.6C404.7 170 422 211.7 422 256s-17.3 86-48.6 117.4C342 404.7 300.3 422 256 422s-86-17.3-117.4-48.6C107.3 342 90 300.3 90 256s17.3-86 48.6-117.4C170 107.3 211.7 90 256 90m0-42C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"},child:[]},{tag:"path",attr:{d:"M360 330.9L330.9 360 256 285.1 181.1 360 152 330.9l74.9-74.9-74.9-74.9 29.1-29.1 74.9 74.9 74.9-74.9 29.1 29.1-74.9 74.9z"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z"},child:[]}]})(a)}function g(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M396.795 396.8H320V448h128V320h-51.205zM396.8 115.205V192H448V64H320v51.205zM115.205 115.2H192V64H64v128h51.205zM115.2 396.795V320H64v128h128v-51.205z"},child:[]}]})(a)}a.s(["IoIosBuild",()=>c,"IoIosList",()=>d,"IoMdCloseCircle",()=>f,"IoMdCloseCircleOutline",()=>e,"IoMdExpand",()=>g])},394317,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M112,60a16,16,0,1,1,16,16A16,16,0,0,1,112,60Zm16,52a16,16,0,1,0,16,16A16,16,0,0,0,128,112Zm0,68a16,16,0,1,0,16,16A16,16,0,0,0,128,180Z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M253.66,106.34a8,8,0,0,0-11.32,0L192,156.69,107.31,72l50.35-50.34a8,8,0,1,0-11.32-11.32L96,60.69A16,16,0,0,0,93.18,79.5L72,100.69a16,16,0,0,0,0,22.62L76.69,128,18.34,186.34a8,8,0,0,0,3.13,13.25l72,24A7.88,7.88,0,0,0,96,224a8,8,0,0,0,5.66-2.34L136,187.31l4.69,4.69a16,16,0,0,0,22.62,0l21.18-21.18A16,16,0,0,0,203.31,168l50.35-50.34A8,8,0,0,0,253.66,106.34ZM152,180.69,83.31,112,104,91.31,172.69,160Z"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M233.54,142.23a8,8,0,0,0-8-2,88.08,88.08,0,0,1-109.8-109.8,8,8,0,0,0-10-10,104.84,104.84,0,0,0-52.91,37A104,104,0,0,0,136,224a103.09,103.09,0,0,0,62.52-20.88,104.84,104.84,0,0,0,37-52.91A8,8,0,0,0,233.54,142.23ZM188.9,190.34A88,88,0,0,1,65.66,67.11a89,89,0,0,1,31.4-26A106,106,0,0,0,96,56,104.11,104.11,0,0,0,200,160a106,106,0,0,0,14.92-1.06A89,89,0,0,1,188.9,190.34Z"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M229.66,58.34l-32-32a8,8,0,0,0-11.32,0l-96,96A8,8,0,0,0,88,128v32a8,8,0,0,0,8,8h32a8,8,0,0,0,5.66-2.34l96-96A8,8,0,0,0,229.66,58.34ZM124.69,152H104V131.31l64-64L188.69,88ZM200,76.69,179.31,56,192,43.31,212.69,64ZM224,128v80a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V48A16,16,0,0,1,48,32h80a8,8,0,0,1,0,16H48V208H208V128a8,8,0,0,1,16,0Z"},child:[]}]})(a)}function g(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"},child:[]}]})(a)}function h(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M120,40V16a8,8,0,0,1,16,0V40a8,8,0,0,1-16,0Zm72,88a64,64,0,1,1-64-64A64.07,64.07,0,0,1,192,128Zm-16,0a48,48,0,1,0-48,48A48.05,48.05,0,0,0,176,128ZM58.34,69.66A8,8,0,0,0,69.66,58.34l-16-16A8,8,0,0,0,42.34,53.66Zm0,116.68-16,16a8,8,0,0,0,11.32,11.32l16-16a8,8,0,0,0-11.32-11.32ZM192,72a8,8,0,0,0,5.66-2.34l16-16a8,8,0,0,0-11.32-11.32l-16,16A8,8,0,0,0,192,72Zm5.66,114.34a8,8,0,0,0-11.32,11.32l16,16a8,8,0,0,0,11.32-11.32ZM48,128a8,8,0,0,0-8-8H16a8,8,0,0,0,0,16H40A8,8,0,0,0,48,128Zm80,80a8,8,0,0,0-8,8v24a8,8,0,0,0,16,0V216A8,8,0,0,0,128,208Zm112-88H216a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16Z"},child:[]}]})(a)}a.s(["PiDotsThreeVerticalBold",()=>c,"PiHighlighterFill",()=>d,"PiMoon",()=>e,"PiNotePencil",()=>f,"PiPlus",()=>g,"PiSun",()=>h])},901797,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(547274),g=a.i(950678),h=a.i(394317),i=a.i(178552),j=a.i(915302),k=b([e]);[e]=k.then?(await k)():k,a.s(["default",0,({activeTab:a,onTabChange:b})=>{let c=(0,j.useTranslation)(),{appService:k}=(0,i.useEnv)();return(0,d.jsxs)("div",{className:(0,e.default)("bottom-tab border-base-300/50 bg-base-200/20 relative flex w-full border-t",k?.hasRoundedWindow&&"rounded-window-bottom-left"),dir:"ltr",children:[(0,d.jsx)("div",{className:(0,e.default)("bg-base-300/85 absolute bottom-1.5 start-1 z-10 h-[calc(100%-12px)] w-[calc(33.3%-8px)] rounded-lg","transform transition-transform duration-300","toc"===a&&"translate-x-0","annotations"===a&&"translate-x-[calc(100%+8px)]","bookmarks"===a&&"translate-x-[calc(200%+16px)]")}),["toc","annotations","bookmarks"].map(a=>(0,d.jsx)("div",{tabIndex:0,role:"button",className:"z-[11] m-1.5 flex-1 cursor-pointer rounded-md p-2",onClick:()=>b(a),onKeyDown:c=>{("Enter"===c.key||" "===c.key)&&(c.preventDefault(),b(a))},title:"toc"===a?c("TOC"):"annotations"===a?c("Annotate"):c("Bookmark"),"aria-label":"toc"===a?c("TOC"):"annotations"===a?c("Annotate"):c("Bookmark"),children:(0,d.jsx)("div",{className:(0,e.default)("m-0 flex h-6 items-center p-0"),children:"toc"===a?(0,d.jsx)(g.IoIosList,{className:"mx-auto"}):"annotations"===a?(0,d.jsx)(h.PiNotePencil,{className:"mx-auto"}):(0,d.jsx)(f.MdBookmarkBorder,{className:"mx-auto"})})},a))]})}]),c()}catch(a){c(a)}},!1),429652,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(162650),h=a.i(466759),i=a.i(715715),j=a.i(862871),k=a.i(191585),l=a.i(744793),m=a.i(862719),n=a.i(901797),o=b([e,g,h,i,j,k,l,m,n]);[e,g,h,i,j,k,l,m,n]=o.then?(await o)():o,a.s(["default",0,({bookDoc:a,sideBarBookKey:b})=>{let{safeAreaInsets:c}=(0,g.useThemeStore)(),{setHoveredBookKey:o}=(0,h.useReaderStore)(),{setSideBarVisible:p}=(0,i.useSidebarStore)(),{getConfig:q,setConfig:r}=(0,j.useBookDataStore)(),s=q(b),[t,u]=(0,f.useState)(s?.viewSettings?.sideBarTab||"toc"),[v,w]=(0,f.useState)(!1),[x,y]=(0,f.useState)(t),z=window.innerWidth<640||window.innerHeight<640;return(0,f.useEffect)(()=>{if(!b)return;let a=q(b);u(a.viewSettings.sideBarTab)},[b]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:(0,e.default)("sidebar-content flex h-full min-h-0 flex-grow flex-col shadow-inner","font-sans text-base font-normal sm:text-sm"),children:(0,d.jsx)(k.OverlayScrollbarsComponent,{className:"min-h-0 flex-1",options:{scrollbars:{autoHide:"scroll",clickScroll:!0},showNativeOverlaidScrollbars:!1},defer:!0,children:(0,d.jsxs)("div",{className:(0,e.default)("scroll-container h-full transition-opacity duration-300 ease-in-out",{"opacity-0":v,"opacity-100":!v}),children:["toc"===x&&a.toc&&(0,d.jsx)(l.default,{toc:a.toc,sections:a.sections,bookKey:b}),"annotations"===x&&(0,d.jsx)(m.default,{type:"annotation",toc:a.toc??[],bookKey:b}),"bookmarks"===x&&(0,d.jsx)(m.default,{type:"bookmark",toc:a.toc??[],bookKey:b})]})})}),(0,d.jsx)("div",{className:"flex-shrink-0",style:{paddingBottom:`${(c?.bottom||0)/2}px`},children:(0,d.jsx)(n.default,{activeTab:t,onTabChange:a=>{w(!0);let c=setTimeout(()=>{if(t===a&&z){o(b),p(!1);return}y(a),w(!1),r(b,d),clearTimeout(c)},300);u(a);let d=q(b);d.viewSettings.sideBarTab=a}})})]})}]),c()}catch(a){c(a)}},!1),887750,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(547274),h=a.i(162650),i=a.i(915302),j=a.i(765918),k=a.i(106865),l=a.i(936114),m=a.i(340980),n=b([e,h,l,m]);[e,h,l,m]=n.then?(await n)():n,a.s(["default",0,({book:a})=>{let{title:b,author:c}=a,n=(0,i.useTranslation)(),{isDarkMode:o}=(0,h.useThemeStore)(),p=(0,k.useResponsiveSize)(18),q=(0,f.useRef)(null);return(0,d.jsxs)("div",{className:"flex h-20 w-full items-center",children:[(0,d.jsx)("div",{ref:q,className:(0,e.default)("me-4 aspect-[28/41] max-h-16 w-[15%] max-w-12 overflow-hidden rounded-sm shadow-md",o?"mix-blend-screen":"mix-blend-multiply"),children:(0,d.jsx)(m.default,{book:a,mode:"list",coverFit:"crop",imageClassName:"rounded-sm",onImageError:()=>q.current.style.display="none"})}),(0,d.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,d.jsx)("h4",{className:"line-clamp-2 w-[90%] text-sm font-semibold",children:(0,l.formatTitle)(b).replace(/\u00A0/g," ")}),(0,d.jsx)("p",{className:"truncate text-xs opacity-75",children:(0,l.formatAuthors)(c)})]}),(0,d.jsx)("button",{className:"btn btn-ghost hover:bg-base-300 h-6 min-h-6 w-6 rounded-full p-0 transition-colors","aria-label":n("More Info"),onClick:()=>{j.eventDispatcher.dispatchSync("show-book-details",a)},children:(0,d.jsx)(g.MdInfoOutline,{size:p,className:"fill-base-content"})})]})}]),c()}catch(a){c(a)}},!1),603150,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(866736),g=a.i(715715),h=a.i(937944),i=b([f,g,h]);[f,g,h]=i.then?(await i)():i,a.s(["default",0,(a,b)=>{let{envConfig:c}=(0,e.useEnv)(),{settings:i}=(0,f.useSettingsStore)(),{sideBarWidth:j,isSideBarVisible:k,isSideBarPinned:l,getSideBarWidth:m,setSideBarWidth:n,setSideBarVisible:o,setSideBarPin:p,toggleSideBar:q,toggleSideBarPin:r}=(0,g.useSidebarStore)();return(0,d.useEffect)(()=>{n(a),p(b),o(b)},[]),{sideBarWidth:j,isSideBarPinned:l,isSideBarVisible:k,getSideBarWidth:m,handleSideBarResize:a=>{n(a),i.globalReadSettings.sideBarWidth=a},handleSideBarTogglePin:()=>{r(),l&&k&&o(!1);let a={...i.globalReadSettings,isSideBarPinned:!l};(0,h.saveSysSettings)(c,"globalReadSettings",a)},setSideBarVisible:o,toggleSideBar:q}}]),c()}catch(a){c(a)}},!1),52105,a=>{"use strict";a.s(["createRejectFilter",0,({tags:a=[],classes:b=[],attributes:c=[],contents:d=[]})=>e=>{if(e.nodeType===Node.ELEMENT_NODE){let f=e.tagName.toLowerCase();return"script"===f||"style"===f||a.includes(f)||b.some(a=>e.classList.contains(a))||c.some(a=>e.hasAttribute(a))||d.some(({tag:a,content:b})=>f===a&&b.test(e.textContent||""))?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP}return NodeFilter.FILTER_ACCEPT}])},466196,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(547274),g=a.i(915302),h=a.i(106865),i=b([e]);[e]=i.then?(await i)():i;let j=({label:a,isActive:b,onClick:c})=>(0,d.jsx)("button",{className:"hover:bg-base-300 flex w-full items-center justify-between rounded-md p-2",onClick:c,children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("span",{style:{minWidth:`${(0,h.useDefaultIconSize)()}px`},children:b&&(0,d.jsx)(f.MdCheck,{className:"text-base-content"})}),(0,d.jsx)("span",{className:"ml-2",children:a})]})});a.s(["default",0,({isEink:a,searchConfig:b,menuClassName:c,onSearchConfigChanged:f,setIsDropdownOpen:h})=>{let i=(0,g.useTranslation)(),k=(a,c)=>{f({...b,[a]:c}),h?.(!1)};return(0,d.jsxs)("div",{className:(0,e.default)("search-options dropdown-content dropdown-center border-base-200 z-20 w-56 border shadow-2xl",a?"bordercolor-content border-base-content !bg-base-100 border":"",c),children:[(0,d.jsx)(j,{label:i("Book"),isActive:"book"===b.scope,onClick:()=>k("scope","book")}),(0,d.jsx)(j,{label:i("Chapter"),isActive:"section"===b.scope,onClick:()=>k("scope","section")}),(0,d.jsx)("hr",{className:"border-base-200 my-1"}),(0,d.jsx)(j,{label:i("Match Case"),isActive:b.matchCase,onClick:()=>k("matchCase",!b.matchCase)}),(0,d.jsx)(j,{label:i("Match Whole Words"),isActive:b.matchWholeWords,onClick:()=>k("matchWholeWords",!b.matchWholeWords)}),(0,d.jsx)(j,{label:i("Match Diacritics"),isActive:b.matchDiacritics,onClick:()=>k("matchDiacritics",!b.matchDiacritics)})]})}]),c()}catch(a){c(a)}},!1),116267,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(929058),h=a.i(950678),i=a.i(547274),j=a.i(399577),k=a.i(178552),l=a.i(866736),m=a.i(862871),n=a.i(466759),o=a.i(715715),p=a.i(915302),q=a.i(106865),r=a.i(951790),s=a.i(890392),t=a.i(52105),u=a.i(320776),v=a.i(466196),w=b([e,l,m,n,o,s,u,v]);[e,l,m,n,o,s,u,v]=w.then?(await w)():w;let x="search";a.s(["default",0,({isVisible:a,bookKey:b,onHideSearchBar:c})=>{let w=(0,p.useTranslation)(),{envConfig:y,appService:z}=(0,k.useEnv)(),{settings:A}=(0,l.useSettingsStore)(),{getBookData:B}=(0,m.useBookDataStore)(),{getConfig:C,setConfig:D,saveConfig:E}=(0,m.useBookDataStore)(),{getView:F,getProgress:G,getViewSettings:H}=(0,n.useReaderStore)(),{setSearchTerm:I,setSearchResults:J,setSearchProgress:K}=(0,o.useSidebarStore)(),{getSearchNavState:L,getSearchStatus:M,setSearchStatus:N}=(0,o.useSidebarStore)(),O=H(b),{searchTerm:P}=L(b),Q=(0,f.useRef)(""),R=(0,f.useRef)(null),S=(0,f.useRef)(!1),T=(0,f.useMemo)(()=>b.split("-")[0],[b]),U=(0,f.useMemo)(()=>`search-history-${T}`,[T]),[V,W]=(0,f.useState)(()=>[]);(0,f.useEffect)(()=>{let a=localStorage.getItem(U);W(a?JSON.parse(a):[])},[U]);let X=(0,f.useCallback)(a=>{let b=V.filter(b=>b!==a),c=[a,...b].slice(0,10);localStorage.setItem(U,JSON.stringify(c)),W(c)},[U,V]),Y=async()=>{W([]),localStorage.removeItem(U),await aa()},Z=(0,f.useCallback)((a,b)=>{let c=JSON.stringify({scope:b.scope,matchCase:b.matchCase,matchWholeWords:b.matchWholeWords,matchDiacritics:b.matchDiacritics});return(0,j.md5)(`${a}-${c}`)},[]),$=(0,f.useCallback)(async(a,b)=>{let c=Z(a,b),d=`${x}/${T}/${c}.json`;try{if(await z?.exists(d,"Cache")){let a=await z?.readFile(d,"Cache","text");if(a)return JSON.parse(a)}}catch(a){console.error("Failed to read search cache:",a)}return null},[T,z,Z]),_=(0,f.useCallback)(async(a,b,c)=>{let d=Z(a,b),e=`${x}/${T}`,f=`${e}/${d}.json`;try{await z?.exists(e,"Cache")||await z?.createDir(e,"Cache",!0),await z?.writeFile(f,"Cache",JSON.stringify(c))}catch(a){console.error("Failed to save search cache:",a)}},[T,z,Z]),aa=(0,f.useCallback)(async()=>{let a=`${x}/${T}`;try{await z?.exists(a,"Cache")&&await z?.deleteDir(a,"Cache",!0)}catch(a){console.error("Failed to clear search cache:",a)}},[T,z]),ab=F(b),ac=C(b),ad=B(b),ae=G(b),af=ad.book?.primaryLanguage||"en",ag=(0,q.useResponsiveSize)(12),ah=(0,q.useResponsiveSize)(16);(0,f.useEffect)(()=>{ak(P)},[b,P]),(0,f.useEffect)(()=>{a&&R.current&&(R.current.onblur=()=>{S.current=!1},R.current.onfocus=()=>{S.current=!0},z?.isMobile||R.current.focus()),a&&P&&ak(P)},[z,a]),(0,f.useEffect)(()=>{let a=a=>{"Escape"===a.key&&(R.current&&S.current?R.current.blur():c())};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[c]);let ai=(0,f.useCallback)(async a=>{console.log("searching for:",a);let c=ac.searchConfig,d=await $(a,c);d&&(J(b,d),K(b,1),d.length>0&&X(a)),K(b,0),N(b,"searching");let{section:e}=ae,f="section"===c.scope?e.current:void 0,g=await ab.search({...c,index:f,query:a,acceptNode:(0,t.createRejectFilter)({tags:af.startsWith("ja")?["rt"]:[]}),results:d}),h=[],i=0;(async()=>{for await(let d of g){if("terminated"===M(b))return void console.log("search terminated");if("string"==typeof d)"done"===d&&(N(b,"completed"),J(b,[...h]),K(b,1),h.length>0&&(X(a),await _(a,c,h)),console.log("search done"));else if(d.progress){K(b,d.progress);let c=Date.now();if(c-i>=1e3&&(console.log("search progress:",d.progress),i=c),Q.current!==a){console.log("search term changed, resetting search"),aj();return}}else h.push(d),J(b,[...h]);await new Promise(a=>setTimeout(a,0))}})()},[ae,ac.searchConfig,J,K,X,$,_]),aj=(0,f.useCallback)(()=>{J(b,[]),ab?.clearSearch()},[b,ab,J]),ak=(0,f.useCallback)((0,r.debounce)(a=>{let b;Q.current=a,(b=(0,s.isCJKStr)(a)?1:2,a.length>=b)?ai(a):aj()},500),[ai,aj]);return(0,d.jsxs)("div",{className:"relative flex flex-col gap-3 p-2",children:[(0,d.jsxs)("div",{className:"bg-base-100 flex h-8 items-center rounded-lg",children:[(0,d.jsx)("div",{className:"absolute ps-3",children:(0,d.jsx)(g.FaSearch,{size:ah,className:"text-base-content/50"})}),(0,d.jsx)("input",{ref:R,type:"text",value:P,spellCheck:!1,onChange:a=>{let c=a.target.value;I(b,c),ak(c)},placeholder:w("Search..."),className:"search-input w-full bg-transparent p-2 pr-0 ps-10 font-sans text-sm font-light focus:outline-none"}),P&&(0,d.jsx)("button",{onClick:()=>{I(b,""),aj(),R.current?.focus()},className:"absolute end-8 flex h-8 w-8 items-center justify-center bg-transparent","aria-label":w("Clear search"),children:(0,d.jsx)(h.IoMdCloseCircle,{size:ah,className:"text-base-content/75"})}),(0,d.jsx)("div",{className:(0,e.default)("absolute end-2 flex h-8 w-8 items-center rounded-r-lg",O?.isEink?"bg-transparent":"bg-base-300"),children:(0,d.jsx)(u.default,{label:w("Search Options"),className:(0,e.default)(window.innerWidth<640&&"dropdown-end","dropdown-bottom flex justify-center"),menuClassName:window.innerWidth<640?"no-triangle mt-1":"dropdown-center mt-3.5",buttonClassName:(0,e.default)("btn btn-ghost h-8 min-h-8 w-8 p-0 rounded-none rounded-r-lg",O?.isEink?"!bg-transparent hover:!bg-transparent":""),toggleButton:(0,d.jsx)(g.FaChevronDown,{size:ag,className:"text-base-content/50"}),children:(0,d.jsx)(v.default,{isEink:!!O?.isEink,searchConfig:ac.searchConfig,onSearchConfigChanged:a=>{D(b,{searchConfig:{...a}}),E(y,b,ac,A),ak(P)}})})})]}),V.length>0&&!P&&(0,d.jsxs)("div",{className:"relative flex",children:[(0,d.jsx)("div",{className:(0,e.default)("from-base-200 pointer-events-none absolute left-0 top-0 h-full w-3 bg-gradient-to-r to-transparent",O?.isEink?"hidden":""),"aria-hidden":"true"}),(0,d.jsx)("div",{className:"scrollbar-hidden flex flex-1 gap-1.5 overflow-x-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:V.map((a,c)=>(0,d.jsx)("button",{onClick:()=>{I(b,a),ak(a)},className:"hover:bg-base-200/20 text-base-content/70 bg-base-100 max-w-[60%] flex-shrink-0 whitespace-nowrap rounded-full px-3 py-0.5 text-xs",children:(0,d.jsx)("p",{className:"truncate",children:a})},c))}),(0,d.jsx)("div",{className:(0,e.default)("from-base-200 pointer-events-none absolute right-6 top-0 h-full w-6 bg-gradient-to-l to-transparent",O?.isEink?"hidden":""),"aria-hidden":"true"}),(0,d.jsx)("button",{onClick:Y,className:(0,e.default)("text-base-content/50 hover:text-base-content/80 flex-shrink-0 items-center","flex h-6 min-h-6 w-8 min-w-8 items-center justify-center p-0"),title:w("Clear search history"),"aria-label":w("Clear search history"),children:(0,d.jsx)(i.MdDeleteOutline,{size:ah})})]})]})}]),c()}catch(a){c(a)}},!1),939634,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(466759),f=a.i(651828),g=a.i(76868),h=b([e,g]);[e,g]=h.then?(await h)():h;let i=({bookKey:a,cfi:b,excerpt:c,onSelectResult:h})=>{let{getProgress:i}=(0,e.useReaderStore)(),j=i(a),{isCurrent:k,viewRef:l}=(0,f.default)(b,j);return(0,d.jsx)("li",{role:"button",ref:l,className:(0,g.default)("my-2 cursor-pointer rounded-lg p-2 text-sm",k?"bg-base-300 hover:bg-gray-300/70":"hover:bg-base-300 bg-base-100"),tabIndex:0,onClick:()=>h(b),onKeyDown:a=>{"Enter"===a.key||" "===a.key?h(b):a.stopPropagation()},children:(0,d.jsxs)("div",{className:"line-clamp-3",children:[(0,d.jsx)("span",{className:"",children:c.pre}),(0,d.jsx)("span",{className:"font-bold text-red-500",children:c.match}),(0,d.jsx)("span",{className:"",children:c.post})]})})};a.s(["default",0,({bookKey:a,results:b,onSelectResult:c})=>(0,d.jsx)("div",{className:"search-results overflow-y-auto p-2 font-sans text-sm font-light",children:(0,d.jsx)("ul",{className:"px-2",children:b.map((b,e)=>"subitems"in b?(0,d.jsxs)("ul",{children:[(0,d.jsx)("h3",{className:"line-clamp-1 font-normal",children:b.label}),(0,d.jsx)("ul",{children:b.subitems.map((b,e)=>(0,d.jsx)(i,{bookKey:a,cfi:b.cfi,excerpt:b.excerpt,onSelectResult:c},`${e}-${b.cfi}`))})]},`${e}-${b.label}`):(0,d.jsx)(i,{bookKey:a,cfi:b.cfi,excerpt:b.excerpt,onSelectResult:c},`${e}-${b.cfi}`))})})]),c()}catch(a){c(a)}},!1),189747,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(402093),f=a.i(76868),g=a.i(127669),h=a.i(556266),i=a.i(866736),j=a.i(862871),k=a.i(466759),l=a.i(715715),m=a.i(915302),n=a.i(765918),o=a.i(936114),p=a.i(178552),q=a.i(847656),r=a.i(162650),s=a.i(240009),t=a.i(551524),u=a.i(936449),v=a.i(429652),w=a.i(887750),x=a.i(603150),y=a.i(116267),z=a.i(939634),A=b([f,i,j,k,l,o,r,s,u,v,w,x,y,z]);[f,i,j,k,l,o,r,s,u,v,w,x,y,z]=A.then?(await A)():A,a.s(["default",0,({onGoToLibrary:a})=>{let b=(0,m.useTranslation)(),{appService:c}=(0,p.useEnv)(),{updateAppTheme:A,safeAreaInsets:B}=(0,r.useThemeStore)(),{settings:C}=(0,i.useSettingsStore)(),{sideBarBookKey:D,setSideBarBookKey:E,getSearchNavState:F,setSearchTerm:G,clearSearch:H}=(0,l.useSidebarStore)(),{searchTerm:I="",searchResults:J=null}=(D?F(D):null)||{},{getBookData:K}=(0,j.useBookDataStore)(),{getView:L,getViewSettings:M}=(0,k.useReaderStore)(),[N,O]=(0,g.useState)(!1),P=(0,g.useRef)(I),Q=(0,g.useRef)(1),R=window.innerWidth<640,{sideBarWidth:S,isSideBarPinned:T,isSideBarVisible:U,getSideBarWidth:V,setSideBarVisible:W,handleSideBarResize:X,handleSideBarTogglePin:Y}=(0,x.default)(C.globalReadSettings.sideBarWidth,!R&&C.globalReadSettings.isSideBarPinned),Z=async a=>{let{term:b,bookKey:c}=a.detail;W(!0),E(c),O(!0),null!=b&&G(c,b)},$=async()=>{let a=document.querySelector(".sidebar-pin-btn");a&&"none"!==window.getComputedStyle(a).display||W(!1)};(0,g.useEffect)(()=>{U?A("base-200"):A("base-100")},[U]),(0,g.useEffect)(()=>{P.current=I},[I]),(0,g.useEffect)(()=>(n.eventDispatcher.on("search-term",Z),n.eventDispatcher.on("navigate",$),()=>{n.eventDispatcher.off("search-term",Z),n.eventDispatcher.off("navigate",$)}),[]);let{handleDragStart:_}=(0,q.useDrag)(a=>{if(!R)return;let b=a.clientY/window.innerHeight,c=Math.max(0,Math.min(1,b));Q.current=c;let d=document.querySelector(".sidebar-container"),e=document.querySelector(".overlay");d&&e&&(d.style.top=`${100*c}%`,e.style.opacity=`${1-b}`)},()=>{},a=>{let b=document.querySelector(".sidebar-container"),d=document.querySelector(".overlay");if(b&&d)if(a.velocity>.5||a.velocity>=0&&a.clientY>=.5*window.innerHeight){let e=.15/Math.max(a.velocity,.5);b.style.transition=`top ${e}s ease-out`,b.style.top="100%",d.style.transition=`opacity ${e}s ease-out`,d.style.opacity="0",setTimeout(()=>W(!1),300),c?.hasHaptics&&(0,h.impactFeedback)("medium")}else b.style.transition="top 0.3s ease-out",b.style.top="0%",d.style.transition="opacity 0.3s ease-out",d.style.opacity="0.8",c?.hasHaptics&&(0,h.impactFeedback)("medium")}),{handleDragStart:aa,handleDragKeyDown:ab}=(0,q.useDrag)(a=>{let b=a.clientX/window.innerWidth,c=Math.max(.05,Math.min(.45,b));X(`${Math.round(1e4*c)/100}%`)},a=>{let b=parseFloat(V())/100,c=b;"ArrowLeft"===a.key?c=Math.max(.05,b-a.step):"ArrowRight"===a.key&&(c=Math.min(.45,b+a.step)),X(`${Math.round(1e4*c)/100}%`)}),ac=(0,g.useCallback)(()=>{setTimeout(()=>{W(!0),O(!0)},100)},[]),ad=(0,g.useCallback)(()=>{O(!1),setTimeout(()=>{D&&H(D)},100),L(D)?.clearSearch()},[D,H]),ae=(0,g.useCallback)(()=>{P.current?ad():T||W(!1)},[D,T]);if((0,t.default)({onShowSearchBar:ac,onEscape:ae},[ae]),!D)return null;let af=M(D),ag=K(D);if(!ag||!ag.book||!ag.bookDoc)return null;let{book:ah,bookDoc:ai}=ag,aj=(0,o.getBookDirFromLanguage)(ai.metadata.language);return U?(0,d.jsxs)(d.Fragment,{children:[!T&&(0,d.jsx)(s.Overlay,{className:(0,f.default)("z-[45]",af?.isEink?"":"bg-black/50 sm:bg-black/20"),onDismiss:()=>{W(!1)}}),(0,d.jsxs)("div",{role:"group","aria-label":b("Sidebar"),dir:af?.rtl&&"rtl"===aj?"rtl":"ltr",style:{width:`${S}`,maxWidth:"45%",position:T?"relative":"absolute",paddingTop:`${B?.top||0}px`},className:"jsx-fbb074d65c8317d1 "+((0,f.default)("sidebar-container flex min-w-60 select-none flex-col","full-height transition-[padding-top] duration-300",af?.isEink?"bg-base-100":"bg-base-200",c?.hasRoundedWindow&&"rounded-window-top-left rounded-window-bottom-left",T?"z-20":"z-[45] shadow-2xl",!T&&af?.isEink&&"border-base-content border-e")||""),children:[(0,d.jsx)(e.default,{id:"fbb074d65c8317d1",children:"@media (width<=640px){.sidebar-container.jsx-fbb074d65c8317d1{border-top-left-radius:16px;border-top-right-radius:16px;width:100%;min-width:100%}.sidebar-container.open.jsx-fbb074d65c8317d1{top:0%}.overlay.jsx-fbb074d65c8317d1{transition:opacity .3s ease-in-out}}"}),(0,d.jsx)("div",{role:"slider",tabIndex:0,"aria-label":b("Resize Sidebar"),"aria-orientation":"horizontal","aria-valuenow":parseFloat(S),onMouseDown:aa,onTouchStart:aa,onKeyDown:ab,className:"jsx-fbb074d65c8317d1 "+((0,f.default)("drag-bar absolute -right-2 top-0 h-full w-0.5 cursor-col-resize bg-transparent p-1",R&&"hidden")||"")}),(0,d.jsxs)("div",{className:"jsx-fbb074d65c8317d1 flex-shrink-0",children:[R&&(0,d.jsx)("div",{role:"slider",tabIndex:0,"aria-label":b("Resize Sidebar"),"aria-orientation":"vertical","aria-valuenow":Q.current,onMouseDown:_,onTouchStart:_,className:"jsx-fbb074d65c8317d1 drag-handle flex h-10 w-full cursor-row-resize items-center justify-center",children:(0,d.jsx)("div",{className:"jsx-fbb074d65c8317d1 bg-base-content/50 h-1 w-10 rounded-full"})}),(0,d.jsx)(u.default,{isPinned:T,isSearchBarVisible:N,onGoToLibrary:a,onClose:()=>W(!1),onTogglePin:Y,onToggleSearchBar:()=>{O(a=>(a&&ad(),!a))}}),(0,d.jsx)("div",{className:"jsx-fbb074d65c8317d1 "+((0,f.default)("search-bar",{"search-bar-visible":N})||""),children:(0,d.jsx)(y.default,{isVisible:N,bookKey:D,onHideSearchBar:ad})}),(0,d.jsx)("div",{className:"jsx-fbb074d65c8317d1 border-base-300/50 border-b px-3",children:(0,d.jsx)(w.default,{book:ah})})]}),N&&J?(0,d.jsx)(z.default,{bookKey:D,results:J,onSelectResult:a=>{$(),L(D)?.goTo(a)}}):(0,d.jsx)(v.default,{bookDoc:ai,sideBarBookKey:D})]})]}):null}]),c()}catch(a){c(a)}},!1),91440,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4"},child:[]},{tag:"path",attr:{d:"M2 6h4"},child:[]},{tag:"path",attr:{d:"M2 10h4"},child:[]},{tag:"path",attr:{d:"M2 14h4"},child:[]},{tag:"path",attr:{d:"M2 18h4"},child:[]},{tag:"path",attr:{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"},child:[]}]})(a)}a.s(["LuNotebookPen",()=>c])},40010,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(687134),g=a.i(91440),h=a.i(547274),i=a.i(915302),j=a.i(106865),k=b([e]);[e]=k.then?(await k)():k,a.s(["default",0,({isPinned:a,isSearchBarVisible:b,handleClose:c,handleTogglePin:k,handleToggleSearchBar:l})=>{let m=(0,i.useTranslation)(),n=(0,j.useResponsiveSize)(14),o=(0,j.useResponsiveSize)(18);return(0,d.jsxs)("div",{className:"notebook-header relative flex h-11 items-center px-3",dir:"ltr",children:[(0,d.jsxs)("div",{className:"absolute inset-0 z-[-1] flex items-center justify-center space-x-2",children:[(0,d.jsx)(g.LuNotebookPen,{size:o}),(0,d.jsx)("div",{className:"notebook-title hidden text-sm font-medium sm:flex",children:m("Notebook")})]}),(0,d.jsxs)("div",{className:"flex w-full items-center gap-x-4",children:[(0,d.jsx)("button",{title:m(a?"Unpin Notebook":"Pin Notebook"),onClick:k,className:(0,e.default)("btn btn-ghost btn-circle hidden h-6 min-h-6 w-6 sm:flex",a?"bg-base-300":"bg-base-300/65"),children:a?(0,d.jsx)(h.MdPushPin,{size:n}):(0,d.jsx)(h.MdOutlinePushPin,{size:n})}),(0,d.jsx)("button",{title:m("Close"),onClick:c,className:"btn btn-ghost btn-circle flex h-6 min-h-6 w-6 hover:bg-transparent sm:hidden",children:(0,d.jsx)(h.MdArrowBackIosNew,{})})]}),(0,d.jsx)("div",{className:"flex items-center justify-end gap-x-4",children:(0,d.jsx)("button",{title:m(b?"Hide Search Bar":"Show Search Bar"),onClick:l,className:(0,e.default)("btn btn-ghost h-8 min-h-8 w-8 p-0",b&&"bg-base-300"),children:(0,d.jsx)(f.FiSearch,{size:o})})})]})}]),c()}catch(a){c(a)}},!1),916866,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(925426),g=a.i(915302),h=a.i(106865),i=a.i(907105),j=a.i(551524),k=a.i(307803),l=a.i(760196),m=b([f,k,l]);[f,k,l]=m.then?(await m)():m,a.s(["default",0,({onSave:a,onEdit:b})=>{let c=(0,g.useTranslation)(),{notebookNewAnnotation:m,notebookEditAnnotation:n,setNotebookNewAnnotation:o,setNotebookEditAnnotation:p,saveNotebookAnnotationDraft:q,getNotebookAnnotationDraft:r}=(0,f.useNotebookStore)(),s=(0,e.useRef)(null),[t,u]=(0,e.useState)(""),v=(0,h.useResponsiveSize)(3);(0,e.useEffect)(()=>{if(n){let a=n.note;u(a),s.current?.setValue(a),s.current?.focus()}else if(m){let a=w();if(a){let b=r((0,i.md5Fingerprint)(a))||"";u(b),s.current?.setValue(b),s.current?.focus()}}},[m,n]);let w=()=>n?.text||m?.text||"",x=()=>{let c=s.current?.getValue();c&&(m?a(m,c):n&&(n.note=c,b(n)))},y=()=>{m&&o(null),n&&p(null)};(0,j.default)({onSaveNote:()=>{s.current?.getValue()&&x()},onEscape:y});let z=!!t.trim();return(0,d.jsxs)("div",{className:"content booknote-item note-editor-container bg-base-100 mt-2 rounded-md p-2",children:[(0,d.jsx)("div",{className:"flex w-full",children:(0,d.jsx)(k.default,{ref:s,value:t,onChange:a=>{u(a)},onBlur:()=>{let a=s.current?.getValue();if(a){let b=w();b&&q((0,i.md5Fingerprint)(b),a)}},onSave:x,onEscape:y,placeholder:c("Add your notes here..."),spellCheck:!1})}),(0,d.jsxs)("div",{className:"flex items-center pt-2",children:[(0,d.jsx)("div",{className:"me-2 mt-0.5 min-h-full self-stretch rounded-xl bg-gray-300",style:{minWidth:`${v}px`}}),(0,d.jsx)("div",{className:"content font-size-sm line-clamp-3",children:(0,d.jsx)("span",{className:"content font-size-xs text-gray-500",children:w()})})]}),(0,d.jsxs)("div",{className:"flex justify-end space-x-3 p-2",dir:"ltr",children:[(0,d.jsx)(l.default,{onClick:y,children:c("Cancel")}),(0,d.jsx)(l.default,{onClick:x,disabled:!z,children:c("Save")})]})]})}]),c()}catch(a){c(a)}},!1),40082,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(929058),g=a.i(862871),h=a.i(915302),i=a.i(106865),j=b([g]);[g]=j.then?(await j)():j,a.s(["default",0,({isVisible:a,bookKey:b,searchTerm:c,onSearchResultChange:j})=>{let k=(0,h.useTranslation)(),{getConfig:l}=(0,g.useBookDataStore)(),[m,n]=(0,e.useState)(c),o=(0,e.useRef)(null),p=(0,e.useRef)(null),q=(0,i.useResponsiveSize)(16),r=(0,i.useResponsiveSize)(12);(0,e.useEffect)(()=>{s(m)},[b]),(0,e.useEffect)(()=>{n(c),s(c)},[c]),(0,e.useEffect)(()=>{a&&o.current&&o.current.focus()},[a]),(0,e.useEffect)(()=>{let a=a=>{"Escape"===a.key&&o.current&&o.current.blur()};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a),p.current&&clearTimeout(p.current)}},[]);let s=a=>{a.trim().length>=1?t(a):u()},t=a=>{let c=l(b);if(!c)return void u();let{booknotes:d=[]}=c,e=d.filter(a=>!a.deletedAt),f=((a,b)=>{if(!b.trim())return[];let c=b.toLowerCase();return a.filter(a=>{let b=a.text?.toLowerCase().includes(c)||!1,d=a.note?.toLowerCase().includes(c)||!1;return b||d})})(e,a);j(f)},u=()=>{j(null)};return(0,d.jsx)("div",{className:"relative px-3 py-2",children:(0,d.jsxs)("div",{className:"bg-base-100 flex h-8 items-center rounded-lg",children:[(0,d.jsx)("div",{className:"pl-3",children:(0,d.jsx)(f.FaSearch,{size:q,className:"text-base-content/50"})}),(0,d.jsx)("input",{ref:o,type:"text",value:m,spellCheck:!1,onChange:a=>{let b=a.target.value;n(b),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{s(b)},300)},placeholder:k("Search notes and excerpts..."),className:"w-full bg-transparent p-2 font-sans text-sm font-light focus:outline-none"}),m&&(0,d.jsx)("div",{className:"bg-base-300 flex h-8 w-8 items-center rounded-r-lg",children:(0,d.jsx)("button",{onClick:()=>{n(""),s(""),o.current&&o.current.focus()},className:"btn btn-ghost h-8 min-h-8 w-8 rounded-none rounded-r-lg p-0",children:(0,d.jsx)(f.FaTimes,{size:r,className:"text-base-content/50"})})})]})})}]),c()}catch(a){c(a)}},!1),352128,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(402093),f=a.i(76868),g=a.i(127669),h=a.i(866736),i=a.i(862871),j=a.i(466759),k=a.i(715715),l=a.i(925426),m=a.i(915302),n=a.i(162650),o=a.i(178552),p=a.i(847656),q=a.i(465863),r=a.i(765918),s=a.i(936114),t=a.i(240009),u=a.i(937944),v=a.i(201716),w=a.i(551524),x=a.i(10662),y=a.i(40010),z=a.i(916866),A=a.i(40082),B=b([f,h,i,j,k,l,n,s,t,u,x,y,z,A]);[f,h,i,j,k,l,n,s,t,u,x,y,z,A]=B.then?(await B)():B,a.s(["default",0,({})=>{let a=(0,m.useTranslation)(),{updateAppTheme:b,safeAreaInsets:c}=(0,n.useThemeStore)(),{envConfig:B,appService:C}=(0,o.useEnv)(),{settings:D}=(0,h.useSettingsStore)(),{sideBarBookKey:E}=(0,k.useSidebarStore)(),{notebookWidth:F,isNotebookVisible:G,isNotebookPinned:H}=(0,l.useNotebookStore)(),{notebookNewAnnotation:I,notebookEditAnnotation:J,setNotebookPin:K}=(0,l.useNotebookStore)(),{getBookData:L,getConfig:M,saveConfig:N,updateBooknotes:O}=(0,i.useBookDataStore)(),{getView:P,getViewSettings:Q}=(0,j.useReaderStore)(),{getNotebookWidth:R,setNotebookWidth:S,setNotebookVisible:T,toggleNotebookPin:U}=(0,l.useNotebookStore)(),{setNotebookNewAnnotation:V,setNotebookEditAnnotation:W}=(0,l.useNotebookStore)(),[X,Y]=(0,g.useState)(!1),[Z,$]=(0,g.useState)(null),[_,aa]=(0,g.useState)(""),ab=async()=>{let a=document.querySelector(".sidebar-pin-btn");a&&"none"!==window.getComputedStyle(a).display||T(!1)},ac=(0,g.useCallback)(()=>{H||T(!1)},[H]);(0,w.default)({onEscape:ac},[ac]),(0,g.useEffect)(()=>{G?b("base-200"):b("base-100")},[G]),(0,g.useEffect)(()=>(S(D.globalReadSettings.notebookWidth),K(D.globalReadSettings.isNotebookPinned),T(D.globalReadSettings.isNotebookPinned),r.eventDispatcher.on("navigate",ab),()=>{r.eventDispatcher.off("navigate",ab)}),[]);let ad=a=>{S(a),D.globalReadSettings.notebookWidth=a},ae=(a,b)=>{if(!E)return;let c=P(E),{booknotes:d=[]}=M(E),e=d.findIndex(b=>b.id===a.id);if(-1===e)return;b?a.deletedAt=Date.now():a.updatedAt=Date.now(),d[e]=a,c?.addAnnotation({...a,value:`${v.NOTE_PREFIX}${a.cfi}`},!0);let f=O(E,d);f&&N(B,E,f,D),W(null)},{handleDragStart:af,handleDragKeyDown:ag}=(0,p.useDrag)(a=>{let b=1-a.clientX/window.innerWidth,c=Math.max(.15,Math.min(.45,b));ad(`${Math.round(1e4*c)/100}%`)},a=>{let b=parseFloat(R())/100,c=b;"ArrowLeft"===a.key?c=Math.max(.15,b+a.step):"ArrowRight"===a.key&&(c=Math.min(.45,b-a.step)),ad(`${Math.round(1e4*c)/100}%`)}),{booknotes:ah=[]}=M(E)||{},ai=ah.filter(a=>"annotation"===a.type&&a.note&&!a.deletedAt).sort((a,b)=>b.createdAt-a.createdAt),aj=ah.filter(a=>"excerpt"===a.type&&a.text&&!a.deletedAt).sort((a,b)=>a.createdAt-b.createdAt),ak=(0,g.useMemo)(()=>X&&Z?Z.filter(a=>"annotation"===a.type&&a.note&&!a.deletedAt):ai,[ai,Z,X]),al=(0,g.useMemo)(()=>X&&Z?Z.filter(a=>"excerpt"===a.type&&a.text&&!a.deletedAt):aj,[aj,Z,X]);if(!E)return null;let am=L(E),an=Q(E);if(!am||!am.bookDoc)return null;let{bookDoc:ao}=am,ap=(0,s.getBookDirFromLanguage)(ao.metadata.language),aq=ak.length>0||al.length>0,ar=ai.length>0||aj.length>0;return G?(0,d.jsxs)(d.Fragment,{children:[!H&&(0,d.jsx)(t.Overlay,{className:(0,f.default)("z-[45]",an?.isEink?"":"bg-black/20"),onDismiss:()=>{T(!1),V(null),W(null)}}),(0,d.jsxs)("div",{role:"group","aria-label":a("Notebook"),dir:an?.rtl&&"rtl"===ap?"rtl":"ltr",style:{width:`${F}`,maxWidth:"45%",position:H?"relative":"absolute",paddingTop:`${c?.top||0}px`},className:"jsx-790d1708c20552f7 "+((0,f.default)("notebook-container right-0 flex min-w-60 select-none flex-col","full-height font-sans text-base font-normal sm:text-sm",an?.isEink?"bg-base-100":"bg-base-200",C?.hasRoundedWindow&&"rounded-window-top-right rounded-window-bottom-right",H?"z-20":"z-[45] shadow-2xl",!H&&an?.isEink&&"border-base-content border-s")||""),children:[(0,d.jsx)(e.default,{id:"790d1708c20552f7",children:"@media (width<=640px){.notebook-container.jsx-790d1708c20552f7{width:100%;min-width:100%}}"}),(0,d.jsx)("div",{role:"slider",tabIndex:0,"aria-label":a("Resize Notebook"),"aria-orientation":"horizontal","aria-valuenow":parseFloat(F),onMouseDown:af,onTouchStart:af,onKeyDown:ag,className:"jsx-790d1708c20552f7 "+((0,f.default)("drag-bar absolute -left-2 top-0 h-full w-0.5 cursor-col-resize bg-transparent p-2")||"")}),(0,d.jsxs)("div",{className:"jsx-790d1708c20552f7 flex-shrink-0",children:[(0,d.jsx)(y.default,{isPinned:H,isSearchBarVisible:X,handleClose:()=>T(!1),handleTogglePin:()=>{U();let a={...D.globalReadSettings,isNotebookPinned:!H};(0,u.saveSysSettings)(B,"globalReadSettings",a)},handleToggleSearchBar:()=>{Y(a=>!a),X&&($(null),aa(""))}}),(0,d.jsx)("div",{className:"jsx-790d1708c20552f7 "+((0,f.default)("search-bar",{"search-bar-visible":X})||""),children:(0,d.jsx)(A.default,{isVisible:X,bookKey:E,searchTerm:_,onSearchResultChange:$})})]}),(0,d.jsxs)("div",{className:"jsx-790d1708c20552f7 flex-grow overflow-y-auto px-3",children:[X&&Z&&!aq&&ar&&(0,d.jsx)("div",{className:"jsx-790d1708c20552f7 flex h-32 items-center justify-center text-gray-500",children:(0,d.jsx)("p",{className:"jsx-790d1708c20552f7 font-size-sm text-center",children:a("No notes match your search")})}),(0,d.jsx)("div",{dir:"ltr",className:"jsx-790d1708c20552f7",children:al.length>0&&(0,d.jsxs)("p",{className:"jsx-790d1708c20552f7 content font-size-base",children:[a("Excerpts"),X&&Z&&(0,d.jsxs)("span",{className:"jsx-790d1708c20552f7 font-size-xs ml-2 text-gray-500",children:["(",al.length,")"]})]})}),(0,d.jsx)("ul",{className:"jsx-790d1708c20552f7 ",children:al.map((b,c)=>(0,d.jsx)("li",{className:"jsx-790d1708c20552f7 my-2",children:(0,d.jsxs)("div",{role:"button",tabIndex:0,onKeyDown:a=>{("Backspace"===a.key||"Delete"===a.key)&&ae(b,!0)},className:"jsx-790d1708c20552f7 booknote-item collapse-arrow border-base-300 bg-base-100 collapse border",children:[(0,d.jsx)("div",{style:{"--top-override":"1.25rem","--end-override":"0.7rem"},className:"jsx-790d1708c20552f7 "+((0,f.default)("collapse-title pe-8 text-sm font-medium","h-[2.5rem] min-h-[2.5rem] p-[0.6rem]")||""),children:(0,d.jsx)("p",{className:"jsx-790d1708c20552f7 line-clamp-1",children:b.text||`Excerpt ${c+1}`})}),(0,d.jsxs)("div",{className:"jsx-790d1708c20552f7 collapse-content font-size-xs select-text px-3 pb-0",children:[(0,d.jsx)("p",{className:"jsx-790d1708c20552f7 hyphens-auto text-justify",children:b.text}),(0,d.jsx)("div",{dir:"ltr",className:"jsx-790d1708c20552f7 flex justify-end",children:(0,d.jsx)("div",{onClick:ae.bind(null,b,!0),"aria-label":a("Delete"),className:"jsx-790d1708c20552f7 font-size-xs cursor-pointer align-bottom text-red-500 hover:text-red-600",children:a("Delete")})})]})]})},`${c}-${b.id}`))}),(0,d.jsx)("div",{dir:"ltr",className:"jsx-790d1708c20552f7",children:(I||ak.length>0)&&(0,d.jsxs)("p",{className:"jsx-790d1708c20552f7 content font-size-base",children:[a("Notes"),X&&Z&&ak.length>0&&(0,d.jsxs)("span",{className:"jsx-790d1708c20552f7 font-size-xs ml-2 text-gray-500",children:["(",ak.length,")"]})]})}),(I||J)&&!X&&(0,d.jsx)(z.default,{onSave:(a,b)=>{if(!E)return;let c=P(E),d=M(E),e=c?.getCFI(a.index,a.range);if(!e)return;let{booknotes:f=[]}=d,g={id:(0,q.uniqueId)(),type:"annotation",cfi:e,note:b,text:a.text,createdAt:Date.now(),updatedAt:Date.now()};c?.addAnnotation({...g,value:`${v.NOTE_PREFIX}${g.cfi}`}),f.push(g);let h=O(E,f);h&&N(B,E,h,D),V(null)},onEdit:a=>ae(a,!1)}),(0,d.jsx)("ul",{className:"jsx-790d1708c20552f7",children:ak.map((a,b)=>(0,d.jsx)(x.default,{bookKey:E,item:a},`${b}-${a.cfi}`))})]})]})]}):null}]),c()}catch(a){c(a)}},!1),348234,a=>{"use strict";let b=(a,b)=>a<=1?{columns:"1fr",rows:"1fr"}:2===a?b<1?{columns:"1fr",rows:"1fr 1fr"}:{columns:"1fr 1fr",rows:"1fr"}:3===a||4===a?{columns:"1fr 1fr",rows:"1fr 1fr"}:{columns:"1fr 1fr 1fr",rows:"1fr 1fr 1fr"};a.s(["getGridTemplate",0,b,"getInsetEdges",0,(a,c,d)=>{let e=b(c,d),f=e.columns.split(" ").length,g=e.rows.split(" ").length,h=Math.floor(a/f),i=a%f;return{top:0===h,right:i===f-1,bottom:h===g-1,left:0===i}}])},370014,a=>{"use strict";a.s(["getViewInsets",0,a=>{let b=a.showHeader,c=a.showFooter,d=a.vertical||a.writingMode.includes("vertical"),e=a.marginPx||a.marginTopPx,f=a.compactMarginPx||a.compactMarginTopPx,g=a.marginBottomPx,h=a.compactMarginBottomPx,i=a.marginLeftPx,j=a.marginRightPx,k=a.compactMarginLeftPx,l=a.compactMarginRightPx;return{top:b&&!d?e:f,right:b&&d?j:l,bottom:c&&!d?g:h,left:c&&d?i:k}}])},945809,a=>a.a(async(b,c)=>{try{a.s(["useSearchNav",()=>j]);var d=a.i(127669),e=a.i(715715),f=a.i(466759),g=a.i(609027),h=a.i(264400),i=b([e,f,h]);function j(a){let{getView:b,getProgress:c}=(0,f.useReaderStore)(),{setSideBarVisible:i}=(0,e.useSidebarStore)(),{getSearchNavState:j,setSearchResultIndex:k,clearSearch:l}=(0,e.useSidebarStore)(),{searchTerm:m,searchResults:n,searchResultIndex:o,searchProgress:p}=j(a),q=c(a),r=(0,d.useMemo)(()=>q?.location,[q]),s=(0,d.useMemo)(()=>n?(0,h.flattenSearchResults)(n):[],[n]),t=s.length,u=n&&t>0,v=(0,d.useMemo)(()=>!s.length||o>=s.length?"":s[o]?.sectionLabel||"",[s,o]),w=(0,d.useMemo)(()=>{if(!s.length||!r)return{firstIndex:-1,lastIndex:-1};let b=-1,c=-1;for(let a=0;a<s.length;a++){let d=s[a];d&&(0,g.isCfiInLocation)(d.cfi,r)&&(-1===b&&(b=a),c=a)}return -1!==b&&setTimeout(()=>k(a,b),0),{firstIndex:b,lastIndex:c}},[s,r,a,k]),x=(0,d.useCallback)(c=>{if(!s.length||c<0||c>=s.length)return;let d=s[c];d&&(k(a,c),b(a)?.goTo(d.cfi))},[a,s,k,b]),y=(0,d.useCallback)(()=>{i(!0)},[i]),z=(0,d.useCallback)(()=>{l(a),b(a)?.clearSearch()},[l,a,b]),A=(0,d.useCallback)(()=>{let{firstIndex:a}=w;a>0?x(a-1):-1===a&&o>0&&x(o-1)},[w,o,x]),B=(0,d.useCallback)(()=>{let{lastIndex:a}=w;a>=0&&a<t-1?x(a+1):-1===a&&o<t-1&&x(o+1)},[w,t,o,x]),C=w.firstIndex>0||-1===w.firstIndex&&o>0,D=w.lastIndex>=0&&w.lastIndex<t-1||-1===w.lastIndex&&o<t-1;return{searchTerm:m,searchProgress:p,currentSection:v,searchResultIndex:o,totalResults:t,showSearchNav:u,hasPreviousPage:C,hasNextPage:D,handleShowResults:y,handleCloseSearch:z,handlePreviousResult:A,handleNextResult:B}}[e,f,h]=i.then?(await i)():i,c()}catch(a){c(a)}},!1),289285,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.28 7.72a.75.75 0 0 1 0 1.06l-2.47 2.47H21a.75.75 0 0 1 0 1.5H4.81l2.47 2.47a.75.75 0 1 1-1.06 1.06l-3.75-3.75a.75.75 0 0 1 0-1.06l3.75-3.75a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M16.72 7.72a.75.75 0 0 1 1.06 0l3.75 3.75a.75.75 0 0 1 0 1.06l-3.75 3.75a.75.75 0 1 1-1.06-1.06l2.47-2.47H3a.75.75 0 0 1 0-1.5h16.19l-2.47-2.47a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"},child:[]}]})(a)}a.s(["HiArrowLongLeft",()=>c,"HiArrowLongRight",()=>d])},729492,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(950678),g=a.i(289285),h=a.i(178552),i=a.i(915302),j=a.i(106865),k=a.i(466759),l=b([e,k]);[e,k]=l.then?(await l)():l,a.s(["default",0,({bookKey:a,gridInsets:b,title:c,section:l,progress:m,showListButton:n=!0,hasPrevious:o,hasNext:p,previousLabel:q,nextLabel:r,previousTitle:s,nextTitle:t,showResultsTitle:u,closeTitle:v,onShowResults:w,onClose:x,onPrevious:y,onNext:z})=>{let{appService:A}=(0,h.useEnv)(),B=(0,i.useTranslation)(),{getViewSettings:C}=(0,k.useReaderStore)(),D=C(a),E=(0,j.useResponsiveSize)(16),F=(0,j.useResponsiveSize)(18),G=(0,j.useResponsiveSize)(20),H=A?.isMobile||!D?.showHeader;return(0,d.jsxs)("div",{className:"results-nav-bar pointer-events-none absolute inset-0 z-30 flex flex-col items-center justify-between px-4 py-1",style:{top:b.top,right:b.right,bottom:b.bottom/4,left:b.left},children:[(0,d.jsxs)("div",{className:"bg-base-100 pointer-events-auto relative flex items-center justify-between overflow-hidden rounded-xl px-2 py-1 shadow-lg sm:gap-6",children:[void 0!==m&&m<1&&(0,d.jsx)("div",{className:"bg-base-200 absolute inset-y-0 left-0 transition-all duration-300",style:{width:`${100*m}%`}}),1===m&&(0,d.jsx)("div",{className:"bg-base-200 absolute inset-0"}),n&&w?(0,d.jsx)("button",{title:u||B("Show Results"),onClick:w,className:"btn btn-ghost relative z-10 h-8 min-h-8 w-8 p-0 hover:bg-transparent",children:(0,d.jsx)(f.IoIosList,{size:G,className:"text-base-content"})}):(0,d.jsx)("div",{className:"relative z-10 w-8"}),(0,d.jsxs)("div",{className:"relative z-10 flex flex-1 flex-col items-center px-2",children:[(0,d.jsx)("span",{className:"line-clamp-1 text-sm font-medium",children:c}),l&&H&&(0,d.jsx)("span",{className:"text-base-content/70 line-clamp-1 text-xs",children:l})]}),(0,d.jsx)("button",{title:v||B("Close"),onClick:x,className:"btn btn-ghost relative z-10 h-8 min-h-8 w-8 p-0 hover:bg-transparent",children:(0,d.jsx)(f.IoMdCloseCircle,{size:E})})]}),(0,d.jsxs)("div",{className:"bg-base-200 pointer-events-auto flex items-center justify-between gap-6 rounded-xl px-4 py-0 shadow-lg",children:[(0,d.jsxs)("button",{title:s||B("Previous"),onClick:y,disabled:!o,className:(0,e.default)("btn btn-ghost flex h-auto min-h-0 flex-1 flex-col items-center gap-0 p-1 hover:bg-transparent",!o&&"opacity-40 disabled:bg-transparent"),children:[(0,d.jsx)(g.HiArrowLongLeft,{size:F,className:"text-base-content"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:q||B("Previous")})]}),(0,d.jsxs)("button",{title:t||B("Next"),onClick:z,disabled:!p,className:(0,e.default)("btn btn-ghost flex h-auto min-h-0 flex-1 flex-col items-center gap-0 p-1 hover:bg-transparent",!p&&"opacity-40 disabled:bg-transparent"),children:[(0,d.jsx)(g.HiArrowLongRight,{size:F,className:"text-base-content"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:r||B("Next")})]})]})]})}]),c()}catch(a){c(a)}},!1),264400,a=>a.a(async(b,c)=>{try{a.s(["default",()=>j,"flattenSearchResults",()=>i]);var d=a.i(508171),e=a.i(915302),f=a.i(945809),g=a.i(729492),h=b([f,g]);[f,g]=h.then?(await h)():h;let j=({bookKey:a,gridInsets:b})=>{let{searchTerm:c,searchProgress:h,currentSection:i,showSearchNav:j,hasPreviousPage:k,hasNextPage:l,handleShowResults:m,handleCloseSearch:n,handlePreviousResult:o,handleNextResult:p}=(0,f.useSearchNav)(a),q=(0,e.useTranslation)();return j?(0,d.jsx)(g.default,{bookKey:a,gridInsets:b,title:q("Search results for '{{term}}'",{term:c}),section:i,progress:h,hasPrevious:k,hasNext:l,previousTitle:q("Previous Result"),nextTitle:q("Next Result"),showResultsTitle:q("Show Search Results"),closeTitle:q("Close Search"),onShowResults:m,onClose:n,onPrevious:o,onNext:p}):null};function i(a){let b=[];for(let c of a)if("subitems"in c)for(let a of c.subitems)b.push({cfi:a.cfi,sectionLabel:c.label});else b.push({cfi:c.cfi,sectionLabel:""});return b}c()}catch(a){c(a)}},!1),608151,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(887287),f=a.i(715715),g=a.i(466759),h=a.i(862871),i=a.i(609027),j=a.i(123588),k=b([f,g,h]);function l(a,b){let{getView:c,getProgress:k}=(0,g.useReaderStore)(),{getConfig:l}=(0,h.useBookDataStore)(),{setSideBarVisible:m,getBooknotesNavState:n,setActiveBooknoteType:o,setBooknoteResults:p,setBooknoteIndex:q,clearBooknotesNav:r}=(0,f.useSidebarStore)(),{activeBooknoteType:s,booknoteResults:t,booknoteIndex:u}=n(a),v=k(a),w=v?.location,x=(0,d.useMemo)(()=>{let b=l(a);return b?.booknotes?.filter(a=>!a.deletedAt)||[]},[a,l]),y=(0,d.useMemo)(()=>t?[...t].sort((a,b)=>e.compare(a.cfi,b.cfi)):[],[t]),z=y.length,A=t&&z>0,B=(0,d.useMemo)(()=>{if(!y.length||u>=y.length)return"";let a=y[u];if(!a)return"";let c=(0,j.findTocItemBS)(b,a.cfi);return c?.label||""},[y,u,b]),C=(0,d.useMemo)(()=>{if(!y.length||!w)return{firstIndex:-1,lastIndex:-1};let b=-1,c=-1;for(let a=0;a<y.length;a++){let d=y[a];d&&(0,i.isCfiInLocation)(d.cfi,w)&&(-1===b&&(b=a),c=a)}return -1!==b&&setTimeout(()=>q(a,b),0),{firstIndex:b,lastIndex:c}},[y,w,a,q]),D=(0,d.useCallback)(b=>{if(!y.length||b<0||b>=y.length)return;let d=y[b];d&&(q(a,b),c(a)?.goTo(d.cfi))},[a,y,q,c]),E=(0,d.useCallback)(b=>{let d=x.filter(a=>a.type===b);if(0===d.length)return;let f=[...d].sort((a,b)=>e.compare(a.cfi,b.cfi));o(a,b),p(a,f),q(a,0),f.length>0&&c(a)?.goTo(f[0].cfi)},[x,a,o,p,q,c]),F=(0,d.useCallback)(()=>{m(!0)},[m]),G=(0,d.useCallback)(()=>{r(a)},[r,a]),H=(0,d.useCallback)(()=>{let{firstIndex:a}=C;a>0?D(a-1):-1===a&&u>0&&D(u-1)},[C,u,D]),I=(0,d.useCallback)(()=>{let{lastIndex:a}=C;a>=0&&a<z-1?D(a+1):-1===a&&u<z-1&&D(u+1)},[C,z,u,D]),J=C.firstIndex>0||-1===C.firstIndex&&u>0,K=C.lastIndex>=0&&C.lastIndex<z-1||-1===C.lastIndex&&u<z-1,L=(0,d.useMemo)(()=>x.filter(a=>"bookmark"===a.type).length,[x]),M=(0,d.useMemo)(()=>x.filter(a=>"annotation"===a.type).length,[x]),N=(0,d.useMemo)(()=>x.filter(a=>"excerpt"===a.type).length,[x]);return{activeBooknoteType:s,currentSection:B,booknoteIndex:u,totalResults:z,showBooknotesNav:A&&null!==s,hasPreviousPage:J,hasNextPage:K,bookmarkCount:L,annotationCount:M,excerptCount:N,startNavigation:E,handleShowResults:F,handleClose:G,handlePrevious:H,handleNext:I}}[f,g,h]=k.then?(await k)():k,a.s(["useBooknotesNav",()=>l]),c()}catch(a){c(a)}},!1),838407,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(915302),f=a.i(608151),g=a.i(729492),h=b([f,g]);[f,g]=h.then?(await h)():h,a.s(["default",0,({bookKey:a,gridInsets:b,toc:c})=>{let{activeBooknoteType:h,currentSection:i,showBooknotesNav:j,hasPreviousPage:k,hasNextPage:l,handleShowResults:m,handleClose:n,handlePrevious:o,handleNext:p}=(0,f.useBooknotesNav)(a,c),q=(0,e.useTranslation)();if(!j)return null;let r=()=>{switch(h){case"bookmark":return q("Bookmarks");case"annotation":return q("Annotations");case"excerpt":return q("Excerpts");default:return""}};return(0,d.jsx)(g.default,{bookKey:a,gridInsets:b,title:r(),section:i,hasPrevious:k,hasNext:l,progress:1,previousTitle:q("Previous"),nextTitle:q("Next"),showResultsTitle:r(),closeTitle:q("Close"),onShowResults:m,onClose:n,onPrevious:o,onNext:p})}]),c()}catch(a){c(a)}},!1),505244,a=>a.a(async(b,c)=>{try{var d=a.i(662677),e=a.i(201993),f=a.i(866736),g=b([d,f]);function h(a){let{blobUrl:b,loaded:c,error:d,...e}=a;return e}[d,f]=g.then?(await g)():g;let i=(0,d.create)((a,b)=>({fonts:[],loading:!1,setFonts:b=>a({fonts:b}),addFont:(c,d)=>{let f=(0,e.createCustomFont)(c,d),g=b().fonts.find(a=>a.id===f.id);if(g)return b().updateFont(f.id,{...f,path:f.path,downloadedAt:Date.now(),deletedAt:void 0,loaded:!1,blobUrl:void 0,error:void 0}),a(a=>({fonts:[...a.fonts]})),g;let h={...f,downloadedAt:Date.now()};return a(a=>({fonts:[...a.fonts,h]})),h},removeFont:c=>{let d=b().getFont(c);if(!d)return!1;d.blobUrl&&URL.revokeObjectURL(d.blobUrl);let e=b().updateFont(c,{deletedAt:Date.now(),blobUrl:void 0,loaded:!1,error:void 0});return a(a=>({fonts:[...a.fonts]})),e},updateFont:(c,d)=>{let e=b().fonts.findIndex(a=>a.id===c);return -1!==e&&(a(a=>({fonts:a.fonts.map((a,b)=>b===e?{...a,...d}:a)})),!0)},getFont:a=>b().fonts.find(b=>b.id===a),getAllFonts:()=>b().fonts,getAvailableFonts:()=>b().fonts.filter(a=>!a.deletedAt),clearAllFonts:()=>{let{fonts:c}=b();c.forEach(a=>{a.blobUrl&&URL.revokeObjectURL(a.blobUrl)}),a({fonts:[]})},loadFont:async(a,c)=>{let d=b().getFont(c);if(!d)throw Error(`Font with id "${c}" not found`);if(d.deletedAt)throw Error(`Font "${d.name}" has been deleted`);if(d.loaded&&d.blobUrl&&!d.error)return d;try{b().updateFont(c,{loaded:!1,error:void 0});let f=await a.getAppService(),g=await f.openFile(d.path,"Fonts"),h=(0,e.getFontFormat)(d.path),i=(0,e.getMimeType)(h),j=new Blob([await g.arrayBuffer()],{type:i}),k=URL.createObjectURL(j);return b().updateFont(c,{blobUrl:k,loaded:!0,error:void 0}),b().getFont(c)}catch(d){let a=d instanceof Error?d.message:"Unknown error";throw b().updateFont(c,{loaded:!1,error:a,blobUrl:void 0}),d}},loadFonts:async(c,d)=>{a({loading:!0});try{return(await Promise.allSettled(d.map(a=>b().loadFont(c,a)))).filter(a=>"fulfilled"===a.status).map(a=>a.value)}finally{a({loading:!1})}},loadAllFonts:async a=>{let c=b().getAvailableFonts().map(a=>a.id);return await b().loadFonts(a,c)},unloadFont:a=>{let c=b().getFont(a);return c?.blobUrl&&URL.revokeObjectURL(c.blobUrl),b().updateFont(a,{blobUrl:void 0,loaded:!1,error:void 0})},unloadAllFonts:()=>{let a=b().getAllFonts();a.forEach(a=>{a.blobUrl&&URL.revokeObjectURL(a.blobUrl)}),a.forEach(a=>{b().updateFont(a.id,{blobUrl:void 0,loaded:!1,error:void 0})})},getFontFamilies:()=>b().getAvailableFonts().filter(a=>a.loaded&&!a.error).map(a=>a.family||a.name).filter((a,b,c)=>c.indexOf(a)===b).sort((a,b)=>a.localeCompare(b)),getLoadedFonts:()=>b().getAvailableFonts().filter(a=>a.loaded&&!a.error),isFontLoaded:a=>{let c=b().getFont(a);return c?.loaded===!0&&!c.error&&!c.deletedAt},loadCustomFonts:async c=>{try{let{settings:d}=f.useSettingsStore.getState(),e=b().fonts;if(d?.customFonts){let f=d.customFonts.map(a=>{let b=e.find(b=>b.id===a.id);return{...a,loaded:b?.loaded||!1,error:b?.error,blobUrl:b?.blobUrl}});a({fonts:f}),await b().loadAllFonts(c)}}catch(a){console.error("Failed to load custom fonts settings:",a)}},saveCustomFonts:async a=>{try{let{settings:c,setSettings:d,saveSettings:e}=f.useSettingsStore.getState(),{fonts:g}=b();c.customFonts=g.map(h),d(c),e(a,c)}catch(a){throw console.error("Failed to save custom fonts settings:",a),a}}}));a.s(["useCustomFontStore",0,i]),c()}catch(a){c(a)}},!1),723082,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(466759),f=a.i(862871),g=a.i(951790),h=a.i(765918),i=b([e,f]);[e,f]=i.then?(await i)():i,a.s(["useMouseEvent",0,(a,b,c)=>{let{hoveredBookKey:f}=(0,e.useReaderStore)(),i=(0,g.debounce)(c,500),j=(0,g.debounce)(b,100),k=c=>{c instanceof MessageEvent?c.data&&c.data.bookKey===a&&("iframe-wheel"===c.data.type&&i("mouse",-c.data.deltaY,0),"iframe-wheel"===c.data.type?c.data.ctrlKey?c.data.deltaY>0?h.eventDispatcher.dispatch("zoom-out",{factor:Math.abs(c.data.deltaY)/100}):c.data.deltaY<0&&h.eventDispatcher.dispatch("zoom-in",{factor:Math.abs(c.data.deltaY)/100}):j(c):b(c)):"wheel"===c.type?i("mouse",-c.deltaY,0):b(c)};return(0,d.useEffect)(()=>(window.addEventListener("message",k),()=>{window.removeEventListener("message",k)}),[a,f]),{onClick:b,onWheel:k}},"useTouchEvent",0,(a,b,c)=>{let{getBookData:g}=(0,f.useBookDataStore)(),{hoveredBookKey:h,setHoveredBookKey:i,getViewSettings:j}=(0,e.useReaderStore)(),k=(0,d.useRef)(null),l=(0,d.useRef)(null),m=(0,d.useRef)(null),n=(0,d.useRef)(null),o=a=>{let b=a.targetTouches[0];b&&(k.current=b,m.current="timeStamp"in a?a.timeStamp:Date.now())},p=b=>{if(!k.current)return;let c=b.targetTouches[0];c&&(l.current=c,n.current="timeStamp"in b?b.timeStamp:Date.now());let{current:d}=k,{current:e}=l;if(h&&e){let b=j(a),c=e.screenY-d.screenY,f=e.screenX-d.screenX;b.scrolled||b.vertical?i(null):Math.abs(f)>Math.abs(c)&&Math.abs(f)>10&&i(null)}},q=d=>{if(!k.current)return;let e=d.targetTouches[0];e&&(l.current=e,n.current="timeStamp"in d?d.timeStamp:Date.now());let f=window.innerWidth,{current:o}=k,{current:p}=l,{current:q}=m,{current:r}=n;if(p){let d=j(a),e=g(a),k=p.screenY-o.screenY,l=p.screenX-o.screenX;k<-10&&Math.abs(k)>2*Math.abs(l)&&Math.abs(l)<.3*f?d.scrolled||d.vertical||e.isFixedLayout&&!(d.zoomLevel<=100)||i(h?null:a):h&&i(null),b(new CustomEvent("touch-swipe",{detail:{deltaX:l,deltaY:k,deltaT:r&&q?r-q:0,startX:o.screenX,startY:o.screenY,endX:p.screenX,endY:p.screenY}})),c("touch",k,30)}k.current=null,l.current=null},r=b=>{b.data&&b.data.bookKey===a&&("iframe-touchstart"===b.data.type?o(b.data):"iframe-touchmove"===b.data.type?p(b.data):"iframe-touchend"===b.data.type&&q(b.data))};return(0,d.useEffect)(()=>(window.addEventListener("message",r),()=>{window.removeEventListener("message",r)}),[h]),{onTouchStart:o,onTouchMove:p,onTouchEnd:q}}]),c()}catch(a){c(a)}},!1),366109,a=>{"use strict";var b=a.i(127669);a.s(["useFoliateEvents",0,(a,c)=>{let d=c?.onLoad,e=c?.onRelocate,f=c?.onLinkClick,g=c?.onRendererRelocate,h=c?.onDrawAnnotation,i=c?.onShowAnnotation;(0,b.useEffect)(()=>{if(a)return d&&a.addEventListener("load",d),e&&a.addEventListener("relocate",e),f&&a.addEventListener("link",f),g&&a.renderer.addEventListener("relocate",g),h&&a.addEventListener("draw-annotation",h),i&&a.addEventListener("show-annotation",i),()=>{d&&a.removeEventListener("load",d),e&&a.removeEventListener("relocate",e),f&&a.removeEventListener("link",f),g&&a.renderer.removeEventListener("relocate",g),h&&a.removeEventListener("draw-annotation",h),i&&a.removeEventListener("show-annotation",i)}},[a])}])},254368,a=>{"use strict";a.s(["transformBookConfigFromDB",0,a=>{let{book_hash:b,meta_hash:c,progress:d,location:e,xpointer:f,search_config:g,view_settings:h,updated_at:i}=a;return{bookHash:b,metaHash:c,location:e,xpointer:f,progress:d&&JSON.parse(d),searchConfig:g&&JSON.parse(g),viewSettings:h&&JSON.parse(h),updatedAt:new Date(i).getTime()}},"transformBookFromDB",0,a=>{let{book_hash:b,meta_hash:c,format:d,title:e,author:f,group_id:g,group_name:h,tags:i,progress:j,source_title:k,metadata:l,created_at:m,updated_at:n,deleted_at:o,uploaded_at:p}=a;return{hash:b,metaHash:c,format:d,title:e,author:f,groupId:g,groupName:h,tags:i,progress:j,sourceTitle:k,metadata:l?JSON.parse(l):null,createdAt:new Date(m).getTime(),updatedAt:new Date(n).getTime(),deletedAt:o?new Date(o).getTime():null,uploadedAt:p?new Date(p).getTime():null}},"transformBookNoteFromDB",0,a=>{let{book_hash:b,meta_hash:c,id:d,type:e,cfi:f,text:g,style:h,color:i,note:j,created_at:k,updated_at:l,deleted_at:m}=a;return{bookHash:b,metaHash:c,id:d,type:e,cfi:f,text:g,style:h,color:i,note:j,createdAt:new Date(k).getTime(),updatedAt:new Date(l).getTime(),deletedAt:m?new Date(m).getTime():null}}],254368)},205244,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(667180),f=a.i(107625),g=a.i(866736),h=a.i(862871),i=a.i(254368),j=a.i(187897),k=a.i(466759),l=b([g,h,k]);[g,h,k]=l.then?(await l)():l;let n={books:i.transformBookFromDB,notes:i.transformBookNoteFromDB,configs:i.transformBookConfigFromDB};function m(a){let b=(0,e.useRouter)(),{settings:c,setSettings:i}=(0,g.useSettingsStore)(),{getConfig:l,setConfig:m}=(0,h.useBookDataStore)(),{setIsSyncing:o}=(0,k.useReaderStore)(),p=a?l(a):null,[q,r]=(0,d.useState)(!1),[s,t]=(0,d.useState)(!1),[u,v]=(0,d.useState)(!1),[w,x]=(0,d.useState)(null),[y,z]=(0,d.useState)(0),[A,B]=(0,d.useState)(0),[C,D]=(0,d.useState)(0),[E,F]=(0,d.useState)(!1),[G,H]=(0,d.useState)(!1),[I,J]=(0,d.useState)({books:null,configs:null,notes:null}),[K,L]=(0,d.useState)(null),[M,N]=(0,d.useState)(null),[O,P]=(0,d.useState)(null),{syncClient:Q}=(0,f.useSyncContext)();(0,d.useEffect)(()=>{a&&o(a,G)},[a,G]),(0,d.useEffect)(()=>{if(!c.version||a&&!p?.location||E)return;let b=c.lastSyncedAtBooks??0,d=p?.lastSyncedAtConfig??c.lastSyncedAtConfigs??0,e=p?.lastSyncedAtNotes??c.lastSyncedAtNotes??0,f=Date.now();z(f-b>2592e5?0:b-864e5),B(f-d>2592e5?0:d-864e5),D(f-e>2592e5?0:e-864e5),F(!0)},[a,c,p]);let R=async(d,e,f,h,k,l)=>{h(!0),x(null);try{let b=await Q.pullChanges(e,d,k,l);J({...I,[d]:b[d]});let c=b[d];if(e>0&&!c?.length)return;let h=c?.length?(a=>{let b=0;for(let c of a){if(c.updated_at){let a=new Date(c.updated_at).getTime();b=Math.max(b,a)}if(c.deleted_at){let a=new Date(c.deleted_at).getTime();b=Math.max(b,a)}}return b})(c):Date.now();f(h);let j=g.useSettingsStore.getState().settings;switch(d){case"books":j.lastSyncedAtBooks=h,i(j);break;case"configs":k?a&&m(a,{lastSyncedAtConfig:h}):(j.lastSyncedAtConfigs=h,i(j));break;case"notes":k?a&&m(a,{lastSyncedAtNotes:h}):(j.lastSyncedAtNotes=h,i(j))}}catch(a){console.error(a),a instanceof Error?(a.message.includes("Not authenticated")&&c.keepLogin&&(c.keepLogin=!1,i(c),(0,j.navigateToLogin)(b)),x(a.message||`Error pulling ${d}`)):x(`Error pulling ${d}`)}finally{h(!1)}},S=async a=>{H(!0),x(null);try{let b=await Q.pushChanges(a);J(b)}catch(a){console.error(a),a instanceof Error?x(a.message||"Error pushing changes"):x("Error pushing changes")}finally{H(!1)}},T=(0,d.useCallback)(async(a,b="both")=>{E&&(("push"===b||"both"===b)&&a?.length&&await S({books:a}),("pull"===b||"both"===b)&&await R("books",y+1,z,r))},[E,y]),U=(0,d.useCallback)(async(a,b,c,d="both")=>{(b||E)&&(("push"===d||"both"===d)&&a?.length&&await S({configs:a}),("pull"===d||"both"===d)&&await R("configs",A,B,t,b,c))},[E,A]),V=(0,d.useCallback)(async(a,b,c,d="both")=>{E&&(("push"===d||"both"===d)&&a?.length&&await S({notes:a}),("pull"===d||"both"===d)&&await R("notes",C,D,v,b,c))},[E,C]);return(0,d.useEffect)(()=>{if(!G&&I){let{books:a,configs:b,notes:c}=I,d=a?.map(a=>n.books(a)),e=b?.map(a=>n.configs(a)),f=c?.map(a=>n.notes(a));d&&L(d),e&&N(e),f&&P(f)}},[I,G]),{syncing:q||s||u,syncError:w,syncResult:I,syncedBooks:K,syncedConfigs:M,syncedNotes:O,lastSyncedAtBooks:y,lastSyncedAtNotes:C,lastSyncedAtConfigs:A,useSyncInited:E,pullChanges:R,pushChanges:S,syncBooks:T,syncConfigs:U,syncNotes:V}}a.s(["useSync",()=>m]),c()}catch(a){c(a)}},!1),244212,a=>{"use strict";var b=a.i(887287);class c{document;spineItemIndex;constructor(a,b=0){this.document=a,this.spineItemIndex=b}static extractSpineIndex(a){try{if(a.startsWith("epubcfi(")){let c=(0,b.collapse)((0,b.parse)(a)),d=c[0]?.[1]?.index;if(void 0===d)throw Error("Cannot extract spine index from CFI");return Math.floor((d-2)/2)}if(a.startsWith("/body/DocFragment[")){let b=a.match(/DocFragment\[(\d+)\]/);if(b)return parseInt(b[1],10)-1;throw Error("Cannot extract spine index from XPath")}throw Error("Unsupported format for spine index extraction")}catch(b){throw Error(`Cannot extract spine index from CFI/XPointer: ${a} - ${b}`)}}xPointerToCFI(a,b){try{if(b)return this.convertRangeXPointerToCFI(a,b);return this.convertPointXPointerToCFI(a)}catch(b){throw Error(`Failed to convert XPointer ${a}: ${b}`)}}cfiToXPointer(a){try{let c=(0,b.parse)(a);if(c.parent){let a=b.fake.toIndex(c.parent.shift());if(a!==this.spineItemIndex)throw Error(`CFI spine index ${a} does not match converter spine index ${this.spineItemIndex}`);let d=(0,b.toRange)(this.document,c),e=this.rangePointToXPointer(d.startContainer,d.startOffset),f=this.rangePointToXPointer(d.endContainer,d.endOffset);return{xpointer:e,pos0:e,pos1:f}}let d=(0,b.collapse)(c),e=b.fake.toIndex(c.shift());if(e!==this.spineItemIndex)throw Error(`CFI spine index ${e} does not match converter spine index ${this.spineItemIndex}`);let f=(0,b.toElement)(this.document,c[0]);if(!f)throw Error(`Element not found for CFI: ${a}`);let g=d[d.length-1]?.[d[d.length-1].length-1],h=g?.offset;return{xpointer:void 0!==h?this.handleTextOffset(f,h):this.buildXPointerPath(f)}}catch(b){throw Error(`Failed to convert CFI ${a}: ${b}`)}}validateCFI(a){try{return(0,b.parse)(a),this.cfiToXPointer(a),!0}catch{return!1}}validateXPointer(a,b){try{return this.xPointerToCFI(a,b),!0}catch{return!1}}convertPointXPointerToCFI(a){let{element:c,textOffset:d}=this.parseXPointer(a),e=this.document.createRange();if(void 0!==d){let a=this.findTextNodeAtOffset(c,d);a?(e.setStart(a.node,a.offset),e.setEnd(a.node,a.offset)):(e.setStart(c,0),e.setEnd(c,0))}else e.setStart(c,0),e.setEnd(c,0);let f=(0,b.fromRange)(e);return this.adjustSpineIndex(f)}convertRangeXPointerToCFI(a,c){let d=this.parseXPointer(a),e=this.parseXPointer(c),f=this.document.createRange();if(void 0!==d.textOffset){let a=this.findTextNodeAtOffset(d.element,d.textOffset);a?f.setStart(a.node,a.offset):f.setStart(d.element,0)}else f.setStart(d.element,0);if(void 0!==e.textOffset){let a=this.findTextNodeAtOffset(e.element,e.textOffset);a?f.setEnd(a.node,a.offset):f.setEnd(e.element,0)}else f.setEnd(e.element,0);let g=(0,b.fromRange)(f);return this.adjustSpineIndex(g)}parseXPointer(a){let b=a.match(/\/text\(\)\.(\d+)$/),c=b?parseInt(b[1],10):void 0,d=void 0!==c?a.replace(/\/text\(\)\.\d+$/,""):a,e=this.resolveXPointerPath(d);if(!e)throw Error(`Cannot resolve XPointer path: ${d}`);return{element:e,textOffset:c}}resolveXPointerPath(a){let b=a.match(/^\/body\/DocFragment\[\d+\]\/body(.*)$/);if(!b)throw Error(`Invalid XPointer format: ${a}`);let c=b[1],d=this.document.body;if(!c||""===c)return d;for(let a of c.split("/").filter(Boolean)){let b,c,e=a.match(/^(\w+)\[(\d+)\]$/),f=a.match(/^(\w+)$/);if(e){let[,a,d]=e;b=a,c=Math.max(0,parseInt(d,10)-1)}else if(f){let[,a]=f;b=a,c=0}else throw Error(`Invalid XPointer segment: ${a}`);let g=Array.from(d.children).filter(a=>a.tagName.toLowerCase()===b?.toLowerCase());if(c>=g.length)throw Error(`Element index ${c} out of bounds for tag ${b}`);d=g[c]}return d}findTextNodeAtOffset(a,b){let c=[];this.collectTextNodes(a,c);let d=0;for(let a of c){let c=(a.textContent||"").length;if(d+c>=b)return{node:a,offset:b-d};d+=c}if(c.length>0){let a=c[c.length-1];return{node:a,offset:(a.textContent||"").length}}return null}adjustSpineIndex(a){let b=a.match(/^epubcfi\((.+)\)$/);if(!b)throw Error(`Invalid CFI format: ${a}`);let c=b[1],d=(this.spineItemIndex+1)*2;if(c.match(/^\/6\/\d+!/)){let a=c.replace(/^\/6\/\d+!/,`/6/${d}!`);return`epubcfi(${a})`}{let a=`/6/${d}!${c}`;return`epubcfi(${a})`}}rangePointToXPointer(a,b){if(a.nodeType===Node.TEXT_NODE){let c=a.parentElement||this.document.documentElement;return this.handleTextOffsetInElement(c,a,b)}if(a.nodeType!==Node.ELEMENT_NODE)return this.buildXPointerPath(this.document.documentElement);if(0===b)return a.childNodes.length>0&&a.childNodes[0].nodeType===Node.ELEMENT_NODE?this.buildXPointerPath(a.childNodes[0]):this.buildXPointerPath(a);{let c=Array.from(a.childNodes),d=c[b-1]||c[c.length-1];return d?.nodeType===Node.ELEMENT_NODE?this.buildXPointerPath(d):d?.nodeType===Node.TEXT_NODE?this.handleTextOffsetInElement(a,d,d.textContent?.length||0):this.buildXPointerPath(a)}}buildXPointerPath(a){let b=[],c=a;for(;c&&c!==this.document.documentElement;){let a=c.parentElement;if(!a)break;let d=c.tagName.toLowerCase(),e=0,f=0;for(let b of Array.from(a.children))b.tagName.toLowerCase()===d&&(b===c&&(e=f),f++);1===f?b.unshift(d):b.unshift(`${d}[${e+1}]`),c=a}let d=`/body/DocFragment[${this.spineItemIndex+1}]`;return b.length>0&&b[0].startsWith("body")&&b.shift(),d+="/body",b.length>0&&(d+="/"+b.join("/")),d}handleTextOffset(a,b){let c=[];this.collectTextNodes(a,c);let d=0,e=null,f=0;for(let a of c){let c=(a.textContent||"").length;if(d+c>=b){e=a,f=b-d;break}d+=c}if(!e)return this.buildXPointerPath(a);let g=e.parentElement;for(;g&&!this.isSignificantElement(g);)g=g.parentElement;g||(g=a);let h=this.buildXPointerPath(g);return`${h}/text().${f}`}handleTextOffsetInElement(a,b,c){let d=[];this.collectTextNodes(a,d);let e=0;for(let a of d){if(a===b){e+=c;break}e+=(a.textContent||"").length}return this.handleTextOffset(a,e)}collectTextNodes(a,b){for(let c of Array.from(a.childNodes))c.nodeType===Node.TEXT_NODE?(c.textContent||"").length>0&&b.push(c):c.nodeType===Node.ELEMENT_NODE&&this.collectTextNodes(c,b)}isSignificantElement(a){let b=a.tagName.toLowerCase();return!new Set(["span","em","strong","i","b","u","small","mark","sup","sub"]).has(b)}}let d=async(a,b,d,e)=>{let f,g=c.extractSpineIndex(a);if(d===g&&b)f=new c(b,d||0);else{let a=await e?.sections?.[g]?.createDocument();if(!a)throw Error("Failed to load document for XPointer conversion.");f=new c(a,g||0)}return f.xPointerToCFI(a)},e=async(a,b,d,e)=>{let f,g=c.extractSpineIndex(a);if(d===g&&b)f=new c(b,d||0);else{let a=await e?.sections?.[g]?.createDocument();if(!a)throw Error("Failed to load document for CFI conversion.");f=new c(a,g||0)}return f.cfiToXPointer(a)};a.s(["XCFI",()=>c,"getCFIFromXPointer",0,d,"getXPointerFromCFI",0,e,"normalizeProgressXPointer",0,a=>{let b=/\/text\(\).*$/;a.match(b)&&(a=a.replace(b,""));let c=/\.\d+$/;return a.match(c)&&(a=a.replace(c,"")),a}])},511369,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(77946),f=a.i(205244),g=a.i(679496),h=a.i(862871),i=a.i(466759),j=a.i(866736),k=a.i(915302),l=a.i(827689),m=a.i(762774),n=a.i(951790),o=a.i(765918),p=a.i(654617),q=a.i(244212),r=b([f,h,i,j]);[f,h,i,j]=r.then?(await r)():r,a.s(["useProgressSync",0,a=>{let b=(0,k.useTranslation)(),{getConfig:c,setConfig:r,getBookData:s}=(0,h.useBookDataStore)(),{getView:t,getProgress:u,setHoveredBookKey:v}=(0,i.useReaderStore)(),{settings:w}=(0,j.useSettingsStore)(),{syncedConfigs:x,syncConfigs:y}=(0,f.useSync)(a),{user:z}=(0,e.useAuth)(),A=u(a),B=(0,d.useRef)(!1),C=(0,d.useRef)(!1),D=async(a,b)=>{let c=s(a)?.book;if(!b||!c||!z)return;let d=a.split("-")[0],e=c.metaHash,f={...b,bookHash:d,metaHash:e},g=JSON.parse((0,l.serializeConfig)(f,w.globalViewSettings,p.DEFAULT_BOOK_SEARCH_CONFIG));delete g.booknotes,await y([g],d,e,"push")},E=async a=>{let b=s(a)?.book;if(!z||!b)return;let c=a.split("-")[0],d=b.metaHash;await y([],c,d,"pull")},F=async()=>{if(B.current){let b=c(a),d=t(a),e=s(a)?.book;if(b&&d&&e&&b.progress&&b.progress[0]>0){try{let a=d.renderer.getContents()[0];if(a&&!g.FIXED_LAYOUT_FORMATS.has(e.format)){let{doc:c,index:d}=a,e=await (0,q.getXPointerFromCFI)(b.location,c,d||0);b.xpointer=(0,q.normalizeProgressXPointer)(e.xpointer)}}catch(a){console.warn("Failed to convert CFI to XPointer",a)}D(a,b)}}else E(a)},G=async b=>{let{bookKey:c}=b.detail;c===a&&(B.current=!1,await E(a))};(0,d.useEffect)(()=>(o.eventDispatcher.on("sync-book-progress",G),()=>{o.eventDispatcher.off("sync-book-progress",G)}),[a]);let H=(0,d.useCallback)((0,n.debounce)(()=>{F()},1e3*p.SYNC_PROGRESS_INTERVAL_SEC),[]);(0,d.useEffect)(()=>{A?.location&&z&&H()},[A?.location]),(0,d.useEffect)(()=>{A&&!C.current&&(C.current=!0,E(a))},[A]);let I=async d=>{let e=c(a),f=s(a)?.book;if(!d||0===d.length||!e||!f)return;let g=a.split("-")[0],h=f.metaHash,i=d.filter(a=>a.bookHash===g||a.metaHash===h)[0];if(i){let c=e?.location,d=i.location,f=i.xpointer,g=s(a),h=t(a);if(f&&h&&g&&g.bookDoc){let a=h.renderer.getContents()[0],b=(0,q.normalizeProgressXPointer)(f),c=await (0,q.getCFIFromXPointer)(b,a?.doc,a?.index,g.bookDoc);(!d||0>m.CFI.compare(d,c))&&(d=c)}let j=Object.fromEntries(Object.entries(i).filter(([a,b])=>null!=b));i.updatedAt>=e.updatedAt?r(a,{...e,...j}):r(a,{...j,...e}),d&&c&&0>m.CFI.compare(c,d)&&h&&(h.goTo(d),v(null),o.eventDispatcher.dispatch("hint",{bookKey:a,message:b("Reading Progress Synced")}))}};(0,d.useEffect)(()=>{!B.current&&x&&(B.current=!0,I(x).catch(a=>{console.error("Failed to apply remote progress",a)}))},[x])}]),c()}catch(a){c(a)}},!1),88327,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(862871),g=a.i(466759),h=a.i(866736),i=a.i(452125),j=b([f,g,h]);[f,g,h]=j.then?(await j)():j,a.s(["useProgressAutoSave",0,a=>{let{envConfig:b}=(0,e.useEnv)(),{getConfig:c,saveConfig:j}=(0,f.useBookDataStore)(),{getProgress:k}=(0,g.useReaderStore)(),l=k(a),m=(0,d.useCallback)((0,i.throttle)(()=>{setTimeout(async()=>{let d=c(a),e=h.useSettingsStore.getState().settings;await j(b,a,d,e)},5e3)},1e4),[]);(0,d.useEffect)(()=>{m()},[l,a])}]),c()}catch(a){c(a)}},!1),2339,a=>{"use strict";var b=a.i(127669);a.s(["useAutoFocus",0,(a={})=>{let{delay:c=0,condition:d=!0,preventScroll:e=!1,ref:f}=a,g=(0,b.useRef)(null),h=f||g;return(0,b.useEffect)(()=>{if(d&&h.current){let a=()=>{h.current?.focus({preventScroll:e})};if(c>0){let b=setTimeout(a,c);return()=>clearTimeout(b)}a()}},[d,c,e]),h}])},84176,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(866736),g=a.i(466759),h=a.i(862871),i=a.i(915302),j=a.i(393224),k=a.i(679496),l=a.i(951790),m=a.i(765918),n=a.i(244212),o=b([f,g,h]);[f,g,h]=o.then?(await o)():o,a.s(["useKOSync",0,a=>{let b=(0,i.useTranslation)(),{appService:c}=(0,e.useEnv)(),{settings:o}=(0,f.useSettingsStore)(),{getProgress:p,getView:q}=(0,g.useReaderStore)(),{getBookData:r}=(0,h.useBookDataStore)(),[s,t]=(0,d.useState)(null),[u,v]=(0,d.useState)("idle"),[w,x]=(0,d.useState)(null),[y]=(0,d.useState)(null),z=(0,d.useRef)(!1),A=p(a);(0,d.useEffect)(()=>{if(!o.kosync.username||!o.kosync.userkey)return void t(null);let a=new j.KOSyncClient(o.kosync);t(a)},[o]);let B=(0,d.useCallback)(()=>{let b,c=p(a),d=r(a)?.book;if(!c||!d)return null;let e="";if(k.FIXED_LAYOUT_FORMATS.has(d.format)){let a=c.section?.current??0,d=c.section?.total??0;e=a.toString(),b=d>0?(a+1)/d:0}else{let d=q(a),f=c.location;if(!d||!f)return null;try{let a=d.renderer.getContents()[0];if(a){let{doc:b,index:c}=a,d=new n.XCFI(b,c||0).cfiToXPointer(f);e=(0,n.normalizeProgressXPointer)(d.xpointer)}}catch(a){console.error("Failed to convert CFI to XPointer",a)}let g=c.pageinfo?.current??0,h=c.pageinfo?.total??0;b=h>0?(g+1)/h:0}return{koProgress:e,percentage:b}},[a,p,r,q]),C=async(c,d,e)=>{let f=q(a);if(k.FIXED_LAYOUT_FORMATS.has(c.format)){let a=parseInt(e.progress,10);if(isNaN(a))return;f?.select(a-1)}else{if(!e.progress?.startsWith("/body"))return;try{let a=f?.renderer.getContents()[0],b=(0,n.normalizeProgressXPointer)(e.progress),c=await (0,n.getCFIFromXPointer)(b,a?.doc,a?.index,d);f?.goTo(c)}catch(a){console.error("Failed to convert XPointer to CFI",a);return}}m.eventDispatcher.dispatch("toast",{message:b("Reading Progress Synced"),type:"info"})},D=async(a,c,d,e)=>{let f="",g="",h=e.percentage||0;if(k.FIXED_LAYOUT_FORMATS.has(a.format)){let a=d.section,c=a&&a.total>0?Math.round((a.current+1)/a.total*100):0;f=a?b("Page {{page}} of {{total}} ({{percentage}}%)",{page:a.current+1,total:a.total,percentage:c}):b("Current position");let i=parseInt(e.progress,10);if(!isNaN(i)&&h>0){let c=a?.total??0,d=Math.round(i/h);g=1>=Math.abs(c-d)?b("Page {{page}} of {{total}} ({{percentage}}%)",{page:i,total:d,percentage:Math.round(100*h)}):b("Approximately page {{page}} of {{total}} ({{percentage}}%)",{page:i,total:d,percentage:Math.round(100*h)})}else g=b("Approximately {{percentage}}%",{percentage:Math.round(100*h)})}else{let a=d.pageinfo,c=a&&a.total>0?Math.round((a.current+1)/a.total*100):0;f=`${d.sectionLabel} (${c}%)`,g=b("Approximately {{percentage}}%",{percentage:Math.round(100*h)})}x({book:a,bookDoc:c,local:{cfi:d.location,preview:f},remote:{...e,preview:g}})},E=(0,d.useMemo)(()=>(0,l.debounce)(async()=>{if(!a||!c||!s||!z.current)return;let{settings:b}=f.useSettingsStore.getState();if(["receive","disable"].includes(b.kosync.strategy))return;let d=r(a)?.book,e=B();d&&e&&e.koProgress&&await s.updateProgress(d,e.koProgress,e.percentage)},5e3),[a,c,s]),F=(0,d.useCallback)(async()=>{if(!A?.location||!c||!s)return;let b=r(a),d=b?.book,e=b?.bookDoc;if(!d||!e)return;let{strategy:f,enabled:g}=o.kosync;if(!g)return;if(z.current=!0,"send"===f)return void v("synced");v("checking");let h=await s.getProgress(d);if(!h||!h.progress)return void v("synced");let i=b?.config?.updatedAt||d.updatedAt,j=h.timestamp?1e3*h.timestamp:Date.now();"receive"===f||"silent"===f&&j>i?(C(d,e,h),v("synced")):"prompt"===f?(D(d,e,A,h),v("conflict")):v("synced")},[a,c,s,o.kosync,A]);(0,d.useEffect)(()=>{let b=b=>{b.detail.bookKey===a&&(E(),E.flush())},c=b=>{b.detail.bookKey===a&&E.flush()};return m.eventDispatcher.on("push-kosync",b),m.eventDispatcher.on("flush-kosync",c),()=>{m.eventDispatcher.off("push-kosync",b),m.eventDispatcher.off("flush-kosync",c),E.flush()}},[a,E]),(0,d.useEffect)(()=>{let b=b=>{b.detail.bookKey===a&&F()};return m.eventDispatcher.on("pull-kosync",b),()=>{m.eventDispatcher.off("pull-kosync",b)}},[a,F]),(0,d.useEffect)(()=>{c&&s&&A?.location&&(z.current||F())},[c,s,A?.location,E,F]),(0,d.useEffect)(()=>{if("synced"===u&&A){let{strategy:a,enabled:b}=o.kosync;"receive"!==a&&b&&E()}},[A,u,o.kosync,E]);let G=async()=>{let b=q(a),c=w?.remote,d=w?.book,e=w?.bookDoc;d&&e&&c&&c.progress&&b&&(C(d,e,c),v("synced"),x(null))};return{syncState:u,conflictDetails:w,errorMessage:y,pushProgress:E,pullProgress:F,resolveWithLocal:()=>{E(),E.flush(),v("synced"),x(null)},resolveWithRemote:G}}]),c()}catch(a){c(a)}},!1),740298,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(466759),f=a.i(866736),g=b([e,f]);[e,f]=g.then?(await g)():g,a.s(["useUICSS",0,a=>{let{settings:b}=(0,f.useSettingsStore)(),{getViewSettings:c}=(0,e.useReaderStore)(),g=c(a||""),[h,i]=(0,d.useState)(null);(0,d.useEffect)(()=>{h&&h.remove();let c=g?.userUIStylesheet||b?.globalViewSettings?.userUIStylesheet||"",d=document.createElement("style");return d.textContent=c.replace("foliate-view",`#foliate-view-${a}`),document.head.appendChild(d),i(d),()=>{d.remove()}},[g?.userUIStylesheet,b?.globalViewSettings?.userUIStylesheet,a])}]),c()}catch(a){c(a)}},!1),583697,a=>{"use strict";var b=a.i(654617),c=a.i(765918);let d=0,e=null,f={key:"",code:"",ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1},g=a=>a&&"ctrlKey"in a?{key:f.key,code:f.code,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey}:{...f},h=(a,b,c)=>{let d=b.targetTouches[0],e=[];d&&e.push({clientX:d.clientX,clientY:d.clientY,screenX:d.screenX,screenY:d.screenY}),window.postMessage({type:c,bookKey:a,timeStamp:Date.now(),targetTouches:e,...g(b)},"*")};a.s(["handleClick",0,(a,f,h)=>{let i=Date.now();if(!f.current&&i-d<b.DOUBLE_CLICK_INTERVAL_THRESHOLD_MS){d=i,window.postMessage({type:"iframe-double-click",bookKey:a,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY,offsetX:h.offsetX,offsetY:h.offsetY,...g(h)},"*");return}d=i;let j=()=>{let b=h.target;if(b?.closest("sup, a, audio, video")&&!b?.closest("a.duokan-footnote:not([href])"))return;let d=b?.closest(".js_readerFooterNote, .zhangyue-footnote, .duokan-footnote");d?c.eventDispatcher.dispatch("footnote-popup",{bookKey:a,element:d,footnote:d.getAttribute("data-wr-footernote")||d.getAttribute("zy-footnote")||d.getAttribute("alt")||b?.getAttribute("alt")||""}):e&&window.postMessage({type:"iframe-single-click",bookKey:a,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY,offsetX:h.offsetX,offsetY:h.offsetY,...g(h)},"*")};f.current?j():setTimeout(()=>{Date.now()-d>=b.DOUBLE_CLICK_INTERVAL_THRESHOLD_MS&&j()},b.DOUBLE_CLICK_INTERVAL_THRESHOLD_MS)},"handleKeydown",0,(a,b)=>{f={key:b.key,code:b.code,ctrlKey:b.ctrlKey,shiftKey:b.shiftKey,altKey:b.altKey,metaKey:b.metaKey},["Backspace"].includes(b.key)&&b.preventDefault(),window.postMessage({type:"iframe-keydown",bookKey:a,key:b.key,code:b.code,ctrlKey:b.ctrlKey,shiftKey:b.shiftKey,altKey:b.altKey,metaKey:b.metaKey},"*")},"handleKeyup",0,(a,b)=>{f={key:"",code:"",ctrlKey:b.ctrlKey,shiftKey:b.shiftKey,altKey:b.altKey,metaKey:b.metaKey},window.postMessage({type:"iframe-keyup",bookKey:a,key:b.key,code:b.code,ctrlKey:b.ctrlKey,shiftKey:b.shiftKey,altKey:b.altKey,metaKey:b.metaKey},"*")},"handleMousedown",0,(a,c)=>{e=setTimeout(()=>{e=null},b.LONG_HOLD_THRESHOLD),window.postMessage({type:"iframe-mousedown",bookKey:a,button:c.button,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY,offsetX:c.offsetX,offsetY:c.offsetY,...g(c)},"*")},"handleMouseup",0,(a,b)=>{[3,4].includes(b.button)&&b.preventDefault(),window.postMessage({type:"iframe-mouseup",bookKey:a,button:b.button,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,offsetX:b.offsetX,offsetY:b.offsetY,...g(b)},"*")},"handleTouchEnd",0,(a,b)=>{h(a,b,"iframe-touchend")},"handleTouchMove",0,(a,b)=>{h(a,b,"iframe-touchmove")},"handleTouchStart",0,(a,b)=>{h(a,b,"iframe-touchstart")},"handleWheel",0,(a,b)=>{window.postMessage({type:"iframe-wheel",bookKey:a,deltaMode:b.deltaMode,deltaX:b.deltaX,deltaY:b.deltaY,deltaZ:b.deltaZ,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,offsetX:b.offsetX,offsetY:b.offsetY,...g(b)},"*")}])},304495,a=>{"use strict";a.s(["footnoteTransformer",0,{name:"footnote",transform:async a=>{let b=a.content;return b.replace(/<aside\s+epub:type\s*=\s*["'](footnote|endnote|note|rearnote)["']([^>]*)>/gi,'<aside class="epubtype-footnote" epub:type="$1"$2>')}}])},891722,a=>a.a(async(b,c)=>{try{var d=a.i(890392),e=b([d]);[d]=e.then?(await e)():e,a.s(["languageTransformer",0,{name:"language",transform:async a=>{let b=a.primaryLanguage,c=a.content,e=c.match(/<html\b([^>]*)>/i);if(e){let a=e[1]||"",f=/ lang="([^"]*)"/i,g=/ xml:lang="([^"]*)"/i,h=a.match(g),i=a.match(f),j=i?.[1]||h?.[1];if(!(0,d.isValidLang)(j)||!(0,d.isSameLang)(j,b)){let j=c.replace(/<[^>]+>/g," "),k=(0,d.isValidLang)(b)&&"en"!==b?b:(0,d.detectLanguage)(j),l=(0,d.getLanguageInfo)(k||""),m=` lang="${k}"`,n=` xml:lang="${k}"`,o=l?.direction==="rtl"?' dir="rtl"':"";a=i?a.replace(f,m):a+m+o,a=h?a.replace(g,n):a+n+o,c=c.replace(e[0],`<html${a}>`)}}else{let a=(0,d.isValidLang)(b)&&"en"!==b?b:(0,d.detectLanguage)(c.replace(/<[^>]+>/g," ")),e=(0,d.getLanguageInfo)(a||""),f=e?.direction==="rtl"?' dir="rtl"':"",g=` lang="${a}" xml:lang="${a}" ${f}`;c=c.replace(/<html>/i,`<html${g}>`)}return c}}]),c()}catch(a){c(a)}},!1),125188,a=>{"use strict";let b={"":"","":"","":"","":"","":"","":"","":"","":""},c={"":"","":"","":"","":"","":"","":"","":"","":""},d={"":"","":"","":"","":"","":"","":"","":"","":""};a.s(["punctuationTransformer",0,{name:"punctuation",transform:async a=>{if(!a.viewSettings.replaceQuotationMarks)return a.content;let e=a.content,f=a.viewSettings.convertChineseVariant,g=a.reversePunctuationTransform||!1;if(f&&"none"!==f)for(let[a,b]of Object.entries(d)){let[c,d]=g!==f.includes("2s")?[b,a]:[a,b];e=e.replace(RegExp(c,"g"),d)}if(a.viewSettings.vertical){let d=["zh-Hant","zh-TW","zh_TW"],f=b;for(let[b,g]of((d.includes(a.primaryLanguage||"")||d.includes(a.userLocale))&&(f=c),Object.entries(f)))e=a.reversePunctuationTransform?e.replace(RegExp(g,"g"),b):e.replace(RegExp(b,"g"),g)}return e}}])},906181,a=>{"use strict";a.s(["whitespaceTransformer",0,{name:"whitespace",transform:async a=>a.viewSettings.overrideLayout?a.content.replace(/(&amp;)?&nbsp;/g,(a,b)=>b?a:" ").replace(/\u00A0/g," ").replace(/ {2,}/g," "):a.content}])},508657,a=>a.a(async(b,c)=>{try{let b=await a.y("dompurify");a.n(b),c()}catch(a){c(a)}},!0),515498,a=>a.a(async(b,c)=>{try{var d=a.i(508657),e=b([d]);[d]=e.then?(await e)():e,a.s(["sanitizerTransformer",0,{name:"sanitizer",transform:async a=>{if(a.viewSettings.allowScript)return a.content;let b=a.content.replaceAll("&nbsp;","&#160;"),c=d.default.sanitize(b,{WHOLE_DOCUMENT:!0,FORBID_TAGS:["script"],ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|blob|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ADD_TAGS:["link","meta"],ADD_ATTR:a=>["xmlns","http-equiv","content","charset","link","vlink","imt-state","data-wr-footernote","zy-footnote"].includes(a)||a.startsWith("xml:")||a.startsWith("xmlns:")||a.startsWith("epub:"),RETURN_DOM:!0}),e=new XMLSerializer().serializeToString(c);return e=e.replaceAll("&#160;","&nbsp;").replaceAll("","&nbsp;"),e=(e=(e='<?xml version="1.0" encoding="utf-8"?>'+e).replace(/(<head[^>]*>)/i,"\n$1")).replace(/(<\/body>)(<\/html>)/i,"$1\n$2")}}]),c()}catch(a){c(a)}},!1),923575,a=>{"use strict";var b=a.i(583840);a.s(["simpleccTransformer",0,{name:"simplecc",transform:async a=>{let c,d=a.viewSettings.convertChineseVariant;if(!d||"none"===d)return a.content;await (0,b.initSimpleCC)();let e=new DOMParser().parseFromString(a.content,"text/html"),f=document.createTreeWalker(e.body||e.documentElement,NodeFilter.SHOW_TEXT,{acceptNode:a=>{let b=a.parentElement;return b&&("SCRIPT"===b.tagName||"STYLE"===b.tagName)?NodeFilter.FILTER_REJECT:a.textContent?.trim()?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),g=[];for(;c=f.nextNode();)g.push(c);for(let a of g)a.textContent&&(a.textContent=(0,b.runSimpleCC)(a.textContent,d));return new XMLSerializer().serializeToString(e)}}])},735391,a=>a.a(async(b,c)=>{try{var d=a.i(173947),e=b([d]);[d]=e.then?(await e)():e,a.s(["styleTransformer",0,{name:"style",transform:async a=>{let b=a.content;for(let c of[...b.matchAll(/<style[^>]*>([\s\S]*?)<\/style>/gi)]){let[e,f]=c,g=await (0,d.transformStylesheet)(f,a.width||window.innerWidth,a.height||window.innerHeight,a.viewSettings.vertical);b=b.replace(e,`<style>${g}</style>`)}return b}}]),c()}catch(a){c(a)}},!1),757309,a=>a.a(async(b,c)=>{try{var d=a.i(887287),e=a.i(866736),f=b([e]);[e]=f.then?(await f)():f;let h=a=>/[\p{L}\p{N}_]/u.test(a||""),i="------------",j=a=>RegExp(`[${i}]`).test(a||"");function g(a,b,c){let d,e;if(!c.isRegex&&!(!1!==c.caseSensitive?b[0]===c.pattern:b[0].toLowerCase()===c.pattern.toLowerCase()))return!1;if(d=c.pattern,/[^\x00-\x7F]/.test(d)&&(e=c.pattern,!RegExp(`^[${i}]+$`).test(e))){let c=a[b.index-1]??"",d=a[b.index+b[0].length]??"";if(!j(c)&&!j(d)&&(h(c)||h(d)))return!1}return!0}a.s(["proofreadTransformer",0,{name:"proofread",transform:async(a,b)=>{let{docType:c="text/html",onlyForTTS:f=!1}=b||{},h=e.useSettingsStore.getState().settings?.globalViewSettings?.proofreadRules,i=a.viewSettings.proofreadRules,j=[...h??[],...i??[]].sort((a,b)=>(a.order??0)-(b.order??0));if(!j.length)return a.content;let k=j.filter(a=>a.enabled&&a.pattern.trim()).filter(a=>f?a.onlyForTTS:!a.onlyForTTS).map(a=>({...a,normalizedPattern:function(a,b,c=!0){let d=/[^\x00-\x7F]/.test(a),e=d?"ug":"g";if(c||(e+="i"),b)return{source:a.includes("\\b")||d?a:`\\b${a}\\b`,flags:e};let f=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(d)return{source:f,flags:e};let g=/^[^\w\s]/.test(a),h=/[^\w\s]$/.test(a);if(g||h){let b=a.match(/[\w]+/);if(!b)return{source:f,flags:e};let c=b[0],d=a.indexOf(c),g=d+c.length,h=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=f.substring(0,d),j=f.substring(g);return{source:`${i}\\b${h}\\b${j}`,flags:e}}return{source:`\\b${f}\\b`,flags:e}}(a.pattern,a.isRegex,!1!==a.caseSensitive)}));if(!k.length)return a.content;let l=new DOMParser().parseFromString(a.content,c),m=function(a){let b,c=document.createTreeWalker(a.body||a.documentElement,NodeFilter.SHOW_TEXT,{acceptNode:a=>{let b=a.parentElement;return b?.tagName==="SCRIPT"||b?.tagName==="STYLE"?NodeFilter.FILTER_REJECT:a.textContent?.trim()?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),d=[];for(;b=c.nextNode();)d.push(b);return d}(l),n={selection:k.filter(a=>"selection"===a.scope),book:k.filter(a=>"book"===a.scope),library:k.filter(a=>"library"===a.scope)};for(let b of[...n.selection,...n.book,...n.library]){if("selection"===b.scope){let c=b.sectionHref?.split("#")[0];if(a.sectionHref?.split("#")[0]!==c)continue}"selection"===b.scope?function(a,b){let c;try{c=new RegExp(b.normalizedPattern.source,b.normalizedPattern.flags)}catch{return}let e=d.parse(b.cfi);if(e.parent){e.parent.shift();let f=d.toRange(a,e);if(f){let a=f.startContainer,d=f.endContainer;if(a===d&&a.nodeType===Node.TEXT_NODE){let d=a.textContent||"",e=f.startOffset,h=f.endOffset,i=Math.max(0,e-32),j=Math.min(d.length,h+32),k=d.slice(i,j),l=d.slice(e,h),m=c.exec(k);if(m&&g(l,m,b)){let c=m.index,f=i+c,g=f+m[0].length;g>=e-32&&f<=h+32&&(a.textContent=d.slice(0,f)+b.replacement+d.slice(g))}}}}}(l,b):function(a,b){let c;try{c=new RegExp(b.normalizedPattern.source,b.normalizedPattern.flags)}catch{return}for(let d of a){let a;if(!d.textContent)continue;let e=d.textContent,f=[];for(;null!==(a=c.exec(e));)g(e,a,b)&&f.push({index:a.index,length:a[0].length});if(0!==f.length){for(let a=f.length-1;a>=0;a--){let c=f[a];e=e.slice(0,c.index)+b.replacement+e.slice(c.index+c.length)}d.textContent=e}}}(m,b)}return new XMLSerializer().serializeToString(l)}}]),c()}catch(a){c(a)}},!1),422036,a=>a.a(async(b,c)=>{try{var d=a.i(304495),e=a.i(891722),f=a.i(125188),g=a.i(906181),h=a.i(515498),i=a.i(923575),j=a.i(735391),k=a.i(757309),l=b([e,h,j,k]);[e,h,j,k]=l.then?(await l)():l;let m=[f.punctuationTransformer,d.footnoteTransformer,e.languageTransformer,j.styleTransformer,g.whitespaceTransformer,h.sanitizerTransformer,i.simpleccTransformer,k.proofreadTransformer];a.s(["availableTransformers",0,m]),c()}catch(a){c(a)}},!1),547105,a=>a.a(async(b,c)=>{try{var d=a.i(422036),e=b([d]);[d]=e.then?(await e)():e;let f=async a=>{let b=a.content;for(let c of a.transformers.map(a=>d.availableTransformers.find(b=>b.name===a)).filter(a=>!!a))try{b=await c.transform({...a,content:b})}catch(a){console.warn(`Error in transformer ${c.name}:`,a)}return b};a.s(["transformContent",0,f]),c()}catch(a){c(a)}},!1),170175,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(915302),g=a.i(862871),h=a.i(866736),i=a.i(452125),j=a.i(936114),k=a.i(765918),l=b([g,h,j]);[g,h,j]=l.then?(await l)():l,a.s(["useBookCoverAutoSave",0,a=>{let b=(0,f.useTranslation)(),{envConfig:c,appService:l}=(0,e.useEnv)(),m=(0,d.useCallback)((0,i.throttle)(()=>{setTimeout(async()=>{let d=h.useSettingsStore.getState().settings,e=g.useBookDataStore.getState().getBookData(a),f=e?.book,i=d.savedBookCoverForLockScreen,m=d.savedBookCoverForLockScreenPath;if(l&&f&&i&&i!==f?.hash){let a=await l.resolveFilePath((0,j.getCoverFilename)(f),"Books");try{let b="last-book-cover.png",e=await l.resolveFilePath("","Images");m&&m!==e?await l.copyFile(a,`${m}/${b}`,"None"):await l.copyFile(a,b,"Images"),d.savedBookCoverForLockScreen=f.hash,h.useSettingsStore.getState().setSettings(d),h.useSettingsStore.getState().saveSettings(c,d)}catch(a){k.eventDispatcher.dispatch("toast",{type:"error",message:b("Failed to auto-save book cover for lock screen: {{error}}",{error:a instanceof Error?a.message:String(a)})})}}},5e3)},5e3,{emitLast:!1}),[]);(0,d.useEffect)(()=>{m()},[])}]),c()}catch(a){c(a)}},!1),43913,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(687323),g=b([f]);[f]=g.then?(await g)():g,a.s(["useDiscordPresence",0,(a,b,c)=>{let{appService:g}=(0,e.useEnv)(),h=(0,d.useRef)(Date.now()),i=(0,d.useRef)(null),j=(0,d.useRef)(null),k=(0,d.useRef)(!1);(0,d.useEffect)(()=>{if(!b||!a||!g?.isDesktopApp)return;let d=()=>{i.current&&(clearInterval(i.current),i.current=null),k.current=!1};if(!c){d(),(0,f.clearDiscordPresence)(g),j.current=null;return}j.current!==a.hash&&(h.current=Date.now(),j.current=a.hash);let e=async()=>{if(!k.current){k.current=!0;try{await (0,f.updateDiscordPresence)(a,h.current,g)}catch(a){console.error("Discord presence update failed:",a)}finally{k.current=!1}}};return e(),i.current=setInterval(()=>{e()},15e3),()=>{d(),(0,f.clearDiscordPresence)(g)}},[a?.hash,b,c,g])}]),c()}catch(a){c(a)}},!1),79915,(a,b,c)=>{class d{constructor(a){void 0===a.data&&(a.data={}),this.data=a.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function e(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function f(a,...b){let c=Object.create(null);for(let b in a)c[b]=a[b];return b.forEach(function(a){for(let b in a)c[b]=a[b]}),c}class g{constructor(a,b){this.buffer="",this.classPrefix=b.classPrefix,a.walk(this)}addText(a){this.buffer+=e(a)}openNode(a){if(!a.scope)return;let b=((a,{prefix:b})=>{if(a.startsWith("language:"))return a.replace("language:","language-");if(a.includes(".")){let c=a.split(".");return[`${b}${c.shift()}`,...c.map((a,b)=>`${a}${"_".repeat(b+1)}`)].join(" ")}return`${b}${a}`})(a.scope,{prefix:this.classPrefix});this.span(b)}closeNode(a){a.scope&&(this.buffer+="</span>")}value(){return this.buffer}span(a){this.buffer+=`<span class="${a}">`}}let h=(a={})=>{let b={children:[]};return Object.assign(b,a),b};class i{constructor(){this.rootNode=h(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(a){this.top.children.push(a)}openNode(a){let b=h({scope:a});this.add(b),this.stack.push(b)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(a){return this.constructor._walk(a,this.rootNode)}static _walk(a,b){return"string"==typeof b?a.addText(b):b.children&&(a.openNode(b),b.children.forEach(b=>this._walk(a,b)),a.closeNode(b)),a}static _collapse(a){"string"==typeof a||a.children&&(a.children.every(a=>"string"==typeof a)?a.children=[a.children.join("")]:a.children.forEach(a=>{i._collapse(a)}))}}class j extends i{constructor(a){super(),this.options=a}addText(a){""!==a&&this.add(a)}startScope(a){this.openNode(a)}endScope(){this.closeNode()}__addSublanguage(a,b){let c=a.root;b&&(c.scope=`language:${b}`),this.add(c)}toHTML(){return new g(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function k(a){return a?"string"==typeof a?a:a.source:null}function l(a){return o("(?=",a,")")}function m(a){return o("(?:",a,")*")}function n(a){return o("(?:",a,")?")}function o(...a){return a.map(a=>k(a)).join("")}function p(...a){let b;return"("+(("object"==typeof(b=a[a.length-1])&&b.constructor===Object?(a.splice(a.length-1,1),b):{}).capture?"":"?:")+a.map(a=>k(a)).join("|")+")"}function q(a){return RegExp(a.toString()+"|").exec("").length-1}let r=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function s(a,{joinWith:b}){let c=0;return a.map(a=>{let b=c+=1,d=k(a),e="";for(;d.length>0;){let a=r.exec(d);if(!a){e+=d;break}e+=d.substring(0,a.index),d=d.substring(a.index+a[0].length),"\\"===a[0][0]&&a[1]?e+="\\"+String(Number(a[1])+b):(e+=a[0],"("===a[0]&&c++)}return e}).map(a=>`(${a})`).join(b)}let t="[a-zA-Z]\\w*",u="[a-zA-Z_]\\w*",v="\\b\\d+(\\.\\d+)?",w="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",x="\\b(0b[01]+)",y={begin:"\\\\[\\s\\S]",relevance:0},z=function(a,b,c={}){let d=f({scope:"comment",begin:a,end:b,contains:[]},c);d.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});let e=p("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return d.contains.push({begin:o(/[ ]+/,"(",e,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),d},A=z("//","$"),B=z("/\\*","\\*/"),C=z("#","$");var D=Object.freeze({__proto__:null,APOS_STRING_MODE:{scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[y]},BACKSLASH_ESCAPE:y,BINARY_NUMBER_MODE:{scope:"number",begin:x,relevance:0},BINARY_NUMBER_RE:x,COMMENT:z,C_BLOCK_COMMENT_MODE:B,C_LINE_COMMENT_MODE:A,C_NUMBER_MODE:{scope:"number",begin:w,relevance:0},C_NUMBER_RE:w,END_SAME_AS_BEGIN:function(a){return Object.assign(a,{"on:begin":(a,b)=>{b.data._beginMatch=a[1]},"on:end":(a,b)=>{b.data._beginMatch!==a[1]&&b.ignoreMatch()}})},HASH_COMMENT_MODE:C,IDENT_RE:t,MATCH_NOTHING_RE:/\b\B/,METHOD_GUARD:{begin:"\\.\\s*"+u,relevance:0},NUMBER_MODE:{scope:"number",begin:v,relevance:0},NUMBER_RE:v,PHRASAL_WORDS_MODE:{begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},QUOTE_STRING_MODE:{scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[y]},REGEXP_MODE:{scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[y,{begin:/\[/,end:/\]/,relevance:0,contains:[y]}]},RE_STARTERS_RE:"!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",SHEBANG:(a={})=>{let b=/^#![ ]*\//;return a.binary&&(a.begin=o(b,/.*\b/,a.binary,/\b.*/)),f({scope:"meta",begin:b,end:/$/,relevance:0,"on:begin":(a,b)=>{0!==a.index&&b.ignoreMatch()}},a)},TITLE_MODE:{scope:"title",begin:t,relevance:0},UNDERSCORE_IDENT_RE:u,UNDERSCORE_TITLE_MODE:{scope:"title",begin:u,relevance:0}});function E(a,b){"."===a.input[a.index-1]&&b.ignoreMatch()}function F(a,b){void 0!==a.className&&(a.scope=a.className,delete a.className)}function G(a,b){!b||a.beginKeywords&&(a.begin="\\b("+a.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",a.__beforeBegin=E,a.keywords=a.keywords||a.beginKeywords,delete a.beginKeywords,void 0===a.relevance&&(a.relevance=0))}function H(a,b){Array.isArray(a.illegal)&&(a.illegal=p(...a.illegal))}function I(a,b){if(a.match){if(a.begin||a.end)throw Error("begin & end are not supported with match");a.begin=a.match,delete a.match}}function J(a,b){void 0===a.relevance&&(a.relevance=1)}let K=(a,b)=>{if(!a.beforeMatch)return;if(a.starts)throw Error("beforeMatch cannot be used with starts");let c=Object.assign({},a);Object.keys(a).forEach(b=>{delete a[b]}),a.keywords=c.keywords,a.begin=o(c.beforeMatch,l(c.begin)),a.starts={relevance:0,contains:[Object.assign(c,{endsParent:!0})]},a.relevance=0,delete c.beforeMatch},L=["of","and","for","in","not","or","if","then","parent","list","value"],M={},N=a=>{console.error(a)},O=(a,...b)=>{console.log(`WARN: ${a}`,...b)},P=(a,b)=>{M[`${a}/${b}`]||(console.log(`Deprecated as of ${a}. ${b}`),M[`${a}/${b}`]=!0)},Q=Error();function R(a,b,{key:c}){let d=0,e=a[c],f={},g={};for(let a=1;a<=b.length;a++)g[a+d]=e[a],f[a+d]=!0,d+=q(b[a-1]);a[c]=g,a[c]._emit=f,a[c]._multi=!0}function S(a){if(a.scope&&"object"==typeof a.scope&&null!==a.scope&&(a.beginScope=a.scope,delete a.scope),"string"==typeof a.beginScope&&(a.beginScope={_wrap:a.beginScope}),"string"==typeof a.endScope&&(a.endScope={_wrap:a.endScope}),Array.isArray(a.begin)){if(a.skip||a.excludeBegin||a.returnBegin)throw N("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Q;if("object"!=typeof a.beginScope||null===a.beginScope)throw N("beginScope must be object"),Q;R(a,a.begin,{key:"beginScope"}),a.begin=s(a.begin,{joinWith:""})}if(Array.isArray(a.end)){if(a.skip||a.excludeEnd||a.returnEnd)throw N("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Q;if("object"!=typeof a.endScope||null===a.endScope)throw N("endScope must be object"),Q;R(a,a.end,{key:"endScope"}),a.end=s(a.end,{joinWith:""})}}class T extends Error{constructor(a,b){super(a),this.name="HTMLInjectionError",this.html=b}}let U=Symbol("nomatch"),V=function(a){let b=Object.create(null),c=Object.create(null),g=[],h=!0,i="Could not find the language '{}', did you forget to load/include a language module?",r={disableAutodetect:!0,name:"Plain text",contains:[]},t={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:j};function u(a){return t.noHighlightRe.test(a)}function v(a,b,c){let d="",e="";"object"==typeof b?(d=a,c=b.ignoreIllegals,e=b.language):(P("10.7.0","highlight(lang, code, ...args) has been deprecated."),P("10.7.0","Please use highlight(code, options) instead.\nhttps://github.com/highlightjs/highlight.js/issues/2277"),e=a,d=b),void 0===c&&(c=!0);let f={code:d,language:e};M("before:highlight",f);let g=f.result?f.result:w(f.language,f.code,c);return g.code=f.code,M("after:highlight",g),g}function w(a,c,g,j){let l=Object.create(null);function m(){if(!C.keywords)return void E.addText(O);let a=0;C.keywordPatternRe.lastIndex=0;let b=C.keywordPatternRe.exec(O),c="";for(;b;){c+=O.substring(a,b.index);let d=y.case_insensitive?b[0].toLowerCase():b[0],e=C.keywords[d];if(e){let[a,f]=e;if(E.addText(c),c="",l[d]=(l[d]||0)+1,l[d]<=7&&(P+=f),a.startsWith("_"))c+=b[0];else{let c=y.classNameAliases[a]||a;o(b[0],c)}}else c+=b[0];a=C.keywordPatternRe.lastIndex,b=C.keywordPatternRe.exec(O)}c+=O.substring(a),E.addText(c)}function n(){null!=C.subLanguage?function(){if(""===O)return;let a=null;if("string"==typeof C.subLanguage){if(!b[C.subLanguage])return E.addText(O);a=w(C.subLanguage,O,!0,D[C.subLanguage]),D[C.subLanguage]=a._top}else a=x(O,C.subLanguage.length?C.subLanguage:null);C.relevance>0&&(P+=a.relevance),E.__addSublanguage(a._emitter,a.language)}():m(),O=""}function o(a,b){""!==a&&(E.startScope(b),E.addText(a),E.endScope())}function p(a,b){let c=1,d=b.length-1;for(;c<=d;){if(!a._emit[c]){c++;continue}let d=y.classNameAliases[a[c]]||a[c],e=b[c];d?o(e,d):(O=e,m(),O=""),c++}}function r(a,b){return a.scope&&"string"==typeof a.scope&&E.openNode(y.classNameAliases[a.scope]||a.scope),a.beginScope&&(a.beginScope._wrap?(o(O,y.classNameAliases[a.beginScope._wrap]||a.beginScope._wrap),O=""):a.beginScope._multi&&(p(a.beginScope,b),O="")),C=Object.create(a,{parent:{value:C}})}let u={};function v(b,e){let f=e&&e[0];if(O+=b,null==f)return n(),0;if("begin"===u.type&&"end"===e.type&&u.index===e.index&&""===f){if(O+=c.slice(e.index,e.index+1),!h){let b=Error(`0 width match regex (${a})`);throw b.languageName=a,b.badRule=u.rule,b}return 1}if(u=e,"begin"===e.type){let a=e[0],b=e.rule,c=new d(b);for(let d of[b.__beforeBegin,b["on:begin"]])if(d&&(d(e,c),c.isMatchIgnored))return 0===C.matcher.regexIndex?(O+=a[0],1):(T=!0,0);return b.skip?O+=a:(b.excludeBegin&&(O+=a),n(),b.returnBegin||b.excludeBegin||(O=a)),r(b,e),b.returnBegin?0:a.length}if("illegal"!==e.type||g){if("end"===e.type){let a=function(a){let b=a[0],e=c.substring(a.index),f=function a(b,c,e){var f;let g,h=(f=b.endRe,(g=f&&f.exec(e))&&0===g.index);if(h){if(b["on:end"]){let a=new d(b);b["on:end"](c,a),a.isMatchIgnored&&(h=!1)}if(h){for(;b.endsParent&&b.parent;)b=b.parent;return b}}if(b.endsWithParent)return a(b.parent,c,e)}(C,a,e);if(!f)return U;let g=C;C.endScope&&C.endScope._wrap?(n(),o(b,C.endScope._wrap)):C.endScope&&C.endScope._multi?(n(),p(C.endScope,a)):g.skip?O+=b:(g.returnEnd||g.excludeEnd||(O+=b),n(),g.excludeEnd&&(O=b));do C.scope&&E.closeNode(),C.skip||C.subLanguage||(P+=C.relevance),C=C.parent;while(C!==f.parent)return f.starts&&r(f.starts,a),g.returnEnd?0:b.length}(e);if(a!==U)return a}}else{let a=Error('Illegal lexeme "'+f+'" for mode "'+(C.scope||"<unnamed>")+'"');throw a.mode=C,a}if("illegal"===e.type&&""===f)return O+="\n",1;if(R>1e5&&R>3*e.index)throw Error("potential infinite loop, way more iterations than matches");return O+=f,f.length}let y=B(a);if(!y)throw N(i.replace("{}",a)),Error('Unknown language: "'+a+'"');let z=function(a){function b(b,c){return RegExp(k(b),"m"+(a.case_insensitive?"i":"")+(a.unicodeRegex?"u":"")+(c?"g":""))}class c{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,b){b.position=this.position++,this.matchIndexes[this.matchAt]=b,this.regexes.push([b,a]),this.matchAt+=q(a)+1}compile(){0===this.regexes.length&&(this.exec=()=>null);let a=this.regexes.map(a=>a[1]);this.matcherRe=b(s(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;let b=this.matcherRe.exec(a);if(!b)return null;let c=b.findIndex((a,b)=>b>0&&void 0!==a),d=this.matchIndexes[c];return b.splice(0,c),Object.assign(b,d)}}class d{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];let b=new c;return this.rules.slice(a).forEach(([a,c])=>b.addRule(a,c)),b.compile(),this.multiRegexes[a]=b,b}resumingScanAtSamePosition(){return 0!==this.regexIndex}considerAll(){this.regexIndex=0}addRule(a,b){this.rules.push([a,b]),"begin"===b.type&&this.count++}exec(a){let b=this.getMatcher(this.regexIndex);b.lastIndex=this.lastIndex;let c=b.exec(a);if(this.resumingScanAtSamePosition())if(c&&c.index===this.lastIndex);else{let b=this.getMatcher(0);b.lastIndex=this.lastIndex+1,c=b.exec(a)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}if(a.compilerExtensions||(a.compilerExtensions=[]),a.contains&&a.contains.includes("self"))throw Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return a.classNameAliases=f(a.classNameAliases||{}),function c(e,g){let h;if(e.isCompiled)return e;[F,I,S,K].forEach(a=>a(e,g)),a.compilerExtensions.forEach(a=>a(e,g)),e.__beforeBegin=null,[G,H,J].forEach(a=>a(e,g)),e.isCompiled=!0;let i=null;return"object"==typeof e.keywords&&e.keywords.$pattern&&(e.keywords=Object.assign({},e.keywords),i=e.keywords.$pattern,delete e.keywords.$pattern),i=i||/\w+/,e.keywords&&(e.keywords=function a(b,c,d="keyword"){let e=Object.create(null);return"string"==typeof b?f(d,b.split(" ")):Array.isArray(b)?f(d,b):Object.keys(b).forEach(function(d){Object.assign(e,a(b[d],c,d))}),e;function f(a,b){c&&(b=b.map(a=>a.toLowerCase())),b.forEach(function(b){var c,d,f;let g=b.split("|");e[g[0]]=[a,(c=g[0],(d=g[1])?Number(d):+(f=c,!L.includes(f.toLowerCase())))]})}}(e.keywords,a.case_insensitive)),e.keywordPatternRe=b(i,!0),g&&(e.begin||(e.begin=/\B|\b/),e.beginRe=b(e.begin),e.end||e.endsWithParent||(e.end=/\B|\b/),e.end&&(e.endRe=b(e.end)),e.terminatorEnd=k(e.end)||"",e.endsWithParent&&g.terminatorEnd&&(e.terminatorEnd+=(e.end?"|":"")+g.terminatorEnd)),e.illegal&&(e.illegalRe=b(e.illegal)),e.contains||(e.contains=[]),e.contains=[].concat(...e.contains.map(function(a){var b;return((b="self"===a?e:a).variants&&!b.cachedVariants&&(b.cachedVariants=b.variants.map(function(a){return f(b,{variants:null},a)})),b.cachedVariants)?b.cachedVariants:!function a(b){return!!b&&(b.endsWithParent||a(b.starts))}(b)?Object.isFrozen(b)?f(b):b:f(b,{starts:b.starts?f(b.starts):null})})),e.contains.forEach(function(a){c(a,e)}),e.starts&&c(e.starts,g),h=new d,e.contains.forEach(a=>h.addRule(a.begin,{rule:a,type:"begin"})),e.terminatorEnd&&h.addRule(e.terminatorEnd,{type:"end"}),e.illegal&&h.addRule(e.illegal,{type:"illegal"}),e.matcher=h,e}(a)}(y),A="",C=j||z,D={},E=new t.__emitter(t),M=[];for(let a=C;a!==y;a=a.parent)a.scope&&M.unshift(a.scope);M.forEach(a=>E.openNode(a));let O="",P=0,Q=0,R=0,T=!1;try{if(y.__emitTokens)y.__emitTokens(c,E);else{for(C.matcher.considerAll();;){R++,T?T=!1:C.matcher.considerAll(),C.matcher.lastIndex=Q;let a=C.matcher.exec(c);if(!a)break;let b=c.substring(Q,a.index),d=v(b,a);Q=a.index+d}v(c.substring(Q))}return E.finalize(),A=E.toHTML(),{language:a,value:A,relevance:P,illegal:!1,_emitter:E,_top:C}}catch(b){if(b.message&&b.message.includes("Illegal"))return{language:a,value:e(c),illegal:!0,relevance:0,_illegalBy:{message:b.message,index:Q,context:c.slice(Q-100,Q+100),mode:b.mode,resultSoFar:A},_emitter:E};if(h)return{language:a,value:e(c),illegal:!1,relevance:0,errorRaised:b,_emitter:E,_top:C};throw b}}function x(a,c){let d;c=c||t.languages||Object.keys(b);let f=((d={value:e(a),illegal:!1,relevance:0,_top:r,_emitter:new t.__emitter(t)})._emitter.addText(a),d),g=c.filter(B).filter(E).map(b=>w(b,a,!1));g.unshift(f);let[h,i]=g.sort((a,b)=>{if(a.relevance!==b.relevance)return b.relevance-a.relevance;if(a.language&&b.language){if(B(a.language).supersetOf===b.language)return 1;else if(B(b.language).supersetOf===a.language)return -1}return 0});return h.secondBest=i,h}function y(a){var b;let d,e=function(a){let b=a.className+" ";b+=a.parentNode?a.parentNode.className:"";let c=t.languageDetectRe.exec(b);if(c){let b=B(c[1]);return b||(O(i.replace("{}",c[1])),O("Falling back to no-highlight mode for this block.",a)),b?c[1]:"no-highlight"}return b.split(/\s+/).find(a=>u(a)||B(a))}(a);if(u(e))return;if(M("before:highlightElement",{el:a,language:e}),a.dataset.highlighted)return void console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",a);if(a.children.length>0&&(t.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(a)),t.throwUnescapedHTML))throw new T("One of your code blocks includes unescaped HTML.",a.innerHTML);let f=a.textContent,g=e?v(f,{language:e,ignoreIllegals:!0}):x(f);a.innerHTML=g.value,a.dataset.highlighted="yes",b=g.language,d=e&&c[e]||b,a.classList.add("hljs"),a.classList.add(`language-${d}`),a.result={language:g.language,re:g.relevance,relevance:g.relevance},g.secondBest&&(a.secondBest={language:g.secondBest.language,relevance:g.secondBest.relevance}),M("after:highlightElement",{el:a,result:g,text:f})}let z=!1;function A(){if("loading"===document.readyState){z||window.addEventListener("DOMContentLoaded",function(){A()},!1),z=!0;return}document.querySelectorAll(t.cssSelector).forEach(y)}function B(a){return b[a=(a||"").toLowerCase()]||b[c[a]]}function C(a,{languageName:b}){"string"==typeof a&&(a=[a]),a.forEach(a=>{c[a.toLowerCase()]=b})}function E(a){let b=B(a);return b&&!b.disableAutodetect}function M(a,b){g.forEach(function(c){c[a]&&c[a](b)})}for(let d in Object.assign(a,{highlight:v,highlightAuto:x,highlightAll:A,highlightElement:y,highlightBlock:function(a){return P("10.7.0","highlightBlock will be removed entirely in v12.0"),P("10.7.0","Please use highlightElement now."),y(a)},configure:function(a){t=f(t,a)},initHighlighting:()=>{A(),P("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")},initHighlightingOnLoad:function(){A(),P("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")},registerLanguage:function(c,d){let e=null;try{e=d(a)}catch(a){if(N("Language definition for '{}' could not be registered.".replace("{}",c)),h)N(a);else throw a;e=r}e.name||(e.name=c),b[c]=e,e.rawDefinition=d.bind(null,a),e.aliases&&C(e.aliases,{languageName:c})},unregisterLanguage:function(a){for(let d of(delete b[a],Object.keys(c)))c[d]===a&&delete c[d]},listLanguages:function(){return Object.keys(b)},getLanguage:B,registerAliases:C,autoDetection:E,inherit:f,addPlugin:function(a){var b;(b=a)["before:highlightBlock"]&&!b["before:highlightElement"]&&(b["before:highlightElement"]=a=>{b["before:highlightBlock"](Object.assign({block:a.el},a))}),b["after:highlightBlock"]&&!b["after:highlightElement"]&&(b["after:highlightElement"]=a=>{b["after:highlightBlock"](Object.assign({block:a.el},a))}),g.push(a)},removePlugin:function(a){let b=g.indexOf(a);-1!==b&&g.splice(b,1)}}),a.debugMode=function(){h=!1},a.safeMode=function(){h=!0},a.versionString="11.11.1",a.regex={concat:o,lookahead:l,either:p,optional:n,anyNumberOfTimes:m},D)"object"==typeof D[d]&&function a(b){return b instanceof Map?b.clear=b.delete=b.set=function(){throw Error("map is read-only")}:b instanceof Set&&(b.add=b.clear=b.delete=function(){throw Error("set is read-only")}),Object.freeze(b),Object.getOwnPropertyNames(b).forEach(c=>{let d=b[c],e=typeof d;"object"!==e&&"function"!==e||Object.isFrozen(d)||a(d)}),b}(D[d]);return Object.assign(a,D),a},W=V({});W.newInstance=()=>V({}),b.exports=W,W.HighlightJS=W,W.default=W},744140,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=b.concat(/[\p{L}_]/u,b.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),d={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},e={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},f=a.inherit(e,{begin:/\(/,end:/\)/}),g=a.inherit(a.APOS_STRING_MODE,{className:"string"}),h=a.inherit(a.QUOTE_STRING_MODE,{className:"string"}),i={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:/[\p{L}0-9._:-]+/u,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/,contains:[d]},{begin:/'/,end:/'/,contains:[d]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,unicodeRegex:!0,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[e,h,g,f,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[e,f,h,g]}]}]},a.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},d,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[h]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[i],starts:{end:/<\/style>/,returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[i],starts:{end:/<\/script>/,returnEnd:!0,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:b.concat(/</,b.lookahead(b.concat(c,b.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:c,relevance:0,starts:i}]},{className:"tag",begin:b.concat(/<\//,b.lookahead(b.concat(c,/>/))),contains:[{className:"name",begin:c,relevance:0},{begin:/>/,relevance:0,endsParent:!0}]}]}}},74304,(a,b,c)=>{b.exports=function(a){let b=a.regex,c={};Object.assign(c,{className:"variable",variants:[{begin:b.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},{begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[c]}]}]});let d={className:"subst",begin:/\$\(/,end:/\)/,contains:[a.BACKSLASH_ESCAPE]},e=a.inherit(a.COMMENT(),{match:[/(^|\s)/,/#.*$/],scope:{2:"comment"}}),f={begin:/<<-?\s*(?=\w+)/,starts:{contains:[a.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},g={className:"string",begin:/"/,end:/"/,contains:[a.BACKSLASH_ESCAPE,c,d]};d.contains.push(g);let h={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},a.NUMBER_MODE,c]},i=a.SHEBANG({binary:"(fish|bash|zsh|sh|csh|ksh|tcsh|dash|scsh)",relevance:10}),j={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:!0,contains:[a.inherit(a.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0};return{name:"Bash",aliases:["sh","zsh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:["if","then","else","elif","fi","time","for","while","until","in","do","done","case","esac","coproc","function","select"],literal:["true","false"],built_in:["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset","alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","sudo","type","typeset","ulimit","unalias","set","shopt","autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp","chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"]},contains:[i,a.SHEBANG(),j,h,e,f,{match:/(\/[a-z._-]+)+/},g,{match:/\\"/},{className:"string",begin:/'/,end:/'/},{match:/\\'/},c]}}},282403,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=a.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),d="decltype\\(auto\\)",e="[a-zA-Z_]\\w*::",f="("+d+"|"+b.optional(e)+"[a-zA-Z_]\\w*"+b.optional("<[^<>]+>")+")",g={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},h={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[a.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'(\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)|.)",end:"'",illegal:"."},a.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},i={className:"number",variants:[{match:/\b(0b[01']+)/},{match:/(-?)\b([\d']+(\.[\d']*)?|\.[\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)/},{match:/(-?)\b(0[xX][a-fA-F0-9]+(?:'[a-fA-F0-9]+)*(?:\.[a-fA-F0-9]*(?:'[a-fA-F0-9]*)*)?(?:[pP][-+]?[0-9]+)?(l|L)?(u|U)?)/},{match:/(-?)\b\d+(?:'\d+)*(?:\.\d*(?:'\d*)*)?(?:[eE][-+]?\d+)?/}],relevance:0},j={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef elifdef elifndef include"},contains:[{begin:/\\\n/,relevance:0},a.inherit(h,{className:"string"}),{className:"string",begin:/<.*?>/},c,a.C_BLOCK_COMMENT_MODE]},k={className:"title",begin:b.optional(e)+a.IDENT_RE,relevance:0},l=b.optional(e)+a.IDENT_RE+"\\s*\\(",m={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","typeof","typeof_unqual","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_BitInt","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal96","_Decimal128","_Decimal64x","_Decimal128x","_Float16","_Float32","_Float64","_Float128","_Float32x","_Float64x","_Float128x","const","static","constexpr","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},n=[j,g,c,a.C_BLOCK_COMMENT_MODE,i,h],o={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:m,contains:n.concat([{begin:/\(/,end:/\)/,keywords:m,contains:n.concat(["self"]),relevance:0}]),relevance:0},p={begin:"("+f+"[\\*&\\s]+)+"+l,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:m,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:d,keywords:m,relevance:0},{begin:l,returnBegin:!0,contains:[a.inherit(k,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:m,relevance:0,contains:[c,a.C_BLOCK_COMMENT_MODE,h,i,g,{begin:/\(/,end:/\)/,keywords:m,relevance:0,contains:["self",c,a.C_BLOCK_COMMENT_MODE,h,i,g]}]},g,c,a.C_BLOCK_COMMENT_MODE,j]};return{name:"C",aliases:["h"],keywords:m,disableAutodetect:!0,illegal:"</",contains:[].concat(o,p,n,[j,{begin:a.IDENT_RE+"::",keywords:m},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},a.TITLE_MODE]}]),exports:{preprocessor:j,strings:h,keywords:m}}}},912715,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=a.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),d="decltype\\(auto\\)",e="[a-zA-Z_]\\w*::",f="(?!struct)("+d+"|"+b.optional(e)+"[a-zA-Z_]\\w*"+b.optional("<[^<>]+>")+")",g={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},h={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[a.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'(\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)|.)",end:"'",illegal:"."},a.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},i={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},j={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},a.inherit(h,{className:"string"}),{className:"string",begin:/<.*?>/},c,a.C_BLOCK_COMMENT_MODE]},k={className:"title",begin:b.optional(e)+a.IDENT_RE,relevance:0},l=b.optional(e)+a.IDENT_RE+"\\s*\\(",m={type:["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],keyword:["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"]},n={className:"function.dispatch",relevance:0,keywords:{_hint:["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"]},begin:b.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,a.IDENT_RE,b.lookahead(/(<[^<>]+>|)\s*\(/))},o=[n,j,g,c,a.C_BLOCK_COMMENT_MODE,i,h],p={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:m,contains:o.concat([{begin:/\(/,end:/\)/,keywords:m,contains:o.concat(["self"]),relevance:0}]),relevance:0},q={className:"function",begin:"("+f+"[\\*&\\s]+)+"+l,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:m,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:d,keywords:m,relevance:0},{begin:l,returnBegin:!0,contains:[k],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[h,i]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:m,relevance:0,contains:[c,a.C_BLOCK_COMMENT_MODE,h,i,g,{begin:/\(/,end:/\)/,keywords:m,relevance:0,contains:["self",c,a.C_BLOCK_COMMENT_MODE,h,i,g]}]},g,c,a.C_BLOCK_COMMENT_MODE,j]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:m,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(p,q,n,o,[j,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:m,contains:["self",g]},{begin:a.IDENT_RE+"::",keywords:m},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}},215486,(a,b,c)=>{b.exports=function(a){let b={keyword:["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"].concat(["add","alias","and","ascending","args","async","await","by","descending","dynamic","equals","file","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","record","remove","required","scoped","select","set","unmanaged","value|0","var","when","where","with","yield"]),built_in:["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],literal:["default","false","null","true"]},c=a.inherit(a.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),d={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},e={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},f=a.inherit(e,{illegal:/\n/}),g={className:"subst",begin:/\{/,end:/\}/,keywords:b},h=a.inherit(g,{illegal:/\n/}),i={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},a.BACKSLASH_ESCAPE,h]},j={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},g]},k=a.inherit(j,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},h]});g.contains=[j,i,e,a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,d,a.C_BLOCK_COMMENT_MODE],h.contains=[k,i,f,a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,d,a.inherit(a.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];let l={variants:[{className:"string",begin:/"""("*)(?!")(.|\n)*?"""\1/,relevance:1},j,i,e,a.APOS_STRING_MODE,a.QUOTE_STRING_MODE]},m={begin:"<",end:">",contains:[{beginKeywords:"in out"},c]},n=a.IDENT_RE+"(<"+a.IDENT_RE+"(\\s*,\\s*"+a.IDENT_RE+")*>)?(\\[\\])?",o={begin:"@"+a.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:b,illegal:/::/,contains:[a.COMMENT("///","$",{returnBegin:!0,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},l,d,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},c,m,a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[c,a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[c,m,a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:!0,end:"\\]",excludeEnd:!0,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+n+"\\s+)+"+a.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,end:/\s*[{;=]/,excludeEnd:!0,keywords:b,contains:[{beginKeywords:"public private protected static internal protected abstract async extern override unsafe virtual new sealed partial",relevance:0},{begin:a.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,contains:[a.TITLE_MODE,m],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:b,relevance:0,contains:[l,d,a.C_BLOCK_COMMENT_MODE]},a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE]},o]}}},915344,(a,b,c)=>{let d=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video","defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],e=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),f=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),g=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),h=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();b.exports=function(a){let b=a.regex,c={IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:a.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[a.APOS_STRING_MODE,a.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:a.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}},i=[a.APOS_STRING_MODE,a.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:!0,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[c.BLOCK_COMMENT,{begin:/-(webkit|moz|ms|o)-(?=[a-z])/},c.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\.[a-zA-Z-][a-zA-Z0-9_-]*",relevance:0},c.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+f.join("|")+")"},{begin:":(:)?("+g.join("|")+")"}]},c.CSS_VARIABLE,{className:"attribute",begin:"\\b("+h.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[c.BLOCK_COMMENT,c.HEXCOLOR,c.IMPORTANT,c.CSS_NUMBER_MODE,...i,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...i,{className:"string",begin:/[^)]/,endsWithParent:!0,excludeEnd:!0}]},c.FUNCTION_DISPATCH]},{begin:b.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:/@-?\w[\w]*(-\w+)*/},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:"and or not only",attribute:e.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...i,c.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+d.join("|")+")\\b"}]}}},283539,(a,b,c)=>{b.exports=function(a){let b=a.regex,c={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},d={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:b.concat(/\[.+?\]\(/,/[A-Za-z][A-Za-z0-9+.-]*/,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:!0,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}]},e={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},f={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},g=a.inherit(e,{contains:[]}),h=a.inherit(f,{contains:[]});e.contains.push(h),f.contains.push(g);let i=[c,d];return[e,f,g,h].forEach(a=>{a.contains=a.contains.concat(i)}),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:i=i.concat(e,f)},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:i}]}]},c,{className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:!0},e,f,{className:"quote",begin:"^>\\s+",contains:i,end:"$"},{className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},{begin:"^[-\\*]{3,}",end:"$"},d,{begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]},{scope:"literal",match:/&([a-zA-Z0-9]+|#[0-9]{1,7}|#[Xx][0-9a-fA-F]{1,6});/}]}}},336141,(a,b,c)=>{b.exports=function(a){let b=a.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:b.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:b.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}},721196,(a,b,c)=>{b.exports=function(a){let b=a.regex,c="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",d=b.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),e=b.concat(d,/(::\w+)*/),f={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield","include","extend","prepend","public","private","protected","raise","throw"],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},g={className:"doctag",begin:"@[A-Za-z]+"},h={begin:"#<",end:">"},i=[a.COMMENT("#","$",{contains:[g]}),a.COMMENT("^=begin","^=end",{contains:[g],relevance:10}),a.COMMENT("^__END__",a.MATCH_NOTHING_RE)],j={className:"subst",begin:/#\{/,end:/\}/,keywords:f},k={className:"string",contains:[a.BACKSLASH_ESCAPE,j],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:b.concat(/<<[-~]?'?/,b.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[a.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[a.BACKSLASH_ESCAPE,j]})]}]},l="[0-9](_?[0-9])*",m={className:"number",relevance:0,variants:[{begin:`\\b([1-9](_?[0-9])*|0)(\\.(${l}))?([eE][+-]?(${l})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},n={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:!0,endsParent:!0,keywords:f}]},o=[k,{variants:[{match:[/class\s+/,e,/\s+<\s+/,e]},{match:[/\b(class|module)\s+/,e]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:f},{match:[/(include|extend)\s+/,e],scope:{2:"title.class"},keywords:f},{relevance:0,match:[e,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:d,scope:"title.class"},{match:[/def/,/\s+/,c],scope:{1:"keyword",3:"title.function"},contains:[n]},{begin:a.IDENT_RE+"::"},{className:"symbol",begin:a.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[k,{begin:c}],relevance:0},m,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|(?!=)/,end:/\|/,excludeBegin:!0,excludeEnd:!0,relevance:0,keywords:f},{begin:"("+a.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[a.BACKSLASH_ESCAPE,j],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(h,i),relevance:0}].concat(h,i);j.contains=o,n.contains=o;let p=[{begin:/^\s*=>/,starts:{end:"$",contains:o}},{className:"meta.prompt",begin:"^([>?]>|[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]|(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>)(?=[ ])",starts:{end:"$",keywords:f,contains:o}}];return i.unshift(h),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:f,illegal:/\/\*/,contains:[a.SHEBANG({binary:"ruby"})].concat(p).concat(i).concat(o)}}},805380,(a,b,c)=>{b.exports=function(a){let b={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:b,illegal:"</",contains:[a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,{className:"string",variants:[a.QUOTE_STRING_MODE,a.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{match:/-?\b0[xX]\.[a-fA-F0-9](_?[a-fA-F0-9])*[pP][+-]?\d(_?\d)*i?/,relevance:0},{match:/-?\b0[xX](_?[a-fA-F0-9])+((\.([a-fA-F0-9](_?[a-fA-F0-9])*)?)?[pP][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b0[oO](_?[0-7])*i?/,relevance:0},{match:/-?\.\d(_?\d)*([eE][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b\d(_?\d)*(\.(\d(_?\d)*)?)?([eE][+-]?\d(_?\d)*)?i?/,relevance:0}]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:!0,contains:[a.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:b,illegal:/["']/}]}]}}},375628,(a,b,c)=>{b.exports=function(a){let b=a.regex;return{name:"GraphQL",aliases:["gql"],case_insensitive:!0,disableAutodetect:!1,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[a.HASH_COMMENT_MODE,a.QUOTE_STRING_MODE,a.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:!0,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:!0},{scope:"symbol",begin:b.concat(/[_A-Za-z][_0-9A-Za-z]*/,b.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}},749917,(a,b,c)=>{b.exports=function(a){let b=a.regex,c={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:a.NUMBER_RE}]},d=a.COMMENT();d.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];let e={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},f={className:"literal",begin:/\bon|off|true|false|yes|no\b/},g={className:"string",contains:[a.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},h=b.either(/[A-Za-z0-9_-]+/,/"(\\"|[^"])*"/,/'[^']*'/);return{name:"TOML, also INI",aliases:["toml"],case_insensitive:!0,illegal:/\S/,contains:[d,{className:"section",begin:/\[+/,end:/\]+/},{begin:b.concat(h,"(\\s*\\.\\s*",h,")*",b.lookahead(/\s*=\s*[^#\s]/)),className:"attr",starts:{end:/$/,contains:[d,{begin:/\[/,end:/\]/,contains:[d,f,e,g,c,"self"],relevance:0},f,e,g,c]}}]}}},222321,(a,b,c)=>{var d="[0-9](_*[0-9])*",e=`\\.(${d})`,f="[0-9a-fA-F](_*[0-9a-fA-F])*",g={className:"number",variants:[{begin:`(\\b(${d})((${e})|\\.)?|(${e}))[eE][+-]?(${d})[fFdD]?\\b`},{begin:`\\b(${d})((${e})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${e})[fFdD]?\\b`},{begin:`\\b(${d})[fFdD]\\b`},{begin:`\\b0[xX]((${f})\\.?|(${f})?\\.(${f}))[pP][+-]?(${d})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${f})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};b.exports=function(a){let b=a.regex,c="[-a-zA-Z_$][-a-zA-Z_$0-9]*",d=c+function a(b,c,d){return -1===d?"":b.replace(c,e=>a(b,c,d-1))}("(?:<"+c+"~~~(?:\\s*,\\s*"+c+"~~~)*>)?",/~~~/g,2),e={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits","goto","when"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},f={className:"meta",begin:"@"+c,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},h={className:"params",begin:/\(/,end:/\)/,keywords:e,relevance:0,contains:[a.C_BLOCK_COMMENT_MODE],endsParent:!0};return{name:"Java",aliases:["jsp"],keywords:e,illegal:/<\/|#/,contains:[a.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[a.BACKSLASH_ESCAPE]},a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,c],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[b.concat(/(?!else)/,c),/\s+/,c,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,c],className:{1:"keyword",3:"title.class"},contains:[h,a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+d+"\\s+)",a.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:e,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:e,relevance:0,contains:[f,a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,g,a.C_BLOCK_COMMENT_MODE]},a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE]},g,f]}}},404970,(a,b,c)=>{let d="[A-Za-z$_][0-9A-Za-z$_]*",e=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],f=["true","false","null","undefined","NaN","Infinity"],g=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],h=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],i=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],j=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],k=[].concat(i,g,h);b.exports=function(a){var b;let c=a.regex,l=/<[A-Za-z0-9\\._:-]+/,m=/\/[A-Za-z0-9\\._:-]+>|\/>/,n={$pattern:d,keyword:e,literal:f,built_in:k,"variable.language":j},o="[0-9](_?[0-9])*",p=`\\.(${o})`,q="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",r={className:"number",variants:[{begin:`(\\b(${q})((${p})|\\.)?|(${p}))[eE][+-]?(${o})\\b`},{begin:`\\b(${q})\\b((${p})\\b|\\.)?|(${p})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},s={className:"subst",begin:"\\$\\{",end:"\\}",keywords:n,contains:[]},t={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[a.BACKSLASH_ESCAPE,s],subLanguage:"xml"}},u={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[a.BACKSLASH_ESCAPE,s],subLanguage:"css"}},v={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[a.BACKSLASH_ESCAPE,s],subLanguage:"graphql"}},w={className:"string",begin:"`",end:"`",contains:[a.BACKSLASH_ESCAPE,s]},x={className:"comment",variants:[a.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:d+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),a.C_BLOCK_COMMENT_MODE,a.C_LINE_COMMENT_MODE]},y=[a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,t,u,v,w,{match:/\$\d+/},r];s.contains=y.concat({begin:/\{/,end:/\}/,keywords:n,contains:["self"].concat(y)});let z=[].concat(x,s.contains),A=z.concat([{begin:/(\s*)\(/,end:/\)/,keywords:n,contains:["self"].concat(z)}]),B={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:n,contains:A},C={variants:[{match:[/class/,/\s+/,d,/\s+/,/extends/,/\s+/,c.concat(d,"(",c.concat(/\./,d),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,d],scope:{1:"keyword",3:"title.class"}}]},D={relevance:0,match:c.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...g,...h]}},E={match:c.concat(/\b/,(b=[...i,"super","import"].map(a=>`${a}\\s*\\(`),c.concat("(?!",b.join("|"),")")),d,c.lookahead(/\s*\(/)),className:"title.function",relevance:0},F={begin:c.concat(/\./,c.lookahead(c.concat(d,/(?![0-9A-Za-z$_(])/))),end:d,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},G="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+a.UNDERSCORE_IDENT_RE+")\\s*=>",H={match:[/const|var|let/,/\s+/,d,/\s*/,/=\s*/,/(async\s*)?/,c.lookahead(G)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[B]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:n,exports:{PARAMS_CONTAINS:A,CLASS_REFERENCE:D},illegal:/#(?![$_A-z])/,contains:[a.SHEBANG({label:"shebang",binary:"node",relevance:5}),{label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,t,u,v,w,x,{match:/\$\d+/},r,D,{scope:"attr",match:d+c.lookahead(":"),relevance:0},H,{begin:"("+a.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[x,a.REGEXP_MODE,{className:"function",begin:G,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:a.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:n,contains:A}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:"<>",end:"</>"},{match:/<[A-Za-z0-9\\._:-]+\s*\/>/},{begin:l,"on:begin":(a,b)=>{let c,d=a[0].length+a.index,e=a.input[d];if("<"===e||","===e)return void b.ignoreMatch();">"!==e||((a,{after:b})=>{let c="</"+a[0].slice(1);return -1!==a.input.indexOf(c,b)})(a,{after:d})||b.ignoreMatch();let f=a.input.substring(d);if((c=f.match(/^\s*=/))||(c=f.match(/^\s+extends\s+/))&&0===c.index)return void b.ignoreMatch()},end:m}],subLanguage:"xml",contains:[{begin:l,end:m,skip:!0,contains:["self"]}]}]},{variants:[{match:[/function/,/\s+/,d,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[B],illegal:/%/},{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+a.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[B,a.inherit(a.TITLE_MODE,{begin:d,className:"title.function"})]},{match:/\.\.\./,relevance:0},F,{match:"\\$"+d,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[B]},E,{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},C,{match:[/get|set/,/\s+/,d,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},B]},{match:/\$[(.]/}]}}},227828,(a,b,c)=>{b.exports=function(a){let b=["true","false","null"],c={scope:"literal",beginKeywords:b.join(" ")};return{name:"JSON",aliases:["jsonc"],keywords:{literal:b},contains:[{className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},{match:/[{}[\],:]/,className:"punctuation",relevance:0},a.QUOTE_STRING_MODE,c,a.C_NUMBER_MODE,a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}},415624,(a,b,c)=>{var d="[0-9](_*[0-9])*",e=`\\.(${d})`,f="[0-9a-fA-F](_*[0-9a-fA-F])*",g={className:"number",variants:[{begin:`(\\b(${d})((${e})|\\.)?|(${e}))[eE][+-]?(${d})[fFdD]?\\b`},{begin:`\\b(${d})((${e})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${e})[fFdD]?\\b`},{begin:`\\b(${d})[fFdD]\\b`},{begin:`\\b0[xX]((${f})\\.?|(${f})?\\.(${f}))[pP][+-]?(${d})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${f})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};b.exports=function(a){let b={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},c={className:"symbol",begin:a.UNDERSCORE_IDENT_RE+"@"},d={className:"subst",begin:/\$\{/,end:/\}/,contains:[a.C_NUMBER_MODE]},e={className:"variable",begin:"\\$"+a.UNDERSCORE_IDENT_RE},f={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[e,d]},{begin:"'",end:"'",illegal:/\n/,contains:[a.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[a.BACKSLASH_ESCAPE,e,d]}]};d.contains.push(f);let h={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+a.UNDERSCORE_IDENT_RE+")?"},i={className:"meta",begin:"@"+a.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[a.inherit(f,{className:"string"}),"self"]}]},j=a.COMMENT("/\\*","\\*/",{contains:[a.C_BLOCK_COMMENT_MODE]}),k={variants:[{className:"type",begin:a.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]};return k.variants[1].contains=[k],k.variants[1].contains=[k],{name:"Kotlin",aliases:["kt","kts"],keywords:b,contains:[a.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),a.C_LINE_COMMENT_MODE,j,{className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},c,h,i,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:!0,excludeEnd:!0,keywords:b,relevance:5,contains:[{begin:a.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:!0,relevance:0,contains:[a.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:b,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:!0,contains:[k,a.C_LINE_COMMENT_MODE,j],relevance:0},a.C_LINE_COMMENT_MODE,j,h,i,f,a.C_NUMBER_MODE]},j]},{begin:[/class|interface|trait/,/\s+/,a.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:!0,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},a.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:!0,returnEnd:!0},h,i]},f,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:"\n"},g]}}},169349,(a,b,c)=>{let d=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video","defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],e=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),f=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),g=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),h=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse(),i=f.concat(g).sort().reverse();b.exports=function(a){let b={IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:a.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[a.APOS_STRING_MODE,a.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:a.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}},c="[\\w-]+",j="("+c+"|@\\{"+c+"\\})",k=[],l=[],m=function(a){return{className:"string",begin:"~?"+a+".*?"+a}},n=function(a,b,c){return{className:a,begin:b,relevance:c}},o={$pattern:/[a-z-]+/,keyword:"and or not only",attribute:e.join(" ")};l.push(a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,m("'"),m('"'),b.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:!0}},b.HEXCOLOR,{begin:"\\(",end:"\\)",contains:l,keywords:o,relevance:0},n("variable","@@?"+c,10),n("variable","@\\{"+c+"\\}"),n("built_in","~?`[^`]*?`"),{className:"attribute",begin:c+"\\s*:",end:":",returnBegin:!0,excludeEnd:!0},b.IMPORTANT,{beginKeywords:"and not"},b.FUNCTION_DISPATCH);let p=l.concat({begin:/\{/,end:/\}/,contains:k}),q={beginKeywords:"when",endsWithParent:!0,contains:[{beginKeywords:"and not"}].concat(l)},r={begin:j+"\\s*:",returnBegin:!0,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},b.CSS_VARIABLE,{className:"attribute",begin:"\\b("+h.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:!0,illegal:"[<=$]",relevance:0,contains:l}}]},s={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:j,end:/\{/}],returnBegin:!0,returnEnd:!0,illegal:"[<='$\"]",relevance:0,contains:[a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,q,n("keyword","all\\b"),n("variable","@\\{"+c+"\\}"),{begin:"\\b("+d.join("|")+")\\b",className:"selector-tag"},b.CSS_NUMBER_MODE,n("selector-tag",j,0),n("selector-id","#"+j),n("selector-class","\\."+j,0),n("selector-tag","&",0),b.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+f.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+g.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:p},{begin:"!important"},b.FUNCTION_DISPATCH]},t={begin:c+":(:)?"+`(${i.join("|")})`,returnBegin:!0,contains:[s]};return k.push(a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,{className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:o,returnEnd:!0,contains:l,relevance:0}},{className:"variable",variants:[{begin:"@"+c+"\\s*:",relevance:15},{begin:"@"+c}],starts:{end:"[;}]",returnEnd:!0,contains:p}},t,r,s,q,b.FUNCTION_DISPATCH),{name:"Less",case_insensitive:!0,illegal:"[=>'/<($\"]",contains:k}}},248722,(a,b,c)=>{b.exports=function(a){let b="\\[=*\\[",c="\\]=*\\]",d={begin:b,end:c,contains:["self"]},e=[a.COMMENT("--(?!"+b+")","$"),a.COMMENT("--"+b,c,{contains:[d],relevance:10})];return{name:"Lua",aliases:["pluto"],keywords:{$pattern:a.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:e.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[a.inherit(a.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:!0,contains:e}].concat(e)},a.C_NUMBER_MODE,a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,{className:"string",begin:b,end:c,contains:[d],relevance:5}])}}},562065,(a,b,c)=>{b.exports=function(a){let b={className:"variable",variants:[{begin:"\\$\\("+a.UNDERSCORE_IDENT_RE+"\\)",contains:[a.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},c={className:"string",begin:/"/,end:/"/,contains:[a.BACKSLASH_ESCAPE,b]},d={begin:"^"+a.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[a.HASH_COMMENT_MODE,b,c,{className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[b,c]},d,{className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},{className:"section",begin:/^[^\s]+:/,end:/$/,contains:[b]}]}}},271517,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=/[dualxmsipngr]{0,12}/,d={$pattern:/[\w.]+/,keyword:"abs accept alarm and atan2 bind binmode bless break caller chdir chmod chomp chop chown chr chroot class close closedir connect continue cos crypt dbmclose dbmopen defined delete die do dump each else elsif endgrent endhostent endnetent endprotoent endpwent endservent eof eval exec exists exit exp fcntl field fileno flock for foreach fork format formline getc getgrent getgrgid getgrnam gethostbyaddr gethostbyname gethostent getlogin getnetbyaddr getnetbyname getnetent getpeername getpgrp getpriority getprotobyname getprotobynumber getprotoent getpwent getpwnam getpwuid getservbyname getservbyport getservent getsockname getsockopt given glob gmtime goto grep gt hex if index int ioctl join keys kill last lc lcfirst length link listen local localtime log lstat lt ma map method mkdir msgctl msgget msgrcv msgsnd my ne next no not oct open opendir or ord our pack package pipe pop pos print printf prototype push q|0 qq quotemeta qw qx rand read readdir readline readlink readpipe recv redo ref rename require reset return reverse rewinddir rindex rmdir say scalar seek seekdir select semctl semget semop send setgrent sethostent setnetent setpgrp setpriority setprotoent setpwent setservent setsockopt shift shmctl shmget shmread shmwrite shutdown sin sleep socket socketpair sort splice split sprintf sqrt srand stat state study sub substr symlink syscall sysopen sysread sysseek system syswrite tell telldir tie tied time times tr truncate uc ucfirst umask undef unless unlink unpack unshift untie until use utime values vec wait waitpid wantarray warn when while write x|0 xor y|0"},e={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:d},f={begin:/->\{/,end:/\}/},g={scope:"attr",match:/\s+:\s*\w+(\s*\(.*?\))?/},h={scope:"variable",variants:[{begin:/\$\d/},{begin:b.concat(/[$%@](?!")(\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@](?!")[^\s\w{=]|\$=/,relevance:0}],contains:[g]},i={className:"number",variants:[{match:/0?\.[0-9][0-9_]+\b/},{match:/\bv?(0|[1-9][0-9_]*(\.[0-9_]+)?|[1-9][0-9_]*)\b/},{match:/\b0[0-7][0-7_]*\b/},{match:/\b0x[0-9a-fA-F][0-9a-fA-F_]*\b/},{match:/\b0b[0-1][0-1_]*\b/}],relevance:0},j=[a.BACKSLASH_ESCAPE,e,h],k=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],l=(a,d,e="\\1")=>{let f="\\1"===e?e:b.concat(e,d);return b.concat(b.concat("(?:",a,")"),d,/(?:\\.|[^\\\/])*?/,f,/(?:\\.|[^\\\/])*?/,e,c)},m=(a,d,e)=>b.concat(b.concat("(?:",a,")"),d,/(?:\\.|[^\\\/])*?/,e,c),n=[h,a.HASH_COMMENT_MODE,a.COMMENT(/^=\w/,/=cut/,{endsWithParent:!0}),f,{className:"string",contains:j,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[a.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[a.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},i,{begin:"(\\/\\/|"+a.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[a.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:l("s|tr|y",b.either(...k,{capture:!0}))},{begin:l("s|tr|y","\\(","\\)")},{begin:l("s|tr|y","\\[","\\]")},{begin:l("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:m("(?:m|qr)?",/\//,/\//)},{begin:m("m|qr",b.either(...k,{capture:!0}),/\1/)},{begin:m("m|qr",/\(/,/\)/)},{begin:m("m|qr",/\[/,/\]/)},{begin:m("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub method",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[a.TITLE_MODE,g]},{className:"class",beginKeywords:"class",end:"[;{]",excludeEnd:!0,relevance:5,contains:[a.TITLE_MODE,g,i]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return e.contains=n,f.contains=n,{name:"Perl",aliases:["pl","pm"],keywords:d,contains:n}}},582970,(a,b,c)=>{b.exports=function(a){let b=/[a-zA-Z@][a-zA-Z0-9_]*/,c={$pattern:b,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:{"variable.language":["this","super"],$pattern:b,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},illegal:"</",contains:[{className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,a.C_NUMBER_MODE,a.QUOTE_STRING_MODE,a.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[a.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},a.inherit(a.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+c.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:!0,keywords:c,contains:[a.UNDERSCORE_TITLE_MODE]},{begin:"\\."+a.UNDERSCORE_IDENT_RE,relevance:0}]}}},299775,(a,b,c)=>{b.exports=function(a){let b,c=a.regex,d=/(?![A-Za-z0-9])(?![$])/,e=c.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,d),f=c.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,d),g=c.concat(/[A-Z]+/,d),h={scope:"variable",match:"\\$+"+e},i={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},j=a.inherit(a.APOS_STRING_MODE,{illegal:null}),k=a.inherit(a.QUOTE_STRING_MODE,{illegal:null,contains:a.QUOTE_STRING_MODE.contains.concat(i)}),l={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:a.QUOTE_STRING_MODE.contains.concat(i),"on:begin":(a,b)=>{b.data._beginMatch=a[1]||a[2]},"on:end":(a,b)=>{b.data._beginMatch!==a[1]&&b.ignoreMatch()}},m=a.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),n="[ 	\n]",o={scope:"string",variants:[k,j,l,m]},p={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},q=["false","null","true"],r=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],s=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],t={keyword:r,literal:(b=[],q.forEach(a=>{b.push(a),a.toLowerCase()===a?b.push(a.toUpperCase()):b.push(a.toLowerCase())}),b),built_in:s},u=a=>a.map(a=>a.replace(/\|\d+$/,"")),v={variants:[{match:[/new/,c.concat(n,"+"),c.concat("(?!",u(s).join("\\b|"),"\\b)"),f],scope:{1:"keyword",4:"title.class"}}]},w=c.concat(e,"\\b(?!\\()"),x={variants:[{match:[c.concat(/::/,c.lookahead(/(?!class\b)/)),w],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[f,c.concat(/::/,c.lookahead(/(?!class\b)/)),w],scope:{1:"title.class",3:"variable.constant"}},{match:[f,c.concat("::",c.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[f,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},y={scope:"attr",match:c.concat(e,c.lookahead(":"),c.lookahead(/(?!::)/))},z={relevance:0,begin:/\(/,end:/\)/,keywords:t,contains:[y,h,x,a.C_BLOCK_COMMENT_MODE,o,p,v]},A={relevance:0,match:[/\b/,c.concat("(?!fn\\b|function\\b|",u(r).join("\\b|"),"|",u(s).join("\\b|"),"\\b)"),e,c.concat(n,"*"),c.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[z]};z.contains.push(A);let B=[y,x,a.C_BLOCK_COMMENT_MODE,o,p,v],C={begin:c.concat(/#\[\s*\\?/,c.either(f,g)),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:q,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:q,keyword:["new","array"]},contains:["self",...B]},...B,{scope:"meta",variants:[{match:f},{match:g}]}]};return{case_insensitive:!1,keywords:t,contains:[C,a.HASH_COMMENT_MODE,a.COMMENT("//","$"),a.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:a.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:!0}]}},{scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},{scope:"variable.language",match:/\$this\b/},h,A,x,{match:[/const/,/\s/,e],scope:{1:"keyword",3:"variable.constant"}},v,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:!0,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},a.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:!0},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0,keywords:t,contains:["self",C,h,x,a.C_BLOCK_COMMENT_MODE,o,p]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:!0,contains:[{beginKeywords:"extends implements"},a.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[a.inherit(a.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},a.UNDERSCORE_TITLE_MODE]},o,p]}}},473557,(a,b,c)=>{b.exports=function(a){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},a.inherit(a.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),a.inherit(a.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]}]}}},141674,(a,b,c)=>{b.exports=function(a){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:!0}}},179212,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=/[\p{XID_Start}_]\p{XID_Continue}*/u,d=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],e={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:d,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},f={className:"meta",begin:/^(>>>|\.\.\.) /},g={className:"subst",begin:/\{/,end:/\}/,keywords:e,illegal:/#/},h={begin:/\{\{/,relevance:0},i={className:"string",contains:[a.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[a.BACKSLASH_ESCAPE,f],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[a.BACKSLASH_ESCAPE,f],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[a.BACKSLASH_ESCAPE,f,h,g]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[a.BACKSLASH_ESCAPE,f,h,g]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[a.BACKSLASH_ESCAPE,h,g]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[a.BACKSLASH_ESCAPE,h,g]},a.APOS_STRING_MODE,a.QUOTE_STRING_MODE]},j="[0-9](_?[0-9])*",k=`(\\b(${j}))?\\.(${j})|\\b(${j})\\.`,l=`\\b|${d.join("|")}`,m={className:"number",relevance:0,variants:[{begin:`(\\b(${j})|(${k}))[eE][+-]?(${j})[jJ]?(?=${l})`},{begin:`(${k})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${l})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${l})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${l})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${l})`},{begin:`\\b(${j})[jJ](?=${l})`}]},n={className:"comment",begin:b.lookahead(/# type:/),end:/$/,keywords:e,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},o={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:e,contains:["self",f,m,i,a.HASH_COMMENT_MODE]}]};return g.contains=[i,m,f],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:e,illegal:/(<\/|\?)|=>/,contains:[f,m,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},i,n,a.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,c],scope:{1:"keyword",3:"title.function"},contains:[o]},{variants:[{match:[/\bclass/,/\s+/,c,/\s*/,/\(\s*/,c,/\s*\)/]},{match:[/\bclass/,/\s+/,c]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[m,o,i]}]}}},170814,(a,b,c)=>{b.exports=function(a){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}},393334,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,d=b.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),e=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,f=b.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:c,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[a.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:b.lookahead(b.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:!0}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:c},{match:/`(?:\\.|[^`\\])+`/}],endsParent:!0}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),a.HASH_COMMENT_MODE,{scope:"string",contains:[a.BACKSLASH_ESCAPE],variants:[a.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),a.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),a.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),a.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),a.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),a.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[e,d]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,d]},{scope:{1:"punctuation",2:"number"},match:[f,d]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,d]}]},{scope:{3:"operator"},match:[c,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:e},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:f},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}},209138,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=/(r#)?/,d=b.concat(c,a.UNDERSCORE_IDENT_RE),e=b.concat(c,a.IDENT_RE),f={className:"title.function.invoke",relevance:0,begin:b.concat(/\b/,/(?!let|for|while|if|else|match\b)/,e,b.lookahead(/\s*\(/))},g="([ui](8|16|32|64|128|size)|f(32|64))?",h=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","eprintln!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],i=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:a.IDENT_RE+"!?",type:i,keyword:["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","union","unsafe","unsized","use","virtual","where","while","yield"],literal:["true","false","Some","None","Ok","Err"],built_in:h},illegal:"</",contains:[a.C_LINE_COMMENT_MODE,a.COMMENT("/\\*","\\*/",{contains:["self"]}),a.inherit(a.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*(?!')/},{scope:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'/,end:/'/,contains:[{scope:"char.escape",match:/\\('|\w|x\w{2}|u\w{4}|U\w{8})/}]}]},{className:"number",variants:[{begin:"\\b0b([01_]+)"+g},{begin:"\\b0o([0-7_]+)"+g},{begin:"\\b0x([A-Fa-f0-9_]+)"+g},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+g}],relevance:0},{begin:[/fn/,/\s+/,d],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/,contains:[a.BACKSLASH_ESCAPE]}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,d],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,d,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,d],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,d],className:{1:"keyword",3:"title.class"}},{begin:a.IDENT_RE+"::",keywords:{keyword:"Self",built_in:h,type:i}},{className:"punctuation",begin:"->"},f]}}},251674,(a,b,c)=>{let d=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video","defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],e=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),f=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),g=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),h=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();b.exports=function(a){let b={IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:a.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[a.APOS_STRING_MODE,a.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:a.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}},c="@[a-z-]+",i={className:"variable",begin:"(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b",relevance:0};return{name:"SCSS",case_insensitive:!0,illegal:"[=/|']",contains:[a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,b.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},b.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+d.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+f.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+g.join("|")+")"},i,{begin:/\(/,end:/\)/,contains:[b.CSS_NUMBER_MODE]},b.CSS_VARIABLE,{className:"attribute",begin:"\\b("+h.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[b.BLOCK_COMMENT,i,b.HEXCOLOR,b.CSS_NUMBER_MODE,a.QUOTE_STRING_MODE,a.APOS_STRING_MODE,b.IMPORTANT,b.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:c,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:!0,keywords:{$pattern:/[a-z-]+/,keyword:"and or not only",attribute:e.join(" ")},contains:[{begin:c,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},i,a.QUOTE_STRING_MODE,a.APOS_STRING_MODE,b.HEXCOLOR,b.CSS_NUMBER_MODE]},b.FUNCTION_DISPATCH]}}},572668,(a,b,c)=>{b.exports=function(a){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}},779060,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=a.COMMENT("--","$"),d=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],e=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year","add","asc","collation","desc","final","first","last","view"].filter(a=>!d.includes(a)),f={match:b.concat(/\b/,b.either(...d),/\s*\(/),relevance:0,keywords:{built_in:d}};function g(a){return b.concat(/\b/,b.either(...a.map(a=>a.replace(/\s+/,"\\s+"))),/\b/)}let h={scope:"keyword",match:g(["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"]),relevance:0};return{name:"SQL",case_insensitive:!0,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:function(a,{exceptions:b,when:c}={}){return b=b||[],a.map(a=>a.match(/\|\d+$/)||b.includes(a)?a:c(a)?`${a}|0`:a)}(e,{when:a=>a.length<3}),literal:["true","false","unknown"],type:["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],built_in:["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"]},contains:[{scope:"type",match:g(["double precision","large object","with timezone","without timezone"])},h,f,{scope:"variable",match:/@[a-z0-9][a-z0-9_]*/},{scope:"string",variants:[{begin:/'/,end:/'/,contains:[{match:/''/}]}]},{begin:/"/,end:/"/,contains:[{match:/""/}]},a.C_NUMBER_MODE,a.C_BLOCK_COMMENT_MODE,c,{scope:"operator",match:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0}]}}},799395,(a,b,c)=>{function d(a){return a?"string"==typeof a?a:a.source:null}function e(a){return f("(?=",a,")")}function f(...a){return a.map(a=>d(a)).join("")}function g(...a){let b;return"("+(("object"==typeof(b=a[a.length-1])&&b.constructor===Object?(a.splice(a.length-1,1),b):{}).capture?"":"?:")+a.map(a=>d(a)).join("|")+")"}let h=a=>f(/\b/,a,/\w$/.test(a)?/\b/:/\B/),i=["Protocol","Type"].map(h),j=["init","self"].map(h),k=["Any","Self"],l=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","borrowing","break","case","catch","class","consume","consuming","continue","convenience","copy","default","defer","deinit","didSet","distributed","do","dynamic","each","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","macro","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","package","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],m=["false","nil","true"],n=["assignment","associativity","higherThan","left","lowerThan","none","right"],o=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warning"],p=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],q=g(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),r=g(q,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),s=f(q,r,"*"),t=g(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),u=g(t,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),v=f(t,u,"*"),w=f(/[A-Z]/,u,"*"),x=["attached","autoclosure",f(/convention\(/,g("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","freestanding","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",f(/objc\(/,v,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","Sendable","testable","UIApplicationMain","unchecked","unknown","usableFromInline","warn_unqualified_access"],y=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];b.exports=function(a){let b={match:/\s+/,relevance:0},c=a.COMMENT("/\\*","\\*/",{contains:["self"]}),d=[a.C_LINE_COMMENT_MODE,c],q={match:[/\./,g(...i,...j)],className:{2:"keyword"}},t={match:f(/\./,g(...l)),relevance:0},z=l.filter(a=>"string"==typeof a).concat(["_|0"]),A={variants:[{className:"keyword",match:g(...l.filter(a=>"string"!=typeof a).concat(k).map(h),...j)}]},B={$pattern:g(/\b\w+/,/#\w+/),keyword:z.concat(o),literal:m},C=[q,t,A],D=[{match:f(/\./,g(...p)),relevance:0},{className:"built_in",match:f(/\b/,g(...p),/(?=\()/)}],E={match:/->/,relevance:0},F=[E,{className:"operator",relevance:0,variants:[{match:s},{match:`\\.(\\.|${r})+`}]}],G="([0-9]_*)+",H="([0-9a-fA-F]_*)+",I={className:"number",relevance:0,variants:[{match:`\\b(${G})(\\.(${G}))?([eE][+-]?(${G}))?\\b`},{match:`\\b0x(${H})(\\.(${H}))?([pP][+-]?(${G}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},J=(a="")=>({className:"subst",variants:[{match:f(/\\/,a,/[0\\tnr"']/)},{match:f(/\\/,a,/u\{[0-9a-fA-F]{1,8}\}/)}]}),K=(a="")=>({className:"subst",label:"interpol",begin:f(/\\/,a,/\(/),end:/\)/}),L=(a="")=>({begin:f(a,/"""/),end:f(/"""/,a),contains:[J(a),((a="")=>({className:"subst",match:f(/\\/,a,/[\t ]*(?:[\r\n]|\r\n)/)}))(a),K(a)]}),M=(a="")=>({begin:f(a,/"/),end:f(/"/,a),contains:[J(a),K(a)]}),N={className:"string",variants:[L(),L("#"),L("##"),L("###"),M(),M("#"),M("##"),M("###")]},O=[a.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[a.BACKSLASH_ESCAPE]}],P=a=>{let b=f(a,/\//),c=f(/\//,a);return{begin:b,end:c,contains:[...O,{scope:"comment",begin:`#(?!.*${c})`,end:/$/}]}},Q={scope:"regexp",variants:[P("###"),P("##"),P("#"),{begin:/\/[^\s](?=[^/\n]*\/)/,end:/\//,contains:O}]},R={match:f(/`/,v,/`/)},S=[R,{className:"variable",match:/\$\d+/},{className:"variable",match:`\\$${u}+`}],T=[{match:/(@|#(un)?)available/,scope:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:y,contains:[...F,I,N]}]}},{scope:"keyword",match:f(/@/,g(...x),e(g(/\(/,/\s+/)))},{scope:"meta",match:f(/@/,v)}],U={match:e(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:f(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,u,"+")},{className:"type",match:w,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:f(/\s+&\s+/,e(w)),relevance:0}]},V={begin:/</,end:/>/,keywords:B,contains:[...d,...C,...T,E,U]};U.contains.push(V);let W={begin:/\(/,end:/\)/,relevance:0,keywords:B,contains:["self",{match:f(v,/\s*:/),keywords:"_|0",relevance:0},...d,Q,...C,...D,...F,I,N,...S,...T,U]},X={begin:/</,end:/>/,keywords:"repeat each",contains:[...d,U]},Y={begin:/\(/,end:/\)/,keywords:B,contains:[{begin:g(e(f(v,/\s*:/)),e(f(v,/\s+/,v,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:v}]},...d,...C,...F,I,N,...T,U,W],endsParent:!0,illegal:/["']/},Z={match:[/(func|macro)/,/\s+/,g(R.match,v,s)],className:{1:"keyword",3:"title.function"},contains:[X,Y,b],illegal:[/\[/,/%/]},$={begin:[/precedencegroup/,/\s+/,w],className:{1:"keyword",3:"title"},contains:[U],keywords:[...n,...m],end:/}/},_={begin:[/(struct|protocol|class|extension|enum|actor)/,/\s+/,v,/\s*/],beginScope:{1:"keyword",3:"title.class"},keywords:B,contains:[X,...C,{begin:/:/,end:/\{/,keywords:B,contains:[{scope:"title.class.inherited",match:w},...C],relevance:0}]};for(let a of N.variants){let b=a.contains.find(a=>"interpol"===a.label);b.keywords=B;let c=[...C,...D,...F,I,N,...S];b.contains=[...c,{begin:/\(/,end:/\)/,contains:["self",...c]}]}return{name:"Swift",keywords:B,contains:[...d,Z,{match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[X,Y,b],illegal:/\[|%/},{match:[/class\b/,/\s+/,/func\b/,/\s+/,/\b[A-Za-z_][A-Za-z0-9_]*\b/],scope:{1:"keyword",3:"keyword",5:"title.function"}},{match:[/class\b/,/\s+/,/var\b/],scope:{1:"keyword",3:"keyword"}},_,{match:[/operator/,/\s+/,s],className:{1:"keyword",3:"title"}},$,{beginKeywords:"import",end:/$/,contains:[...d],relevance:0},Q,...C,...D,...F,I,N,...S,...T,U,W]}}},303588,(a,b,c)=>{b.exports=function(a){let b="true false yes no null",c="[\\w#;/?:@&=+$,.~*'()[\\]]+",d={className:"string",relevance:0,variants:[{begin:/"/,end:/"/},{begin:/\S+/}],contains:[a.BACKSLASH_ESCAPE,{className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]}]},e=a.inherit(d,{variants:[{begin:/'/,end:/'/,contains:[{begin:/''/,relevance:0}]},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),f={end:",",endsWithParent:!0,excludeEnd:!0,keywords:b,relevance:0},g=[{className:"attr",variants:[{begin:/[\w*@][\w*@ :()\./-]*:(?=[ \t]|$)/},{begin:/"[\w*@][\w*@ :()\./-]*":(?=[ \t]|$)/},{begin:/'[\w*@][\w*@ :()\./-]*':(?=[ \t]|$)/}]},{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!\\w+!"+c},{className:"type",begin:"!<"+c+">"},{className:"type",begin:"!"+c},{className:"type",begin:"!!"+c},{className:"meta",begin:"&"+a.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+a.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},a.HASH_COMMENT_MODE,{beginKeywords:b,keywords:{literal:b}},{className:"number",begin:"\\b[0-9]{4}(-[0-9][0-9]){0,2}([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?(\\.[0-9]*)?([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?\\b"},{className:"number",begin:a.C_NUMBER_RE+"\\b",relevance:0},{begin:/\{/,end:/\}/,contains:[f],illegal:"\\n",relevance:0},{begin:"\\[",end:"\\]",contains:[f],illegal:"\\n",relevance:0},{className:"string",relevance:0,begin:/'/,end:/'/,contains:[{match:/''/,scope:"char.escape",relevance:0}]},d],h=[...g];return h.pop(),h.push(e),f.contains=h,{name:"YAML",case_insensitive:!0,aliases:["yml"],contains:g}}},572692,(a,b,c)=>{let d="[A-Za-z$_][0-9A-Za-z$_]*",e=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],f=["true","false","null","undefined","NaN","Infinity"],g=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],h=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],i=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],j=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],k=[].concat(i,g,h);b.exports=function(a){var b;let c,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.regex,K=(c=a.regex,l=/<[A-Za-z0-9\\._:-]+/,m=/\/[A-Za-z0-9\\._:-]+>|\/>/,n=(a,b)=>{let c,d=a[0].length+a.index,e=a.input[d];if("<"===e||","===e)return void b.ignoreMatch();">"!==e||((a,{after:b})=>{let c="</"+a[0].slice(1);return -1!==a.input.indexOf(c,b)})(a,{after:d})||b.ignoreMatch();let f=a.input.substring(d);if((c=f.match(/^\s*=/))||(c=f.match(/^\s+extends\s+/))&&0===c.index)return void b.ignoreMatch()},o={$pattern:d,keyword:e,literal:f,built_in:k,"variable.language":j},p="[0-9](_?[0-9])*",q=`\\.(${p})`,r="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",s={className:"number",variants:[{begin:`(\\b(${r})((${q})|\\.)?|(${q}))[eE][+-]?(${p})\\b`},{begin:`\\b(${r})\\b((${q})\\b|\\.)?|(${q})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},t={className:"subst",begin:"\\$\\{",end:"\\}",keywords:o,contains:[]},u={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[a.BACKSLASH_ESCAPE,t],subLanguage:"xml"}},v={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[a.BACKSLASH_ESCAPE,t],subLanguage:"css"}},w={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[a.BACKSLASH_ESCAPE,t],subLanguage:"graphql"}},x={className:"string",begin:"`",end:"`",contains:[a.BACKSLASH_ESCAPE,t]},y={className:"comment",variants:[a.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:d+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),a.C_BLOCK_COMMENT_MODE,a.C_LINE_COMMENT_MODE]},t.contains=(z=[a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,u,v,w,x,{match:/\$\d+/},s]).concat({begin:/\{/,end:/\}/,keywords:o,contains:["self"].concat(z)}),B=(A=[].concat(y,t.contains)).concat([{begin:/(\s*)\(/,end:/\)/,keywords:o,contains:["self"].concat(A)}]),C={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:B},D={variants:[{match:[/class/,/\s+/,d,/\s+/,/extends/,/\s+/,c.concat(d,"(",c.concat(/\./,d),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,d],scope:{1:"keyword",3:"title.class"}}]},E={relevance:0,match:c.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...g,...h]}},F={match:c.concat(/\b/,(b=[...i,"super","import"].map(a=>`${a}\\s*\\(`),c.concat("(?!",b.join("|"),")")),d,c.lookahead(/\s*\(/)),className:"title.function",relevance:0},G={begin:c.concat(/\./,c.lookahead(c.concat(d,/(?![0-9A-Za-z$_(])/))),end:d,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},H="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+a.UNDERSCORE_IDENT_RE+")\\s*=>",I={match:[/const|var|let/,/\s+/,d,/\s*/,/=\s*/,/(async\s*)?/,c.lookahead(H)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[C]},{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:o,exports:{PARAMS_CONTAINS:B,CLASS_REFERENCE:E},illegal:/#(?![$_A-z])/,contains:[a.SHEBANG({label:"shebang",binary:"node",relevance:5}),{label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},a.APOS_STRING_MODE,a.QUOTE_STRING_MODE,u,v,w,x,y,{match:/\$\d+/},s,E,{scope:"attr",match:d+c.lookahead(":"),relevance:0},I,{begin:"("+a.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[y,a.REGEXP_MODE,{className:"function",begin:H,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:a.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:B}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:"<>",end:"</>"},{match:/<[A-Za-z0-9\\._:-]+\s*\/>/},{begin:l,"on:begin":n,end:m}],subLanguage:"xml",contains:[{begin:l,end:m,skip:!0,contains:["self"]}]}]},{variants:[{match:[/function/,/\s+/,d,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[C],illegal:/%/},{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+a.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[C,a.inherit(a.TITLE_MODE,{begin:d,className:"title.function"})]},{match:/\.\.\./,relevance:0},G,{match:"\\$"+d,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[C]},F,{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},D,{match:[/get|set/,/\s+/,d,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},C]},{match:/\$[(.]/}]}),L=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],M={begin:[/namespace/,/\s+/,a.IDENT_RE],beginScope:{1:"keyword",3:"title.class"}},N={beginKeywords:"interface",end:/\{/,excludeEnd:!0,keywords:{keyword:"interface extends",built_in:L},contains:[K.exports.CLASS_REFERENCE]},O={$pattern:d,keyword:e.concat(["type","interface","public","private","protected","implements","declare","abstract","readonly","enum","override","satisfies"]),literal:f,built_in:k.concat(L),"variable.language":j},P={className:"meta",begin:"@"+d},Q=(a,b,c)=>{let d=a.contains.findIndex(a=>a.label===b);if(-1===d)throw Error("can not find mode to replace");a.contains.splice(d,1,c)};Object.assign(K.keywords,O),K.exports.PARAMS_CONTAINS.push(P);let R=K.contains.find(a=>"attr"===a.scope),S=Object.assign({},R,{match:J.concat(d,J.lookahead(/\s*\?:/))});return K.exports.PARAMS_CONTAINS.push([K.exports.CLASS_REFERENCE,R,S]),K.contains=K.contains.concat([P,M,N,S]),Q(K,"shebang",a.SHEBANG()),Q(K,"use_strict",{className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/}),K.contains.find(a=>"func.def"===a.label).relevance=0,Object.assign(K,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),K}},51519,(a,b,c)=>{b.exports=function(a){let b=a.regex,c=/\d{1,2}\/\d{1,2}\/\d{4}/,d=/\d{4}-\d{1,2}-\d{1,2}/,e=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,f=/\d{1,2}(:\d{1,2}){1,2}/,g={className:"literal",variants:[{begin:b.concat(/# */,b.either(d,c),/ *#/)},{begin:b.concat(/# */,f,/ *#/)},{begin:b.concat(/# */,e,/ *#/)},{begin:b.concat(/# */,b.either(d,c),/ +/,b.either(e,f),/ *#/)}]},h=a.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),i=a.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:!0,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[{className:"string",begin:/"(""|[^/n])"C\b/},{className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},g,{className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},{className:"label",begin:/^\w+:/},h,i,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[i]}]}}},194902,(a,b,c)=>{b.exports=function(a){a.regex;let b=a.COMMENT(/\(;/,/;\)/);return b.contains.push("self"),{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"]},contains:[a.COMMENT(/;;/,/$/),b,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},{className:"variable",begin:/\$[\w_]+/},{match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},{begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},a.QUOTE_STRING_MODE,{match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},{className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/},{className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/}]}}},451795,(a,b,c)=>{var d=a.r(79915);d.registerLanguage("xml",a.r(744140)),d.registerLanguage("bash",a.r(74304)),d.registerLanguage("c",a.r(282403)),d.registerLanguage("cpp",a.r(912715)),d.registerLanguage("csharp",a.r(215486)),d.registerLanguage("css",a.r(915344)),d.registerLanguage("markdown",a.r(283539)),d.registerLanguage("diff",a.r(336141)),d.registerLanguage("ruby",a.r(721196)),d.registerLanguage("go",a.r(805380)),d.registerLanguage("graphql",a.r(375628)),d.registerLanguage("ini",a.r(749917)),d.registerLanguage("java",a.r(222321)),d.registerLanguage("javascript",a.r(404970)),d.registerLanguage("json",a.r(227828)),d.registerLanguage("kotlin",a.r(415624)),d.registerLanguage("less",a.r(169349)),d.registerLanguage("lua",a.r(248722)),d.registerLanguage("makefile",a.r(562065)),d.registerLanguage("perl",a.r(271517)),d.registerLanguage("objectivec",a.r(582970)),d.registerLanguage("php",a.r(299775)),d.registerLanguage("php-template",a.r(473557)),d.registerLanguage("plaintext",a.r(141674)),d.registerLanguage("python",a.r(179212)),d.registerLanguage("python-repl",a.r(170814)),d.registerLanguage("r",a.r(393334)),d.registerLanguage("rust",a.r(209138)),d.registerLanguage("scss",a.r(251674)),d.registerLanguage("shell",a.r(572668)),d.registerLanguage("sql",a.r(779060)),d.registerLanguage("swift",a.r(799395)),d.registerLanguage("yaml",a.r(303588)),d.registerLanguage("typescript",a.r(572692)),d.registerLanguage("vbnet",a.r(51519)),d.registerLanguage("wasm",a.r(194902)),d.HighlightJS=d,d.default=d,b.exports=d},663048,a=>{"use strict";let b=a.i(451795).default;a.s(["CODE_LANGUAGES",0,["auto-detect","bash","c","cpp","csharp","css","diff","go","graphql","ini","java","javascript","json","kotlin","less","lua","makefile","markdown","objectivec","perl","php","php-t","python","python-r","r","ruby","rust","scss","shell","sql","swift","typescript","vbnet","wasm","xml","yaml"],"manageSyntaxHighlighting",0,(a,c)=>{let d,e,f="highlight-js-theme-style",{codeHighlighting:g,codeLanguage:h}=c,i=a.getElementById(f);if(i&&i.remove(),!g){let b=a.getElementById(f);b&&b.remove(),a.querySelectorAll("pre").forEach(a=>{a.dataset.highlighted&&(a.innerHTML=a.textContent||"")});return}let j=a.createElement("style");j.id=f,d=`
  pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!
  Theme: GitHub
  Description: Light theme as seen on github.com
  Author: github.com
  Maintainer: @Hirse
  Updated: 2021-05-15

  Outdated base version: https://github.com/primer/github-syntax-light
  Current colors taken from GitHub's CSS
  */.hljs{color:#24292e;background:#fff}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#d73a49}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#6f42c1}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#005cc5}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#032f62}.hljs-built_in,.hljs-symbol{color:#e36209}.hljs-code,.hljs-comment,.hljs-formula{color:#6a737d}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#22863a}.hljs-subst{color:#24292e}.hljs-section{color:#005cc5;font-weight:700}.hljs-bullet{color:#735c0f}.hljs-emphasis{color:#24292e;font-style:italic}.hljs-strong{color:#24292e;font-weight:700}.hljs-addition{color:#22863a;background-color:#f0fff4}.hljs-deletion{color:#b31d28;background-color:#ffeef0}
  `,e=`
  @media (prefers-color-scheme: dark) {
    pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!
    Theme: GitHub Dark
    Description: Dark theme as seen on github.com
    Author: github.com
    Maintainer: @Hirse
    Updated: 2021-05-15
    
    Outdated base version: https://github.com/primer/github-syntax-dark
    Current colors taken from GitHub's CSS
    */.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}
  }`,j.textContent=`${d}
${e}`,a.head.appendChild(j);let k=a.querySelectorAll("pre");b.configure({ignoreUnescapedHTML:!0}),k.forEach(a=>{a.innerHTML=a.textContent||"",a.className=a.className.replace(/language-\S+/g,""),a.classList.remove("hljs"),a.removeAttribute("data-highlighted"),h&&"auto-detect"!==h&&a.classList.add(`language-${h}`),b.highlightElement(a)})}],663048)},399558,a=>{"use strict";a.s(["removeTabIndex",0,a=>{a.querySelectorAll("a").forEach(a=>{a.setAttribute("tabindex","-1")})}])},758738,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(381322),f=a.i(915302),g=b([e]);[e]=g.then?(await g)():g,a.s(["default",0,({details:a,onResolveWithLocal:b,onResolveWithRemote:c,onClose:g})=>{let h=(0,f.useTranslation)();return a?(0,d.jsxs)(e.default,{isOpen:!0,onClose:g,title:h("Sync Conflict"),children:[(0,d.jsx)("p",{className:"py-4 text-center",children:h('Sync reading progress from "{{deviceName}}"?',{deviceName:a.remote.device||h("another device")})}),(0,d.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,d.jsxs)("button",{className:"btn h-auto w-full flex-col items-start py-2",onClick:b,children:[(0,d.jsx)("span",{children:h("Local Progress")}),(0,d.jsx)("span",{className:"text-base-content/50 text-xs font-normal normal-case",children:a.local.preview})]}),(0,d.jsxs)("button",{className:"btn btn-primary h-auto w-full flex-col items-start py-2",onClick:c,children:[(0,d.jsx)("span",{children:h("Remote Progress")}),(0,d.jsx)("span",{className:"text-xs font-normal normal-case",children:a.remote.preview})]})]})]}):null}]),c()}catch(a){c(a)}},!1),44947,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(762774),g=a.i(201716),h=a.i(178552),i=a.i(162650),j=a.i(466759),k=a.i(862871),l=a.i(866736),m=a.i(505244),n=a.i(954885),o=a.i(723082),p=a.i(288413),q=a.i(366109),r=a.i(511369),s=a.i(88327),t=a.i(699522),u=a.i(2339),v=a.i(915302),w=a.i(428956),x=a.i(84176),y=a.i(173947),z=a.i(201993),A=a.i(936114),B=a.i(740298),C=a.i(583697),D=a.i(714617),E=a.i(773288),F=a.i(557469),G=a.i(547105),H=a.i(545251),I=a.i(52529),J=a.i(170175),K=a.i(43913),L=a.i(663048),M=a.i(370014),N=a.i(399558),O=a.i(890392),P=a.i(465863),Q=a.i(793179),R=a.i(758738),S=b([i,j,k,l,m,n,o,p,r,s,t,w,x,y,A,B,G,I,J,K,O,Q,R]);[i,j,k,l,m,n,o,p,r,s,t,w,x,y,A,B,G,I,J,K,O,Q,R]=S.then?(await S)():S,a.s(["default",0,({bookKey:b,bookDoc:c,config:S,gridInsets:T,contentInsets:U})=>{let V=(0,v.useTranslation)(),{appService:W,envConfig:X}=(0,h.useEnv)(),{themeCode:Y,isDarkMode:Z}=(0,i.useThemeStore)(),{settings:$}=(0,l.useSettingsStore)(),{loadCustomFonts:_,getLoadedFonts:aa}=(0,m.useCustomFontStore)(),{getView:ab,setView:ac,setViewInited:ad,setProgress:ae}=(0,j.useReaderStore)(),{getViewState:af,getViewSettings:ag,setViewSettings:ah}=(0,j.useReaderStore)(),{getParallels:ai}=(0,n.useParallelViewStore)(),{getBookData:aj}=(0,k.useBookDataStore)(),{applyBackgroundTexture:ak}=(0,t.useBackgroundTexture)(),{applyEinkMode:al}=(0,w.useEinkMode)(),am=aj(b),an=af(b),ao=ag(b),ap=(0,e.useRef)(null),aq=(0,e.useRef)(null),ar=(0,e.useRef)(!1),as=(0,e.useRef)(!!ao?.disableDoubleClick),[at,au]=(0,e.useState)(""),[av,aw]=(0,e.useState)(!1),ax=(0,e.useRef)(!1);(0,u.useAutoFocus)({ref:aq}),(0,K.useDiscordPresence)(am?.book||null,!!an?.isPrimary,$.discordRichPresenceEnabled),(0,e.useEffect)(()=>{let a=setTimeout(()=>au(""),2e3);return()=>clearTimeout(a)},[at]),(0,B.useUICSS)(b),(0,r.useProgressSync)(b),(0,s.useProgressAutoSave)(b),(0,J.useBookCoverAutoSave)(b);let{syncState:ay,conflictDetails:az,resolveWithLocal:aA,resolveWithRemote:aB}=(0,x.useKOSync)(b);(0,I.useTextTranslation)(b,ap.current);let{handlePageFlip:aC,handleContinuousScroll:aD}=(0,p.usePagination)(b,ap,aq),aE=(0,o.useMouseEvent)(b,aC,aD),aF=(0,o.useTouchEvent)(b,aC,aD);(0,q.useFoliateEvents)(ap.current,{onLoad:a=>{aw(!1),ax.current=!0;let d=a.detail;if(console.log("doc index loaded:",d.index),d.doc){let a=ap.current?.renderer.setStyles&&(0,f.getDirection)(d.doc),e=ag(b),g=aj(b),h=a?.vertical||e.writingMode.includes("vertical")||!1,i=a?.rtl||"rtl"===(0,E.getDirFromUILanguage)()||e.writingMode.includes("rl")||!1;(e.vertical!==h||e.rtl!==i)&&(e.vertical=h,e.rtl=i,ah(b,{...e})),g?.isFixedLayout||(0,z.mountAdditionalFonts)(d.doc,(0,O.isCJKLang)(g.book?.primaryLanguage)),aa().forEach(a=>{(0,z.mountCustomFont)(d.doc,a)}),c.rendition?.layout==="pre-paginated"&&(0,y.applyFixedlayoutStyles)(d.doc,e),(0,y.applyImageStyle)(d.doc),(0,y.applyTableStyle)(d.doc),(0,y.applyThemeModeClass)(d.doc,Z),(0,y.applyScrollModeClass)(d.doc,e.scrolled||!1),(0,y.keepTextAlignment)(d.doc),(0,N.removeTabIndex)(d.doc),e.allowScript&&(0,F.isTauriAppPlatform)()&&(a=>{if(a.defaultView&&a.defaultView.frameElement){let b=a.defaultView.frameElement;a.querySelectorAll("script:not([src])").forEach((a,c)=>{let d=a.textContent||a.innerHTML;try{console.warn("Evaluating inline scripts in iframe"),b.contentWindow?.eval(d)}catch(a){console.error(`Error executing iframe script ${c+1}:`,a)}})}})(d.doc),e.codeHighlighting&&(0,L.manageSyntaxHighlighting)(d.doc,e),setTimeout(()=>{(S.booknotes||[]).filter(a=>!a.deletedAt&&"annotation"===a.type&&a.style).forEach(a=>ap.current?.addAnnotation(a))},100),d.doc.isEventListenersAdded||(d.doc.isEventListenersAdded=!0,d.doc.addEventListener("keydown",C.handleKeydown.bind(null,b)),d.doc.addEventListener("keyup",C.handleKeyup.bind(null,b)),d.doc.addEventListener("mousedown",C.handleMousedown.bind(null,b)),d.doc.addEventListener("mouseup",C.handleMouseup.bind(null,b)),d.doc.addEventListener("click",C.handleClick.bind(null,b,as)),d.doc.addEventListener("wheel",C.handleWheel.bind(null,b)),d.doc.addEventListener("touchstart",C.handleTouchStart.bind(null,b)),d.doc.addEventListener("touchmove",C.handleTouchMove.bind(null,b)),d.doc.addEventListener("touchend",C.handleTouchEnd.bind(null,b)))}},onRelocate:a=>{let c=a.detail;ae(b,c.cfi,c.tocItem,c.section,c.location,c.time,c.range)},onRendererRelocate:a=>{let c=a.detail;if("scroll"!==c.reason&&"page"!==c.reason)return;let d=ai(b);d&&d.size>0&&d.forEach(a=>{if(a!==b){let b=ab(a)?.renderer;b&&b.goTo?.({index:c.index,anchor:c.fraction})}})}}),(0,e.useEffect)(()=>{ar.current||(ar.current=!0,setTimeout(()=>aw(!0),200),(async()=>{console.log("Opening book",b),await a.A(725140);let d=(0,g.wrappedFoliateView)(document.createElement("foliate-view"));d.id=`foliate-view-${b}`,aq.current?.appendChild(d);let e=ag(b),f=e.writingMode;if(f){let a=(0,A.getBookDirFromWritingMode)(f),b=(0,A.getBookDirFromLanguage)(c.metadata.language);"auto"!==a?c.dir=a:"auto"!==b&&(c.dir=b)}if(c.rendition?.layout==="pre-paginated"&&c.sections){c.rendition.spread=e.spreadMode;let a="rtl"===c.dir?"right":"left";c.sections[0].pageSpread=e.keepCoverSpread?"":a}await d.open(c),ap.current=d,ac(b,d);let{book:h}=d;h.transformTarget?.addEventListener("load",a=>{let{detail:b}=a;b.isScript&&(b.allow=e.allowScript??!1)});let i=W?.isMobile?screen.width:window.innerWidth,j=W?.isMobile?screen.height:window.innerHeight;h.transformTarget?.addEventListener("data",(({width:a,height:c})=>d=>{let{detail:e}=d;e.data=Promise.resolve(e.data).then(d=>{let f=ag(b),g=aj(b);if(f&&"text/css"===e.type)return(0,y.transformStylesheet)(d,a,c,f.vertical);let h="application/xhtml+xml"===e.type||"text/html"===e.type;if(f&&g&&h){let h={bookKey:b,viewSettings:f,width:a,height:c,primaryLanguage:g.book?.primaryLanguage,userLocale:(0,P.getLocale)(),content:d,sectionHref:e.name,transformers:["style","punctuation","footnote","whitespace","language","sanitizer","simplecc","proofread"]};return Promise.resolve((0,G.transformContent)(h))}return d}).catch(a=>(console.error(Error(`Failed to load ${e.name}`,{cause:a})),""))})({width:i,height:j})),d.renderer.setStyles?.((0,y.getStyles)(e)),(0,y.applyTranslationStyle)(e),as.current=e.disableDoubleClick;let k=e.animated,l=e.isEink,m=e.maxColumnCount,n=(0,D.getMaxInlineSize)(e),o=e.maxBlockSize,p=e.screenOrientation;W?.isMobileApp&&await (0,H.lockScreenOrientation)({orientation:p}),k?d.renderer.setAttribute("animated",""):d.renderer.removeAttribute("animated"),W?.isAndroidApp&&(l?d.renderer.setAttribute("eink",""):d.renderer.removeAttribute("eink"),al(l)),c?.rendition?.layout==="pre-paginated"?(d.renderer.setAttribute("zoom",e.zoomMode),d.renderer.setAttribute("spread",e.spreadMode),d.renderer.setAttribute("scale-factor",e.zoomLevel)):(d.renderer.setAttribute("max-column-count",m),d.renderer.setAttribute("max-inline-size",`${n}px`),d.renderer.setAttribute("max-block-size",`${o}px`)),aG();let q=S.location;q?await d.init({lastLocation:q}):await d.goToFraction(0),ad(b,!0)})())},[]);let aG=()=>{let a=ag(b),c=af(b),d=(0,M.getViewInsets)(a),e=a.vertical&&a.doubleBorder,f=e&&a.showHeader,g=e&&a.showFooter,h=a.showHeader&&!a.vertical,i=a.showFooter&&!a.vertical,j=h?Math.max(0,44-U.top):0,k=c?.ttsEnabled&&a.showTTSBar?52+.33*T.bottom:0,l=i?Math.max(0,Math.max(k,44)-U.bottom):Math.max(0,k),m=(h?U.top:d.top)+j,n=U.right+32*!!f,o=(i?U.bottom:d.bottom)+l,p=U.left+32*!!g,q=a.showMarginsOnScroll&&a.scrolled;ap.current?.renderer.setAttribute("margin-top",`${q?0:m}px`),ap.current?.renderer.setAttribute("margin-right",`${n}px`),ap.current?.renderer.setAttribute("margin-bottom",`${q?0:o}px`),ap.current?.renderer.setAttribute("margin-left",`${p}px`),ap.current?.renderer.setAttribute("gap",`${a.gapPercent}%`),a.scrolled&&ap.current?.renderer.setAttribute("flow","scrolled")};(0,e.useEffect)(()=>{if(ap.current&&ap.current.renderer){let a=ag(b);ap.current.renderer.setStyles?.((0,y.getStyles)(a)),ap.current.renderer.getContents().forEach(({doc:b})=>{c.rendition?.layout==="pre-paginated"&&(0,y.applyFixedlayoutStyles)(b,a),(0,y.applyThemeModeClass)(b,Z),(0,y.applyScrollModeClass)(b,a.scrolled||!1)})}},[Y,Z,ao?.scrolled,ao?.overrideColor,ao?.invertImgColorInDark]),(0,e.useEffect)(()=>{let a=async()=>{await _(X),aa().forEach(a=>{(0,z.mountCustomFont)(document,a);let b=ap.current?.renderer.getContents();b?.forEach(({doc:b})=>(0,z.mountCustomFont)(b,a))})};$.customFonts&&a()},[$.customFonts,X]),(0,e.useEffect)(()=>{ao&&ak(X,ao)},[ao?.backgroundTextureId,ao?.backgroundOpacity,ao?.backgroundSize,ak]),(0,e.useEffect)(()=>{ap.current&&ap.current.renderer&&(as.current=!!ao?.disableDoubleClick)},[ao?.disableDoubleClick]),(0,e.useEffect)(()=>{ap.current&&ap.current.renderer&&ao&&aG()},[U.top,U.right,U.bottom,U.left,ao?.doubleBorder,ao?.showHeader,ao?.showFooter,ao?.showTTSBar,an?.ttsEnabled]);let aH=ao?.showMarginsOnScroll&&ao?.scrolled;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{ref:aq,tabIndex:-1,role:"document","aria-label":V("Book Content"),className:"foliate-viewer h-[100%] w-[100%] focus:outline-none",style:{paddingTop:aH?U.top:0,paddingBottom:aH?U.bottom:0},...aE,...aF}),!ax.current&&av&&(0,d.jsx)(Q.default,{loading:!0}),"conflict"===ay&&az&&(0,d.jsx)(R.default,{details:az,onResolveWithLocal:aA,onResolveWithRemote:aB,onClose:aA})]})}]),c()}catch(a){c(a)}},!1),19832,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(178552),g=a.i(162650),h=a.i(466759),i=a.i(915302),j=b([e,g,h]);[e,g,h]=j.then?(await j)():j,a.s(["default",0,({bookKey:a,section:b,showDoubleBorder:c,isScrolled:j,isVertical:k,isEink:l,horizontalGap:m,contentInsets:n,gridInsets:o})=>{let p=(0,i.useTranslation)(),{appService:q}=(0,f.useEnv)(),{hoveredBookKey:r,setHoveredBookKey:s}=(0,h.useReaderStore)(),{systemUIVisible:t,statusBarHeight:u}=(0,g.useThemeStore)(),v=Math.max(o.top,q?.isAndroidApp&&t?u/2:0);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:(0,e.default)("absolute left-0 right-0 top-0 z-10",j&&!k&&"bg-base-100"),style:{height:`${v}px`}}),(0,d.jsx)("div",{className:(0,e.default)("sectioninfo absolute flex items-center overflow-hidden font-sans",l?"text-sm font-normal":"text-neutral-content text-xs font-light",k?"writing-vertical-rl max-h-[85%]":"top-0 h-[44px]",j&&!k&&"bg-base-100"),role:"none",onClick:()=>s(a),style:k?{top:`${(n.top-o.top)*1.5}px`,right:c?`calc(${n.right}px)`:`calc(${Math.max(0,n.right-32)}px)`,width:c?"32px":`${n.right}px`,height:`calc(100% - ${n.top+n.bottom}px)`}:{top:`${v}px`,paddingInline:`calc(${m/2}% + ${n.left/2}px)`,width:"100%"},children:(0,d.jsx)("span",{"aria-label":b?p("Section Title")+`: ${b}`:"",className:(0,e.default)("text-center",k?"":"line-clamp-1",!k&&r==a&&"hidden"),children:b||""})})]})}]),c()}catch(a){c(a)}},!1),450517,a=>{"use strict";var b=a.i(654617);a.s(["getHighlightColorHex",0,(a,c)=>{if(!c)return c;let d=a.globalReadSettings.customHighlightColors;return d?.[c]??b.HIGHLIGHT_COLOR_HEX[c]}])},564645,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 21a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3zm12 -16h-8v14h8a1 1 0 0 0 1 -1v-12a1 1 0 0 0 -1 -1"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 12v-6a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v6"},child:[]},{tag:"path",attr:{d:"M10 18h-7"},child:[]},{tag:"path",attr:{d:"M21 18h-7"},child:[]},{tag:"path",attr:{d:"M6 15l-3 3l3 3"},child:[]},{tag:"path",attr:{d:"M18 15l3 3l-3 3"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 8h8v8h-8z"},child:[]},{tag:"path",attr:{d:"M4 4v.01"},child:[]},{tag:"path",attr:{d:"M8 4v.01"},child:[]},{tag:"path",attr:{d:"M12 4v.01"},child:[]},{tag:"path",attr:{d:"M16 4v.01"},child:[]},{tag:"path",attr:{d:"M20 4v.01"},child:[]},{tag:"path",attr:{d:"M4 20v.01"},child:[]},{tag:"path",attr:{d:"M8 20v.01"},child:[]},{tag:"path",attr:{d:"M12 20v.01"},child:[]},{tag:"path",attr:{d:"M16 20v.01"},child:[]},{tag:"path",attr:{d:"M20 20v.01"},child:[]},{tag:"path",attr:{d:"M20 16v.01"},child:[]},{tag:"path",attr:{d:"M20 12v.01"},child:[]},{tag:"path",attr:{d:"M20 8v.01"},child:[]},{tag:"path",attr:{d:"M4 16v.01"},child:[]},{tag:"path",attr:{d:"M4 12v.01"},child:[]},{tag:"path",attr:{d:"M4 8v.01"},child:[]}]})(a)}function f(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 11l8 3l8 -3"},child:[]}]})(a)}function g(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 13l8 -3l8 3"},child:[]}]})(a)}function h(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 3m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z"},child:[]}]})(a)}function i(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 3m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1zm9 -1v18"},child:[]}]})(a)}function j(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19.875 6.27a2.225 2.225 0 0 1 1.125 1.948v7.284c0 .809 -.443 1.555 -1.158 1.948l-6.75 4.27a2.269 2.269 0 0 1 -2.184 0l-6.75 -4.27a2.225 2.225 0 0 1 -1.158 -1.948v-7.285c0 -.809 .443 -1.554 1.158 -1.947l6.75 -3.98a2.33 2.33 0 0 1 2.25 0l6.75 3.98h-.033z"},child:[]},{tag:"path",attr:{d:"M10 8v8h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-2z"},child:[]}]})(a)}function k(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"},child:[]},{tag:"path",attr:{d:"M9 4l0 16"},child:[]}]})(a)}function l(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9.173 14.83a4 4 0 1 1 5.657 -5.657"},child:[]},{tag:"path",attr:{d:"M11.294 12.707l.174 .247a7.5 7.5 0 0 0 8.845 2.492a9 9 0 0 1 -14.671 2.914"},child:[]},{tag:"path",attr:{d:"M3 12h1"},child:[]},{tag:"path",attr:{d:"M12 3v1"},child:[]},{tag:"path",attr:{d:"M5.6 5.6l.7 .7"},child:[]},{tag:"path",attr:{d:"M3 21l18 -18"},child:[]}]})(a)}function m(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 4h-6.5a3.5 3.5 0 0 0 0 7h.5"},child:[]},{tag:"path",attr:{d:"M14 15v-11"},child:[]},{tag:"path",attr:{d:"M10 15v-11"},child:[]},{tag:"path",attr:{d:"M5 19h14"},child:[]},{tag:"path",attr:{d:"M7 21l-2 -2l2 -2"},child:[]}]})(a)}a.s(["TbArrowAutofitWidth",()=>d,"TbBoxMargin",()=>e,"TbChevronCompactDown",()=>f,"TbChevronCompactUp",()=>g,"TbColumns1",()=>h,"TbColumns2",()=>i,"TbHexagonLetterD",()=>j,"TbLayoutSidebar",()=>k,"TbLayoutSidebarFilled",()=>c,"TbSunMoon",()=>l,"TbTextDirectionRtl",()=>m])},860898,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 80C149.9 80 62.4 159.4 49.6 262c9.4-3.8 19.6-6 30.4-6c26.5 0 48 21.5 48 48l0 128c0 26.5-21.5 48-48 48c-44.2 0-80-35.8-80-80l0-16 0-48 0-48C0 146.6 114.6 32 256 32s256 114.6 256 256l0 48 0 48 0 16c0 44.2-35.8 80-80 80c-26.5 0-48-21.5-48-48l0-128c0-26.5 21.5-48 48-48c10.8 0 21 2.1 30.4 6C449.6 159.4 362.1 80 256 80z"},child:[]}]})(a)}a.s(["FaHeadphones",()=>c])},258312,a=>{"use strict";var b=a.i(687134),c=a.i(394317),d=a.i(929058),e=a.i(591509),f=a.i(564645),g=a.i(860898),h=a.i(950678),i=a.i(465863);let j=[{type:"copy",label:(0,i.stubTranslation)("Copy"),tooltip:(0,i.stubTranslation)("Copy text after selection"),Icon:b.FiCopy},{type:"highlight",label:(0,i.stubTranslation)("Highlight"),tooltip:(0,i.stubTranslation)("Highlight text after selection"),Icon:c.PiHighlighterFill,quickAction:!0},{type:"annotate",label:(0,i.stubTranslation)("Annotate"),tooltip:(0,i.stubTranslation)("Annotate text after selection"),Icon:function(a){return(0,e.GenIcon)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"},child:[]}]})(a)}},{type:"search",label:(0,i.stubTranslation)("Search"),tooltip:(0,i.stubTranslation)("Search text after selection"),Icon:b.FiSearch,quickAction:!0},{type:"dictionary",label:(0,i.stubTranslation)("Dictionary"),tooltip:(0,i.stubTranslation)("Look up text in dictionary after selection"),Icon:f.TbHexagonLetterD,quickAction:!0},{type:"wikipedia",label:(0,i.stubTranslation)("Wikipedia"),tooltip:(0,i.stubTranslation)("Look up text in Wikipedia after selection"),Icon:d.FaWikipediaW,quickAction:!0},{type:"translate",label:(0,i.stubTranslation)("Translate"),tooltip:(0,i.stubTranslation)("Translate text after selection"),Icon:function(a){return(0,e.GenIcon)({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"},child:[]},{tag:"path",attr:{d:"M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"},child:[]}]})(a)},quickAction:!0},{type:"tts",label:(0,i.stubTranslation)("Speak"),tooltip:(0,i.stubTranslation)("Read text aloud after selection"),Icon:g.FaHeadphones,quickAction:!0},{type:"proofread",label:(0,i.stubTranslation)("Proofread"),tooltip:(0,i.stubTranslation)("Proofread text after selection"),Icon:h.IoIosBuild}],k=j.filter(a=>a.quickAction);a.s(["annotationToolButtons",0,j,"annotationToolQuickActions",0,k],258312)},622741,a=>{"use strict";var b=a.i(591509);function c({tipColor:a="#FFD700",tipStyle:c={},...d}){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"none"},child:[{tag:"path",attr:{d:"M253.66,106.34a8,8,0,0,0-11.32,0L192,156.69,107.31,72l50.35-50.34a8,8,0,1,0-11.32-11.32L96,60.69A16,16,0,0,0,93.18,79.5L72,100.69a16,16,0,0,0,0,22.62L76.69,128,136,187.31l4.69,4.69a16,16,0,0,0,22.62,0l21.18-21.18A16,16,0,0,0,203.31,168l50.35-50.34A8,8,0,0,0,253.66,106.34ZM152,180.69,83.31,112,104,91.31,172.69,160Z",fill:"currentColor"},child:[]},{tag:"path",attr:{d:"M18.34,186.34c-4.209212,4.20621-2.516471,11.37196,3.13,13.25l72,24c0.815308,0.27382,1.669943,0.41232,2.53,0.41c2.12237,0.002,4.15842-0.84009,5.66-2.34L136,187.31c13.62143,13.61626-70.243446-70.24754-64-64l4.69,4.69z",fill:a,style:c},child:[]}]})(d)}a.s(["HighlighterIcon",()=>c])},436899,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(756009),i=a.i(557469),j=a.i(915302),k=b([e]);[e]=k.then?(await k)():k;let l=({onClick:a,label:b,id:c,children:e})=>(0,d.jsx)("button",{id:c,onClick:a,className:"window-button bg-base-200/35 hover:bg-base-200 text-base-content/85 hover:text-base-content","aria-label":b,children:e});a.s(["default",0,({className:b,headerRef:c,showMinimize:k=!0,showMaximize:m=!0,showClose:n=!0,onMinimize:o,onToggleMaximize:p,onClose:q})=>{let r=(0,j.useTranslation)(),s=(0,f.useRef)(null),{appService:t}=(0,g.useEnv)(),u=(0,f.useRef)({lastPointerTime:0,pointerStartPosition:{x:0,y:0},isDragging:!1}),v=a=>a.closest(".btn")||a.closest(".window-button")||a.closest(".dropdown-container")||a.closest(".exclude-title-bar-mousedown"),w=async b=>{let c=b.target;if(v(c))return;let{getCurrentWindow:d}=await a.A(31225);1===b.buttons&&(2===b.detail?d().toggleMaximize():d().startDragging())},x=async b=>{let c=b.target;if(v(c)||"mouse"===b.pointerType)return;b.preventDefault();let d=Date.now(),e=d-u.current.lastPointerTime;if(u.current.pointerStartPosition={x:b.clientX,y:b.clientY},e<300){let{getCurrentWindow:b}=await a.A(31225);b().toggleMaximize();return}u.current.lastPointerTime=d,u.current.isDragging=!1},y=async b=>{let c=b.target;if(v(c)||u.current.isDragging||"mouse"===b.pointerType)return;b.preventDefault();let d=Math.abs(b.clientX-u.current.pointerStartPosition.x),e=Math.abs(b.clientY-u.current.pointerStartPosition.y);if(d>5||e>5){u.current.isDragging=!0;try{let{getCurrentWindow:b}=await a.A(31225);await b().startDragging()}catch(a){console.warn("Failed to start window dragging:",a)}}},z=()=>{u.current.isDragging=!1};(0,f.useEffect)(()=>{if(!(0,i.isTauriAppPlatform)())return;let a=c?.current;if(a)return a.addEventListener("mousedown",w),a.addEventListener("pointerdown",x),a.addEventListener("pointermove",y),a.addEventListener("pointerup",z),a.addEventListener("pointercancel",z),()=>{a.removeEventListener("mousedown",w),a.removeEventListener("pointerdown",x),a.removeEventListener("pointermove",y),a.removeEventListener("pointerup",z),a.removeEventListener("pointercancel",z)}},[]);let A=async()=>{o?o():(0,h.tauriHandleMinimize)()},B=async()=>{p?p():(0,h.tauriHandleToggleMaximize)()},C=async()=>{q?q():(0,h.tauriHandleClose)()};return(0,d.jsxs)("div",{ref:s,className:(0,e.default)("window-buttons flex h-8 items-center justify-end space-x-2",n||m||k?"visible":"hidden",b),children:[k&&t?.hasWindowBar&&(0,d.jsx)(l,{onClick:A,label:r("Minimize"),id:"titlebar-minimize",children:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{fill:"currentColor",d:"M20 14H4v-2h16"})})}),m&&t?.hasWindowBar&&(0,d.jsx)(l,{onClick:B,label:r("Maximize or Restore"),id:"titlebar-maximize",children:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{fill:"currentColor",d:"M4 4h16v16H4zm2 4v10h12V8z"})})}),n&&(t?.hasWindowBar||q)&&(0,d.jsx)(l,{onClick:C,label:r("Close"),id:"titlebar-close",children:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})})})]})}]),c()}catch(a){c(a)}},!1),286642,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(915302),g=a.i(258312),h=a.i(765918),i=a.i(937065),j=a.i(964855),k=b([e,i,j]);[e,i,j]=k.then?(await k)():k,a.s(["default",0,({selectedAction:a,onActionSelect:b,setIsDropdownOpen:c})=>{let k=(0,f.useTranslation)();return(0,d.jsx)(j.default,{className:(0,e.default)("annotation-quick-action-menu dropdown-content z-20 mt-1 border","bgcolor-base-200 shadow-2xl"),style:{maxWidth:`${window.innerWidth-40}px`},onCancel:()=>c?.(!1),children:g.annotationToolQuickActions.map(e=>(0,d.jsx)(i.default,{label:k(e.label),tooltip:k(e.tooltip),buttonClass:a===e.type?"bg-base-300/85":"",Icon:e.Icon,onClick:()=>{var d;return d=e.type,void(b(d),a===d?h.eventDispatcher.dispatch("toast",{type:"info",timeout:2e3,message:k("Quick action disabled")}):h.eventDispatcher.dispatch("toast",{type:"info",timeout:2e3,message:k(g.annotationToolQuickActions.find(a=>a.type===d)?.tooltip||"")}),c?.(!1))}},e.type))})}]),c()}catch(a){c(a)}},!1),181232,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(178552),g=b([e]);[e]=g.then?(await g)():g,a.s(["default",0,({icon:a,onClick:b,disabled:c=!1,label:g,className:h})=>{let{appService:i}=(0,f.useEnv)();return(0,d.jsx)("button",{className:(0,e.default)("btn btn-ghost h-8 min-h-8 w-8 p-0",i?.isMobileApp&&"hover:bg-transparent",c&&"cursor-default !bg-transparent opacity-50",h),title:g,"aria-label":g,onClick:c?void 0:b,children:a})}]),c()}catch(a){c(a)}},!1),519984,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(564645),f=a.i(466759),g=a.i(715715),h=a.i(915302),i=a.i(181232),j=b([f,g,i]);[f,g,i]=j.then?(await j)():j,a.s(["default",0,({bookKey:a})=>{let b=(0,h.useTranslation)(),{sideBarBookKey:c,isSideBarVisible:j,setSideBarBookKey:k,toggleSideBar:l}=(0,g.useSidebarStore)(),{setHoveredBookKey:m}=(0,f.useReaderStore)();return(0,d.jsx)(i.default,{icon:c===a&&j?(0,d.jsx)(e.TbLayoutSidebarFilled,{className:"text-base-content"}):(0,d.jsx)(e.TbLayoutSidebar,{className:"text-base-content"}),onClick:()=>{c===a?l():(k(a),j||l()),m("")},label:b("Toggle Sidebar")})}]),c()}catch(a){c(a)}},!1),889818,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(547274),g=a.i(866736),h=a.i(862871),i=a.i(466759),j=a.i(915302),k=a.i(178552),l=a.i(465863),m=a.i(181232),n=a.i(936114),o=a.i(765918),p=a.i(609027),q=b([g,h,i,m,n]);[g,h,i,m,n]=q.then?(await q)():q,a.s(["default",0,({bookKey:a})=>{let b=(0,j.useTranslation)(),{envConfig:c}=(0,k.useEnv)(),{settings:q}=(0,g.useSettingsStore)(),{getConfig:r,saveConfig:s,getBookData:t,updateBooknotes:u}=(0,h.useBookDataStore)(),{getProgress:v,getViewState:w,setBookmarkRibbonVisibility:x}=(0,i.useReaderStore)(),[y,z]=(0,e.useState)(!1),A=r(a),B=v(a),C=()=>{let b=t(a),d=r(a),e=v(a);if(!b||!d||!e)return;let{booknotes:f=[]}=d,{location:g,range:h}=e;if(g)if(w(a)?.ribbonVisible){z(!1),f.forEach(a=>{"bookmark"===a.type&&(0,p.isCfiInLocation)(a.cfi,g)&&(a.deletedAt=Date.now())});let b=u(a,f);b&&s(c,a,b,q)}else{z(!0);let d=h?.startContainer.textContent?.slice(0,128)||"",i=128===d.length?d+"...":d,j={id:(0,l.uniqueId)(),type:"bookmark",cfi:g,text:i||`${(0,n.getCurrentPage)(b.book,e)}`,note:"",createdAt:Date.now(),updatedAt:Date.now()},k=f.find(a=>"bookmark"===a.type&&a.cfi===g);k?(k.deletedAt=null,k.updatedAt=Date.now(),k.text=j.text):f.push(j);let m=u(a,f);m&&s(c,a,m,q)}};return(0,e.useEffect)(()=>{let b=b=>{let{bookKey:c}=b.detail;c===a&&C()};return o.eventDispatcher.on("toggle-bookmark",b),()=>{o.eventDispatcher.off("toggle-bookmark",b)}},[a]),(0,e.useEffect)(()=>{let{booknotes:b=[]}=A||{},{location:c}=B||{};if(!c)return;let d=b.filter(a=>"bookmark"===a.type&&!a.deletedAt).some(a=>(0,p.isCfiInLocation)(a.cfi,c));z(d),x(a,d)},[A,B]),(0,d.jsx)(m.default,{icon:y?(0,d.jsx)(f.MdOutlineBookmark,{className:"text-base-content"}):(0,d.jsx)(f.MdOutlineBookmarkAdd,{className:"text-base-content"}),onClick:C,label:b(y?"Remove Bookmark":"Add Bookmark")})}]),c()}catch(a){c(a)}},!1),677615,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(91440),f=a.i(178552),g=a.i(466759),h=a.i(715715),i=a.i(925426),j=a.i(915302),k=a.i(106865),l=a.i(181232),m=b([g,h,i,l]);[g,h,i,l]=m.then?(await m)():m,a.s(["default",0,({bookKey:a})=>{let b=(0,j.useTranslation)(),{appService:c}=(0,f.useEnv)(),{setHoveredBookKey:m}=(0,g.useReaderStore)(),{sideBarBookKey:n,setSideBarBookKey:o}=(0,h.useSidebarStore)(),{isNotebookVisible:p,toggleNotebook:q}=(0,i.useNotebookStore)(),r=(0,k.useResponsiveSize)(16);return(0,d.jsx)(l.default,{icon:(0,d.jsx)(e.LuNotebookPen,{size:r,className:"text-base-content"}),onClick:()=>{c?.isMobile&&m(""),n===a?q():(o(a),p||q())},label:b("Notebook")})}]),c()}catch(a){c(a)}},!1),957715,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(540438),f=a.i(466759),g=a.i(915302),h=a.i(866736),i=a.i(181232),j=b([f,h,i]);[f,h,i]=j.then?(await j)():j,a.s(["default",0,({bookKey:a})=>{let b=(0,g.useTranslation)(),{setHoveredBookKey:c}=(0,f.useReaderStore)(),{isSettingsDialogOpen:j,setSettingsDialogOpen:k}=(0,h.useSettingsStore)(),{setSettingsDialogBookKey:l}=(0,h.useSettingsStore)();return(0,d.jsx)(i.default,{icon:(0,d.jsx)(e.RiFontSize,{className:"text-base-content"}),onClick:()=>{c(""),l(a),k(!j)},label:b("Font & Layout")})}]),c()}catch(a){c(a)}},!1),323014,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(540438),g=a.i(178552),h=a.i(466759),i=a.i(915302),j=a.i(862871),k=a.i(937944),l=a.i(95114),m=a.i(181232),n=b([h,j,k,l,m]);[h,j,k,l,m]=n.then?(await n)():n,a.s(["default",0,({bookKey:a})=>{let b=(0,i.useTranslation)(),{envConfig:c,appService:n}=(0,g.useEnv)(),{getBookData:o}=(0,j.useBookDataStore)(),{getViewSettings:p,setViewSettings:q,setHoveredBookKey:r}=(0,h.useReaderStore)(),s=o(a),t=p(a),[u,v]=(0,e.useState)(t.translationEnabled),[w,x]=(0,e.useState)((0,l.isTranslationAvailable)(s?.book,t.translateTargetLang));return(0,e.useEffect)(()=>{u!==t.translationEnabled&&(n?.isMobile&&r(""),(0,k.saveViewSettings)(c,a,"translationEnabled",u,!0,!1),t.translationEnabled=u,q(a,{...t}))},[u]),(0,e.useEffect)(()=>{v(t.translationEnabled),x((0,l.isTranslationAvailable)(s?.book,t.translateTargetLang))},[s,t.translationEnabled,t.translateTargetLang]),(0,d.jsx)(m.default,{icon:(0,d.jsx)(f.RiTranslateAi,{className:u?"text-blue-500":"text-base-content"}),"aria-label":b("Toggle Translation"),disabled:!w&&!u,onClick:()=>v(!u),label:b(w?u?"Disable Translation":"Enable Translation":"Translation Disabled")})}]),c()}catch(a){c(a)}},!1),369602,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224zm-2.772 4.301a7.947 7.947 0 0 1-5.656 2.343 7.953 7.953 0 0 1-5.658-2.344c-3.118-3.119-3.118-8.195 0-11.314a7.923 7.923 0 0 1 2.06-1.483 10.027 10.027 0 0 0 2.89 7.848 9.972 9.972 0 0 0 7.848 2.891 8.036 8.036 0 0 1-1.484 2.059z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6.993 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007S14.761 6.993 12 6.993 6.993 9.239 6.993 12zM12 8.993c1.658 0 3.007 1.349 3.007 3.007S13.658 15.007 12 15.007 8.993 13.658 8.993 12 10.342 8.993 12 8.993zM10.998 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2h-3zm17 0h3v2h-3zM4.219 18.363l2.12-2.122 1.415 1.414-2.12 2.122zM16.24 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.342 7.759 4.22 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z"},child:[]}]})(a)}a.s(["BiMoon",()=>c,"BiSun",()=>d])},830052,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(667180),h=a.i(369602),i=a.i(564645),j=a.i(547274),k=a.i(950678),l=a.i(654617),m=a.i(178552),n=a.i(77946),o=a.i(162650),p=a.i(466759),q=a.i(862871),r=a.i(866736),s=a.i(915302),t=a.i(173947),u=a.i(187897),v=a.i(765918),w=a.i(714617),x=a.i(937944),y=a.i(756009),z=a.i(937065),A=a.i(964855),B=b([e,o,p,q,r,t,x,z,A]);[e,o,p,q,r,t,x,z,A]=B.then?(await B)():B,a.s(["default",0,({bookKey:a,setIsDropdownOpen:b})=>{let c=(0,s.useTranslation)(),B=(0,g.useRouter)(),{user:C}=(0,n.useAuth)(),{envConfig:D,appService:E}=(0,m.useEnv)(),{getConfig:F,getBookData:G}=(0,q.useBookDataStore)(),{setSettingsDialogOpen:H,setSettingsDialogBookKey:I}=(0,r.useSettingsStore)(),{getView:J,getViewSettings:K,getViewState:L,setViewSettings:M}=(0,p.useReaderStore)(),N=F(a),O=G(a),P=K(a),Q=L(a),{themeMode:R,isDarkMode:S,setThemeMode:T}=(0,o.useThemeStore)(),[U,V]=(0,f.useState)(P.scrolled),[W,X]=(0,f.useState)(P.zoomLevel),[Y,Z]=(0,f.useState)(P.zoomMode),[$,_]=(0,f.useState)(P.spreadMode),[aa,ab]=(0,f.useState)(P.keepCoverSpread),[ac,ad]=(0,f.useState)(P.invertImgColorInDark);(0,f.useEffect)(()=>{U!==P.scrolled&&(P.scrolled=U,J(a)?.renderer.setAttribute("flow",U?"scrolled":"paginated"),J(a)?.renderer.setAttribute("max-inline-size",`${(0,w.getMaxInlineSize)(P)}px`),J(a)?.renderer.setStyles?.((0,t.getStyles)(P)),M(a,P))},[U]),(0,f.useEffect)(()=>{(0,x.saveViewSettings)(D,a,"zoomLevel",W,!0,!0),O.bookDoc?.rendition?.layout==="pre-paginated"&&J(a)?.renderer.setAttribute("scale-factor",W)},[W]),(0,f.useEffect)(()=>{ac!==P.invertImgColorInDark&&(0,x.saveViewSettings)(D,a,"invertImgColorInDark",ac,!0,!0)},[ac]),(0,f.useEffect)(()=>{Y!==P.zoomMode&&(P.zoomMode=Y,J(a)?.renderer.setAttribute("zoom",Y),M(a,P),(0,x.saveViewSettings)(D,a,"zoomMode",Y,!0,!1))},[Y]),(0,f.useEffect)(()=>{$!==P.spreadMode&&(P.spreadMode=$,J(a)?.renderer.setAttribute("spread",$),M(a,P),(0,x.saveViewSettings)(D,a,"spreadMode",$,!0,!1))},[$]),(0,f.useEffect)(()=>{if(aa===P.keepCoverSpread||!O?.bookDoc?.sections?.length)return;P.keepCoverSpread=aa;let b="rtl"===O.bookDoc.dir?"right":"left";O.bookDoc.sections[0].pageSpread=aa?"":b,J(a)?.renderer.setAttribute("spread",$),M(a,P),(0,x.saveViewSettings)(D,a,"keepCoverSpread",aa,!0,!1)},[aa]);let ae=Math.max(N?.lastSyncedAtConfig||0,N?.lastSyncedAtNotes||0);return(0,d.jsxs)(A.default,{className:(0,e.default)("view-menu dropdown-content dropdown-right no-triangle z-20 mt-1 border","bgcolor-base-200 shadow-2xl"),style:{maxWidth:`${window.innerWidth-40}px`,marginRight:window.innerWidth<640?"-36px":"0px"},onCancel:()=>b?.(!1),children:[O.bookDoc?.rendition?.layout==="pre-paginated"&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{title:c("Zoom Level"),className:(0,e.default)("flex items-center justify-between rounded-md"),children:[(0,d.jsx)("button",{title:c("Zoom Out"),onClick:()=>X(a=>Math.max(a-l.ZOOM_STEP,l.MIN_ZOOM_LEVEL)),className:(0,e.default)("hover:bg-base-300 text-base-content rounded-full p-2",W<=l.MIN_ZOOM_LEVEL&&"btn-disabled text-gray-400"),children:(0,d.jsx)(j.MdZoomOut,{})}),(0,d.jsxs)("button",{title:c("Reset Zoom"),className:(0,e.default)("hover:bg-base-300 text-base-content h-8 min-h-8 w-[50%] rounded-md p-1 text-center"),onClick:()=>X(100),children:[W,"%"]}),(0,d.jsx)("button",{title:c("Zoom In"),onClick:()=>X(a=>Math.min(a+l.ZOOM_STEP,l.MAX_ZOOM_LEVEL)),className:(0,e.default)("hover:bg-base-300 text-base-content rounded-full p-2",W>=l.MAX_ZOOM_LEVEL&&"btn-disabled text-gray-400"),children:(0,d.jsx)(j.MdZoomIn,{})})]}),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{title:c("Zoom Mode"),className:(0,e.default)("my-2 flex items-center justify-between rounded-md"),children:[(0,d.jsx)("button",{title:c("Single Page"),onClick:_.bind(null,"none"),className:(0,e.default)("hover:bg-base-300 text-base-content rounded-full p-2","none"===$&&"bg-base-300/75"),children:(0,d.jsx)(i.TbColumns1,{})}),(0,d.jsx)("button",{title:c("Auto Spread"),onClick:_.bind(null,"auto"),className:(0,e.default)("hover:bg-base-300 text-base-content rounded-full p-2","auto"===$&&"bg-base-300/75"),children:(0,d.jsx)(i.TbColumns2,{})}),(0,d.jsx)("div",{className:"bg-base-300 mx-2 h-6 w-[1px]"}),(0,d.jsx)("button",{title:c("Fit Page"),onClick:Z.bind(null,"fit-page"),className:(0,e.default)("hover:bg-base-300 text-base-content rounded-full p-2","fit-page"===Y&&"bg-base-300/75"),children:(0,d.jsx)(k.IoMdExpand,{})}),(0,d.jsx)("button",{title:c("Fit Width"),onClick:Z.bind(null,"fit-width"),className:(0,e.default)("hover:bg-base-300 text-base-content rounded-full p-2","fit-width"===Y&&"bg-base-300/75"),children:(0,d.jsx)(i.TbArrowAutofitWidth,{})})]}),(0,d.jsx)(z.default,{label:c("Separate Cover Page"),Icon:aa?j.MdCheck:void 0,onClick:()=>ab(!aa),disabled:"none"===$})]}),(0,d.jsx)("hr",{"aria-hidden":"true",className:"border-base-300 my-1"})]}),(0,d.jsx)(z.default,{label:c("Font & Layout"),shortcut:"Shift+F",onClick:()=>{b?.(!1),I(a),H(!0)}}),(0,d.jsx)(z.default,{label:c("Scrolled Mode"),shortcut:"Shift+J",Icon:U?j.MdCheck:void 0,onClick:()=>V(!U),disabled:O.isFixedLayout}),(0,d.jsx)("hr",{"aria-hidden":"true",className:"border-base-300 my-1"}),(0,d.jsx)(z.default,{label:C?ae?c("Synced at {{time}}",{time:new Date(ae).toLocaleString()}):c("Never synced"):c("Sign in to Sync"),Icon:C?j.MdSync:j.MdSyncProblem,iconClassName:C&&Q?.syncing?"animate-reverse-spin":"",onClick:()=>{C?v.eventDispatcher.dispatch("sync-book-progress",{bookKey:a}):((0,u.navigateToLogin)(B),b?.(!1))}}),(0,d.jsx)("hr",{"aria-hidden":"true",className:"border-base-300 my-1"}),E?.hasWindow&&(0,d.jsx)(z.default,{label:c("Fullscreen"),onClick:()=>{(0,y.tauriHandleToggleFullScreen)(),b?.(!1)}}),(0,d.jsx)(z.default,{label:c("dark"===R?"Dark Mode":"light"===R?"Light Mode":"Auto Mode"),Icon:"dark"===R?h.BiMoon:"light"===R?h.BiSun:i.TbSunMoon,onClick:()=>{T("auto"===R?"light":"light"===R?"dark":"auto")}}),(0,d.jsx)(z.default,{label:c("Invert Image In Dark Mode"),disabled:!S,Icon:ac?j.MdCheck:void 0,onClick:()=>ad(!ac)})]})}]),c()}catch(a){c(a)}},!1),205205,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(394317),h=a.i(178552),i=a.i(162650),j=a.i(466759),k=a.i(715715),l=a.i(915302),m=a.i(866736),n=a.i(646233),o=a.i(993289),p=a.i(106865),q=a.i(450517),r=a.i(258312),s=a.i(937944),t=a.i(622741),u=a.i(320776),v=a.i(436899),w=a.i(286642),x=a.i(519984),y=a.i(889818),z=a.i(677615),A=a.i(957715),B=a.i(323014),C=a.i(830052),D=b([e,i,j,k,m,n,o,s,u,v,w,x,y,z,A,B,C]);[e,i,j,k,m,n,o,s,u,v,w,x,y,z,A,B,C]=D.then?(await D)():D,a.s(["default",0,({bookKey:a,bookTitle:b,isTopLeft:c,isHoveredAnim:D,gridInsets:E,onCloseBook:F})=>{let G=(0,l.useTranslation)(),{envConfig:H,appService:I}=(0,h.useEnv)(),{settings:J}=(0,m.useSettingsStore)(),{isTrafficLightVisible:K}=(0,o.useTrafficLight)(),{trafficLightInFullscreen:L,setTrafficLightVisibility:M}=(0,n.useTrafficLightStore)(),{bookKeys:N,hoveredBookKey:O}=(0,j.useReaderStore)(),{isDarkMode:P,systemUIVisible:Q,statusBarHeight:R}=(0,i.useThemeStore)(),{isSideBarVisible:S}=(0,k.useSidebarStore)(),{getView:T,getViewSettings:U,setHoveredBookKey:V}=(0,j.useReaderStore)(),W=U(a),[X,Y]=(0,f.useState)(!1),Z=T(a),$=(0,p.useResponsiveSize)(16),_=(0,f.useRef)(null),aa=I?.hasWindowBar&&!K,ab=(Z?.renderer.getContents()??[]).some(({doc:a})=>a?.body?.style.cursor==="pointer"),ac=W?.enableAnnotationQuickActions,ad=r.annotationToolQuickActions.find(a=>a.type===W?.annotationQuickAction)||r.annotationToolQuickActions[0],ae=W?.annotationQuickAction,af=ad.Icon,ag=J.globalReadSettings.highlightStyle,ah=J.globalReadSettings.highlightStyles[ag],ai=(0,q.getHighlightColorHex)(J,ah),aj=a=>{Y(a),a||V("")};(0,f.useEffect)(()=>{I?.hasTrafficLight&&!S&&(O===a&&c?M(!0,{x:10,y:20}):O||M(!1))},[I,S,O]);let ak=(0,f.useCallback)((a,b)=>{if(!_.current)return!0;let c=_.current.getBoundingClientRect();return a<=c.left||a>=c.right||b<=c.top||b>=c.bottom},[]),al=O===a||X,am=I?.hasTrafficLight&&!L&&!S&&c;return(0,d.jsxs)("div",{className:(0,e.default)("bg-base-100 absolute top-0 w-full"),style:{paddingTop:I?.hasSafeAreaInset?`${E.top}px`:"0px"},children:[(0,d.jsx)("div",{role:"none",className:(0,e.default)("absolute top-0 z-10 h-11 w-full",ab&&"pointer-events-none"),onClick:()=>V(a),onMouseEnter:()=>!I?.isMobile&&V(a),onTouchStart:()=>!I?.isMobile&&V(a)}),(0,d.jsx)("div",{className:(0,e.default)("bg-base-100 absolute left-0 right-0 top-0 z-10",I?.hasRoundedWindow&&"rounded-window-top-right",al?"visible":"hidden"),style:{height:Q?`${Math.max(E.top,R)}px`:"0px"}}),(0,d.jsxs)("div",{ref:_,role:"group","aria-label":G("Header Bar"),className:(0,e.default)("header-bar bg-base-100 absolute top-0 z-10 flex h-11 w-full items-center pr-4","shadow-xs transition-[opacity,margin-top] duration-300",am?"pl-20":"pl-4",I?.hasRoundedWindow&&"rounded-window-top-right",!S&&I?.hasRoundedWindow&&"rounded-window-top-left",D&&"hover-bar-anim",al?"pointer-events-auto visible":"pointer-events-none opacity-0",X&&"header-bar-pinned"),style:{marginTop:Q?`${Math.max(E.top,R)}px`:`${E.top}px`},onFocus:()=>!I?.isMobile&&V(a),onMouseLeave:a=>{!I?.isMobile&&ak(a.clientX,a.clientY)&&V("")},children:[(0,d.jsxs)("div",{className:"bg-base-100 sidebar-bookmark-toggler z-20 flex h-full items-center gap-x-4 pe-2",children:[(0,d.jsx)("div",{className:"hidden sm:flex",children:(0,d.jsx)(x.default,{bookKey:a})}),(0,d.jsx)(y.default,{bookKey:a}),(0,d.jsx)(B.default,{bookKey:a}),ac&&(0,d.jsx)(u.default,{label:G(ae?"Disable Quick Action":"Enable Quick Action on Selection"),className:"exclude-title-bar-mousedown dropdown-bottom",buttonClassName:(0,e.default)("btn btn-ghost h-8 min-h-8 w-8 p-0",W?.annotationQuickAction&&"bg-base-300/50"),toggleButton:"highlight"===ae||null===ae?(0,d.jsx)(t.HighlighterIcon,{size:$,tipColor:null===ae?"#8F8F8F":ai,tipStyle:{opacity:null===ae?.5:.8,mixBlendMode:P?"screen":"multiply"}}):(0,d.jsx)(af,{size:$}),onToggle:aj,children:(0,d.jsx)(w.default,{selectedAction:W.annotationQuickAction,onActionSelect:b=>{W?.annotationQuickAction===b&&(b=null),(0,s.saveViewSettings)(H,a,"annotationQuickAction",b,!1,!0)}})})]}),(0,d.jsx)("div",{role:"contentinfo","aria-label":G("Title")+" - "+b,className:(0,e.default)("header-title z-15 bg-base-100 pointer-events-none hidden flex-1 items-center justify-center sm:flex",!aa&&"absolute inset-0"),children:(0,d.jsx)("div",{"aria-hidden":"true",className:(0,e.default)("line-clamp-1 text-center text-xs font-semibold",!aa&&"max-w-[50%]"),children:b})}),(0,d.jsxs)("div",{className:"bg-base-100 z-20 ml-auto flex h-full items-center space-x-4 ps-2",children:[(0,d.jsx)(A.default,{bookKey:a}),(0,d.jsx)(z.default,{bookKey:a}),(0,d.jsx)(u.default,{label:G("View Options"),className:"exclude-title-bar-mousedown dropdown-bottom dropdown-end",buttonClassName:"btn btn-ghost h-8 min-h-8 w-8 p-0",toggleButton:(0,d.jsx)(g.PiDotsThreeVerticalBold,{size:$}),onToggle:aj,children:(0,d.jsx)(C.default,{bookKey:a})}),(0,d.jsx)(v.default,{className:"window-buttons flex h-full items-center",headerRef:_,showMinimize:1==N.length&&aa,showMaximize:1==N.length&&aa,onClose:()=>{V(null),F(a)}})]})]})]})}]),c()}catch(a){c(a)}},!1),264480,a=>{"use strict";a.s(["getNavigationHandler",0,(a,b,c)=>a?c:b,"getNavigationIcon",0,(a,b,c)=>a?c:b,"getNavigationLabel",0,(a,b,c)=>a?c:b])},291188,a=>{"use strict";var b=a.i(508171),c=a.i(127669);a.s(["default",0,({label:a,min:d=0,max:e=100,step:f=1,initialValue:g=50,heightPx:h=40,minLabel:i="",maxLabel:j="",minIcon:k,maxIcon:l,bubbleElement:m,bubbleLabel:n="",className:o="",minClassName:p="",maxClassName:q="",bubbleClassName:r="",onChange:s,valueToPosition:t,positionToValue:u})=>{let[v,w]=(0,c.useState)(g),[x,y]=(0,c.useState)(!1),z=(0,c.useRef)(null),A=u||((a,b,c)=>b+a/100*(c-b));(0,c.useEffect)(()=>{let a=z.current;for(;a;){if("rtl"===a.getAttribute("dir")){y(!0);break}a=a.parentElement}},[]),(0,c.useEffect)(()=>{w(g)},[g]);let B=(t||((a,b,c)=>(a-b)/(c-b)*100))(v,d,e),C=B/100*95;return(0,b.jsx)("div",{ref:z,"aria-label":a,className:`slider bg-base-200 mx-auto w-full rounded-xl ${o}`,dir:x?"rtl":void 0,children:(0,b.jsxs)("div",{className:"relative",style:{height:`${h}px`},children:[(0,b.jsx)("div",{className:"bg-base-300/40 absolute h-full w-full rounded-full"}),(0,b.jsx)("div",{className:"bg-base-300 absolute h-full rounded-full",style:{width:C>0?`max(calc(${C}% + ${h/2}px), ${h}px)`:"0px",[x?"right":"left"]:0}}),(0,b.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-4 text-sm",children:[k||(0,b.jsx)("span",{className:`ml-2 ${p}`,children:i}),l||(0,b.jsx)("span",{className:`mr-2 ${q}`,children:j})]}),(0,b.jsx)("div",{className:"pointer-events-none absolute top-0 z-10",style:{[x?"right":"left"]:`max(${h/2}px, calc(${C}%))`,transform:x?"translateX(calc(50%))":"translateX(calc(-50%))",height:"100%"},children:(0,b.jsx)("div",{className:`bg-base-200 flex h-full items-center justify-center rounded-full text-xs shadow-md ${r}`,style:{width:`${h}px`},children:m||n})}),(0,b.jsx)("input",{type:"range",min:0,max:100,step:f,value:B,className:"absolute inset-0 h-full w-full cursor-pointer opacity-0",onChange:a=>{let b=Math.round(A(parseInt(a.target.value,10),d,e)/f)*f;w(b),s&&s(b)},"aria-label":a,"aria-valuemin":d,"aria-valuemax":e,"aria-valuenow":v,"aria-valuetext":`${v}`,"aria-orientation":"horizontal"})]})})}])},81956,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(540438),h=a.i(264480),i=a.i(466759),j=a.i(915302),k=a.i(181232),l=a.i(291188),m=b([e,i,k]);[e,i,k]=m.then?(await m)():m,a.s(["NavigationPanel",0,({bookKey:a,actionTab:b,progressFraction:c,progressValid:m,navigationHandlers:n,viewSettings:o,bottomOffset:p,sliderHeight:q})=>{let r=(0,j.useTranslation)(),{getView:s}=(0,i.useReaderStore)(),t=s(a),[u,v]=f.default.useState(m?100*c:0);(0,f.useEffect)(()=>{m&&v(100*c)},[m,c]);let w=(0,f.useCallback)(a=>{v(a),n.onProgressChange(a)},[n]),x=(0,e.default)("footerbar-progress-mobile bg-base-200 absolute flex w-full flex-col items-center gap-y-8 px-4 transition-all sm:hidden","progress"===b?"pointer-events-auto translate-y-0 pb-4 pt-8 ease-out":"pointer-events-none invisible translate-y-full overflow-hidden pb-0 pt-0 ease-in");return(0,d.jsxs)("div",{className:x,style:{bottom:p},children:[(0,d.jsx)("div",{className:"flex w-full items-center justify-between gap-x-6",children:(0,d.jsx)(l.default,{label:r("Reading Progress"),heightPx:q,bubbleLabel:`${Math.round(u)}%`,initialValue:u,onChange:w})}),(0,d.jsxs)("div",{className:"flex w-full items-center justify-between gap-x-6",children:[(0,d.jsx)(k.default,{icon:(0,h.getNavigationIcon)(o?.rtl,(0,d.jsx)(g.RiArrowLeftDoubleLine,{}),(0,d.jsx)(g.RiArrowRightDoubleLine,{})),onClick:(0,h.getNavigationHandler)(o?.rtl,n.onPrevSection,n.onNextSection),label:(0,h.getNavigationLabel)(o?.rtl,r("Previous Section"),r("Next Section"))}),(0,d.jsx)(k.default,{icon:(0,h.getNavigationIcon)(o?.rtl,(0,d.jsx)(g.RiArrowLeftSLine,{}),(0,d.jsx)(g.RiArrowRightSLine,{})),onClick:(0,h.getNavigationHandler)(o?.rtl,n.onPrevPage,n.onNextPage),label:(0,h.getNavigationLabel)(o?.rtl,r("Previous Page"),r("Next Page"))}),(0,d.jsx)(k.default,{icon:(0,h.getNavigationIcon)(o?.rtl,(0,d.jsx)(g.RiArrowGoBackLine,{}),(0,d.jsx)(g.RiArrowGoForwardLine,{})),onClick:n.onGoBack,label:r("Go Back"),disabled:!t?.history.canGoBack}),(0,d.jsx)(k.default,{icon:(0,h.getNavigationIcon)(o?.rtl,(0,d.jsx)(g.RiArrowGoForwardLine,{}),(0,d.jsx)(g.RiArrowGoBackLine,{})),onClick:n.onGoForward,label:r("Go Forward"),disabled:!t?.history.canGoForward}),(0,d.jsx)(k.default,{icon:(0,h.getNavigationIcon)(o?.rtl,(0,d.jsx)(g.RiArrowRightSLine,{}),(0,d.jsx)(g.RiArrowLeftSLine,{})),onClick:(0,h.getNavigationHandler)(o?.rtl,n.onNextPage,n.onPrevPage),label:(0,h.getNavigationLabel)(o?.rtl,r("Next Page"),r("Previous Page"))}),(0,d.jsx)(k.default,{icon:(0,h.getNavigationIcon)(o?.rtl,(0,d.jsx)(g.RiArrowRightDoubleLine,{}),(0,d.jsx)(g.RiArrowLeftDoubleLine,{})),onClick:(0,h.getNavigationHandler)(o?.rtl,n.onNextSection,n.onPrevSection),label:(0,h.getNavigationLabel)(o?.rtl,r("Next Section"),r("Previous Section"))})]})]})}]),c()}catch(a){c(a)}},!1),902244,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M3.78233 2.21713C3.70732 2.14212 3.60557 2.09998 3.49949 2.09998C3.3934 2.09998 3.29166 2.14212 3.21664 2.21713L1.21664 4.21713C1.06044 4.37334 1.06044 4.62661 1.21664 4.78282C1.37285 4.93903 1.62612 4.93903 1.78233 4.78282L3.09949 3.46566L3.09949 11.5343L1.78233 10.2171C1.62612 10.0609 1.37285 10.0609 1.21664 10.2171C1.06043 10.3733 1.06043 10.6266 1.21664 10.7828L3.21664 12.7828C3.29166 12.8578 3.3934 12.9 3.49949 12.9C3.60557 12.9 3.70731 12.8578 3.78233 12.7828L5.78233 10.7828C5.93854 10.6266 5.93854 10.3733 5.78233 10.2171C5.62612 10.0609 5.37285 10.0609 5.21664 10.2171L3.89949 11.5343L3.89949 3.46566L5.21664 4.78282C5.37285 4.93903 5.62612 4.93903 5.78233 4.78282C5.93854 4.62661 5.93854 4.37334 5.78233 4.21713L3.78233 2.21713ZM8.49998 3.99997C8.22383 3.99997 7.99998 4.22382 7.99998 4.49997C7.99998 4.77611 8.22383 4.99997 8.49998 4.99997H14.5C14.7761 4.99997 15 4.77611 15 4.49997C15 4.22382 14.7761 3.99997 14.5 3.99997H8.49998ZM7.99998 7.49997C7.99998 7.22382 8.22383 6.99997 8.49998 6.99997H14.5C14.7761 6.99997 15 7.22382 15 7.49997C15 7.77611 14.7761 7.99997 14.5 7.99997H8.49998C8.22383 7.99997 7.99998 7.77611 7.99998 7.49997ZM8.49998 9.99997C8.22383 9.99997 7.99998 10.2238 7.99998 10.5C7.99998 10.7761 8.22383 11 8.49998 11H14.5C14.7761 11 15 10.7761 15 10.5C15 10.2238 14.7761 9.99997 14.5 9.99997H8.49998Z",fill:"currentColor"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M10.3004 7.49991C10.3004 8.4943 9.49426 9.30041 8.49988 9.30041C7.50549 9.30041 6.69938 8.4943 6.69938 7.49991C6.69938 6.50553 7.50549 5.69942 8.49988 5.69942C9.49426 5.69942 10.3004 6.50553 10.3004 7.49991ZM11.205 8C10.9699 9.28029 9.84816 10.2504 8.49988 10.2504C7.1516 10.2504 6.0299 9.28029 5.79473 8H0.5C0.223858 8 0 7.77614 0 7.5C0 7.22386 0.223858 7 0.5 7H5.7947C6.0298 5.71962 7.15154 4.74942 8.49988 4.74942C9.84822 4.74942 10.97 5.71962 11.2051 7H14.5C14.7761 7 15 7.22386 15 7.5C15 7.77614 14.7761 8 14.5 8H11.205Z",fill:"currentColor"},child:[]}]})(a)}a.s(["RxLineHeight",()=>c,"RxSlider",()=>d])},269269,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(564645),h=a.i(902244),i=a.i(178552),j=a.i(466759),k=a.i(915302),l=a.i(937944),m=a.i(291188),n=b([e,j,l]);[e,j,l]=n.then?(await n)():n;let o={MAX_MARGIN_PX:88,MAX_GAP_PERCENT:10,MARGIN_RATIO:50};a.s(["FontLayoutPanel",0,({bookKey:a,actionTab:b,bottomOffset:c,marginIconSize:n})=>{let p=(0,k.useTranslation)(),{envConfig:q}=(0,i.useEnv)(),{getView:r,getViewSettings:s}=(0,j.useReaderStore)(),t=s(a),u=r(a),v=(0,f.useCallback)(b=>{(0,l.saveViewSettings)(q,a,"defaultFontSize",b)},[q,a]),w=(0,f.useCallback)(b=>{let c=s(a);if(!c)return;let{MAX_MARGIN_PX:d,MAX_GAP_PERCENT:e}=o,f=Math.round(b/100*d),g=Math.round(b/100*e);c.marginTopPx=f,c.marginBottomPx=f/2,c.marginLeftPx=f/2,c.marginRightPx=f/2,(0,l.saveViewSettings)(q,a,"gapPercent",g,!1,!1),u?.renderer.setAttribute("margin",`${f}px`),u?.renderer.setAttribute("gap",`${g}%`),c?.scrolled&&u?.renderer.setAttribute("flow","scrolled")},[q,a,u,s]),x=(0,f.useCallback)(b=>{(0,l.saveViewSettings)(q,a,"lineHeight",b/10)},[q,a]),y=(0,f.useCallback)((a,b)=>{let{MAX_MARGIN_PX:c,MAX_GAP_PERCENT:d,MARGIN_RATIO:e}=o;return(a/c+b/d)*e},[]),z=(0,e.default)("footerbar-font-mobile bg-base-200 absolute flex w-full flex-col items-center gap-y-8 px-4 transition-all sm:hidden","font"===b?"pointer-events-auto translate-y-0 pb-4 pt-8 ease-out":"pointer-events-none invisible translate-y-full overflow-hidden pb-0 pt-0 ease-in");return(0,d.jsxs)("div",{className:z,style:{bottom:c},children:[(0,d.jsx)(m.default,{label:p("Font Size"),initialValue:t?.defaultFontSize??16,bubbleLabel:`${t?.defaultFontSize??16}`,minLabel:"A",maxLabel:"A",minClassName:"text-xs",maxClassName:"text-base",onChange:v,min:8,max:30}),(0,d.jsxs)("div",{className:"flex w-full items-center justify-between gap-x-6",children:[(0,d.jsx)(m.default,{label:p("Page Margin"),initialValue:y(t?.marginTopPx??44,t?.gapPercent??5),bubbleElement:(0,d.jsx)(g.TbBoxMargin,{size:n}),minLabel:p("Small"),maxLabel:p("Large"),step:10,onChange:w}),(0,d.jsx)(m.default,{label:p("Line Spacing"),initialValue:(t?.lineHeight??1.6)*10,bubbleElement:(0,d.jsx)(h.RxLineHeight,{size:n}),minLabel:p("Small"),maxLabel:p("Large"),min:8,max:24,onChange:x})]})]})}]),c()}catch(a){c(a)}},!1),114767,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(394317),h=a.i(564645),i=a.i(178552),j=a.i(162650),k=a.i(915302),l=a.i(866736),m=a.i(108328),n=a.i(937944),o=a.i(713551),p=a.i(951790),q=a.i(291188),r=b([e,j,l,m,n,o]);[e,j,l,m,n,o]=r.then?(await r)():r;a.s(["ColorPanel",0,({actionTab:a,bottomOffset:b})=>{let c=(0,k.useTranslation)(),{envConfig:r,appService:s}=(0,i.useEnv)(),{settings:t}=(0,l.useSettingsStore)(),{getScreenBrightness:u,setScreenBrightness:v}=(0,m.useDeviceControlStore)(),{themeMode:w,themeColor:x,isDarkMode:y,setThemeMode:z,setThemeColor:A}=(0,j.useThemeStore)(),[B,C]=(0,f.useState)(t.screenBrightness>=0?t.screenBrightness:50);(0,f.useEffect)(()=>{s?.isMobileApp&&"color"===a&&u().then(a=>{if(a>=0&&a<=1){let b=Math.round(100*a);C(b)}})},[a,s,u]);let D=(0,f.useMemo)(()=>(0,p.debounce)(async a=>{(0,n.saveSysSettings)(r,"screenBrightness",a),(0,n.saveSysSettings)(r,"autoScreenBrightness",!1),await v(a/100)},100),[r,v]),E=(0,f.useCallback)(async a=>{s?.isMobileApp&&(C(a),D(a))},[s,D]),F=(0,e.default)("footerbar-color-mobile bg-base-200 absolute flex w-full flex-col items-center gap-y-8 px-4 transition-all sm:hidden","color"===a?"pointer-events-auto translate-y-0 pb-4 pt-8 ease-out":"pointer-events-none invisible translate-y-full overflow-hidden pb-0 pt-0 ease-in");return(0,d.jsxs)("div",{className:F,style:{bottom:b},children:[s?.hasScreenBrightness&&(0,d.jsx)(q.default,{label:c("Screen Brightness"),initialValue:B,bubbleLabel:`${B}`,minIcon:(0,d.jsx)(g.PiSun,{size:16}),maxIcon:(0,d.jsx)(g.PiSun,{size:24}),onChange:E,min:0,max:100,valueToPosition:(a,b,c)=>a<=b?0:a>=c?100:100*Math.pow(a/c,.5),positionToValue:(a,b,c)=>{if(a<=0)return b;if(a>=100)return c;let d=Math.pow(a/100,2)*c;return Math.max(b,Math.min(c,d))}}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("div",{className:"flex items-center justify-between p-2",children:(0,d.jsx)("span",{className:"text-sm font-medium",children:c("Color")})}),(0,d.jsxs)("div",{className:"flex gap-3 overflow-x-auto p-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[o.themes.map(({name:a,label:b,colors:f})=>(0,d.jsx)("button",{onClick:()=>A(a),className:(0,e.default)("flex flex-shrink-0 flex-col items-center justify-center rounded-lg p-3 transition-all","h-[40px] min-w-[80px]",x===a?"ring-primary ring-offset-base-200 ring-2 ring-offset-2":"hover:opacity-80"),style:{backgroundColor:y?f.dark["base-100"]:f.light["base-100"],color:y?f.dark["base-content"]:f.light["base-content"]},children:(0,d.jsx)("span",{className:"text-xs font-medium",children:c(b)})},a)),(0,d.jsx)("button",{onClick:()=>void z("auto"===w?"light":"light"===w?"dark":"auto"),className:(0,e.default)("flex flex-shrink-0 flex-col items-center justify-center rounded-lg p-3 transition-all","h-[40px] min-w-[80px]","dark"===w?"ring-primary ring-offset-base-200 ring-2 ring-offset-2":"hover:opacity-80"),style:{backgroundColor:(o.themes.find(a=>a.name===x)||o.themes[0]).colors.dark["base-100"],color:(o.themes.find(a=>a.name===x)||o.themes[0]).colors.dark["base-content"]},children:"light"===w?(0,d.jsx)(g.PiSun,{size:20}):"dark"===w?(0,d.jsx)(g.PiMoon,{size:20}):(0,d.jsx)(h.TbSunMoon,{size:20})})]})]})]})}]),c()}catch(a){c(a)}},!1),481803,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(950678),g=a.i(902244),h=a.i(540438),i=a.i(394317),j=a.i(547274),k=a.i(466759),l=a.i(915302),m=a.i(106865),n=a.i(181232),o=b([e,k,n]);[e,k,n]=o.then?(await o)():o,a.s(["NavigationBar",0,({bookKey:a,actionTab:b,navPadding:c,onSetActionTab:o})=>{let p=(0,l.useTranslation)(),{getViewState:q}=(0,k.useReaderStore)(),r=q(a),s=(0,m.useResponsiveSize)(23),t=(0,m.useResponsiveSize)(18);return(0,d.jsxs)("div",{className:(0,e.default)("bg-base-200 z-30 mt-auto flex w-full justify-between px-8 py-4 sm:hidden"),style:{paddingBottom:c},children:[(0,d.jsx)(n.default,{label:p("Table of Contents"),icon:(0,d.jsx)(f.IoIosList,{size:s}),onClick:()=>o("toc")}),(0,d.jsx)(n.default,{label:p("Color"),icon:(0,d.jsx)(i.PiSun,{className:(0,e.default)("color"===b&&"text-blue-500")}),onClick:()=>o("color")}),(0,d.jsx)(n.default,{label:p("Reading Progress"),icon:(0,d.jsx)(g.RxSlider,{className:(0,e.default)("progress"===b&&"text-blue-500")}),onClick:()=>o("progress")}),(0,d.jsx)(n.default,{label:p("Font & Layout"),icon:(0,d.jsx)(h.RiFontFamily,{size:t,className:(0,e.default)("font"===b&&"text-blue-500")}),onClick:()=>o("font")}),(0,d.jsx)(n.default,{label:p("Speak"),icon:(0,d.jsx)(j.MdOutlineHeadphones,{className:r?.ttsEnabled?"text-blue-500":""}),onClick:()=>o("tts")})]})}]),c()}catch(a){c(a)}},!1),494075,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(106865),f=a.i(81956),g=a.i(269269),h=a.i(114767),i=a.i(481803),j=b([f,g,h,i]);[f,g,h,i]=j.then?(await j)():j,a.s(["default",0,({bookKey:a,gridInsets:b,actionTab:c,progressValid:j,progressFraction:k,navigationHandlers:l,onSetActionTab:m})=>{let n=window.innerWidth<640||window.innerHeight<640,o=(0,e.useResponsiveSize)(28),p=(0,e.useResponsiveSize)(20),q=n?`${.33*b.bottom+64}px`:"64px",r=n?`${.33*b.bottom+16}px`:"0px";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h.ColorPanel,{actionTab:c,bottomOffset:q}),(0,d.jsx)(f.NavigationPanel,{bookKey:a,actionTab:c,progressFraction:k,progressValid:j,navigationHandlers:l,bottomOffset:q,sliderHeight:o}),(0,d.jsx)(g.FontLayoutPanel,{bookKey:a,actionTab:c,bottomOffset:q,marginIconSize:p}),(0,d.jsx)(i.NavigationBar,{bookKey:a,actionTab:c,navPadding:r,onSetActionTab:m})]})}]),c()}catch(a){c(a)}},!1),883225,a=>{"use strict";let b=(a,b,c=!1)=>{let d=b.toLowerCase();if(!d.startsWith("zh"))return a.toString();let e=d.includes("tw")||d.includes("hk"),f=c?"":"",g=(e?"":"").replace("",f),h=e?["","","","","",""]:["","","","","",""],i=String(a),j=i.length,k="";for(let a=0;a<j;a++){let b=Number(i[a]),c=j-a-1;0!==b?k+=g[b]+h[c%4]:!k.endsWith(f)&&a<j-1&&(k+=f),4===c&&(k+=h[4]),8===c&&(k+=h[5])}return k=k.replace(RegExp(`${f}+$`),"").replace(`${f}`,"").replace(`${f}`,"").replace(RegExp(`${f}+`,"g"),f),c||(k=e?k.replace(/^$/,"").replace(/(^|[^])([^]|$)/g,"$1$2"):k.replace(/^$/,"").replace(/(^|[^])([^]|$)/g,"$1$2")),k};function c(a,d,e,f=!1,g="en",h=1){if(void 0===a||void 0===d||!(d>0)||!(a>=0))return"";{let c=f?b(a+1,g,!0):String(a+1),i=f?b(d,g,!0):String(d);return e.replace("{current}",c).replace("{total}",i).replace("{percent}",((a+1)/d*100).toFixed(h))}}function d(a,c=!1,e="en"){return void 0===a||a<0?"":c?b(a,e):String(a)}a.s(["formatNumber",()=>d,"formatProgress",()=>c],883225)},646004,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(860898),g=a.i(540438),h=a.i(264480),i=a.i(466759),j=a.i(915302),k=a.i(862871),l=a.i(883225),m=a.i(181232),n=b([i,k,m]);[i,k,m]=n.then?(await n)():n,a.s(["default",0,({bookKey:a,gridInsets:b,progressValid:c,progressFraction:n,navigationHandlers:o,onSpeakText:p})=>{let q=(0,j.useTranslation)(),{hoveredBookKey:r,getView:s,getViewState:t,getProgress:u,getViewSettings:v}=(0,i.useReaderStore)(),{getBookData:w}=(0,k.useBookDataStore)(),x=s(a),y=w(a),z=u(a),A=t(a),B=v(a),C=B?.progressStyle||"percentage",[D,E]=e.default.useState(c?100*n:0),{section:F,pageinfo:G}=z||{},H=y?.isFixedLayout?F:G,I=(0,l.formatProgress)(H?.current,H?.total,"fraction"===C?"{current} / {total}":"{percent}%",!1,"en",0),J=(0,e.useRef)(null);(0,e.useEffect)(()=>{r!==a&&J.current&&document.activeElement===J.current&&J.current.blur()},[r,a]),(0,e.useEffect)(()=>{c&&E(100*n)},[c,n]);let K=(0,e.useCallback)(a=>{E(a),o.onProgressChange(a)},[o]),L=window.innerWidth<640||window.innerHeight<640;return(0,d.jsxs)("div",{className:"absolute hidden h-8 w-full items-center gap-x-4 px-4 sm:flex",style:{bottom:L?`${.33*b.bottom}px`:"0px"},children:[(0,d.jsx)(m.default,{icon:(0,h.getNavigationIcon)(B?.rtl,(0,d.jsx)(g.RiArrowLeftDoubleLine,{}),(0,d.jsx)(g.RiArrowRightDoubleLine,{})),onClick:(0,h.getNavigationHandler)(B?.rtl,o.onPrevSection,o.onNextSection),label:(0,h.getNavigationLabel)(B?.rtl,q("Previous Section"),q("Next Section"))}),(0,d.jsx)(m.default,{icon:(0,h.getNavigationIcon)(B?.rtl,(0,d.jsx)(g.RiArrowLeftSLine,{}),(0,d.jsx)(g.RiArrowRightSLine,{})),onClick:(0,h.getNavigationHandler)(B?.rtl,o.onPrevPage,o.onNextPage),label:(0,h.getNavigationLabel)(B?.rtl,q("Previous Page"),q("Next Page"))}),(0,d.jsx)(m.default,{icon:(0,h.getNavigationIcon)(B?.rtl,(0,d.jsx)(g.RiArrowGoBackLine,{}),(0,d.jsx)(g.RiArrowGoForwardLine,{})),onClick:o.onGoBack,label:q("Go Back"),disabled:!x?.history.canGoBack}),(0,d.jsx)(m.default,{icon:(0,h.getNavigationIcon)(B?.rtl,(0,d.jsx)(g.RiArrowGoForwardLine,{}),(0,d.jsx)(g.RiArrowGoBackLine,{})),onClick:o.onGoForward,label:q("Go Forward"),disabled:!x?.history.canGoForward}),c&&(0,d.jsx)("span",{title:q("Reading Progress"),"aria-label":`${q("Reading Progress")}: ${Math.round(100*n)}%`,className:"mx-2 text-center text-sm",children:(0,d.jsx)("span",{"aria-hidden":"true",children:I})}),(0,d.jsx)("input",{ref:J,type:"range",className:"text-base-content mx-2 min-w-0 flex-1",min:0,max:100,"aria-label":q("Jump to Location"),value:D,onChange:a=>K(parseInt(a.target.value,10))}),(0,d.jsx)(m.default,{icon:(0,d.jsx)(f.FaHeadphones,{className:A?.ttsEnabled?"text-blue-500":""}),onClick:p,label:q("Speak")}),(0,d.jsx)(m.default,{icon:(0,h.getNavigationIcon)(B?.rtl,(0,d.jsx)(g.RiArrowRightSLine,{}),(0,d.jsx)(g.RiArrowLeftSLine,{})),onClick:(0,h.getNavigationHandler)(B?.rtl,o.onNextPage,o.onPrevPage),label:(0,h.getNavigationLabel)(B?.rtl,q("Next Page"),q("Previous Page"))}),(0,d.jsx)(m.default,{icon:(0,h.getNavigationIcon)(B?.rtl,(0,d.jsx)(g.RiArrowRightDoubleLine,{}),(0,d.jsx)(g.RiArrowLeftDoubleLine,{})),onClick:(0,h.getNavigationHandler)(B?.rtl,o.onNextSection,o.onPrevSection),label:(0,h.getNavigationLabel)(B?.rtl,q("Next Section"),q("Previous Section"))})]})}]),c()}catch(a){c(a)}},!1),846447,a=>{"use strict";a.s([])},537148,a=>{"use strict";a.s([])},593133,a=>a.a(async(b,c)=>{try{var d=a.i(890392),e=b([d]);[d]=e.then?(await e)():e;let f=a=>a.replace(/\r\n/g,"  ").replace(/\r/g," ").replace(/\n/g," ").trimStart(),g=(a,b)=>{let c="en",e=a.match(/xml:lang\s*=\s*"([^"]+)"/);if(e&&e[1]){let a=e[1].split("-");c=a.length>1?`${a[0].toLowerCase()}-${a[1].toUpperCase()}`:a[0].toLowerCase(),c=(0,d.code6392to6391)(c)||c,(0,d.isValidLang)(c)||(c="en")}b=(0,d.code6392to6391)(b?.toLowerCase()||"")||b,"en"===c&&b&&!(0,d.isSameLang)(c,b)&&(c=b.split("-")[0].toLowerCase());let f=a.replace(/<lang[^>]*>.*?<\/lang>/gs,"");return(0,d.inferLangFromScript)(f,c)};a.s(["filterSSMLWithLang",0,(a,b,c)=>{let e,f=g(a,c),h=(0,d.code6392to6391)(b.toLowerCase())||b.toLowerCase();if((0,d.isSameLang)(h,f))return a.replace(/<lang\s+xml:lang="([^"]+)"[^>]*>.*?<\/lang>/gs,(a,b)=>{let c=(0,d.code6392to6391)(b.toLowerCase())||b.toLowerCase();return(0,d.isSameLang)(c,f)?a:""});let i=[],j=/<lang\s+xml:lang="([^"]+)"[^>]*>(.*?)<\/lang>/gs,k=new RegExp(j.source,j.flags);for(;null!==(e=k.exec(a));){let a=(0,d.code6392to6391)(e[1].toLowerCase())||e[1].toLowerCase();(0,d.isSameLang)(a,h)&&i.push({match:e[0],lang:e[1],content:e[2]})}if(i.length>0){let b=a.match(/<speak[^>]*>/i),c=a.match(/<\/speak>/i);if(!b||!c)return a;let d=i.map(a=>a.match).join("");return`${b[0]}${d}${c[0]}`}return a},"genSSML",0,(a,b,c,d)=>{let e=b.replace(/^<break\b[^>]*>/i,"");return`
    <speak version="1.0" xml:lang="${a}">
      <voice name="${c}">
        <prosody rate="${d}" >
            ${e}
        </prosody>
      </voice>
    </speak>
  `},"parseSSMLLang",0,g,"parseSSMLMarks",0,(a,b)=>{let c,e=g(a,b)||"en";a=a.replace(/<speak[^>]*>/i,"").replace(/<\/speak>/i,"");let h="",i=[],j=null,k=e,l=[],m=/<(\/?)(\w+)([^>]*)>|([^<]+)/g;for(;null!==(c=m.exec(a));)if(c[4]){let a=c[4],b=f(a);if(b&&j){let a=h.length;h+=b,i.push({offset:a,name:j,text:b,language:(0,d.inferLangFromScript)(b,k)||k})}else h+=f(a)}else{let a="/"===c[1],b=c[2],d=c[3];if("mark"!==b||a){if("lang"===b)if(a)k=l.pop()??e;else{l.push(k);let a=d?.match(/xml:lang="([^"]+)"/);a&&(k=a[1])}}else{let a=d?.match(/name="([^"]+)"/);a&&(j=a[1])}}return{plainText:h,marks:i}}]),c()}catch(a){c(a)}},!1),94591,a=>{"use strict";a.s(["SILENCE_DATA",0,"data:audio/mp3;base64,//MkxAAHiAICWABElBeKPL/RANb2w+yiT1g/gTok//lP/W/l3h8QO/OCdCqCW2Cw//MkxAQHkAIWUAhEmAQXWUOFW2dxPu//9mr60ElY5sseQ+xxesmHKtZr7bsqqX2L//MkxAgFwAYiQAhEAC2hq22d3///9FTV6tA36JdgBJoOGgc+7qvqej5Zu7/7uI9l//MkxBQHAAYi8AhEAO193vt9KGOq+6qcT7hhfN5FTInmwk8RkqKImTM55pRQHQSq//MkxBsGkgoIAABHhTACIJLf99nVI///yuW1uBqWfEu7CgNPWGpUadBmZ////4sL//MkxCMHMAH9iABEmAsKioqKigsLCwtVTEFNRTMuOTkuNVVVVVVVVVVVVVVVVVVV//MkxCkECAUYCAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV","WEB_SPEECH_BLACKLISTED_VOICES",0,["Albert","Bad News","Bahh","Bells","Boing","Bubbles","Cellos","Eddy","Flo","Fred","Good News","Grandma","Grandpa","Jester","Junior","Kathy","Organ","Ralph","Reed","Rocko","Sandy","Shelley","Superstar","Trinoids","Whisper","Wobble","Zarvox"]])},581833,a=>{"use strict";class b{static LOCAL_STORAGE_KEY="ttsPreferredVoices";static PREFERRED_CLIENT_KEY="preferredClient";static normalizeLanguage(a){return a?a.toLowerCase().slice(0,2):"n/a"}static setPreferredClient(a){if(!a)return;let b=this.getPreferences();b[this.PREFERRED_CLIENT_KEY]=a,localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(b))}static setPreferredVoice(a,b,c){if(!a||!b||!c)return;let d=this.getPreferences(),e=this.normalizeLanguage(b);d[`${a}-${e}`]=c,localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(d))}static getPreferredClient(){return this.getPreferences()[this.PREFERRED_CLIENT_KEY]||null}static getPreferredVoice(a,b){let c=this.getPreferences(),d=this.normalizeLanguage(b);return c[`${a}-${d}`]||null}static getPreferences(){let a=localStorage.getItem(this.LOCAL_STORAGE_KEY);return a?JSON.parse(a):{}}static sortVoicesFunc(a,b){let c=a.lang.split("-")[1]||"",d=b.lang.split("-")[1]||"";return c===d?a.name<b.name?-1:+(a.name>b.name):"CN"===c?-1:"CN"===d?1:"TW"===c?-1:"TW"===d?1:"HK"===c?-1:"HK"===d?1:"US"===c?-1:"US"===d?1:"GB"===c?-1:"GB"===d?1:a.name<b.name?-1:+(a.name>b.name)}}a.s(["TTSUtils",()=>b])},117634,a=>a.a(async(b,c)=>{try{var d=a.i(465863),e=a.i(593133),f=a.i(94591),g=a.i(581833),h=b([e]);async function*i(a,b,c,d,f,g,h,i){let{marks:j}=(0,e.parseSSMLMarks)(a,b),k=window.speechSynthesis,l=new SpeechSynthesisUtterance;for(let a of j){let{language:b}=a;i(a),l.text=a.text,l.rate=c(),l.pitch=d();let e=await f(b);e&&(l.voice=e,g(e.voiceURI)),b&&(l.lang=b,h(b)),yield{type:"boundary",speaking:!0,name:"sentence",mark:a.name};let j=await new Promise(a=>{l.onend=()=>a({type:"end",speaking:!1}),l.onerror=b=>a({type:"error",speaking:!1,error:b.error}),k.speak(l)});if(yield j,"error"===j.type)break}}[e]=h.then?(await h)():h;class j{name="web-speech";initialized=!1;controller;#a=[];#b="en";#c="";#d="";#e=1;#f=1;#g=window.speechSynthesis;constructor(a){this.controller=a}async init(){return this.#g?(await new Promise(a=>{let b=()=>{this.#a=this.#g.getVoices().map(a=>(a.id=a.voiceURI||a.name,a)),a()};this.#g.getVoices().length>0?b():void 0!==this.#g.onvoiceschanged?this.#g.onvoiceschanged=b:(console.warn("Voiceschanged event not supported."),a())}),this.initialized=!0):this.initialized=!1,this.initialized}getVoiceIdFromLang=async a=>{let b=g.TTSUtils.getPreferredVoice(this.name,a),c=this.#a.find(a=>a.id===b)||(await this.getVoices(a))[0]?.voices[0]||null;return c?.id||this.#d||""};getWebSpeechVoiceFromLang=async a=>{let b=await this.getVoiceIdFromLang(a);return this.#a.find(a=>a.id===b)||null};async *speak(a,b,c=!1){if(!c)for await(let c of i(a,this.#b,()=>this.#e,()=>this.#f,this.getWebSpeechVoiceFromLang,a=>this.#d=a,a=>this.#c=a,a=>this.controller?.dispatchSpeakMark(a))){if(b.aborted){console.log("TTS aborted"),yield{code:"error",message:"Aborted"};return}"boundary"===c.type?yield{code:"boundary",mark:c.mark??"",message:`${c.name??"Unknown"} ${c.charIndex??0}/${c.charLength??0}`}:"error"===c.type?yield{code:"error",message:c.error??"Unknown error"}:"end"===c.type&&(yield{code:"end",message:"Speech finished"})}}async pause(){return this.#g.pause(),!0}async resume(){return this.#g.resume(),!0}async stop(){this.#g.cancel()}setPrimaryLang(a){this.#b=a}async setRate(a){this.#e=a}async setPitch(a){this.#f=a}async setVoice(a){let b=this.#a.find(b=>b.id===a);b&&(this.#d=b.id)}async getAllVoices(){return this.#a.map(a=>({id:a.id,name:a.name,lang:a.lang,disabled:!this.initialized}))}async getVoices(a){let b="en"===a&&(0,d.getUserLocale)(a)||a,c=this.#a.filter(c=>c.lang.startsWith(b)||"en"===a&&["en-US","en-GB"].includes(c.lang)).filter(a=>{let b;return!(b=a.voiceURI||"").includes("com.apple")||b.includes("com.apple.voice.compact")}).filter(a=>!1===f.WEB_SPEECH_BLACKLISTED_VOICES.some(b=>a.name.includes(b))),e=new Set,h=c.map(a=>({id:a.voiceURI,name:a.name,lang:a.lang})).filter(a=>!e.has(a.id)&&(e.add(a.id),!0));return h.forEach(a=>{a.disabled=!this.initialized}),[{id:"web-speech-api",name:"Web TTS",voices:h.sort(g.TTSUtils.sortVoicesFunc),disabled:!this.initialized||0===h.length}]}getGranularities(){return["sentence"]}getVoiceId(){return this.#d}getSpeakingLang(){return this.#c}async shutdown(){this.initialized=!1,this.#a=[],await this.stop()}}a.s(["WebSpeechClient",()=>j]),c()}catch(a){c(a)}},!1),648015,(a,b,c)=>{b.exports=a.x("isomorphic-ws",()=>require("isomorphic-ws"))},26035,a=>{"use strict";class b{capacity;map;onEvict;constructor(a,b){if(a<=0)throw Error("LRUCache capacity must be greater than 0");this.capacity=a,this.map=new Map,this.onEvict=b}get(a){if(!this.map.has(a))return;let b=this.map.get(a);return this.map.delete(a),this.map.set(a,b),b}set(a,b){if(this.map.has(a)){let b=this.map.get(a);this.map.delete(a),this.onEvict&&this.onEvict(a,b)}else if(this.map.size===this.capacity){let a=this.map.keys().next().value;if(a){let b=this.map.get(a);this.map.delete(a),this.onEvict&&this.onEvict(a,b)}}this.map.set(a,b)}has(a){return this.map.has(a)}delete(a){if(this.map.has(a)){let b=this.map.get(a),c=this.map.delete(a);return c&&this.onEvict&&this.onEvict(a,b),c}return!1}clear(){if(this.onEvict)for(let[a,b]of this.map)this.onEvict(a,b);this.map.clear()}size(){return this.map.size}entries(){return Array.from(this.map).reverse()}}a.s(["LRUCache",()=>b])},764344,a=>a.a(async(b,c)=>{try{let m;var d=a.i(399577),e=a.i(648015),f=a.i(254799),g=a.i(465863),h=a.i(26035),i=a.i(593133),j=a.i(75788),k=a.i(557469),l=b([i,j]);[i,j]=l.then?(await l)():l;let n="6A5AA1D4EAFF4E9FB37E23D68491D6F4",o="143.0.3650.75",p=o.split(".")[0],q={"af-ZA":["af-ZA-AdriNeural","af-ZA-WillemNeural"],"am-ET":["am-ET-AmehaNeural","am-ET-MekdesNeural"],"ar-AE":["ar-AE-FatimaNeural","ar-AE-HamdanNeural"],"ar-BH":["ar-BH-AliNeural","ar-BH-LailaNeural"],"ar-DZ":["ar-DZ-AminaNeural","ar-DZ-IsmaelNeural"],"ar-EG":["ar-EG-SalmaNeural","ar-EG-ShakirNeural"],"ar-IQ":["ar-IQ-BasselNeural","ar-IQ-RanaNeural"],"ar-JO":["ar-JO-SanaNeural","ar-JO-TaimNeural"],"ar-KW":["ar-KW-FahedNeural","ar-KW-NouraNeural"],"ar-LB":["ar-LB-LaylaNeural","ar-LB-RamiNeural"],"ar-LY":["ar-LY-ImanNeural","ar-LY-OmarNeural"],"ar-MA":["ar-MA-JamalNeural","ar-MA-MounaNeural"],"ar-OM":["ar-OM-AbdullahNeural","ar-OM-AyshaNeural"],"ar-QA":["ar-QA-AmalNeural","ar-QA-MoazNeural"],"ar-SA":["ar-SA-HamedNeural","ar-SA-ZariyahNeural"],"ar-SY":["ar-SY-AmanyNeural","ar-SY-LaithNeural"],"ar-TN":["ar-TN-HediNeural","ar-TN-ReemNeural"],"ar-YE":["ar-YE-MaryamNeural","ar-YE-SalehNeural"],"az-AZ":["az-AZ-BabekNeural","az-AZ-BanuNeural"],"bg-BG":["bg-BG-BorislavNeural","bg-BG-KalinaNeural"],"bn-BD":["bn-BD-NabanitaNeural","bn-BD-PradeepNeural"],"bn-IN":["bn-IN-BashkarNeural","bn-IN-TanishaaNeural"],"bs-BA":["bs-BA-GoranNeural","bs-BA-VesnaNeural"],"ca-ES":["ca-ES-EnricNeural","ca-ES-JoanaNeural"],"cs-CZ":["cs-CZ-AntoninNeural","cs-CZ-VlastaNeural"],"cy-GB":["cy-GB-AledNeural","cy-GB-NiaNeural"],"da-DK":["da-DK-ChristelNeural","da-DK-JeppeNeural"],"de-AT":["de-AT-IngridNeural","de-AT-JonasNeural"],"de-CH":["de-CH-JanNeural","de-CH-LeniNeural"],"de-DE":["de-DE-AmalaNeural","de-DE-ConradNeural","de-DE-FlorianMultilingualNeural","de-DE-KatjaNeural","de-DE-KillianNeural","de-DE-SeraphinaMultilingualNeural"],"el-GR":["el-GR-AthinaNeural","el-GR-NestorasNeural"],"en-AU":["en-AU-NatashaNeural","en-AU-WilliamNeural"],"en-CA":["en-CA-ClaraNeural","en-CA-LiamNeural"],"en-GB":["en-GB-LibbyNeural","en-GB-MaisieNeural","en-GB-RyanNeural","en-GB-SoniaNeural","en-GB-ThomasNeural"],"en-HK":["en-HK-SamNeural","en-HK-YanNeural"],"en-IE":["en-IE-ConnorNeural","en-IE-EmilyNeural"],"en-IN":["en-IN-NeerjaExpressiveNeural","en-IN-NeerjaNeural","en-IN-PrabhatNeural"],"en-KE":["en-KE-AsiliaNeural","en-KE-ChilembaNeural"],"en-NG":["en-NG-AbeoNeural","en-NG-EzinneNeural"],"en-NZ":["en-NZ-MitchellNeural","en-NZ-MollyNeural"],"en-PH":["en-PH-JamesNeural","en-PH-RosaNeural"],"en-SG":["en-SG-LunaNeural","en-SG-WayneNeural"],"en-TZ":["en-TZ-ElimuNeural","en-TZ-ImaniNeural"],"en-US":["en-US-AnaNeural","en-US-AndrewMultilingualNeural","en-US-AndrewNeural","en-US-AriaNeural","en-US-AvaMultilingualNeural","en-US-AvaNeural","en-US-BrianMultilingualNeural","en-US-BrianNeural","en-US-ChristopherNeural","en-US-EmmaMultilingualNeural","en-US-EmmaNeural","en-US-EricNeural","en-US-GuyNeural","en-US-JennyNeural","en-US-MichelleNeural","en-US-RogerNeural","en-US-SteffanNeural"],"es-AR":["es-AR-ElenaNeural","es-AR-TomasNeural"],"es-BO":["es-BO-MarceloNeural","es-BO-SofiaNeural"],"es-CL":["es-CL-CatalinaNeural","es-CL-LorenzoNeural"],"es-CO":["es-CO-GonzaloNeural","es-CO-SalomeNeural"],"es-CR":["es-CR-JuanNeural","es-CR-MariaNeural"],"es-CU":["es-CU-BelkysNeural","es-CU-ManuelNeural"],"es-DO":["es-DO-EmilioNeural","es-DO-RamonaNeural"],"es-EC":["es-EC-AndreaNeural","es-EC-LuisNeural"],"es-ES":["es-ES-AlvaroNeural","es-ES-ElviraNeural","es-ES-XimenaNeural"],"es-US":["es-US-AlonsoNeural","es-US-PalomaNeural"],"et-EE":["et-EE-AnuNeural","et-EE-KertNeural"],"fa-IR":["fa-IR-DilaraNeural","fa-IR-FaridNeural"],"fi-FI":["fi-FI-HarriNeural","fi-FI-NooraNeural"],"fil-PH":["fil-PH-AngeloNeural","fil-PH-BlessicaNeural"],"fr-BE":["fr-BE-CharlineNeural","fr-BE-GerardNeural"],"fr-CA":["fr-CA-AntoineNeural","fr-CA-JeanNeural","fr-CA-SylvieNeural","fr-CA-ThierryNeural"],"fr-CH":["fr-CH-ArianeNeural","fr-CH-FabriceNeural"],"fr-FR":["fr-FR-DeniseNeural","fr-FR-EloiseNeural","fr-FR-HenriNeural","fr-FR-RemyMultilingualNeural","fr-FR-VivienneMultilingualNeural"],"ga-IE":["ga-IE-ColmNeural","ga-IE-OrlaNeural"],"gl-ES":["gl-ES-RoiNeural","gl-ES-SabelaNeural"],"gu-IN":["gu-IN-DhwaniNeural","gu-IN-NiranjanNeural"],"he-IL":["he-IL-AvriNeural","he-IL-HilaNeural"],"hi-IN":["hi-IN-MadhurNeural","hi-IN-SwaraNeural"],"hr-HR":["hr-HR-GabrijelaNeural","hr-HR-SreckoNeural"],"hu-HU":["hu-HU-NoemiNeural","hu-HU-TamasNeural"],"id-ID":["id-ID-ArdiNeural","id-ID-GadisNeural"],"is-IS":["is-IS-GudrunNeural","is-IS-GunnarNeural"],"it-IT":["it-IT-DiegoNeural","it-IT-ElsaNeural","it-IT-GiuseppeMultilingualNeural","it-IT-IsabellaNeural"],"iu-Cans-CA":["iu-Cans-CA-SiqiniqNeural","iu-Cans-CA-TaqqiqNeural"],"iu-Latn-CA":["iu-Latn-CA-SiqiniqNeural","iu-Latn-CA-TaqqiqNeural"],"ja-JP":["ja-JP-KeitaNeural","ja-JP-NanamiNeural"],"jv-ID":["jv-ID-DimasNeural","jv-ID-SitiNeural"],"ka-GE":["ka-GE-EkaNeural","ka-GE-GiorgiNeural"],"kk-KZ":["kk-KZ-AigulNeural","kk-KZ-DauletNeural"],"km-KH":["km-KH-PisethNeural","km-KH-SreymomNeural"],"kn-IN":["kn-IN-GaganNeural","kn-IN-SapnaNeural"],"ko-KR":["ko-KR-HyunsuMultilingualNeural","ko-KR-InJoonNeural","ko-KR-SunHiNeural"],"lo-LA":["lo-LA-ChanthavongNeural","lo-LA-KeomanyNeural"],"lt-LT":["lt-LT-LeonasNeural","lt-LT-OnaNeural"],"lv-LV":["lv-LV-EveritaNeural","lv-LV-NilsNeural"],"mk-MK":["mk-MK-AleksandarNeural","mk-MK-MarijaNeural"],"ml-IN":["ml-IN-MidhunNeural","ml-IN-SobhanaNeural"],"mn-MN":["mn-MN-BataaNeural","mn-MN-YesuiNeural"],"mr-IN":["mr-IN-AarohiNeural","mr-IN-ManoharNeural"],"ms-MY":["ms-MY-OsmanNeural","ms-MY-YasminNeural"],"mt-MT":["mt-MT-GraceNeural","mt-MT-JosephNeural"],"my-MM":["my-MM-NilarNeural","my-MM-ThihaNeural"],"nb-NO":["nb-NO-FinnNeural","nb-NO-PernilleNeural"],"ne-NP":["ne-NP-HemkalaNeural","ne-NP-SagarNeural"],"nl-BE":["nl-BE-ArnaudNeural","nl-BE-DenaNeural"],"nl-NL":["nl-NL-ColetteNeural","nl-NL-FennaNeural","nl-NL-MaartenNeural"],"pl-PL":["pl-PL-MarekNeural","pl-PL-ZofiaNeural"],"ps-AF":["ps-AF-GulNawazNeural","ps-AF-LatifaNeural"],"pt-BR":["pt-BR-AntonioNeural","pt-BR-FranciscaNeural","pt-BR-ThalitaMultilingualNeural"],"pt-PT":["pt-PT-DuarteNeural","pt-PT-RaquelNeural"],"ro-RO":["ro-RO-AlinaNeural","ro-RO-EmilNeural"],"ru-RU":["ru-RU-DmitryNeural","ru-RU-SvetlanaNeural"],"si-LK":["si-LK-SameeraNeural","si-LK-ThiliniNeural"],"sk-SK":["sk-SK-LukasNeural","sk-SK-ViktoriaNeural"],"sl-SI":["sl-SI-PetraNeural","sl-SI-RokNeural"],"so-SO":["so-SO-MuuseNeural","so-SO-UbaxNeural"],"sq-AL":["sq-AL-AnilaNeural","sq-AL-IlirNeural"],"sr-RS":["sr-RS-NicholasNeural","sr-RS-SophieNeural"],"su-ID":["su-ID-JajangNeural","su-ID-TutiNeural"],"sv-SE":["sv-SE-MattiasNeural","sv-SE-SofieNeural"],"sw-KE":["sw-KE-RafikiNeural","sw-KE-ZuriNeural"],"sw-TZ":["sw-TZ-DaudiNeural","sw-TZ-RehemaNeural"],"ta-IN":["ta-IN-PallaviNeural","ta-IN-ValluvarNeural"],"ta-LK":["ta-LK-KumarNeural","ta-LK-SaranyaNeural"],"ta-MY":["ta-MY-KaniNeural","ta-MY-SuryaNeural"],"ta-SG":["ta-SG-AnbuNeural","ta-SG-VenbaNeural"],"te-IN":["te-IN-MohanNeural","te-IN-ShrutiNeural"],"th-TH":["th-TH-NiwatNeural","th-TH-PremwadeeNeural"],"tr-TR":["tr-TR-AhmetNeural","tr-TR-EmelNeural"],"uk-UA":["uk-UA-OstapNeural","uk-UA-PolinaNeural"],"ur-IN":["ur-IN-GulNeural","ur-IN-SalmanNeural"],"ur-PK":["ur-PK-AsadNeural","ur-PK-UzmaNeural"],"uz-UZ":["uz-UZ-MadinaNeural","uz-UZ-SardorNeural"],"vi-VN":["vi-VN-HoaiMyNeural","vi-VN-NamMinhNeural"],"zh-CN":["zh-CN-XiaoxiaoNeural","zh-CN-XiaoyiNeural","zh-CN-YunjianNeural","zh-CN-YunxiNeural","zh-CN-YunxiaNeural","zh-CN-YunyangNeural","zh-CN-liaoning-XiaobeiNeural","zh-CN-shaanxi-XiaoniNeural"],"zh-HK":["zh-HK-HiuGaaiNeural","zh-HK-HiuMaanNeural","zh-HK-WanLungNeural"],"zh-TW":["zh-TW-HsiaoChenNeural","zh-TW-HsiaoYuNeural","zh-TW-YunJheNeural"],"zu-ZA":["zu-ZA-ThandoNeural","zu-ZA-ThembaNeural"]};class r{static voices=(m=q,Object.entries(m).flatMap(([a,b])=>b.map(b=>({name:b.replace(`${a}-`,"").replace("Neural",""),id:b,lang:a}))));static audioCache=new h.LRUCache(200);static audioUrlCache=new h.LRUCache(200,(a,b)=>{b.startsWith("blob:")&&URL.revokeObjectURL(b)});protocol="wss";constructor(a){a&&(this.protocol=a)}async #h({lang:a,text:b,voice:c,rate:d}){let e=(0,k.getNodeAPIBaseUrl)()+"/tts/edge",f=await (0,j.fetchWithAuth)(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:b,voice:c,rate:d,lang:a})});if(!f.ok)throw Error(`Edge TTS HTTP request failed: ${f.status} ${f.statusText}`);return f}async #i({lang:b,text:c,voice:d,rate:h}){let j,l,m,q=(0,g.randomMd5)(),r=new URLSearchParams({ConnectionId:q,TrustedClientToken:n,"Sec-MS-GEC":(j=Math.floor(Date.now()/1e3)+0x2b6109100,j-=j%300,j*=1e7,l=`${j.toFixed(0)}${n}`,(0,f.createHash)("sha256").update(l,"ascii").digest("hex").toUpperCase()),"Sec-MS-GEC-Version":`1-${o}`}),s=`wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1?${r.toString()}`,t=new Date().toString(),u={"User-Agent":`Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/${p}.0.0.0 Safari/537.36 Edg/${p}.0.0.0`,"Accept-Encoding":"gzip, deflate, br, zstd","Accept-Language":"en-US,en;q=0.9",Pragma:"no-cache","Cache-Control":"no-cache",Origin:"chrome-extension://jdiccldimpdaibmpdkjnbmckianbfold","Sec-WebSocket-Version":"13",Cookie:`muid=${(m=new Uint8Array(16),crypto.getRandomValues(m),Array.from(m).map(a=>a.toString(16).padStart(2,"0")).join("").toUpperCase())};`},v=JSON.stringify({context:{synthesis:{audio:{metadataoptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!0},outputFormat:"audio-24khz-48kbitrate-mono-mp3"}}}}),w=(a,b)=>{let c="";for(let b of Object.keys(a))c+=`${b}: ${a[b]}\r
`;return`${c}\r
${b}`},x=a=>{let b=a.split("\n"),c={},d="",e=0;for(e=0;e<b.length;e++){let a=b[e].trim();if(!a)break;let d=a.indexOf(":");if(-1===d)continue;let f=a.slice(0,d).trim(),g=a.slice(d+1).trim();c[f]=g}for(e+=1;e<b.length;e++)d+=b[e]+"\n";return{headers:c,body:d}},y=(0,i.genSSML)(b,c,d,h),z=w({"Content-Type":"application/ssml+xml",Path:"ssml","X-RequestId":q,"X-Timestamp":t},y),A=w({"Content-Type":"application/json; charset=utf-8",Path:"speech.config","X-Timestamp":t},v);return new Promise((0,k.isTauriAppPlatform)()?async(b,c)=>{try{let d=(await a.A(795251)).default,e=await d.connect(s,{headers:u}),f=new ArrayBuffer(0),g=await e.addListener(a=>{if("Text"===a.type){let{headers:d}=x(a.data);if("turn.end"===d.Path){if(e.disconnect(),g(),!f.byteLength)return c(Error("No audio data received."));let a=new Response(f);b(a)}}else if("Binary"===a.type){let b;b=a.data instanceof Uint8Array?a.data.buffer:new Uint8Array(a.data).buffer;let c=new DataView(b).getInt16(0);if(b.byteLength>c+2){let a=b.slice(2+c),d=new Uint8Array(f.byteLength+a.byteLength);d.set(new Uint8Array(f),0),d.set(new Uint8Array(a),f.byteLength),f=d.buffer}}});await e.send(A),await e.send(z)}catch(a){c(Error(`WebSocket error occurred: ${a}`))}}:(a,b)=>{let c=new e.default(s,{headers:u});c.binaryType="arraybuffer";let d=new ArrayBuffer(0);c.addEventListener("open",()=>{c.send(A),c.send(z)}),c.addEventListener("message",e=>{if("string"==typeof e.data){let{headers:f}=x(e.data);if("turn.end"===f.Path){if(c.close(),!d.byteLength)return b(Error("No audio data received."));let e=new Response(d);a(e)}}else if(e.data instanceof ArrayBuffer){let a=new DataView(e.data).getInt16(0);if(e.data.byteLength>a+2){let b=e.data.slice(2+a),c=new Uint8Array(d.byteLength+b.byteLength);c.set(new Uint8Array(d),0),c.set(new Uint8Array(b),d.byteLength),d=c.buffer}}}),c.addEventListener("close",()=>{d.byteLength||b(Error("No audio data received."))}),c.addEventListener("error",()=>{b(Error("WebSocket error occurred."))})})}async create(a){return"https"===this.protocol?this.#h(a):this.#i(a)}async createAudioUrl(a){let b,c=(b=JSON.stringify(a),(0,d.md5)(b));if(r.audioUrlCache.has(c))return r.audioUrlCache.get(c);try{let b=await this.create(a),d=await b.arrayBuffer(),e=new Blob([d],{type:"audio/mpeg"}),f=URL.createObjectURL(e);return r.audioCache.set(c,e),r.audioUrlCache.set(c,f),f}catch(a){throw a}}}a.s(["EdgeSpeechTTS",()=>r]),c()}catch(a){c(a)}},!1),8919,a=>a.a(async(b,c)=>{try{var d=a.i(465863),e=a.i(764344),f=a.i(593133),g=a.i(581833),h=b([e,f]);[e,f]=h.then?(await h)():h;class i{name="edge-tts";initialized=!1;controller;#a=[];#b="en";#c="";#d="";#e=1;#f=1;#j=null;#k=null;#l=!1;#m=0;#n=0;#o=null;constructor(a){this.controller=a}async init(a="wss"){this.#j=new e.EdgeSpeechTTS(a),this.#a=e.EdgeSpeechTTS.voices;try{await this.#j.create({lang:"en",text:"test",voice:"en-US-AriaNeural",rate:1,pitch:1}),this.initialized=!0}catch{"wss"===a?this.controller?.isAuthenticated?await this.init("https"):this.controller?.dispatchEvent(new CustomEvent("tts-need-auth")):this.initialized=!1}return this.initialized}getPayload=(a,b,c)=>({lang:a,text:b,voice:c,rate:1,pitch:this.#f});getVoiceIdFromLang=async a=>{let b=g.TTSUtils.getPreferredVoice(this.name,a),c=this.#a.find(a=>a.id===b);if(c)return c.id;let d=((await this.getVoices(a))[0]?.voices||[])[0]||null;return d?.id==="en-US-AnaNeural"?"en-US-AriaNeural":d?.id||this.#d||"en-US-AriaNeural"};async *speak(a,b,c=!1){let{marks:d}=(0,f.parseSSMLMarks)(a,this.#b);if(c){for(let a=0;a<Math.min(2,d.length)&&!b.aborted;a++){let b=d[a],{language:c}=b,e=await this.getVoiceIdFromLang(c);this.#d=e,await this.#j?.createAudioUrl(this.getPayload(c,b.text,e)).catch(b=>{console.warn("Error preloading mark",a,b)})}d.length>2&&(async()=>{for(let a=2;a<d.length;a++){let c=d[a];try{if(b.aborted)break;let{language:a}=c,d=await this.getVoiceIdFromLang(a);await this.#j?.createAudioUrl(this.getPayload(a,c.text,d))}catch(b){console.warn("Error preloading mark (bg)",a,b)}}})(),yield{code:"end",message:"Preload finished"};return}await this.stopInternal(),this.#k||(this.#k=new Audio);let e=this.#k;for(let a of(e.setAttribute("x-webkit-airplay","deny"),e.preload="auto",d)){this.controller?.dispatchSpeakMark(a);let c=null;try{let{language:d}=a,f=await this.getVoiceIdFromLang(d);this.#c=d;let g=await this.#j?.createAudioUrl(this.getPayload(d,a.text,f));if(b.aborted){yield{code:"error",message:"Aborted"};break}yield{code:"boundary",message:`Start chunk: ${a.name}`,mark:a.name};let h=await new Promise(d=>{let f=()=>{e.onended=null,e.onerror=null,e.src=""};(c=()=>{f(),d({code:"error",message:"Aborted"})},b.aborted)?c():(b.addEventListener("abort",c),e.onended=()=>{f(),d({code:"end",message:`Chunk finished: ${a.name}`})},e.onerror=a=>{f(),console.warn("Audio playback error:",a),d({code:"error",message:"Audio playback error"})},this.#l=!0,e.src=g||"",e.play().then(()=>e.playbackRate=this.#e).catch(a=>{f(),console.error("Failed to play audio:",a),d({code:"error",message:"Playback failed: "+a.message})}))});yield h}catch(c){if(c instanceof Error&&"No audio data received."===c.message){console.warn("No audio data received for:",a.text),yield{code:"end",message:`Chunk finished: ${a.name}`};continue}let b=c instanceof Error?c.message:String(c);console.warn("TTS error for mark:",a.text,b),yield{code:"error",message:b};break}finally{c&&b.removeEventListener("abort",c)}}await this.stopInternal()}async pause(){return!this.#l||!this.#k||(this.#m=this.#k.currentTime-this.#n,await this.#k.pause(),this.#l=!1,!0)}#p(){if(null!==this.#o)return this.#o;let a=navigator.userAgent,b=/Safari/.test(a)&&!/Chrome/.test(a),c=/iPad|iPhone|iPod/.test(a);return b||c?this.#o=.2:this.#o=0,this.#o}async resume(){if(this.#l||!this.#k)return!0;let a=this.#p();return this.#k.currentTime=Math.max(0,this.#k.currentTime-a),await this.#k.play(),this.#l=!0,this.#n=this.#k.currentTime-this.#m,!0}async stop(){await this.stopInternal()}async stopInternal(){this.#l=!1,this.#m=0,this.#n=0,this.#k&&(this.#k.pause(),this.#k.currentTime=0,this.#k?.onended&&this.#k.onended(new Event("stopped")),this.#k.src="")}async setRate(a){this.#e=a}async setPitch(a){this.#f=a}async setVoice(a){let b=this.#a.find(b=>b.id===a);b&&(this.#d=b.id)}async getAllVoices(){return this.#a.forEach(a=>{a.disabled=!this.initialized}),this.#a}async getVoices(a){let b="en"===a&&(0,d.getUserLocale)(a)||a,c=(await this.getAllVoices()).filter(c=>c.lang.startsWith(b)||"en"===a&&["en-US","en-GB"].includes(c.lang));return[{id:"edge-tts",name:"Edge TTS",voices:c.sort(g.TTSUtils.sortVoicesFunc),disabled:!this.initialized||0===c.length}]}setPrimaryLang(a){this.#b=a}getGranularities(){return["sentence"]}getVoiceId(){return this.#d}getSpeakingLang(){return this.#c}async shutdown(){this.initialized=!1,this.#k=null,this.#a=[]}}a.s(["EdgeTTSClient",()=>i]),c()}catch(a){c(a)}},!1),859377,a=>a.a(async(b,c)=>{try{var d=a.i(177898),e=a.i(465863),f=a.i(593133),g=a.i(581833),h=b([f]);[f]=h.then?(await h)():h;let i={default:"System TTS",msctts:"Msc TTS",mstrans:"MSTrans TTS",microsoft:"Microsoft TTS",bytedance:"ByteDance TTS",peiyinya:"PeiYinYa TTS",huoshan:"HuoShan TTS",sougou:"Sougou TTS",xiaomi:"XiaoMi TTS",bdetts:"BDeTTS",bdotts:"BDoTTS",vcstts:"VcsTTS",isstts:"IssTTS",xfpeiyin:"XFPeiYin",azure:"Azure TTS",edgetts:"Edge TTS",google:"Google TTS",gemini:"Gemini TTS",weread:"WeRead TTS",aispeech:"Aispeech"};class j{name="native-tts";initialized=!1;controller;#a=[];#b="en";#c="";#d="";#e=1;#f=1;#q=null;#r=new Map;constructor(a){this.controller=a}async setupEventListener(){try{if(this.#q)return;this.#q=await (0,d.addPluginListener)("native-tts","tts_events",a=>{let{utteranceId:b,code:c,message:d,mark:e}=a,f=this.#r.get(b);if(!f)return;let g={code:c,message:d,mark:e};f.eventQueue.push(g),"end"===c||"error"===c?(f.finished=!0,f.resolver&&f.resolver({value:void 0,done:!0})):f.resolver&&(f.resolver({value:g,done:!1}),f.resolver=null)})}catch(a){console.error("Failed to setup TTS event listener:",a)}}async init(){let a=await (0,d.invoke)("plugin:native-tts|init");return this.initialized=a.success,this.initialized&&this.setupEventListener(),this.initialized}async *speakMark(a,b,c){if(b)return void(yield{code:"end",message:"Dummy preload finished"});let{language:e}=a,f=await this.getVoiceIdFromLang(e);this.#d=f,this.#c=e,await this.setVoice(f);try{let e=(await (0,d.invoke)("plugin:native-tts|speak",{payload:{text:a.text,preload:b}})).utteranceId;this.#r.set(e,{eventQueue:[],resolver:null,finished:!1});let f=()=>{let a=this.#r.get(e);a&&a.resolver&&(a.resolver({value:{code:"error",message:"Aborted"},done:!0}),a.resolver=null),this.stop()};c.addEventListener("abort",f);try{for(;;){let b=this.#r.get(e);if(!b)break;if(b.eventQueue.length>0){let c=b.eventQueue.shift();if(c.mark=a.name,yield c,"end"===c.code||"error"===c.code)break}else if(b.finished)break;else{let a=new Promise(a=>{let b=this.#r.get(e);if(!b)return a();b.resolver=b=>a(b.value?.code==="error"?b.value:void 0)}),b=new Promise(a=>setTimeout(()=>a(null),100)),c=await Promise.race([a,b]);c&&(yield c)}if(c.aborted)break}}finally{c.removeEventListener("abort",f),this.#r.delete(e)}}catch(a){throw console.error("Failed to speak:",a),a}}async *speak(a,b,c=!1){let{marks:d}=(0,f.parseSSMLMarks)(a,this.#b);for(let a of d)for await(let d of(this.controller?.dispatchSpeakMark(a),this.speakMark(a,c,b))){if(b.aborted)return void(yield{code:"error",message:"Aborted"});yield d}}async getVoiceIdFromLang(a){let b=g.TTSUtils.getPreferredVoice(this.name,a),c=this.#a.find(a=>a.id===b)||(await this.getVoices(a))[0]?.voices[0]||null;return c?.id||""}async pause(){return await (0,d.invoke)("plugin:native-tts|pause"),!1}async resume(){return await (0,d.invoke)("plugin:native-tts|resume"),!1}async stop(){await (0,d.invoke)("plugin:native-tts|stop"),this.#r.clear()}async setRate(a){this.#e=parseFloat(Math.pow(a,2.5).toFixed(2)),await (0,d.invoke)("plugin:native-tts|set_rate",{payload:{rate:this.#e}})}async setPitch(a){this.#f=a,await (0,d.invoke)("plugin:native-tts|set_pitch",{payload:{pitch:this.#f}})}async setVoice(a){this.#d=a,await (0,d.invoke)("plugin:native-tts|set_voice",{payload:{voice:a}})}async getAllVoices(){if(this.#a.length>0)return this.#a;try{let a=await (0,d.invoke)("plugin:native-tts|get_all_voices");return this.#a=a.voices,this.#a}catch(a){return console.error("Failed to get all voices:",a),[]}}async getVoices(a){let b="en"===a&&(0,e.getUserLocale)(a)||a,c=(await this.getAllVoices()).filter(c=>c.lang.startsWith(b)||"en"===a&&["en-US","en-GB"].includes(c.lang)),d=new Map;return c.forEach(a=>{let{name:b,lang:c}=a,f=a.id.split("_")[0];f in i?a.name=b.replace(`${f}_`,"").replace(`${c}-`,"").replace("Neural","").trim():f="default",a.name=a.name.replace("NOT_SET",(0,e.stubTranslation)("Default")),d.has(f)||d.set(f,[]),d.get(f).push(a)}),Array.from(d.entries()).map(([a,b])=>({id:a,name:i[a]||a,voices:b.sort(g.TTSUtils.sortVoicesFunc),disabled:!this.initialized||0===b.length})).sort((a,b)=>"default"===a.id?-1:"default"===b.id?1:a.id.localeCompare(b.id))}setPrimaryLang(a){this.#b=a}getGranularities(){return["sentence"]}getVoiceId(){return this.#d}getSpeakingLang(){return this.#c}async shutdown(){this.#q&&(this.#q.unregister(),this.#q=null),await this.stop()}}a.s(["NativeTTSClient",()=>j]),c()}catch(a){c(a)}},!1),725436,a=>a.a(async(b,c)=>{try{var d=a.i(593133),e=a.i(640219),f=a.i(52105),g=a.i(117634),h=a.i(859377),i=a.i(8919),j=a.i(581833),k=b([d,g,h,i]);[d,g,h,i]=k.then?(await k)():k;let l="tts-highlight";class m extends EventTarget{appService=null;view;isAuthenticated=!1;preprocessCallback;#s=0;#t=null;#u=null;state="stopped";ttsLang="";ttsRate=1;ttsClient;ttsWebClient;ttsEdgeClient;ttsNativeClient=null;ttsWebVoices=[];ttsEdgeVoices=[];ttsNativeVoices=[];ttsTargetLang="";options={style:"highlight",color:"gray"};constructor(a,b,c=!1,d){super(),this.ttsWebClient=new g.WebSpeechClient(this),this.ttsEdgeClient=new i.EdgeTTSClient(this),a?.isAndroidApp&&(this.ttsNativeClient=new h.NativeTTSClient(this)),this.ttsClient=this.ttsWebClient,this.appService=a,this.view=b,this.isAuthenticated=c,this.preprocessCallback=d}async init(){let a=[];await this.ttsEdgeClient.init()&&a.push(this.ttsEdgeClient),this.ttsNativeClient&&await this.ttsNativeClient.init()&&(a.push(this.ttsNativeClient),this.ttsNativeVoices=await this.ttsNativeClient.getAllVoices()),await this.ttsWebClient.init()&&a.push(this.ttsWebClient),this.ttsClient=a[0]||this.ttsWebClient;let b=j.TTSUtils.getPreferredClient();if(b){let c=a.find(a=>a.name===b);c&&(this.ttsClient=c)}this.ttsWebVoices=await this.ttsWebClient.getAllVoices(),this.ttsEdgeVoices=await this.ttsEdgeClient.getAllVoices()}#v(){return a=>{let{overlayer:b}=this.view.renderer.getContents()[0],{style:c,color:d}=this.options;b?.remove(l),b?.add(l,a,e.Overlayer[c],{color:d})}}#w(){let{overlayer:a}=this.view.renderer.getContents()?.[0]||{};a?.remove(l)}async initViewTTS(a){a&&(this.options.style=a.style,this.options.color=a.color);let b=this.view.language.isCJK?"sentence":"word",c=this.ttsClient.getGranularities();c.includes(b)||(b=c[0]),await this.view.initTTS(b,(0,f.createRejectFilter)({tags:["rt"],contents:[{tag:"a",content:/^[\[\(]?[\*\d]+[\)\]]?$/}]}),this.#v())}async preloadSSML(a,b){if(a)for await(let c of(await this.ttsClient.speak(a,b,!0)));}async preloadNextSSML(a=4){let b=this.view.tts;if(!b)return;let c=0;for(let d=0;d<a;d++){let a=await this.#x(b.next());this.preloadSSML(a,new AbortController().signal),a&&c++}for(let a=0;a<c;a++)b.prev()}async #x(a){if(a)return a=a.replace(/<emphasis[^>]*>([^<]+)<\/emphasis>/g,"$1").replace(/[]/g,",").replace("<break/>"," ").replace(/\.{3,}/g,"   ").replace(//g,"  ").replace(/\*/g," ").replace(//g," "),this.ttsTargetLang&&(a=(0,d.filterSSMLWithLang)(a,this.ttsTargetLang)),this.preprocessCallback&&(a=await this.preprocessCallback(a)),a}async #y(a,b=!1){await this.stop(),this.#t=new AbortController;let{signal:c}=this.#t;this.#u=new Promise(async(e,f)=>{try{let f;if(console.log("TTS speak"),this.state="playing",c.addEventListener("abort",()=>{e()}),a=await this.#x(await a))this.#s=0;else{this.#s++,this.#s<10&&"playing"===this.state&&!b&&(e(),await this.view.next(),await this.forward()),console.log("no SSML, skipping for",this.#s);return}let{plainText:g,marks:h}=(0,d.parseSSMLMarks)(a);if((!g||0===h.length)&&!b)return e(),await this.forward();for await(let{code:b}of(this.dispatchSpeakMark(h[0]),await this.preloadSSML(a,c),await this.ttsClient.speak(a,c))){if(c.aborted)return void e();f=b}"end"!==f||"playing"!==this.state||b||(e(),await this.forward()),e()}catch(a){c.aborted?e():f(a)}finally{this.#t&&(this.#t.abort(),this.#t=null)}}),await this.#u.catch(a=>this.error(a))}async speak(a,b=!1){await this.initViewTTS(),this.#y(a,b).catch(a=>this.error(a)),this.preloadNextSSML(),this.dispatchSpeakMark()}play(){"playing"!==this.state?this.start():this.pause()}async start(){await this.initViewTTS();let a=this.state.includes("paused")?this.view.tts?.resume():this.view.tts?.start();this.state.includes("paused")&&this.resume(),this.#y(a),this.preloadNextSSML()}async pause(){this.state="paused",await this.ttsClient.pause().catch(a=>this.error(a))||(await this.stop(),this.state="stop-paused")}async resume(){this.state="playing",await this.ttsClient.resume().catch(a=>this.error(a))}async stop(){if(this.#t&&this.#t.abort(),await this.ttsClient.stop().catch(a=>this.error(a)),this.#u){let a=new Promise((a,b)=>setTimeout(()=>b(Error("Stop operation timed out")),3e3));await Promise.race([this.#u.catch(a=>this.error(a)),a]).catch(a=>this.error(a)),this.#u=null}this.state="stopped"}async backward(a=!1){await this.initViewTTS(),"playing"===this.state?(await this.stop(),a?this.#y(this.view.tts?.prevMark()):this.#y(this.view.tts?.prev())):(await this.stop(),this.state="backward-paused",a?this.view.tts?.prevMark(!0):this.view.tts?.prev(!0))}async forward(a=!1){await this.initViewTTS(),"playing"===this.state?(await this.stop(),a?this.#y(this.view.tts?.nextMark()):(this.#y(this.view.tts?.next()),this.preloadNextSSML())):(await this.stop(),this.state="forward-paused",a?this.view.tts?.nextMark(!0):this.view.tts?.next(!0))}async setLang(a){this.ttsLang=a,this.setPrimaryLang(a)}async setPrimaryLang(a){this.ttsEdgeClient.initialized&&this.ttsEdgeClient.setPrimaryLang(a),this.ttsWebClient.initialized&&this.ttsWebClient.setPrimaryLang(a),this.ttsNativeClient?.initialized&&this.ttsNativeClient?.setPrimaryLang(a)}async setRate(a){this.state="setrate-paused",this.ttsRate=a,await this.ttsClient.setRate(this.ttsRate)}async getVoices(a){let b=await this.ttsWebClient.getVoices(a),c=await this.ttsEdgeClient.getVoices(a);return[...await this.ttsNativeClient?.getVoices(a)??[],...c,...b]}async setVoice(a,b){this.state="setvoice-paused";let c=!!this.ttsEdgeVoices.find(b=>(""===a||b.id===a)&&!b.disabled),d=!!this.ttsNativeVoices.find(b=>(""===a||b.id===a)&&!b.disabled);if(c)this.ttsClient=this.ttsEdgeClient,await this.ttsClient.setRate(this.ttsRate);else if(d){if(!this.ttsNativeClient)throw Error("Native TTS client is not available");this.ttsClient=this.ttsNativeClient,await this.ttsClient.setRate(this.ttsRate)}else this.ttsClient=this.ttsWebClient,await this.ttsClient.setRate(this.ttsRate);j.TTSUtils.setPreferredClient(this.ttsClient.name),j.TTSUtils.setPreferredVoice(this.ttsClient.name,b,a),await this.ttsClient.setVoice(a)}getVoiceId(){return this.ttsClient.getVoiceId()}getSpeakingLang(){return this.ttsClient.getSpeakingLang()}setTargetLang(a){this.ttsTargetLang=a}dispatchSpeakMark(a){if(this.dispatchEvent(new CustomEvent("tts-speak-mark",{detail:a||{text:""}})),a){let b=this.view.tts?.setMark(a.name);this.dispatchEvent(new CustomEvent("tts-highlight-mark",{detail:b}))}}error(a){console.error(a),this.state="stopped"}async shutdown(){await this.stop(),this.#w(),this.ttsWebClient.initialized&&await this.ttsWebClient.shutdown(),this.ttsEdgeClient.initialized&&await this.ttsEdgeClient.shutdown(),this.ttsNativeClient?.initialized&&await this.ttsNativeClient.shutdown()}}a.s(["TTSController",()=>m]),c()}catch(a){c(a)}},!1),674899,a=>a.a(async(b,c)=>{try{a.i(846447),a.i(537148);var d=a.i(117634),e=a.i(8919),f=a.i(859377),g=a.i(725436);a.i(94591);var h=b([d,e,f,g]);[d,e,f,g]=h.then?(await h)():h,a.s([]),c()}catch(a){c(a)}},!1),404171,a=>{"use strict";var b=a.i(557469),c=a.i(465863),d=a.i(177898);class e{handlers={};eventListenerInited=!1;eventListeners=[];async requestPostNotificationPermission(){(await (0,d.invoke)("plugin:native-tts|checkPermissions")).postNotification.startsWith("prompt")&&await (0,d.invoke)("plugin:native-tts|requestPermissions",{permissions:["postNotification"]})}async initializeListeners(){if(this.eventListenerInited)return;this.eventListenerInited=!0;let a=await (0,d.addPluginListener)("native-tts","media-session-play",()=>{this.handlers.play&&this.handlers.play()});this.eventListeners.push(a);let b=await (0,d.addPluginListener)("native-tts","media-session-pause",()=>{this.handlers.pause&&this.handlers.pause()});this.eventListeners.push(b);let c=await (0,d.addPluginListener)("native-tts","media-session-next",()=>{this.handlers.nexttrack&&this.handlers.nexttrack()});this.eventListeners.push(c);let e=await (0,d.addPluginListener)("native-tts","media-session-previous",()=>{this.handlers.previoustrack&&this.handlers.previoustrack()});this.eventListeners.push(e);let f=await (0,d.addPluginListener)("native-tts","media-session-seek",a=>{let b=a.payload.position;this.handlers.seekto&&this.handlers.seekto(b)});this.eventListeners.push(f)}async cleanupListeners(){for(let a of this.eventListeners)await a.unregister();this.eventListeners=[],this.eventListenerInited=!1}async updateMetadata(a){try{await (0,d.invoke)("plugin:native-tts|update_media_session_metadata",{payload:a})}catch(a){console.error("Failed to update media metadata:",a)}}async updatePlaybackState(a){try{await (0,d.invoke)("plugin:native-tts|update_media_session_state",{payload:a})}catch(a){console.error("Failed to update playback state:",a)}}async setActive(a){try{a.active?(a.keepAppInForeground&&await this.requestPostNotificationPermission(),await this.initializeListeners()):await this.cleanupListeners(),await (0,d.invoke)("plugin:native-tts|set_media_session_active",{payload:a})}catch(a){console.error("Failed to set media session active state:",a)}}setActionHandler(a,b){b?this.handlers[a]=b:delete this.handlers[a]}}function f(){return"mediaSession"in navigator?navigator.mediaSession:"android"===(0,c.getOSPlatform)()&&(0,b.isTauriAppPlatform)()?new e:null}a.s(["TauriMediaSession",()=>e,"getMediaSession",()=>f])},478474,a=>{"use strict";let b=(a,b,c=1,d=1)=>{if(!b)return{left:0,right:0,top:0,bottom:0};let e=c*b.left+a.left,f=c*b.right+a.left;return{left:e,right:f,top:d*b.top+a.top,bottom:d*b.bottom+a.top}},c=({x:a,y:b})=>a>0&&b>0&&a<window.innerWidth&&b<window.innerHeight,d=(a,b,c)=>({x:Math.max(c,Math.min(a.x,b.right-b.left-c)),y:Math.max(c,Math.min(a.y,b.bottom-b.top-c))});a.s(["getPopupPosition",0,(a,b,c,d,e)=>{let f={x:0,y:0};return"up"===a.dir?(f.x=a.point.x-c/2,f.y=a.point.y-d):"down"===a.dir?(f.x=a.point.x-c/2,f.y=a.point.y+6):"left"===a.dir?(f.x=a.point.x-c,f.y=a.point.y-d/2):"right"===a.dir&&(f.x=a.point.x+6,f.y=a.point.y-d/2),f.x<e&&(f.x=e),f.y<e&&(f.y=e),f.x+c>b.right-b.left-e&&(f.x=b.right-b.left-e-c),f.y+d>b.bottom-b.top-e&&(f.y=b.bottom-b.top-e-d),{point:f,dir:a.dir}},"getPosition",0,(a,e,f,g=!1)=>{let{range:h,rect:i}=a&&"range"in a?a:{range:a,rect:void 0},j=(a=>{let b;for(b=a&&"object"==typeof a&&("tagName"in a)?a:a&&"object"==typeof a&&("collapse"in a)?a.commonAncestorContainer:a;b;){if(b.nodeType===Node.DOCUMENT_NODE){let a=b;if(a.defaultView&&a.defaultView.frameElement)return a.defaultView.frameElement}b=b.parentNode}return null})(h),k=(j?getComputedStyle(j).transform:"").match(/matrix\((.+)\)/),[l,,,m]=k?.[1]?.split(/\s*,\s*/)?.map(a=>parseFloat(a))??[],n=j?.getBoundingClientRect()??{top:0,left:0},o={top:0,right:0,bottom:0,left:0};if("nodeType"in h&&1===h.nodeType){let a=window.getComputedStyle(h);o={top:parseInt(a.paddingTop,10)||0,right:parseInt(a.paddingRight,10)||0,bottom:parseInt(a.paddingBottom,10)||0,left:parseInt(a.paddingLeft,10)||0}}let p=Array.from(h.getClientRects()).map(a=>({top:a.top+o.top,right:a.right-o.right,bottom:a.bottom-o.bottom,left:a.left+o.left})),q=i?b(n,i,l,m):b(n,p[0],l,m),r=i?b(n,i,l,m):b(n,p.at(-1),l,m);if(g){let a=q.left-e.left>e.right-q.right?"left":"right",b={point:d({x:"left"===a?q.left-e.left-6:q.right-e.left+6,y:(q.top+q.bottom)/2-e.top},e,f),dir:a};return c(b.point)?b:{point:{x:0,y:0},dir:a}}let s={point:d({x:(q.left+q.right)/2-e.left,y:q.top-e.top-12},e,f),dir:"up"},t={point:d({x:(r.left+r.right)/2-e.left,y:r.bottom-e.top+6},e,f),dir:"down"},u=c(s.point),v=c(t.point);return u||v?u?v?s.point.y>window.innerHeight-t.point.y?s:t:s:t:{point:{x:0,y:0}}},"getTextFromRange",0,(a,b=[])=>{let c,d=a.cloneRange().cloneContents(),e=document.createTreeWalker(d,NodeFilter.SHOW_TEXT,{acceptNode:a=>{let c=a.parentElement;return b.includes(c?.tagName.toLowerCase()||"")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),f="";for(;c=e.nextNode();)f+=c.nodeValue??"";return f},"isPointerInsideSelection",0,(a,b)=>{if(0===a.rangeCount)return!1;let c=a.getRangeAt(0).getClientRects();for(let a=0;a<c.length;a++){let d=c[a];if(b.clientX>=d.left-80&&b.clientX<=d.right+80&&b.clientY>=d.top-80&&b.clientY<=d.bottom+80)return!0}return!1}])},726001,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(106865),h=a.i(629474),i=b([e,h]);[e,h]=i.then?(await i)():i;let j=(a,b,c)=>{if(!a)return{left:"-999px",top:"-999px"};let{dir:d,point:e}=a,f=0,g=0;switch(d){case"up":f=c;break;case"down":f=-c;break;case"left":g=c;break;case"right":g=-c}return{left:`${e.x+g}px`,top:`${e.y+f}px`,borderLeft:"right"===d?"none":"left"===d?`${b}px solid`:`${b}px solid transparent`,borderRight:"left"===d?"none":"right"===d?`${b}px solid`:`${b}px solid transparent`,borderTop:"down"===d?"none":"up"===d?`${b}px solid`:`${b}px solid transparent`,borderBottom:"up"===d?"none":"down"===d?`${b}px solid`:`${b}px solid transparent`,transform:"left"===d||"right"===d?"translateY(-50%)":"translateX(-50%)"}};a.s(["default",0,({width:a,height:b,minHeight:c,maxHeight:i,position:k,trianglePosition:l,children:m,className:n="",triangleClassName:o="",additionalStyle:p={},isOpen:q=!0,onDismiss:r})=>{let s=(0,f.useRef)(null),[t,u]=(0,f.useState)(k),[v,w]=(0,f.useState)(b||c||0);(0,h.useKeyDownActions)({onCancel:r,elementRef:s,enabled:q});let x=(0,g.useResponsiveSize)(10),y=window.innerHeight-2*x;l?.dir==="up"?y=l.point.y-x:l?.dir==="down"&&(y=window.innerHeight-l.point.y-x),i=Math.min(i||y,y),(0,f.useEffect)(()=>{if(!s.current)return;let a=new ResizeObserver(a=>{for(let b of a){let a=b.contentRect.height;if(a!==v)return void w(a)}});return a.observe(s.current),()=>{a.disconnect()}},[]),(0,f.useEffect)(()=>{if(!s.current)return;if(!k||!l||"up"!==k.dir)return void u(k);let a=v||s.current.offsetHeight,b={...k,point:{...k.point,y:Math.max(x,l.point.y-a)}};u(b)},[k,l,x,v]);let z=j(l,7,0),A=j(l,7,-1);return(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:(0,e.default)("popup-triangle-outer text-base-300 absolute z-50",o),style:z}),(0,d.jsx)("div",{id:"popup-container",ref:s,className:(0,e.default)("popup-container bg-base-300 absolute z-50 rounded-lg font-sans","eink:border eink:border-base-content",l?.dir!=="up"&&"not-eink:shadow-xl",n),style:{width:`${a}px`,height:b?`${b}px`:"auto",minHeight:c?`${c}px`:"none",maxHeight:i?`${i}px`:"none",left:`${t?t.point.x:-999}px`,top:`${t?t.point.y:-999}px`,...p},children:m}),(0,d.jsx)("div",{className:(0,e.default)("popup-triangle-inner text-base-300 absolute z-50",o),style:A})]})}]),c()}catch(a){c(a)}},!1),740080,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(547274),h=a.i(564645),i=a.i(540438),j=a.i(178552),k=a.i(466759),l=a.i(915302),m=a.i(866736),n=a.i(106865),o=a.i(890392),p=b([e,k,m,o]);[e,k,m,o]=p.then?(await p)():p;let q=a=>{let b=Date.now();if(a>b){let c=Math.floor((a-b)/1e3),d=60*Math.floor(c/3600)+Math.floor(c%3600/60),e=c%60;return`${d}:${e<10?"0":""}${e}`}return""};a.s(["default",0,({bookKey:a,ttsLang:b,isPlaying:c,timeoutOption:p,timeoutTimestamp:r,onTogglePlay:s,onBackward:t,onForward:u,onSetRate:v,onGetVoices:w,onSetVoice:x,onGetVoiceId:y,onSelectTimeout:z,onToogleTTSBar:A})=>{let B=(0,l.useTranslation)(),{envConfig:C}=(0,j.useEnv)(),{getViewSettings:D,setViewSettings:E}=(0,k.useReaderStore)(),{settings:F,setSettings:G,saveSettings:H}=(0,m.useSettingsStore)(),I=D(a),[J,K]=(0,f.useState)([]),[L,M]=(0,f.useState)(I?.ttsRate??1),[N,O]=(0,f.useState)(I?.ttsVoice??""),[P,Q]=(0,f.useState)(()=>q(r)),R=(0,n.useDefaultIconSize)(),S=(0,n.useResponsiveSize)(32),T=(0,n.useResponsiveSize)(48);(0,f.useEffect)(()=>{setTimeout(()=>{let b;b=Date.now(),r>0&&r<b?(z(a,0),Q("")):r>0&&Q(q(r))},1e3)},[r,P]),(0,f.useEffect)(()=>{let a=y();O(a)},[]),(0,f.useEffect)(()=>{(async()=>{let a=await w(b),c=a.reduce((a,b)=>a+b.voices.length,0);a&&0!==c?K(a):(console.warn("No voices found for TTSPanel"),K([{id:"no-voices",name:B("Voices for {{lang}}",{lang:(0,o.getLanguageName)(b)}),voices:[]}]))})()},[b]);let U=[{label:B("No Timeout"),value:0},{label:B("{{value}} minute",{value:1}),value:60},{label:B("{{value}} minutes",{value:3}),value:180},{label:B("{{value}} minutes",{value:5}),value:300},{label:B("{{value}} minutes",{value:10}),value:600},{label:B("{{value}} minutes",{value:20}),value:1200},{label:B("{{value}} minutes",{value:30}),value:1800},{label:B("{{value}} minutes",{value:45}),value:2700},{label:B("{{value}} hour",{value:1}),value:3600},{label:B("{{value}} hours",{value:2}),value:7200},{label:B("{{value}} hours",{value:3}),value:10800},{label:B("{{value}} hours",{value:4}),value:14400},{label:B("{{value}} hours",{value:6}),value:21600},{label:B("{{value}} hours",{value:8}),value:28800}];return(0,d.jsxs)("div",{className:"flex w-full flex-col items-center justify-center gap-2 rounded-2xl px-4 pt-4 sm:gap-1",children:[(0,d.jsxs)("div",{className:"flex w-full flex-col items-center gap-0.5",children:[(0,d.jsx)("input",{className:"range",type:"range",min:0,max:3,step:"0.1",value:L,onChange:b=>{let c=parseFloat(b.target.value);c=Math.max(.2,Math.min(3,c)),M(c),v(c);let d=D(a);d.ttsRate=c,F.globalViewSettings.ttsRate=c,E(a,d),G(F),H(C,F)}}),(0,d.jsxs)("div",{className:"grid w-full grid-cols-7 text-xs",children:[(0,d.jsx)("span",{className:"text-center",children:"|"}),(0,d.jsx)("span",{className:"text-center",children:"|"}),(0,d.jsx)("span",{className:"text-center",children:"|"}),(0,d.jsx)("span",{className:"text-center",children:"|"}),(0,d.jsx)("span",{className:"text-center",children:"|"}),(0,d.jsx)("span",{className:"text-center",children:"|"}),(0,d.jsx)("span",{className:"text-center",children:"|"})]}),(0,d.jsxs)("div",{className:"grid w-full grid-cols-7 text-xs",children:[(0,d.jsx)("span",{className:"text-center",children:B("Slow")}),(0,d.jsx)("span",{className:"text-center"}),(0,d.jsx)("span",{className:"text-center",children:"1.0"}),(0,d.jsx)("span",{className:"text-center",children:"1.5"}),(0,d.jsx)("span",{className:"text-center",children:"2.0"}),(0,d.jsx)("span",{className:"text-center"}),(0,d.jsx)("span",{className:"text-center",children:B("Fast")})]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between space-x-2",children:[(0,d.jsx)("button",{onClick:()=>t(),className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:B("Previous Paragraph"),"aria-label":B("Previous Paragraph"),children:(0,d.jsx)(g.MdFastRewind,{size:S})}),(0,d.jsx)("button",{onClick:s,className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:c?B("Pause"):B("Play"),"aria-label":c?B("Pause"):B("Play"),children:c?(0,d.jsx)(g.MdPauseCircle,{size:T,className:"fill-primary"}):(0,d.jsx)(g.MdPlayCircle,{size:T,className:"fill-primary"})}),(0,d.jsx)("button",{onClick:()=>u(),className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:B("Next Paragraph"),"aria-label":B("Next Paragraph"),children:(0,d.jsx)(g.MdFastForward,{size:S})}),(0,d.jsxs)("div",{className:"dropdown dropdown-top",children:[(0,d.jsxs)("button",{tabIndex:0,className:"flex flex-col items-center justify-center rounded-full p-1 transition-transform duration-200 hover:scale-105",onClick:a=>a.currentTarget.focus(),title:B("Set Timeout"),"aria-label":B("Set Timeout"),children:[(0,d.jsx)(g.MdAlarm,{size:S}),P&&(0,d.jsx)("span",{className:(0,e.default)("absolute bottom-0 left-1/2 w-12 translate-x-[-50%] translate-y-[80%] px-1","bg-primary/80 text-base-100 rounded-full text-center text-xs"),children:P})]}),(0,d.jsx)("ul",{tabIndex:0,className:(0,e.default)("dropdown-content bgcolor-base-200 no-triangle menu menu-vertical rounded-box absolute right-0 z-[1] shadow","mt-4 inline max-h-96 w-[200px] overflow-y-scroll"),children:U.map((b,c)=>(0,d.jsx)("li",{onClick:()=>z(a,b.value),children:(0,d.jsxs)("div",{className:"flex items-center px-2",children:[(0,d.jsx)("span",{style:{width:`${R}px`,height:`${R}px`},children:p===b.value&&(0,d.jsx)(g.MdCheck,{className:"text-base-content"})}),(0,d.jsx)("span",{className:(0,e.default)("text-base sm:text-sm"),children:b.label})]})},`${c}-${b.value}`))})]}),(0,d.jsxs)("div",{className:"dropdown dropdown-top",children:[(0,d.jsx)("button",{tabIndex:0,className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",onClick:a=>a.currentTarget.focus(),children:(0,d.jsx)(i.RiVoiceAiFill,{size:S})}),(0,d.jsx)("ul",{tabIndex:0,className:(0,e.default)("dropdown-content bgcolor-base-200 no-triangle menu menu-vertical rounded-box absolute right-0 z-[1] shadow","mt-4 inline max-h-96 w-[250px] overflow-y-scroll"),title:B("Select Voice"),"aria-label":B("Select Voice"),children:J.map((b,c)=>(0,d.jsxs)("div",{className:"",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1",children:[(0,d.jsx)("span",{style:{width:`${R}px`,height:`${R}px`}}),(0,d.jsx)("span",{className:"text-sm text-gray-400 sm:text-xs",children:B("{{engine}}: {{count}} voices",{engine:B(b.name),count:b.voices.length})})]}),b.voices.map((f,h)=>(0,d.jsx)("li",{onClick:()=>{var b,c;let d;return!f.disabled&&(b=f.id,c=f.lang,x(b,c),O(b),void((d=D(a)).ttsVoice=b,E(a,d)))},children:(0,d.jsxs)("div",{className:"flex items-center px-2",children:[(0,d.jsx)("span",{style:{width:`${R}px`,height:`${R}px`},children:N===f.id&&(0,d.jsx)(g.MdCheck,{className:"text-base-content"})}),(0,d.jsx)("span",{className:(0,e.default)("max-w-[180px] overflow-hidden text-ellipsis text-base sm:text-sm",f.disabled&&"text-gray-400"),children:B(f.name)})]})},`${c}-${b.id}-${h}`))]},b.id))})]})]}),(0,d.jsx)("div",{className:"flex h-4 items-center justify-center opacity-60 transition-transform duration-200 hover:scale-105 hover:opacity-100",children:(0,d.jsx)("button",{onClick:A,className:"p-0",title:B("Toggle Sticky Bottom TTS Bar"),"aria-label":B("Toggle Sticky Bottom TTS Bar"),children:I?.showTTSBar?(0,d.jsx)(h.TbChevronCompactUp,{size:T,style:{transform:"scaleY(0.85)"}}):(0,d.jsx)(h.TbChevronCompactDown,{size:T,style:{transform:"scaleY(0.85)"}})})})]})}]),c()}catch(a){c(a)}},!1),764568,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=b([e]);[e]=f.then?(await f)():f,a.s(["default",0,({isPlaying:a,ttsInited:b,onClick:c})=>(0,d.jsxs)("button",{className:(0,e.default)("relative h-full w-full rounded-full",b?"cursor-pointer":"cursor-not-allowed"),style:{maskImage:"radial-gradient(circle, white 100%, transparent 100%)",WebkitMaskImage:"radial-gradient(circle, white 100%, transparent 100%)"},onClick:c,children:[(0,d.jsx)("div",{className:"absolute inset-0 overflow-hidden rounded-full bg-gradient-to-r from-blue-500 via-emerald-500 to-violet-500",children:(0,d.jsx)("div",{className:"absolute -inset-full rounded-full bg-gradient-to-r from-blue-500 via-emerald-500 to-violet-500",style:{animation:a&&b?"moveGradient 2s alternate infinite":"none"}})}),(0,d.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center",children:[(0,d.jsx)("style",{children:`
          @keyframes moveGradient {
            0% { transform: translate(0, 0); }
            100% { transform: translate(25%, 25%); }
          }
          @keyframes bounce {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.6); }
          }
        `}),(0,d.jsx)("div",{className:"flex items-end space-x-1",children:[1,2,3,4].map(b=>(0,d.jsx)("div",{className:"w-1 rounded-t bg-white",style:{height:"16px",animationName:a?"bounce":"none",animationDuration:a?`${1+.1*b}s`:"0s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite",animationDelay:`${.1*b}s`}},b))})]})]})]),c()}catch(a){c(a)}},!1),757676,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(547274),g=a.i(178552),h=a.i(466759),i=a.i(106865),j=a.i(915302),k=b([e,h]);[e,h]=k.then?(await k)():k,a.s(["default",0,({bookKey:a,isPlaying:b,onTogglePlay:c,onBackward:k,onForward:l,gridInsets:m})=>{let n=(0,j.useTranslation)(),{appService:o}=(0,g.useEnv)(),{hoveredBookKey:p,setHoveredBookKey:q}=(0,h.useReaderStore)(),r=(0,i.useResponsiveSize)(30),s=(0,i.useResponsiveSize)(36);return(0,d.jsx)("div",{className:(0,e.default)("bg-base-100 absolute bottom-0 z-40","inset-x-0 mx-auto flex w-full justify-center sm:w-fit","transition-opacity duration-300",p!==a?"pointer-events-auto opacity-100":"pointer-events-none opacity-0"),style:{paddingBottom:o?.hasSafeAreaInset?`${.33*m.bottom}px`:0},onMouseEnter:()=>!o?.isMobile&&q(""),onTouchStart:()=>!o?.isMobile&&q(""),children:(0,d.jsxs)("div",{className:"text-base-content flex h-[52px] items-center space-x-2 px-2",children:[(0,d.jsx)("button",{onClick:k.bind(null,!1),className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:n("Previous Paragraph"),"aria-label":n("Previous Paragraph"),children:(0,d.jsx)(f.MdFastRewind,{size:r})}),(0,d.jsx)("button",{onClick:k.bind(null,!0),className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:n("Previous Sentence"),"aria-label":n("Previous Sentence"),children:(0,d.jsx)(f.MdSkipPrevious,{size:r})}),(0,d.jsx)("button",{onClick:c,className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:n(b?"Pause":"Play"),"aria-label":n(b?"Pause":"Play"),children:b?(0,d.jsx)(f.MdOutlinePause,{size:s}):(0,d.jsx)(f.MdPlayArrow,{size:s})}),(0,d.jsx)("button",{onClick:l.bind(null,!0),className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:n("Next Sentence"),"aria-label":n("Next Sentence"),children:(0,d.jsx)(f.MdSkipNext,{size:r})}),(0,d.jsx)("button",{onClick:l.bind(null,!1),className:"rounded-full p-1 transition-transform duration-200 hover:scale-105",title:n("Next Paragraph"),"aria-label":n("Next Paragraph"),children:(0,d.jsx)(f.MdFastForward,{size:r})})]})})}]),c()}catch(a){c(a)}},!1),569137,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(77946),i=a.i(162650),j=a.i(866736),k=a.i(862871),l=a.i(466759),m=a.i(200104),n=a.i(757309),o=a.i(915302),p=a.i(106865),q=a.i(674899),r=a.i(725436),s=a.i(94591),t=a.i(404171),u=a.i(478474),v=a.i(765918),w=a.i(593133),x=a.i(452125),y=a.i(240009),z=a.i(107218),A=a.i(545251),B=a.i(609027),C=a.i(465863),D=a.i(726001),E=a.i(740080),F=a.i(764568),G=a.i(757676),H=b([e,i,j,k,l,m,n,q,r,w,y,D,E,F,G]);[e,i,j,k,l,m,n,q,r,w,y,D,E,F,G]=H.then?(await H)():H,a.s(["default",0,({bookKey:a,gridInsets:b})=>{let c=(0,o.useTranslation)(),{appService:q}=(0,g.useEnv)(),{user:H}=(0,h.useAuth)(),{safeAreaInsets:I,isDarkMode:J}=(0,i.useThemeStore)(),{settings:K}=(0,j.useSettingsStore)(),{getBookData:L}=(0,k.useBookDataStore)(),{hoveredBookKey:M,getView:N,getProgress:O,getViewSettings:P}=(0,l.useReaderStore)(),{setViewSettings:Q,setTTSEnabled:R}=(0,l.useReaderStore)(),{getMergedRules:S}=(0,m.useProofreadStore)(),T=P(a),[U,V]=(0,f.useState)("en"),[W,X]=(0,f.useState)(!1),[Y,Z]=(0,f.useState)(!1),[$,_]=(0,f.useState)(!1),[aa,ab]=(0,f.useState)(!1),[ac,ad]=(0,f.useState)(()=>!!T?.showTTSBar),[ae,af]=(0,f.useState)(),[ag,ah]=(0,f.useState)(),[ai,aj]=(0,f.useState)(0),[ak,al]=(0,f.useState)(0),[am,an]=(0,f.useState)(null),ao=(0,f.useRef)(null),[ap,aq]=(0,f.useState)(!0),ar=(0,p.useResponsiveSize)(10),as=window.innerWidth-2*ar,at=Math.min(as,(0,p.useResponsiveSize)(282)),au=(0,p.useResponsiveSize)(160),av=(0,f.useRef)(null),aw=(0,f.useRef)(null),ax=(0,f.useRef)(null),ay=(0,f.useRef)(null),[az,aA]=(0,f.useState)(null),[aB,aC]=(0,f.useState)(!1),aD=async()=>{let b=(0,t.getMediaSession)();if(b&&(ay.current=b,b instanceof t.TauriMediaSession)){let d=L(a),e=O(a);if(!d||!d.book)return;let{title:f,author:g,coverImageUrl:h}=d.book,{sectionLabel:i}=e||{},j="/icon.png";try{j=await (0,z.fetchImageAsBase64)(h||"/icon.png")}catch{j=await (0,z.fetchImageAsBase64)("/icon.png")}await b.setActive({active:!0,keepAppInForeground:K.alwaysInForeground,notificationTitle:c("Read Aloud"),notificationText:c("Ready to read aloud"),foregroundServiceTitle:c("Read Aloud"),foregroundServiceText:c("Ready to read aloud")}),b.updateMetadata({title:f,artist:i||f,album:g,artwork:j})}},aE=async()=>{ay.current&&ay.current instanceof t.TauriMediaSession&&await ay.current.setActive({active:!1,keepAppInForeground:K.alwaysInForeground}),ay.current=null};(0,f.useEffect)(()=>()=>{ax.current&&(ax.current.shutdown(),ax.current=null)},[]),(0,f.useEffect)(()=>(v.eventDispatcher.on("tts-speak",aJ),v.eventDispatcher.on("tts-stop",aK),()=>{v.eventDispatcher.off("tts-speak",aJ),v.eventDispatcher.off("tts-stop",aK)}),[]),(0,f.useEffect)(()=>{if(!az||!a)return;let b=L(a);if(!b||!b.book)return;let{title:d,author:e,coverImageUrl:f}=b.book,g=()=>{v.eventDispatcher.dispatch("toast",{message:c("Please log in to use advanced TTS features"),type:"error",timeout:5e3})},h=b=>{let{sectionLabel:c}=O(a)||{},g=b.detail;if(ay.current){let a=ay.current;a instanceof t.TauriMediaSession?a.updateMetadata({title:g?.text||"",artist:c||d,album:e,artwork:""}):a.metadata=new MediaMetadata({title:g?.text||"",artist:c||d,album:e,artwork:[{src:f||"/icon.png",sizes:"512x512",type:"image/png"}]})}},i=b=>{let c=b.detail,d=N(a),e=O(a),f=P(a);if(!c||!d||!e||!f)return;let{location:g}=e,{index:h}=d.resolveCFI(g),i=d?.getCFI(h,c);if(i&&(f.ttsLocation=i||"",Q(a,f)),!d.renderer.getContents().some(({doc:a})=>(a.getSelection()?.toString().length??0)>0))if(d.renderer.scrolled){let a=c.getBoundingClientRect(),{start:b,size:e,viewSize:g,sideProp:h}=d.renderer,i=a["height"===h?"y":"x"]+f.marginTopPx,j=a["height"===h?"height":"width"]+i,k="rtl"===d.book.dir?g-i:i,l="rtl"===d.book.dir?g-j:j,m=f.showHeader,n=f.showFooter,o=f.showBarsOnScroll,p=m&&o?44:0,q=f.scrollingOverlap;(l>b+e-(n&&o?44:0)-q||k<b+p+q)&&d.renderer.scrollToAnchor((k-p-q)/g)}else d.renderer.scrollToAnchor(c)};return az.addEventListener("tts-need-auth",g),az.addEventListener("tts-speak-mark",h),az.addEventListener("tts-highlight-mark",i),()=>{az.removeEventListener("tts-need-auth",g),az.removeEventListener("tts-speak-mark",h),az.removeEventListener("tts-highlight-mark",i)}},[az,a]);let aF=(0,f.useCallback)(()=>{let b=T?.ttsReadAloudText;if(T?.translationEnabled&&"translated"===b)return T?.translateTargetLang||(0,C.getLocale)();if(T?.translationEnabled&&"source"===b){let b=L(a);return b?.book?.primaryLanguage||""}return null},[a,L,T?.translationEnabled,T?.ttsReadAloudText,T?.translateTargetLang]);(0,f.useEffect)(()=>{ax.current?.setTargetLang(aF()||"")},[aF]);let aG=(0,f.useMemo)(()=>({bookKey:a,viewSettings:P(a),userLocale:(0,C.getLocale)(),content:"",transformers:[],reversePunctuationTransform:!0}),[]),aH=(0,f.useCallback)(async b=>{let c=S(a),d=P(a),e=c.filter(a=>a.enabled&&a.onlyForTTS&&("book"===a.scope||"library"===a.scope));return 0===e.length?b:(aG.content=b,aG.viewSettings=d,b=await n.proofreadTransformer.transform(aG,{docType:"text/xml",onlyForTTS:!0}))},[a,S,P,aG]),aI=(0,f.useCallback)((a,b)=>{let c=J?"#000000":"#ffffff",d=b?c:a.color;return{...a,color:d}},[J]);(0,f.useEffect)(()=>{let a=T?.ttsHighlightOptions;ax.current&&a&&ax.current.initViewTTS(aI(a,T.isEink))},[T?.ttsHighlightOptions,T?.isEink,aI]);let aJ=async b=>{let{bookKey:d,range:e,oneTime:f=!1}=b.detail;if(a!==d)return;let g=N(a),h=O(a),i=P(a),j=L(a);if(!g||!h||!i||!j||!j.book)return;if(j.book?.format==="PDF")return void v.eventDispatcher.dispatch("toast",{message:c("TTS not supported for PDF"),type:"warning"});let k=e;if(!k&&i.ttsLocation){let{location:a}=h,b=i.ttsLocation;if((0,B.isCfiInLocation)(b,a)){let{index:a,anchor:c}=g.resolveCFI(b),{doc:d}=g.renderer.getContents().find(b=>b.index===a)||{};d&&(k=c(d))}}k||(k=h.range);let l=j.book.primaryLanguage;ax.current&&(ax.current.stop(),ax.current=null);try{q?.isIOSApp&&await (0,A.invokeUseBackgroundAudio)({enabled:!0}),q?.isMobile&&(aw.current||(aw.current=document.createElement("audio"),aw.current.setAttribute("x-webkit-airplay","deny"),aw.current.addEventListener("play",()=>{"mediaSession"in navigator&&(navigator.mediaSession.metadata=null)}),aw.current.preload="auto",aw.current.loop=!0,aw.current.src=s.SILENCE_DATA,aw.current.play())),await aD(),aC(!1),f||_(!0);let b=new r.TTSController(q,g,!!H?.id,aH);ax.current=b,aA(b),await b.init(),await b.initViewTTS(aI(i.ttsHighlightOptions,i.isEink));let c=g.tts?.from(k);if(c){let a=(0,w.parseSSMLLang)(c,l)||"en";X(!0),V(a),b.setLang(a),b.setRate(i.ttsRate),b.speak(c,f),b.setTargetLang(aF()||"")}aC(!0),R(a,!0)}catch(a){v.eventDispatcher.dispatch("toast",{message:c("TTS not supported for this document"),type:"error"}),console.error(a)}},aK=async b=>{let{bookKey:c}=b.detail;ax.current&&a===c&&aP(a)},aL=(0,f.useCallback)(async()=>{let a=ax.current;if(a&&(W?(X(!1),Z(!0),await a.pause()):Y&&(X(!0),Z(!1),"paused"===a.state?await a.resume():await a.start()),ay.current)){let a=ay.current;a instanceof t.TauriMediaSession?await a.updatePlaybackState({playing:!W}):a.playbackState=W?"paused":"playing"}},[W,Y]),aM=(0,f.useCallback)(async(a=!1)=>{let b=ax.current;b&&await b.backward(a)},[]),aN=(0,f.useCallback)(async(a=!1)=>{let b=ax.current;b&&await b.forward(a)},[]),aO=(0,f.useCallback)(async()=>{let a=ax.current;a&&(X(!1),Z(!0),await a.pause())},[]),aP=(0,f.useCallback)(async a=>{let b=ax.current;b&&(await b.shutdown(),ax.current=null,aA(null),N(a)?.deselect(),X(!1),ab(!1),_(!1)),q?.isIOSApp&&await (0,A.invokeUseBackgroundAudio)({enabled:!1}),q?.isMobile&&(()=>{if(aw.current)try{aw.current.pause(),aw.current.currentTime=0,aw.current.removeAttribute("src"),aw.current.src="",aw.current.load(),aw.current=null,console.log("Unblock audio released")}catch(a){console.warn("Error releasing unblock audio:",a)}})(),await aE(),R(a,!1)},[q]),aQ=(0,f.useCallback)((0,x.throttle)(async a=>{let b=ax.current;b&&("playing"===b.state?(await b.stop(),await b.setRate(a),await b.start()):await b.setRate(a))},3e3),[]),aR=(0,f.useCallback)((0,x.throttle)(async(a,b)=>{let c=ax.current;c&&("playing"===c.state?(await c.stop(),await c.setVoice(a,b),await c.start()):await c.setVoice(a,b))},3e3),[]),aS=async a=>{let b=ax.current;return b?b.getVoices(a):[]},aT=()=>{if(av.current){let a=av.current.getBoundingClientRect(),b=av.current.parentElement?.getBoundingClientRect()||document.documentElement.getBoundingClientRect(),c={dir:"up",point:{x:a.left+a.width/2-b.left,y:a.top-12}},d=(0,u.getPopupPosition)(c,b,at,au,ar);af(d),ah(c)}},aU=()=>{ab(!1)};return(0,f.useEffect)(()=>{let{current:a}=ay;a&&(a.setActionHandler("play",()=>{aL()}),a.setActionHandler("pause",()=>{aL()}),a.setActionHandler("stop",()=>{aO()}),a.setActionHandler("seekforward",()=>{aN(!0)}),a.setActionHandler("seekbackward",()=>{aM(!0)}),a.setActionHandler("nexttrack",()=>{aN()}),a.setActionHandler("previoustrack",()=>{aM()}))},[aL,aO,aN,aM]),(0,f.useEffect)(()=>{if(!av.current||!aa)return;let a=av.current.parentElement;if(!a)return;let b=new ResizeObserver(()=>{aT()});return b.observe(a),()=>{b.disconnect()}},[aa]),(0,f.useEffect)(()=>(M?(ao.current&&(clearTimeout(ao.current),ao.current=null),ao.current=setTimeout(()=>{aq(!0)},100)):(ao.current&&(clearTimeout(ao.current),ao.current=null),ao.current=setTimeout(()=>{aq(!1)},5e3)),()=>{ao.current&&clearTimeout(ao.current)}),[M]),(0,d.jsxs)(d.Fragment,{children:[aa&&(0,d.jsx)(y.Overlay,{onDismiss:aU}),(aa||$&&ap)&&(0,d.jsx)("div",{ref:av,className:(0,e.default)("absolute h-12 w-12","transition-transform duration-300",T?.rtl?"left-8":"right-6",!q?.hasSafeAreaInset&&"bottom-[70px] sm:bottom-14"),style:{bottom:q?.hasSafeAreaInset?`${.33*(I?.bottom||0)+(M?70:52)}px`:void 0},children:(0,d.jsx)(F.default,{isPlaying:W,ttsInited:aB,onClick:()=>{if(aT(),!aa&&ax.current){let a=ax.current.getSpeakingLang()||U;V(a)}ab(a=>!a)}})}),aa&&ae&&ag&&aB&&(0,d.jsx)(D.default,{width:at,height:au,position:ae,trianglePosition:ag,className:"bg-base-200 flex shadow-lg",onDismiss:aU,children:(0,d.jsx)(E.default,{bookKey:a,ttsLang:U,isPlaying:W,timeoutOption:ai,timeoutTimestamp:ak,onTogglePlay:aL,onBackward:aM,onForward:aN,onSetRate:aQ,onGetVoices:aS,onSetVoice:aR,onGetVoiceId:()=>{let a=ax.current;return a?a.getVoiceId():""},onSelectTimeout:(a,b)=>{aj(b),am&&clearTimeout(am),b>0?(an(setTimeout(()=>{aP(a)},1e3*b)),al(Date.now()+1e3*b)):al(0)},onToogleTTSBar:()=>{let b=P(a);b.showTTSBar=!b.showTTSBar,ad(b.showTTSBar),b.showTTSBar&&ab(!1),Q(a,b)}})}),$&&ac&&aB&&(0,d.jsx)(G.default,{bookKey:a,isPlaying:W,onBackward:aM,onTogglePlay:aL,onForward:aN,gridInsets:b})]})}]),c()}catch(a){c(a)}},!1),432219,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(466759),i=a.i(715715),j=a.i(862871),k=a.i(915302),l=a.i(108328),m=a.i(765918),n=a.i(951790),o=a.i(288413),p=a.i(494075),q=a.i(646004),r=a.i(569137),s=b([e,h,i,j,l,o,p,q,r]);[e,h,i,j,l,o,p,q,r]=s.then?(await s)():s,a.s(["default",0,({bookKey:a,bookFormat:b,section:c,pageinfo:s,isHoveredAnim:t,gridInsets:u})=>{let v=(0,k.useTranslation)(),{appService:w}=(0,g.useEnv)(),{getConfig:x,setConfig:y,getBookData:z}=(0,j.useBookDataStore)(),{hoveredBookKey:A,setHoveredBookKey:B}=(0,h.useReaderStore)(),{getView:C,getViewState:D,getProgress:E,getViewSettings:F}=(0,h.useReaderStore)(),{isSideBarVisible:G,setSideBarVisible:H}=(0,i.useSidebarStore)(),{acquireBackKeyInterception:I,releaseBackKeyInterception:J}=(0,l.useDeviceControlStore)(),K=C(a),L=x(a),M=z(a),N=D(a),O=E(a),P=F(a),[Q,R]=(0,f.useState)(""),S=A===a?Q:"",T=A===a,U=(K?.renderer.getContents()??[]).some(({doc:a})=>a?.body?.style.cursor==="pointer"),V=(0,f.useMemo)(()=>"PDF"===b?c:s,[b,c,s]),W=!!V&&V.total>0&&V.current>=0,X=(0,f.useMemo)(()=>W&&V.total>0&&V.current>=0?(V.current+1)/V.total:0,[W,V]),Y=(0,f.useMemo)(()=>(0,n.debounce)(a=>{K?.goToFraction(a/100)},100),[K]),Z=(0,f.useCallback)(()=>{(0,o.viewPagination)(K,P,"left","page")},[K,P]),$=(0,f.useCallback)(()=>{(0,o.viewPagination)(K,P,"right","page")},[K,P]),_=(0,f.useCallback)(()=>{K?.renderer.prevSection?.()},[K]),aa=(0,f.useCallback)(()=>{K?.renderer.nextSection?.()},[K]),ab=(0,f.useCallback)(()=>{K?.history.back()},[K]),ac=(0,f.useCallback)(()=>{K?.history.forward()},[K]),ad=(0,f.useCallback)(async()=>{if(!K||!O||!N)return;let b=N.ttsEnabled?"tts-stop":"tts-speak";m.eventDispatcher.dispatch(b,{bookKey:a})},[K,O,N,a]),ae=(0,f.useCallback)(b=>{R(a=>a===b?"":b),"tts"===b?(N?.ttsEnabled&&B(""),ad()):"toc"===b?(B(""),L?.viewSettings&&y(a,{viewSettings:{...L.viewSettings,sideBarTab:"toc"}}),H(!0)):"note"===b&&(B(""),H(!0),L?.viewSettings&&y(a,{viewSettings:{...L.viewSettings,sideBarTab:"annotations"}}))},[L,a,N?.ttsEnabled,y,H,B,ad]),af=(0,f.useMemo)(()=>({onPrevPage:Z,onNextPage:$,onPrevSection:_,onNextSection:aa,onGoBack:ab,onGoForward:ac,onProgressChange:Y}),[Z,$,_,aa,ab,ac,Y]),ag=(0,f.useCallback)(a=>{if(a instanceof CustomEvent){if("Back"===a.detail.keyName)return B(""),!0}else"Escape"===a.key&&B(""),a.stopPropagation();return!1},[B]);(0,f.useEffect)(()=>{if(w?.isAndroidApp)return A&&(I(),m.eventDispatcher.onSync("native-key-down",ag)),()=>{A&&(J(),m.eventDispatcher.offSync("native-key-down",ag))}},[A]);let ah={bookKey:a,gridInsets:u,actionTab:S,progressValid:W,progressFraction:X,navigationHandlers:af,onSetActionTab:ae,onSpeakText:ad},ai=P?.vertical&&P?.scrolled||M?.isFixedLayout&&P?.zoomLevel&&P.zoomLevel>100,aj=(0,e.default)("footer-bar shadow-xs bottom-0 z-10 flex w-full flex-col","sm:h-[52px] sm:justify-center","sm:bg-base-100 border-base-300/50 border-t sm:border-none","transition-[opacity,transform] duration-300",window.innerWidth<640?"fixed":"absolute",w?.hasRoundedWindow&&"rounded-window-bottom-right",!G&&w?.hasRoundedWindow&&"rounded-window-bottom-left",t&&"hover-bar-anim",ai&&"sm:!bottom-3 sm:!h-10 sm:justify-end",T?"pointer-events-auto translate-y-0 opacity-100":"pointer-events-none translate-y-full opacity-0 sm:translate-y-0"),ak=w?.isMobile||window.innerWidth<640;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{role:"none",className:(0,e.default)("absolute bottom-0 left-0 z-10 flex h-[52px] w-full",ai&&"sm:!bottom-3 sm:!h-7",ak||U?"pointer-events-none":""),onMouseEnter:()=>!ak&&B(a),onTouchStart:()=>!ak&&B(a)}),(0,d.jsxs)("div",{role:"group","aria-label":v("Footer Bar"),className:aj,dir:P?.rtl?"rtl":"ltr",onFocus:()=>!w?.isMobile&&B(a),onMouseLeave:()=>window.innerWidth>=640&&B(""),children:[(0,d.jsx)(p.default,{...ah}),(0,d.jsx)(q.default,{...ah})]}),T&&ai&&(0,d.jsx)("div",{className:"bg-base-100 pointer-events-none absolute bottom-0 left-0 hidden h-3 w-full sm:block"}),(0,d.jsx)(r.default,{bookKey:a,gridInsets:u})]})}]),c()}catch(a){c(a)}},!1),218517,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(466759),i=a.i(915302),j=a.i(862871),k=a.i(883225),l=a.i(937944),m=b([e,h,j,l]);[e,h,j,l]=m.then?(await m)():m,a.s(["default",0,({bookKey:a,section:b,pageinfo:c,timeinfo:m,horizontalGap:n,contentInsets:o,gridInsets:p})=>{let q=(0,i.useTranslation)(),{envConfig:r,appService:s}=(0,g.useEnv)(),{getBookData:t}=(0,j.useBookDataStore)(),{getView:u,getViewSettings:v}=(0,h.useReaderStore)(),w=u(a),x=t(a),y=v(a),z=y.vertical&&y.doubleBorder,A=y.scrolled,B=y.vertical,C=y.isEink,{progressStyle:D}=y,E=localStorage?.getItem("i18nextLng")||"",F=B&&E.toLowerCase().startsWith("zh"),G=x?.isFixedLayout?b:c,H=(0,k.formatProgress)(G?.current,G?.total,"fraction"===D?B?"{current}  {total}":"{current} / {total}":"{percent}%",F,E),I=m?q("{{time}} min left in chapter",{time:(0,k.formatNumber)(Math.round(m.section),F,E)}):"",{page:J=0,pages:K=0}=w?.renderer||{},L=K-1>J?F?q("{{number}} pages left in chapter",{number:(0,k.formatNumber)(K-J-1,F,E)}):q("{{count}} pages left in chapter",{count:K-J-1}):"",[M,N]=(0,f.useState)(y.progressInfoMode);(0,f.useEffect)(()=>{(0,l.saveViewSettings)(r,a,"progressInfoMode",M)},[M]);let O=s?.isMobile||window.innerWidth<640;return(0,d.jsx)("div",{role:"presentation",className:(0,e.default)("progressinfo absolute bottom-0 flex items-center justify-between font-sans",C?"text-sm font-normal":"text-neutral-content text-xs font-extralight",B?"writing-vertical-rl":"w-full",A&&!B&&"bg-base-100",O?"pointer-events-auto":"pointer-events-none"),onClick:()=>(()=>{if(!y.tapToToggleFooter)return;let a=y.showRemainingTime||y.showRemainingPages,b=y.showProgressInfo,c=["all","remaining","progress","none"],d=c.indexOf(M);for(let e=1;e<=c.length;e++){let f=(d+e)%c.length,g=c[f],h={remaining:("all"===M||"remaining"===M)&&a,progress:("all"===M||"progress"===M)&&b},i={remaining:("all"===g||"remaining"===g)&&a,progress:("all"===g||"progress"===g)&&b};if(h.remaining!==i.remaining||h.progress!==i.progress)return void N(g)}let e=(d+1)%c.length;N(c[e])})(),"aria-label":[G?q("On {{current}} of {{total}} page",{current:G.current+1,total:G.total}):"",I,L].filter(Boolean).join(", "),style:B?{bottom:`${(o.bottom-p.bottom)*1.5}px`,left:z?`calc(${o.left}px)`:`calc(${Math.max(0,o.left-32)}px)`,width:z?"32px":`${o.left}px`,height:`calc(100% - ${(o.top+o.bottom)/2*3}px)`}:{paddingInlineStart:`calc(${n/2}% + ${o.left/2}px)`,paddingInlineEnd:`calc(${n/2}% + ${o.right/2}px)`,paddingBottom:s?.hasSafeAreaInset?`${.33*p.bottom}px`:0},children:(0,d.jsxs)("div",{"aria-hidden":"true",className:(0,e.default)("flex items-center justify-between",B?"h-full":"h-[52px] w-full"),children:[("all"===M||"remaining"===M)&&(0,d.jsx)(d.Fragment,{children:y.showRemainingTime?(0,d.jsx)("span",{className:"text-start",children:I}):y.showRemainingPages?(0,d.jsx)("span",{className:"text-start",children:L}):null}),("all"===M||"progress"===M)&&(0,d.jsx)(d.Fragment,{children:y.showProgressInfo&&(0,d.jsx)("span",{className:(0,e.default)("text-end",B?"mt-auto":"ms-auto"),children:H})})]})})}]),c()}catch(a){c(a)}},!1),641287,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(162650),g=b([e,f]);[e,f]=g.then?(await g)():g,a.s(["default",0,({})=>{let{safeAreaInsets:a}=(0,f.useThemeStore)();return(0,d.jsx)("div",{className:(0,e.default)("ribbon absolute inset-0 z-10 flex w-8 justify-center sm:w-6"),style:{height:`${(a?.top||0)+44}px`},children:(0,d.jsx)("svg",{width:"100%",height:"100%",preserveAspectRatio:"none",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",shapeRendering:"geometricPrecision",imageRendering:"optimizeQuality",children:(0,d.jsx)("polygon",{fill:"#F44336",points:"100 100, 50 78, 0 100, 0 0, 100 0"})})})}]),c()}catch(a){c(a)}},!1),44484,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(77946),f=a.i(205244),g=a.i(862871),h=a.i(654617),i=a.i(452125),j=b([f,g]);[f,g]=j.then?(await j)():j,a.s(["useNotesSync",0,a=>{let{user:b}=(0,e.useAuth)(),{syncedNotes:c,syncNotes:j,lastSyncedAtNotes:k}=(0,f.useSync)(a),{getConfig:l,setConfig:m,getBookData:n}=(0,g.useBookDataStore)(),o=l(a),p=(0,d.useCallback)(()=>{let c=l(a),d=n(a)?.book;if(!c?.location||!d||!b)return{};let e=(c.booknotes??[]).filter(a=>k<a.updatedAt||k<(a.deletedAt??0));return e.forEach(a=>{a.bookHash=d.hash,a.metaHash=d.metaHash}),{notes:e,lastSyncedAt:k}},[b,a,k,l,n]),q=(0,d.useCallback)((0,i.throttle)(()=>{let b=n(a)?.book,c=p();j(c.notes,b?.hash,b?.metaHash,"both")},1e3*h.SYNC_NOTES_INTERVAL_SEC,{emitLast:!1}),[j]);(0,d.useEffect)(()=>{o?.location&&b&&q()},[o?.booknotes,q]),(0,d.useEffect)(()=>{if(c?.length&&o){let b=n(a)?.book,d=c.filter(a=>a.bookHash===b?.hash||a.metaHash===b?.metaHash);if(!d.length)return;let e=[...(o.booknotes??[]).filter(a=>!d.some(b=>b.id===a.id)),...d.map(b=>{let c=l(a),d=(c?.booknotes??[]).find(a=>a.id===b.id);if(d)if(d.updatedAt<b.updatedAt||(d.deletedAt??0)<(b.deletedAt??0))return{...d,...b};else return{...b,...d};return b})];m(a,{booknotes:e})}},[c])}]),c()}catch(a){c(a)}},!1),244056,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(866736),g=a.i(862871),h=a.i(466759),i=a.i(465863),j=b([f,g,h]);[f,g,h]=j.then?(await j)():j,a.s(["useInstantAnnotation",0,({bookKey:a,getAnnotationText:b})=>{let{envConfig:c}=(0,e.useEnv)(),{settings:j}=(0,f.useSettingsStore)(),{getConfig:k,saveConfig:l,updateBooknotes:m}=(0,g.useBookDataStore)(),{getView:n,getViewsById:o,getViewSettings:p}=(0,h.useReaderStore)(),q=(0,d.useRef)(null),r=(0,d.useRef)(null),s=(0,d.useRef)(0),t=(0,d.useRef)(null),u=(0,d.useRef)((0,i.uniqueId)()),v=(0,d.useCallback)(()=>{let b=p(a);return b?.enableAnnotationQuickActions&&b?.annotationQuickAction==="highlight"},[a,p]),w=(0,d.useCallback)(()=>{t.current&&(o(a.split("-")[0]).forEach(a=>a?.addAnnotation(t.current,!0)),t.current=null)},[a,o]),x=(0,d.useCallback)((a,b,c)=>{if(a.caretPositionFromPoint){let d=a.caretPositionFromPoint(b,c);if(d)return{node:d.offsetNode,offset:d.offset}}if(a.caretRangeFromPoint){let d=a.caretRangeFromPoint(b,c);if(d)return{node:d.startContainer,offset:d.startOffset}}return null},[]),y=(0,d.useCallback)((a,b,c)=>{let d=x(a,b,c);if(!d||d.node.nodeType!==Node.TEXT_NODE)return!1;let e=d.node,f=e.length;if(0===f)return!1;let g=a.createRange();try{let a=Math.min(d.offset,f-1),h=Math.min(d.offset+1,f);for(let d of(g.setStart(e,a),g.setEnd(e,h),g.getClientRects()))if(b>=d.left-20&&b<=d.right+20&&c>=d.top-20&&c<=d.bottom+20)return!0}catch{}return!1},[x]),z=(0,d.useCallback)((a,b,c)=>{let d=x(a,b.x,b.y),e=x(a,c.x,c.y);if(!d||!e)return null;let f=a.createRange();try{if(d.node.compareDocumentPosition(e.node)&Node.DOCUMENT_POSITION_PRECEDING||d.node===e.node&&d.offset>e.offset?(f.setStart(e.node,e.offset),f.setEnd(d.node,d.offset)):(f.setStart(d.node,d.offset),f.setEnd(e.node,e.offset)),f.collapsed)return null;return f}catch(a){return console.warn("Failed to create range:",a),null}},[x]),A=(0,d.useCallback)((a,b)=>{let c=j.globalReadSettings.highlightStyle,d=j.globalReadSettings.highlightStyles[c];return{id:u.current,type:"annotation",cfi:a,style:c,color:d,text:b??"",note:"",createdAt:Date.now(),updatedAt:Date.now()}},[]),B=(0,d.useCallback)((a,b,c)=>!!v()&&0===c.button&&!!y(a,c.clientX,c.clientY)&&(q.current={x:c.clientX,y:c.clientY},r.current=a,s.current=b,t.current=null,u.current=(0,i.uniqueId)(),!0),[v,y]),C=(0,d.useCallback)((b,c,d)=>{if(!v())return!1;let e=n(a);if(!q.current||!r.current||!e)return!1;let f={x:d.clientX,y:d.clientY},g=q.current,h=Math.abs(f.x-g.x),i=Math.abs(f.y-g.y),j=Math.sqrt(Math.pow(h,2)+Math.pow(i,2));if(j<20||h/i<5&&i/h<5&&j<30)return!1;let k=z(b,g,f);if(!k)return!1;let l=e.getCFI(c,k);if(!l)return!1;w();let m=A(l);return o(a.split("-")[0]).forEach(a=>a?.addAnnotation(m)),t.current=m,!0},[v,z]),D=(0,d.useCallback)(()=>!!v()&&(q.current=null,r.current=null,w(),!0),[v,w]),E=(0,d.useCallback)(async(d,e,f)=>{if(!v())return!1;let g=n(a);if(!q.current||!g)return q.current=null,r.current=null,w(),!1;let h={x:f.clientX,y:f.clientY},i=q.current;if(q.current=null,r.current=null,10>Math.sqrt(Math.pow(h.x-i.x,2)+Math.pow(h.y-i.y,2)))return w(),!1;let p=z(d,i,h);if(!p)return w(),!1;let s=await b(p),t=g.getCFI(e,p);if(!s||!t||0===s.trim().length)return w(),!1;w();let u=A(t,s);o(a.split("-")[0]).forEach(a=>a?.addAnnotation(u));let{booknotes:x=[]}=k(a),y=x.findIndex(a=>a.cfi===t&&"annotation"===a.type&&a.style&&!a.deletedAt);-1!==y?x[y]={...x[y],...u,id:x[y].id}:x.push(u);let B=m(a,x);return B&&l(c,a,B,j),!0},[v,z,b,w]),F=(0,d.useCallback)(()=>{q.current=null,r.current=null,w()},[w]);return{isInstantAnnotationEnabled:v,handleInstantAnnotationPointerDown:B,handleInstantAnnotationPointerMove:C,handleInstantAnnotationPointerCancel:D,handleInstantAnnotationPointerUp:E,cancelInstantAnnotation:F}}]),c()}catch(a){c(a)}},!1),71976,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(466759),g=a.i(465863),h=a.i(765918),i=a.i(478474),j=a.i(244056),k=b([f,j]);[f,j]=k.then?(await k)():k,a.s(["useTextSelector",0,(a,b,c,k)=>{let{appService:l}=(0,e.useEnv)(),{getView:m,getViewSettings:n}=(0,f.useReaderStore)(),o=m(a),p=(0,g.getOSPlatform)(),q=(0,d.useRef)(!1),r=(0,d.useRef)(!1),s=(0,d.useRef)(!1),t=(0,d.useRef)(!1),u=(0,d.useRef)(null),v=(0,d.useRef)("mouse"),w=(0,d.useRef)(!1),x=(0,d.useRef)(!1),{isInstantAnnotationEnabled:y,handleInstantAnnotationPointerDown:z,handleInstantAnnotationPointerMove:A,handleInstantAnnotationPointerCancel:B,handleInstantAnnotationPointerUp:C}=(0,j.useInstantAnnotation)({bookKey:a,getAnnotationText:c,setSelection:b}),D=a=>a&&a.toString().trim().length>0&&a.rangeCount>0,E=async(d,e,f=!1)=>{s.current=!0;let g=d.getRangeAt(0);f&&(d.removeAllRanges(),d.addRange(g)),b({key:a,text:await c(g),cfi:o?.getCFI(e,g),range:g,index:e})},F=async(d,e)=>{s.current=!0;let f=d.getRangeAt(0);setTimeout(()=>{d.removeAllRanges(),setTimeout(async()=>{s.current&&(d.addRange(f),b({key:a,text:await c(f),cfi:o?.getCFI(e,f),range:f,index:e}))},30)},30)},G=a=>{w.current=!1,x.current=!1,o&&(o.renderer.scrollLocked=!1),a.target.style.userSelect=""},H=async(a,b,c)=>{if(w.current&&c){if(G(c),await C(a,b,c)){s.current=!0;return}c.target?.dispatchEvent(new MouseEvent("mousedown",{...c,bubbles:!0,cancelable:!0}))}let d=a.getSelection();if(D(d)){let a=c&&(0,i.isPointerInsideSelection)(d,c),e="ios"===p||l?.isIOSApp;a&&e?F(d,b):a&&(r.current=!0,E(d,b,!0))}};return(0,d.useEffect)(()=>{let a=()=>r.current?(r.current=!1,!0):s.current?(k(),s.current=!1,o?.deselect(),!0):!!q.current&&(k(),!0);return h.eventDispatcher.onSync("iframe-single-click",a),()=>{h.eventDispatcher.offSync("iframe-single-click",a)}},[]),{isTextSelected:s,handleScroll:()=>{if("android"!==p||!l?.isAndroidApp)return;let b=n(a);!b?.scrolled&&s.current&&o?.renderer?.containerPosition&&u.current&&(console.warn("Keep container position",u.current),o.renderer.containerPosition=u.current)},handleTouchStart:()=>{t.current=!0},handleTouchMove:a=>{w.current&&x.current&&a.preventDefault()},handleTouchEnd:()=>{t.current=!1},handlePointerDown:(a,b,c)=>{(v.current=c.pointerType,y()&&z(a,b,c))&&(c.preventDefault(),w.current=!0,x.current=!1,o&&(o.renderer.scrollLocked=!0),c.target.style.userSelect="none")},handlePointerMove:(a,b,c)=>{w.current&&(c.preventDefault(),x.current=A(a,b,c))},handlePointerCancel:(a,b,c)=>{w.current&&(G(c),B())},handlePointerUp:H,handleSelectionchange:(a,b)=>{if("android"!==p||!l?.isAndroidApp)return;let c=a.getSelection();D(c)?(u.current||(u.current=o?.renderer?.start||null),E(c,b,!1)):u.current=null},handleShowPopup:a=>{setTimeout(()=>{a&&!q.current&&(r.current=!1),q.current=a},500)},handleUpToPopup:()=>{r.current=!0},handleContextmenu:a=>l?.isMobile||"touch"===v.current||"pen"===v.current?(a.preventDefault(),a.stopPropagation(),!1):void 0}}]),c()}catch(a){c(a)}},!1),868400,a=>{"use strict";a.s(["getWordCount",0,a=>a?a.trim().split(/\s+/).filter(Boolean).length:0,"isPunctuationOnly",0,a=>/^[\p{P}\p{S}\s]+$/u.test(a),"isWholeWord",0,(a,b)=>{try{let c=b.trim();if(!c)return!1;let d=/[\p{L}\p{N}\p{M}_]/u;if(!d.test(c))return!1;if(/[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}]/u.test(c)||/[\s\p{P}\p{S}]/u.test(c))return!0;let{charBefore:e,charAfter:f}=(a=>{let b="",c="";try{let d=a.startContainer;if(d.nodeType===Node.TEXT_NODE)if(a.startOffset>0)b=d.textContent?.charAt(a.startOffset-1)||"";else{let a=d.previousSibling;for(;a&&a.nodeType!==Node.TEXT_NODE;)a=a.previousSibling;if(a?.nodeType===Node.TEXT_NODE){let c=a.textContent||"";b=c.charAt(c.length-1)}}let e=a.endContainer;if(e.nodeType===Node.TEXT_NODE){let b=e.textContent||"";if(a.endOffset<b.length)c=b.charAt(a.endOffset);else{let a=e.nextSibling;for(;a&&a.nodeType!==Node.TEXT_NODE;)a=a.nextSibling;a?.nodeType===Node.TEXT_NODE&&(c=(a.textContent||"").charAt(0))}}}catch(a){console.warn("[getBoundaryChars] Error:",a)}return{charBefore:b,charAfter:c}})(a);return(!e||!d.test(e))&&(!f||!d.test(f))}catch(a){return console.warn("Failed to check whole word:",a),/[\p{L}\p{N}\p{M}_]/u.test(b)}}])},512912,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(178552),f=a.i(466759),g=a.i(866736),h=a.i(862871),i=b([f,g,h]);[f,g,h]=i.then?(await i)():i,a.s(["useAnnotationEditor",0,({bookKey:a,annotation:b,getAnnotationText:c,setSelection:i})=>{let{envConfig:j}=(0,e.useEnv)(),{settings:k}=(0,g.useSettingsStore)(),{getConfig:l,saveConfig:m,updateBooknotes:n}=(0,h.useBookDataStore)(),{getView:o,getViewsById:p}=(0,f.useReaderStore)(),q=o(a),r=(0,d.useRef)(b),[s,t]=(0,d.useState)(null),u=(0,d.useCallback)((b,c)=>{if(!document.querySelector(`#gridcell-${a}`))return null;let d=Array.from(b.getClientRects());if(0===d.length)return null;let e=d[0],f=d[d.length-1],g=b.commonAncestorContainer.ownerDocument?.defaultView?.frameElement,h=g?.getBoundingClientRect()??{top:0,left:0};return{start:{x:h.left+(c?e.right:e.left),y:h.top+e.top},end:{x:h.left+(c?f.left:f.right),y:h.top+f.bottom}}},[a]),v=(0,d.useCallback)(async(b,d,e,f)=>{if(!r.current||!q)return;let g=q.renderer.getContents();if(!g||0===g.length)return;let h=(a,b,c)=>{let d=a.defaultView?.frameElement,e=d?.getBoundingClientRect()??{top:0,left:0},f=b-e.left,g=c-e.top;if(a.caretPositionFromPoint){let b=a.caretPositionFromPoint(f,g);if(b)return{node:b.offsetNode,offset:b.offset}}if(a.caretRangeFromPoint){let b=a.caretRangeFromPoint(f,g);if(b)return{node:b.startContainer,offset:b.startOffset}}return null},o=null,s=null,v=null,w=0;for(let a of g){let{doc:c,index:e}=a;if(!c)continue;let f=h(c,b.x,b.y),g=h(c,d.x,d.y);if(f&&g){o=f,s=g,v=c,w=e??0;break}}if(!o||!s||!v)return;let x=v.createRange();try{if(o.node.compareDocumentPosition(s.node)&Node.DOCUMENT_POSITION_PRECEDING||o.node===s.node&&o.offset>s.offset?(x.setStart(s.node,s.offset),x.setEnd(o.node,o.offset)):(x.setStart(o.node,o.offset),x.setEnd(s.node,s.offset)),x.collapsed)return void console.warn("Range is collapsed")}catch(a){console.warn("Failed to create range:",a);return}let y=u(x,e);y&&t(y);let z=q.getCFI(w,x),A=await c(x);if(z&&A){let{booknotes:b=[]}=l(a),c=b.findIndex(a=>a.id===r.current.id&&!a.deletedAt);if(-1!==c){let d={...b[c],cfi:z,text:A,updatedAt:Date.now()},e=p(a.split("-")[0]);if(e.forEach(a=>a?.addAnnotation(r.current,!0)),e.forEach(a=>a?.addAnnotation(d)),r.current=d,!f){b[c]=d;let e=n(a,b);e&&m(j,a,e,k),i({key:a,annotated:!0,text:A,cfi:z,range:x,index:w})}}}},[a,u,c,i]);return{handlePositions:s,setHandlePositions:t,getHandlePositionsFromRange:u,handleAnnotationRangeChange:v}}]),c()}catch(a){c(a)}},!1),140968,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(162650),h=a.i(866736),i=a.i(106865),j=a.i(512912),k=a.i(450517),l=b([e,g,h,j]);[e,g,h,j]=l.then?(await l)():l;let m=({position:a,isVertical:b,type:c,color:g,onDragStart:h,onDrag:j,onDragEnd:k})=>{let l=(0,f.useRef)(!1),m=(0,i.useResponsiveSize)(24),n=(0,i.useResponsiveSize)(8),o=(0,i.useResponsiveSize)(12),p=(0,f.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),l.current=!0,h(),a.target.setPointerCapture(a.pointerId)},[h]),q=(0,f.useCallback)(a=>{l.current&&(a.preventDefault(),a.stopPropagation(),j({x:a.clientX,y:a.clientY}))},[j]),r=(0,f.useCallback)(a=>{l.current&&(a.preventDefault(),a.stopPropagation(),l.current=!1,a.target.releasePointerCapture(a.pointerId),k())},[k]);return(0,d.jsx)("div",{className:"pointer-events-auto absolute z-50 cursor-grab touch-none active:cursor-grabbing",style:{left:b&&"start"===c?a.x-m/2+o/4:a.x-m/2,top:b?"start"===c?a.y-m+o/2:a.y-m/2-o/2:"start"===c?a.y-m:a.y-m/2-o/8,width:m,height:m+o},onPointerDown:p,onPointerMove:q,onPointerUp:r,onPointerCancel:r,children:(0,d.jsxs)("svg",{width:m,height:m+o,viewBox:`0 0 ${m} ${m+o}`,className:(0,e.default)("start"===c&&"rotate-180"),style:{transform:b?"start"===c?"rotate(270deg)":"rotate(90deg)":"start"===c?"rotate(180deg)":void 0},children:[(0,d.jsx)("line",{x1:m/2,y1:0,x2:m/2,y2:o,stroke:g,strokeWidth:2,strokeLinecap:"round"}),(0,d.jsx)("circle",{cx:m/2,cy:o+n,r:n,fill:g})]})})};a.s(["default",0,({bookKey:a,isVertical:b,annotation:c,selection:e,handleColor:i,getAnnotationText:l,setSelection:n,onStartEdit:o})=>{let{settings:p}=(0,h.useSettingsStore)(),{isDarkMode:q}=(0,g.useThemeStore)(),r=p.globalViewSettings.isEink,s=q?"#ffffff":"#000000",{handlePositions:t,getHandlePositionsFromRange:u,handleAnnotationRangeChange:v}=(0,j.useAnnotationEditor)({bookKey:a,annotation:c,getAnnotationText:l,setSelection:n}),w=(0,f.useRef)(!1),x=(0,k.getHighlightColorHex)(p,i)??"#FFFF00",y=(0,f.useRef)(null),z=(0,f.useRef)({x:0,y:0}),A=(0,f.useRef)({x:0,y:0}),[B,C]=(0,f.useState)({x:0,y:0}),[D,E]=(0,f.useState)({x:0,y:0});(0,f.useEffect)(()=>{if(w.current)return;w.current=!0;let a=e.range,c=u(a,b);c&&(setTimeout(()=>{C(c.start),E(c.end)},0),z.current=c.start,A.current=c.end)},[c,e,b,u]),(0,f.useEffect)(()=>{t&&!y.current&&(setTimeout(()=>{C(t.start),E(t.end)},0),z.current=t.start,A.current=t.end)},[t]);let F=(0,f.useCallback)(()=>{y.current="start",o()},[o]),G=(0,f.useCallback)(()=>{y.current="end",o()},[o]),H=(0,f.useCallback)(a=>{C(a),z.current=a,v(a,A.current,b,!0)},[b,v]),I=(0,f.useCallback)(a=>{E(a),A.current=a,v(z.current,a,b,!0)},[b,v]),J=(0,f.useCallback)(()=>{y.current=null,v(z.current,A.current,b,!1)},[b,v]);return 0===B.x&&0===B.y?null:(0,d.jsxs)("div",{className:"pointer-events-none fixed inset-0 z-50",children:[(0,d.jsx)(m,{position:B,isVertical:b,type:"start",color:r?s:x,onDragStart:F,onDrag:H,onDragEnd:J}),(0,d.jsx)(m,{position:D,isVertical:b,type:"end",color:r?s:x,onDragStart:G,onDrag:I,onDragEnd:J})]})}]),c()}catch(a){c(a)}},!1),304058,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=b([e]);[e]=g.then?(await g)():g,a.s(["default",0,({showTooltip:a,tooltipText:b,disabled:c,Icon:g,onClick:h})=>{let[i,j]=(0,f.useState)(!1);return(0,d.jsx)("div",{className:"lg:tooltip lg:tooltip-bottom",title:!i&&a?b:void 0,children:(0,d.jsx)("button",{onClick:()=>{j(!0),h()},className:(0,e.default)("flex h-8 min-h-8 w-8 items-center justify-center p-0",c?"cursor-not-allowed opacity-50":"not-eink:hover:bg-gray-500 eink:hover:border rounded-md"),disabled:c,children:(0,d.jsx)(g,{})})})}]),c()}catch(a){c(a)}},!1),58286,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(800587),g=a.i(127669),h=a.i(178552),i=a.i(862871),j=a.i(466759),k=a.i(715715),l=a.i(106865),m=b([e,i,j,k]);[e,i,j,k]=m.then?(await m)():m,a.s(["default",0,({bookKey:a,isVertical:b,notes:c,toolsVisible:m,triangleDir:n,popupWidth:o,popupHeight:p,onDismiss:q})=>{let{appService:r}=(0,h.useEnv)(),{getConfig:s,setConfig:t}=(0,i.useBookDataStore)(),{setHoveredBookKey:u}=(0,j.useReaderStore)(),{setSideBarVisible:v}=(0,k.useSidebarStore)(),w=s(a),x=(0,l.useResponsiveSize)(250),y=(0,g.useMemo)(()=>[...c].sort((a,b)=>b.updatedAt-a.updatedAt),[c]),z=b=>{b.id&&(r?.isMobile&&q(),u(""),v(!0),w?.viewSettings&&t(a,{viewSettings:{...w.viewSettings,sideBarTab:"annotations"}}))};return(0,d.jsx)("div",{className:(0,e.default)("annotation-notes absolute flex rounded-lg text-white"),style:{...b?{right:"left"===n?`${m?o+16:0}px`:void 0,left:"right"===n?`${m?o+16:0}px`:void 0,height:`${p}px`,maxWidth:`${x}px`,overflowX:"auto"}:{top:"down"===n?`${m?p+16:0}px`:void 0,bottom:"up"===n?`${m?p+16:0}px`:void 0,width:`${o}px`,maxHeight:`${x}px`,overflowY:"auto"},scrollbarWidth:"thin"},children:(0,d.jsx)("div",{className:(0,e.default)("flex gap-4",b?"h-full flex-row":"w-full flex-col"),style:b?{display:"grid",gridAutoFlow:"column",gridAutoColumns:"max-content",minWidth:"min-content",height:`${p}px`,maxHeight:`${p}px`}:{},children:y.map((a,c)=>(0,d.jsx)("div",{role:"none",onClick:()=>z?.(a),className:(0,e.default)("popup-container cursor-pointer rounded-lg bg-gray-600 shadow-lg transition-colors"),style:b?{minWidth:"max-content",height:`${p}px`,maxHeight:`${p}px`}:{},children:a.note&&(0,d.jsx)("div",{dir:"auto",className:(0,e.default)("m-4 hyphens-auto text-justify font-sans text-sm","not-eink:text-white eink:text-base-content",b&&"writing-vertical-rl"),style:b?{fontFeatureSettings:"'vrt2' 1, 'vert' 1",minWidth:"max-content"}:{},children:(0,d.jsxs)("div",{className:(0,e.default)("flex flex-col justify-between gap-2"),children:[a.note,(0,d.jsx)("span",{className:"not-eink:text-white/50 eink:text-base-content/50 text-sm sm:text-xs",children:(0,f.default)(a.createdAt).fromNow()})]})})},a.id||c))})})}]),c()}catch(a){c(a)}},!1),685055,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(929058),h=a.i(178552),i=a.i(162650),j=a.i(866736),k=a.i(106865),l=a.i(937944),m=b([e,i,j,l]);[e,i,j,l]=m.then?(await m)():m;let n=["highlight","underline","squiggly"],o=["red","violet","blue","green","yellow"];a.s(["default",0,({isVertical:a,popupWidth:b,popupHeight:c,triangleDir:m,selectedStyle:p,selectedColor:q,onHandleHighlight:r})=>{let{envConfig:s}=(0,h.useEnv)(),{settings:t}=(0,j.useSettingsStore)(),{isDarkMode:u}=(0,i.useThemeStore)(),v=t.globalReadSettings,w=t.globalViewSettings.isEink,x=u?"#000000":"#ffffff",y=u?"#ffffff":"#000000",z=v.customHighlightColors,[A,B]=(0,f.useState)(p),[C,D]=(0,f.useState)(q),E=(0,k.useResponsiveSize)(16),F=(0,k.useResponsiveSize)(28),G=(0,k.useResponsiveSize)(28),H=(0,k.useResponsiveSize)(16);return(0,d.jsxs)("div",{className:(0,e.default)("highlight-options absolute flex items-center justify-between",a?"flex-col":"flex-row"),style:{width:`${b}px`,height:`${c}px`,...a?{left:`${(G+H)*("left"===m?-1:1)}px`}:{top:`${(G+H)*("up"===m?-1:1)}px`}},children:[(0,d.jsx)("div",{className:(0,e.default)("flex gap-2",a?"flex-col":"flex-row"),style:a?{width:F}:{height:F},children:n.map(a=>(0,d.jsx)("button",{onClick:()=>{let b;return b={...v,highlightStyle:a},void((0,l.saveSysSettings)(s,"globalReadSettings",b),B(a),D(v.highlightStyles[a]),r(!0))},className:"not-eink:bg-gray-700 eink-bordered flex items-center justify-center rounded-full p-0",style:{width:F,height:F,minHeight:F},children:(0,d.jsx)("div",{style:{width:E,height:E,..."highlight"===a&&"highlight"===A&&{backgroundColor:w?y:z[C],color:w?x:"#d1d5db",paddingTop:"2px"},..."highlight"===a&&"highlight"!==A&&{backgroundColor:"#d1d5db",paddingTop:"2px"},...("underline"===a||"squiggly"===a)&&{color:w?y:"#d1d5db",textDecoration:"underline",textDecorationThickness:"2px",textDecorationColor:A===a?w?y:z[C]:"#d1d5db",..."squiggly"===a&&{textDecorationStyle:"wavy"}}},className:"w-4 p-0 text-center leading-none",children:"A"})},a))}),(0,d.jsx)("div",{className:(0,e.default)("not-eink:bg-gray-700 eink-bordered flex items-center justify-center gap-2 rounded-3xl",a?"flex-col py-2":"flex-row px-2"),style:a?{width:F}:{height:F},children:o.filter(a=>!w||C===a).map(a=>(0,d.jsx)("button",{onClick:()=>{let b;return b={...v,highlightStyle:A,highlightStyles:{...v.highlightStyles,[A]:a}},void((0,l.saveSysSettings)(s,"globalReadSettings",b),D(a),r(!0))},style:{width:E,height:E,backgroundColor:C!==a?z[a]:"transparent"},className:"rounded-full p-0",children:C===a&&(0,d.jsx)(g.FaCheckCircle,{size:E,style:{fill:w?y:z[a]}})},a))})]})}]),c()}catch(a){c(a)}},!1),261463,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(726001),g=a.i(304058),h=a.i(58286),i=a.i(685055),j=b([e,f,g,h,i]);[e,f,g,h,i]=j.then?(await j)():j,a.s(["default",0,({bookKey:a,dir:b,isVertical:c,buttons:j,notes:k,position:l,trianglePosition:m,highlightOptionsVisible:n,selectedStyle:o,selectedColor:p,popupWidth:q,popupHeight:r,onHighlight:s,onDismiss:t})=>(0,d.jsx)("div",{dir:b,children:(0,d.jsx)(f.default,{width:c?r:q,height:c?q:r,minHeight:c?q:r,position:l,trianglePosition:m,className:(0,e.default)("selection-popup bg-gray-600 text-white",k.length>0&&"bg-transparent"),triangleClassName:"text-gray-600",onDismiss:t,children:(0,d.jsxs)("div",{className:(0,e.default)("flex h-full gap-4",c?"flex-row":"flex-col"),children:[(0,d.jsx)("div",{className:(0,e.default)("selection-buttons flex h-full w-full items-center justify-between p-2",c?"flex-col overflow-y-auto":"flex-row overflow-x-auto",k.length>0&&"hidden"),style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:j.map((a,b)=>!1===a.visible?null:(0,d.jsx)(g.default,{showTooltip:!n,tooltipText:a.tooltipText,Icon:a.Icon,onClick:a.onClick,disabled:a.disabled},b))}),k.length>0?(0,d.jsx)(h.default,{bookKey:a,isVertical:c,notes:k,toolsVisible:!1,triangleDir:m.dir,popupWidth:c?r:q,popupHeight:c?q:r,onDismiss:t}):n&&(0,d.jsx)(i.default,{isVertical:c,triangleDir:m.dir,popupWidth:c?r:q,popupHeight:c?q:r,selectedStyle:o,selectedColor:p,onHandleHighlight:s})]})})})]),c()}catch(a){c(a)}},!1),284293,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(915302),g=a.i(726001),h=b([g]);[g]=h.then?(await h)():h,a.s(["default",0,({word:a,lang:b,position:c,trianglePosition:h,popupWidth:i,popupHeight:j,onDismiss:k})=>{let l=(0,f.useTranslation)(),[m,n]=(0,e.useState)(a),o=(0,e.useRef)(!1);return(0,e.useEffect)(()=>{if(o.current)return;o.current=!0;let a=document.querySelector("main"),c=document.querySelector("footer"),d=async(b,d)=>{a.innerHTML="",c.dataset.state="loading";try{let e=await fetch(`https://en.wiktionary.org/api/rest_v1/page/definition/${b}`);if(!e.ok)throw Error("Failed to fetch definitions");let f=await e.json(),g=d?f[d]||f.en:f[Object.keys(f)[0]];if(!g||0===g.length)throw Error("No results found");let h=document.createElement("hgroup"),i=document.createElement("h1");i.innerText=b,i.className="text-lg font-bold";let j=document.createElement("p");j.innerText=g[0].language,j.className="text-sm italic opacity-75",h.append(i,j),a.append(h),g.forEach(({partOfSpeech:b,definitions:c})=>{let d=document.createElement("h2");d.innerText=b,d.className="text-base font-semibold mt-4";let e=document.createElement("ol");e.className="pl-8 list-decimal",c.forEach(({definition:a,examples:b})=>{let c;if(!a)return;let d=document.createElement("li"),f=((c=document.createElement("div")).innerHTML=a,c.querySelectorAll('a[rel="mw:WikiLink"]').forEach(a=>{let b=a.getAttribute("title");b&&(a.addEventListener("click",a=>{a.preventDefault(),n(b),o.current=!1}),a.className="text-primary underline cursor-pointer")}),Array.from(c.childNodes));if(d.append(...f),b){let a=document.createElement("ul");a.className="pl-8 list-disc text-sm italic opacity-75",b.forEach(b=>{let c=document.createElement("li");c.innerHTML=b,a.appendChild(c)}),d.appendChild(a)}e.appendChild(d)}),a.appendChild(d),a.appendChild(e)}),c.dataset.state="loaded"}catch(g){console.error(g),c.dataset.state="error";let d=document.createElement("div");d.className="flex flex-col items-center justify-center w-full h-full text-center absolute inset-0";let e=document.createElement("h1");e.innerText=l("Error"),e.className="text-lg font-bold";let f=document.createElement("p");f.innerHTML=l("Unable to load the word. Try searching directly on {{link}}.",{link:`<a href="https://en.wiktionary.org/w/index.php?search=${encodeURIComponent(b)}" target="_blank" rel="noopener noreferrer" class="text-primary underline">Wiktionary</a>`}),d.append(e,f),a.append(d)}},e="string"==typeof b?b:b?.[0];d(m,e)},[l,m,b]),(0,d.jsx)("div",{children:(0,d.jsx)(g.default,{trianglePosition:h,width:i,height:j,position:c,className:"select-text",onDismiss:k,children:(0,d.jsxs)("div",{className:"flex h-full flex-col",children:[(0,d.jsx)("main",{className:"flex-grow overflow-y-auto p-4 font-sans"}),(0,d.jsx)("footer",{className:"mt-auto hidden data-[state=loaded]:block data-[state=error]:hidden data-[state=loading]:hidden",children:(0,d.jsx)("div",{className:"flex items-center px-4 py-2 text-sm opacity-60",children:"Source: Wiktionary (CC BY-SA)"})})]})})})}]),c()}catch(a){c(a)}},!1),813792,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(726001),g=a.i(915302),h=b([f]);[f]=h.then?(await h)():h,a.s(["default",0,({text:a,lang:b,position:c,trianglePosition:h,popupWidth:i,popupHeight:j,onDismiss:k})=>{let l=(0,g.useTranslation)(),m=(0,e.useRef)(!1);return(0,e.useEffect)(()=>{if(m.current)return;m.current=!0;let c=document.querySelector("main"),d=document.querySelector("footer"),e=async(a,b)=>{c.innerHTML="",d.dataset.state="loading";try{let e=await fetch(`https://${b}.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(a)}`);if(!e.ok)throw Error("Failed to fetch Wikipedia summary");let f=await e.json(),g=document.createElement("hgroup");g.style.color="white",g.style.backgroundPosition="center center",g.style.backgroundSize="cover",g.style.backgroundColor="rgba(0, 0, 0, .4)",g.style.backgroundBlendMode="darken",g.style.borderRadius="6px",g.style.padding="12px",g.style.marginBottom="12px",g.style.minHeight="100px";let h=document.createElement("h1");if(h.innerHTML=f.titles.display,h.className="text-lg font-bold",g.append(h),f.description){let a=document.createElement("p");a.innerText=f.description,g.appendChild(a)}f.thumbnail&&(g.style.backgroundImage=`url("${f.thumbnail.source}")`);let i=document.createElement("div");i.innerHTML=f.extract_html,i.className="p-2 text-sm",i.dir=f.dir,c.append(g,i),d.dataset.state="loaded"}catch(h){console.error(h);let e=document.createElement("div"),f=document.createElement("h1");f.innerText=l("Error");let g=document.createElement("p");g.innerHTML=l("Unable to load the article. Try searching directly on {{link}}.",{link:`<a href="https://${b}.wikipedia.org/w/index.php?search=${encodeURIComponent(a)}" target="_blank" rel="noopener noreferrer" class="text-primary underline">Wikipedia</a>`}),e.append(f,g),c.appendChild(e),d.dataset.state="error"}},f="string"==typeof b?b:b?.[0],g=f?f.split("-")[0]:"en";e(a,g)},[l,a,b]),(0,d.jsx)("div",{children:(0,d.jsx)(f.default,{width:i,height:j,position:c,trianglePosition:h,className:"select-text",onDismiss:k,children:(0,d.jsxs)("div",{className:"text-base-content flex h-full flex-col pt-2",children:[(0,d.jsx)("main",{className:"flex-grow overflow-y-auto px-2 font-sans"}),(0,d.jsx)("footer",{className:"mt-auto hidden data-[state=loaded]:block data-[state=error]:hidden data-[state=loading]:hidden",children:(0,d.jsx)("div",{className:"flex items-center px-4 py-2 text-sm opacity-60",children:"Source: Wikipedia (CC BY-SA)"})})]})})})}]),c()}catch(a){c(a)}},!1),986872,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=b([e]);function g({value:a,onChange:b,options:c,className:f,disabled:g=!1}){return(0,d.jsx)("select",{value:a,onChange:b,onKeyDown:a=>a.stopPropagation(),className:(0,e.default)("select bg-base-200 h-8 min-h-8 max-w-[60%] truncate rounded-md border-none text-sm",f),disabled:g,style:{textAlignLast:"end"},children:c.map(({value:a,label:b})=>(0,d.jsx)("option",{value:a,children:b},a))})}[e]=f.then?(await f)():f,a.s(["default",()=>g]),c()}catch(a){c(a)}},!1),625410,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(726001),g=a.i(77946),h=a.i(866736),i=a.i(915302),j=a.i(665647),k=a.i(654617),l=a.i(81402),m=a.i(947334),n=a.i(986872),o=b([f,h,j,l,m,n]);[f,h,j,l,m,n]=o.then?(await o)():o;let p=[""],q=Object.fromEntries(Object.entries(k.TRANSLATOR_LANGS).filter(([a])=>!p.includes(a)));a.s(["default",0,({text:a,position:b,trianglePosition:c,popupWidth:k,popupHeight:l,onDismiss:o})=>{let p=(0,i.useTranslation)(),{token:r}=(0,g.useAuth)(),{settings:s,setSettings:t}=(0,h.useSettingsStore)(),[u,v]=(0,e.useState)([]),[w,x]=(0,e.useState)("AUTO"),[y,z]=(0,e.useState)(s.globalReadSettings.translateTargetLang),[A,B]=(0,e.useState)(s.globalReadSettings.translationProvider),[C,D]=(0,e.useState)(null),[E,F]=(0,e.useState)(null),[G,H]=(0,e.useState)(!1),[I,J]=(0,e.useState)(null),{translate:K,translators:L}=(0,j.useTranslator)({provider:A,sourceLang:w,targetLang:y});return(0,e.useEffect)(()=>{let a=L.map(a=>{let b=a.label;return a.authRequired&&!r?b=`${b} (${p("Login Required")})`:a.quotaExceeded&&(b=`${b} (${p("Quota Exceeded")})`),{name:a.name,label:b}});v(a)},[L]),(0,e.useEffect)(()=>{H(!0),(async()=>{J(null),D(null);try{let b=a.replaceAll("\n","").trim(),c=(await K([b]))[0];if(!c)throw Error("No translation found");D(c)}catch(a){console.error(a),r?J(p("Unable to fetch the translation. Try again later.")):J(p("Unable to fetch the translation. Please log in first and try again."))}finally{H(!1)}})()},[a,r,w,y,A,K]),(0,d.jsx)("div",{children:(0,d.jsxs)(f.default,{trianglePosition:c,width:k,minHeight:l,maxHeight:720,position:b,className:"not-eink:text-white grid h-full select-text grid-rows-[1fr,auto,1fr] bg-gray-600",triangleClassName:"text-gray-600",onDismiss:o,children:[(0,d.jsxs)("div",{className:"overflow-y-auto p-4 font-sans",children:[(0,d.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,d.jsx)("h1",{className:"text-sm font-normal",children:p("Original Text")}),(0,d.jsx)(n.default,{className:"not-eink:bg-gray-600 not-eink:text-white eink:bg-base-100",value:w,onChange:a=>{x(a.target.value)},options:[{value:"AUTO",label:p("Auto Detect")},...Object.entries(q).sort((a,b)=>a[1].localeCompare(b[1])).map(([a,b])=>{let c=E&&"AUTO"===w&&"AUTO"===a?`${q[E]||E} `+p("(detected)"):b;return{value:a,label:c}})]})]}),(0,d.jsx)("p",{className:"not-eink:text-white/90 text-base",children:a})]}),(0,d.jsx)("div",{className:"mx-4 flex-shrink-0 border-t border-gray-500/30"}),(0,d.jsxs)("div",{className:"overflow-y-auto px-4 pb-8 pt-4 font-sans",children:[(0,d.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"text-sm font-normal",children:p("Translated Text")}),(0,d.jsx)(n.default,{className:"not-eink:bg-gray-600 not-eink:text-white eink:bg-base-100",value:y,onChange:a=>{s.globalReadSettings.translateTargetLang=a.target.value,t(s),z(a.target.value)},options:[{value:"",label:p("System Language")},...Object.entries(q).sort((a,b)=>a[1].localeCompare(b[1])).map(([a,b])=>({value:a,label:b}))]})]}),G?(0,d.jsx)("p",{className:"text-base italic text-gray-500",children:p("Loading...")}):(0,d.jsx)("div",{children:I?(0,d.jsx)("p",{className:"text-base text-red-600",children:I}):(0,d.jsx)("p",{className:"not-eink:text-white/90 text-base",children:C||p("No translation available.")})})]}),(0,d.jsxs)("div",{className:"absolute bottom-0 flex h-8 w-full items-center justify-between px-4",children:[(0,d.jsx)("div",{className:"line-clamp-1 text-xs opacity-60",children:A&&!G&&!I&&p("Translated by {{provider}}.",{provider:u.find(a=>a.name===A)?.label})}),(0,d.jsx)(n.default,{className:"not-eink:bg-gray-600 not-eink:text-white eink:bg-base-100",value:A,onChange:a=>{let b=a.target.value,c=(0,m.getTranslators)().filter(a=>(!a.authRequired||!!r)&&!a.quotaExceeded),d=c.find(a=>a.name===b)||c[0];d&&(s.globalReadSettings.translationProvider=d.name,t(s),B(d.name))},options:u.map(({name:a,label:b})=>({value:a,label:b}))})]})]})})}]),c()}catch(a){c(a)}},!1),980886,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(466759),i=a.i(915302),j=a.i(2339),k=a.i(200104),l=a.i(765918),m=a.i(868400),n=a.i(986872),o=a.i(726001),p=b([e,h,k,n,o]);[e,h,k,n,o]=p.then?(await p)():p,a.s(["default",0,({bookKey:a,selection:b,position:c,trianglePosition:p,popupWidth:q,popupHeight:r,onConfirm:s,onDismiss:t})=>{let u=(0,i.useTranslation)(),{envConfig:v}=(0,g.useEnv)(),{getProgress:w,getView:x,recreateViewer:y}=(0,h.useReaderStore)(),{addRule:z}=(0,k.useProofreadStore)(),A=w(a),[B,C]=(0,f.useState)(""),[D,E]=(0,f.useState)(!0),[F,G]=(0,f.useState)(!(0,m.isPunctuationOnly)(b?.text||"")),[H,I]=(0,f.useState)("selection"),[J,K]=(0,f.useState)(!1),L=(0,f.useRef)(null);(0,j.useAutoFocus)({ref:L});let M=async()=>{if(!b)return;let c=b?.range;if(c){let d=(0,m.isWholeWord)(c,b?.text||"");if(F&&!d)return void l.eventDispatcher.dispatch("toast",{type:"warning",message:'Please select a whole word or uncheck the "Whole word" option.',timeout:5e3});if("selection"===H){c.deleteContents();let a=document.createTextNode(B);c.insertNode(a)}let e={scope:H,pattern:b.text,replacement:B.trim(),cfi:b.cfi,sectionHref:A?.sectionHref,isRegex:!1,enabled:!0,caseSensitive:D,wholeWord:F,onlyForTTS:"selection"!==H?J:void 0};s?.(e),await z(v,a,e),t(),"selection"!==H&&!J&&x(a)&&y(v,a)}},N=[{value:"selection",label:u("Current selection")},{value:"book",label:u("All occurrences in this book")},{value:"library",label:u("All occurrences in your library")}];return(0,d.jsx)("div",{children:(0,d.jsxs)(o.default,{trianglePosition:p,width:q,minHeight:r,position:c,className:"not-eink:text-gray-400 flex flex-col justify-between rounded-lg bg-gray-700",triangleClassName:"text-gray-700",onDismiss:t,children:[(0,d.jsxs)("div",{className:"flex flex-col gap-6 p-4",children:[(0,d.jsxs)("div",{className:"not-eink:text-gray-400 flex gap-1 text-xs",children:[(0,d.jsx)("span",{className:"text-nowrap",children:u("Selected text:")}),(0,d.jsxs)("span",{className:"not-eink:text-yellow-300 line-clamp-1 select-text break-words font-medium",children:['"',b?.text||"",'"']})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,d.jsx)("label",{htmlFor:"replacement-input",className:"text-xs",children:u("Replace with:")}),(0,d.jsx)("input",{ref:L,type:"text",value:B,onChange:a=>{let b=a.target.value;C(b)},onKeyDown:a=>{"Enter"===a.key&&B&&M()},placeholder:u("Enter text..."),className:(0,e.default)("w-full flex-1 rounded-md p-2 text-sm placeholder-gray-400 focus:outline-none focus:ring-0","not-eink:bg-gray-600 not-eink:text-white eink:border eink:border-base-content")}),(0,d.jsx)("button",{onClick:M,disabled:!B,className:(0,e.default)("btn btn-sm btn-ghost btn-primary disabled:text-base-content/75 text-blue-600 disabled:opacity-75","bg-transparent hover:bg-transparent disabled:bg-transparent"),children:u("Apply")})]})]}),(0,d.jsxs)("div",{className:"flex flex-wrap items-center gap-4 p-4",children:[(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("span",{className:"line-clamp-1 text-xs",title:u("Case sensitive:"),children:u("Case sensitive:")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle toggle-sm bg-gray-500 checked:bg-black hover:bg-gray-500 hover:checked:bg-black",style:{"--tglbg":"#4B5563"},checked:D,onChange:a=>E(a.target.checked)})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("span",{className:"line-clamp-1 text-xs",title:u("Whole word:"),children:u("Whole word:")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle toggle-sm bg-gray-500 checked:bg-black hover:bg-gray-500 hover:checked:bg-black",style:{"--tglbg":"#4B5563"},checked:F,onChange:a=>G(a.target.checked)})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("span",{className:"line-clamp-1 text-xs",title:u("Only for TTS:"),children:u("Only for TTS:")}),(0,d.jsx)("input",{type:"checkbox",disabled:"selection"===H,className:"toggle toggle-sm bg-gray-500 checked:bg-black hover:bg-gray-500 hover:checked:bg-black",style:{"--tglbg":"#4B5563"},checked:J,onChange:a=>K(a.target.checked)})]})]}),(0,d.jsxs)("div",{className:"flex flex-1 items-center justify-between gap-2 p-4",children:[(0,d.jsx)("label",{htmlFor:"scope-select",className:"line-clamp-1 text-xs",title:u("Scope:"),children:u("Scope:")}),(0,d.jsx)(n.default,{className:"not-eink:bg-gray-600 eink:bg-base-100 not-eink:text-white max-w-[85%]",value:H,onChange:a=>{I(a.target.value)},options:N})]})]})})}]),c()}catch(a){c(a)}},!1),259058,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(852835),h=a.i(915302),i=a.i(381322),j=a.i(466759),k=a.i(654617),l=a.i(937944),m=a.i(178552),n=b([e,i,j,l]);[e,i,j,l]=n.then?(await n)():n;let o=(a,b)=>{let c=(a,b)=>{let c=a.trim().split("."),d=b;for(let a of c)d=d?.[a];return d},d=a,e=d.match(/\{%\s*for\s+(\w+)\s+in\s+(\w+(?:\.\w+)*)\s*%\}/);if(e){let a=e[1],f=e[2],g=0,h=-1,i=e.index+e[0].length;for(let a=i;a<d.length;a++){let b=d.slice(a);if(b.startsWith("{% for "))g++,a+=6;else if(b.startsWith("{% endfor %}")){if(0===g){h=a;break}g--,a+=11}}if(-1!==h){let g=d.slice(0,e.index),j=d.slice(i,h),k=d.slice(h+13),l=c(f,b);if(!Array.isArray(l))return d=g+k,o(d,b);{let c=l.map(c=>{let d={...b,[a]:c};return o(j,d)}).join("");return d=g+c+k,o(d,b)}}}return d=(d=d.replace(/\{%\s*if\s+([^%]+?)\s*%\}([\s\S]*?)\{%\s*endif\s*%\}/g,(a,d,e)=>c(d,b)?o(e,b):"")).replace(/\{\{\s*([^}|]+?)(?:\s*\|\s*(\w+)(?:\s*\((['"]?)([^)'"]*)\3\))?)?\s*\}\}/g,(a,d,e,f,g)=>{let h=c(d,b);if(null==h)return"";if(e){if("date"===e&&"number"==typeof h){let a=new Date(h);return g?g.replace("%Y",a.getFullYear().toString()).replace("%m",String(a.getMonth()+1).padStart(2,"0")).replace("%d",String(a.getDate()).padStart(2,"0")).replace("%H",String(a.getHours()).padStart(2,"0")).replace("%M",String(a.getMinutes()).padStart(2,"0")).replace("%S",String(a.getSeconds()).padStart(2,"0")):a.toLocaleString()}return h}return String(h)})};a.s(["default",0,({bookKey:a,isOpen:b,bookTitle:c,bookAuthor:n,booknotes:p,booknoteGroups:q,onCancel:r,onExport:s})=>{let t=(0,h.useTranslation)(),{envConfig:u}=(0,m.useEnv)(),{getViewSettings:v}=(0,j.useReaderStore)(),w=v(a),x=`## {{ title }}
**${t("Author")}**: {{ author }}

**${t("Exported from Readest")}**: {{ exportDate }}

---

### ${t("Highlights & Annotations")}

{% for chapter in chapters %}
#### {{ chapter.title }}
{% for annotation in chapter.annotations %}
> {{ annotation.text }}
{% if annotation.note %}
**${t("Note:")}** {{ annotation.note }}
{% endif %}
*${t("Time:")} {{ annotation.timestamp | date('%Y-%m-%d %H:%M') }}*
{% endfor %}

---
{% endfor %}`,[y,z]=(0,f.useState)(()=>{let a=w?.noteExportConfig||k.DEFAULT_NOTE_EXPORT_CONFIG;return a.customTemplate?a:{...a,customTemplate:x}}),[A,B]=(0,f.useState)(!1),[C,D]=(0,f.useState)(!1);(0,f.useEffect)(()=>{let b=y.customTemplate,c={...y,customTemplate:b===x?"":b};(0,l.saveViewSettings)(u,a,"noteExportConfig",c,!1,!1)},[y,u,a]);let E=(0,f.useMemo)(()=>{if(y.useCustomTemplate){let a=Object.values(q).sort((a,b)=>a.id-b.id),b={title:c,author:n,exportDate:new Date().toISOString().slice(0,10),chapters:a.map(a=>({title:a.label||t("Untitled"),annotations:a.booknotes.map(a=>({text:a.text||"",note:a.note||"",style:a.style,color:a.color,timestamp:a.updatedAt}))}))};return o(y.customTemplate,b)}let a=Object.values(q).sort((a,b)=>a.id-b.id),b=[];for(let d of(y.includeTitle&&b.push(`# ${c}`),y.includeAuthor&&n&&(b.push(`**${t("Author")}**: ${n}`),b.push("")),y.includeDate&&(b.push(`**${t("Exported from Readest")}**: ${new Date().toISOString().slice(0,10)}`),b.push("")),(y.includeTitle||y.includeAuthor||y.includeDate)&&(b.push("---"),b.push("")),b.push(`## ${t("Highlights & Annotations")}`),b.push(""),a)){if(y.includeChapterTitles){let a=d.label||t("Untitled");b.push(`### ${a}`)}for(let a of d.booknotes){if(y.includeQuotes&&a.text&&b.push(`> ${a.text}`),y.includeNotes&&a.note&&(b.push(""),b.push(`**${t("Note")}**:: ${a.note}`)),y.includeTimestamp&&a.updatedAt){let c=new Date(a.updatedAt).toLocaleString();b.push(""),b.push(`*${t("Time:")} ${c}*`)}b.push(y.noteSeparator)}y.includeChapterSeparator&&(b.push("---"),b.push(""))}return b.join("\n")},[y,q,c,n,t]),F=(0,f.useMemo)(()=>E?g.marked.parse(E):"",[E]),G=a=>{z(b=>({...b,[a]:!b[a]}))};return(0,d.jsx)(i.default,{isOpen:b,title:t("Export Annotations"),onClose:r,boxClassName:"sm:!w-[75%] sm:h-auto sm:!max-h-[90vh] sm:!max-w-5xl",contentClassName:"sm:!px-8 sm:!py-2",children:(0,d.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("h3",{className:"font-bold",children:t("Format Options")}),(0,d.jsxs)("div",{className:(0,e.default)("grid grid-cols-2 gap-x-6 gap-y-3 sm:grid-cols-3",y.useCustomTemplate&&"pointer-events-none opacity-50"),children:[(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeTitle,onChange:()=>G("includeTitle"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Title")})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeAuthor,onChange:()=>G("includeAuthor"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Author")})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeDate,onChange:()=>G("includeDate"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Export Date")})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeChapterTitles,onChange:()=>G("includeChapterTitles"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Chapter Titles")})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeChapterSeparator,onChange:()=>G("includeChapterSeparator"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Chapter Separator")})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeQuotes,onChange:()=>G("includeQuotes"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Highlights")})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeNotes,onChange:()=>G("includeNotes"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Notes")})]}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.includeTimestamp,onChange:()=>G("includeTimestamp"),className:"checkbox checkbox-sm",disabled:y.useCustomTemplate}),(0,d.jsx)("span",{className:"text-sm",children:t("Note Date")})]})]})]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h3",{className:"font-bold",children:t("Advanced")}),(0,d.jsx)("button",{onClick:()=>D(!C),className:"text-sm text-blue-500 hover:underline",children:C?t("Hide"):t("Show")})]}),C&&(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:y.useCustomTemplate,onChange:()=>G("useCustomTemplate"),className:"checkbox checkbox-sm"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:t("Use Custom Template")})]}),y.useCustomTemplate&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:t("Export Template")}),(0,d.jsx)("textarea",{value:y.customTemplate,onChange:a=>z({...y,customTemplate:a.target.value}),className:"textarea textarea-bordered w-full font-mono text-xs",rows:12,placeholder:x})]}),(0,d.jsxs)("div",{className:"bg-base-200 space-y-3 rounded-lg p-3 text-xs",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"mb-2 font-bold",children:t("Template Syntax:")}),(0,d.jsxs)("ul",{className:"space-y-1 font-mono",children:[(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"{{ variable }}"})," -"," ",t("Insert value")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"{{ variable | date }}"})," ","- ",t("Format date (locale)")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"{{ variable | date('%Y-%m-%d') }}"})," ","- ",t("Format date (custom)")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"{% if variable %}...{% endif %}"})," ","- ",t("Conditional")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"{% for item in list %}...{% endfor %}"})," ","- ",t("Loop")]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"mb-2 font-bold",children:t("Available Variables:")}),(0,d.jsxs)("ul",{className:"space-y-1",children:[(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"title"})," -"," ",t("Book title")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"author"})," -"," ",t("Book author")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"exportDate"})," -"," ",t("Export date")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"chapters"})," -"," ",t("Array of chapters")]}),(0,d.jsxs)("li",{className:"ml-4",children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"chapter.title"})," -"," ",t("Chapter title")]}),(0,d.jsxs)("li",{className:"ml-4",children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"chapter.annotations"})," -"," ",t("Array of annotations")]}),(0,d.jsxs)("li",{className:"ml-8",children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"annotation.text"})," -"," ",t("Highlighted text")]}),(0,d.jsxs)("li",{className:"ml-8",children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"annotation.note"})," -"," ",t("Annotation note")]}),(0,d.jsxs)("li",{className:"ml-8",children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"annotation.timestamp"})," -"," ",t("Update time")]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"mb-2 font-bold",children:t("Date Format Tokens:")}),(0,d.jsxs)("ul",{className:"space-y-1 font-mono",children:[(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"%Y"})," -"," ",t("Year (4 digits)")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"%m"})," -"," ",t("Month (01-12)")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"%d"})," - ",t("Day (01-31)")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"%H"})," - ",t("Hour (00-23)")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"%M"})," -"," ",t("Minute (00-59)")]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{className:"bg-base-300 rounded px-1",children:"%S"})," -"," ",t("Second (00-59)")]})]})]})]})]})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h3",{className:"font-bold",children:t("Preview")}),(0,d.jsxs)("label",{className:"flex cursor-pointer items-center gap-2",children:[(0,d.jsx)("input",{type:"checkbox",checked:A,onChange:()=>B(!A),className:"checkbox checkbox-sm"}),(0,d.jsx)("span",{className:"text-sm",children:t("Show Source")})]})]}),A?(0,d.jsx)("div",{className:(0,e.default)("bg-base-200 max-h-[40vh] overflow-y-auto rounded-lg p-4 font-mono text-xs","select-text whitespace-pre-wrap break-words"),children:E||t("No content to preview")}):(0,d.jsx)("div",{className:(0,e.default)("bg-base-200 prose prose-sm max-w-none overflow-y-auto rounded-lg p-4","max-h-[40vh] select-text break-words"),dangerouslySetInnerHTML:{__html:F||`<p class="text-base-content/50">${t("No content to preview")}</p>`}})]}),(0,d.jsxs)("div",{className:"mt-4 flex justify-end gap-4",children:[(0,d.jsx)("button",{onClick:r,className:"btn btn-ghost btn-sm",children:t("Cancel")}),(0,d.jsx)("button",{onClick:()=>{s(E)},className:"btn btn-primary btn-sm",disabled:0===p.length,children:t("Export")})]})]})})}]),c()}catch(a){c(a)}},!1),415842,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(540438),g=a.i(887287),h=a.i(640219),i=a.i(178552),j=a.i(201716),k=a.i(465863),l=a.i(162650),m=a.i(862871),n=a.i(866736),o=a.i(466759),p=a.i(925426),q=a.i(915302),r=a.i(106865),s=a.i(108328),t=a.i(366109),u=a.i(44484),v=a.i(71976),w=a.i(478474),x=a.i(765918),y=a.i(123588),z=a.i(452125),A=a.i(583840),B=a.i(868400),C=a.i(609027),D=a.i(547105),E=a.i(450517),F=a.i(258312),G=a.i(140968),H=a.i(261463),I=a.i(284293),J=a.i(813792),K=a.i(625410),L=a.i(551524),M=a.i(980886),N=a.i(259058),O=b([l,m,n,o,p,s,u,v,D,G,H,I,J,K,M,N]);[l,m,n,o,p,s,u,v,D,G,H,I,J,K,M,N]=O.then?(await O)():O,a.s(["default",0,({bookKey:a})=>{let b=(0,q.useTranslation)(),{envConfig:c,appService:O}=(0,i.useEnv)(),{settings:P}=(0,n.useSettingsStore)(),{isDarkMode:Q}=(0,l.useThemeStore)(),{getConfig:R,saveConfig:S,getBookData:T,updateBooknotes:U}=(0,m.useBookDataStore)(),{getProgress:V,getView:W,getViewsById:X,getViewSettings:Y}=(0,o.useReaderStore)(),{setNotebookVisible:Z,setNotebookNewAnnotation:$}=(0,p.useNotebookStore)(),{listenToNativeTouchEvents:_}=(0,s.useDeviceControlStore)();(0,u.useNotesSync)(a);let aa=(0,k.getOSPlatform)(),ab=R(a),ac=V(a),ad=T(a),ae=W(a),af=Y(a),ag=ad.book?.primaryLanguage||"en",ah=e.default.useRef(null),[ai,aj]=(0,e.useState)(null),[ak,al]=(0,e.useState)(!1),[am,an]=(0,e.useState)(!1),[ao,ap]=(0,e.useState)(!1),[aq,ar]=(0,e.useState)(!1),[as,at]=(0,e.useState)(!1),[au,av]=(0,e.useState)(),[aw,ax]=(0,e.useState)(),[ay,az]=(0,e.useState)(),[aA,aB]=(0,e.useState)(),[aC,aD]=(0,e.useState)(),[aE,aF]=(0,e.useState)(!1),[aG,aH]=(0,e.useState)(!1),[aI,aJ]=(0,e.useState)([]),[aK,aL]=(0,e.useState)(null),[aM,aN]=(0,e.useState)(!1),[aO,aP]=(0,e.useState)(null),[aQ,aR]=(0,e.useState)(P.globalReadSettings.highlightStyle),[aS,aT]=(0,e.useState)(P.globalReadSettings.highlightStyles[aQ]),aU=ak||am||ao||aq||as,aV=(0,r.useResponsiveSize)(10),aW=2*aV+6,aX=window.innerWidth-2*aV,aY=window.innerHeight-2*aV,aZ=Math.min(480,aX),a$=Math.min(300,aY),a_=Math.min(480,aX),a0=Math.min(265,aY),a1=Math.min(440,aX),a2=Math.min(200,aY),a3=Math.min((0,r.useResponsiveSize)(300),aX),a4=(0,r.useResponsiveSize)(44),a5=(0,e.useCallback)(()=>{if(!ai||!ai.text)return;let b=document.querySelector(`#gridcell-${a}`);if(!b)return;let c=b.getBoundingClientRect(),d=(0,w.getPosition)(ai,c,aW,af.vertical),e=(0,w.getPopupPosition)(d,c,af.vertical?a4:a3,af.vertical?a3:a4,aV);"down"===e.dir&&"android"===aa&&(d.point.y+=0,e.point.y+=0);let f=(0,w.getPopupPosition)(d,c,aZ,a$,aV),g=(0,w.getPopupPosition)(d,c,a_,a0,aV),h=(0,w.getPopupPosition)(d,c,a1,a2,aV);0!=d.point.x&&0!=d.point.y&&(ax(e),az(f),aB(g),aD(h),av(d))},[ai,a,af.vertical]);(0,e.useEffect)(()=>{aR(P.globalReadSettings.highlightStyle)},[P.globalReadSettings.highlightStyle]),(0,e.useEffect)(()=>{aT(P.globalReadSettings.highlightStyles[aQ])},[P.globalReadSettings.highlightStyles,aQ]);let a6=(0,e.useMemo)(()=>({bookKey:a,viewSettings:Y(a),userLocale:(0,k.getLocale)(),content:"",transformers:["punctuation"],reversePunctuationTransform:!0}),[]),a7=(0,e.useCallback)(async a=>(a6.content=(0,w.getTextFromRange)(a,ag.startsWith("ja")?["rt"]:[]),await (0,D.transformContent)(a6)),[ag,a6]),a8=(0,e.useCallback)((0,z.throttle)(()=>{aj(null),al(!1),an(!1),ap(!1),ar(!1),at(!1),aL(null)},500),[]),{isTextSelected:a9,handleScroll:ba,handleTouchStart:bb,handleTouchMove:bc,handleTouchEnd:bd,handlePointerDown:be,handlePointerMove:bf,handlePointerCancel:bg,handlePointerUp:bh,handleSelectionchange:bi,handleShowPopup:bj,handleUpToPopup:bk,handleContextmenu:bl}=(0,v.useTextSelector)(a,aj,a7,a8),bm=()=>{a8(),ae?.deselect(),a9.current=!1};(0,t.useFoliateEvents)(ae,{onLoad:b=>{let c=b.detail,{doc:d,index:e}=c;O?.isAndroidApp&&(_(),x.eventDispatcher.on("native-touch",a=>{let b=a.detail;"touchstart"===b.type?bb():"touchend"===b.type&&(bd(),bh(d,e))})),ae?.renderer?.addEventListener("scroll",ba),ae?.renderer?.addEventListener("scroll",()=>{a5()});let f={passive:!1};c.doc?.addEventListener("touchstart",bb,f),c.doc?.addEventListener("touchmove",a=>{al(!1),aL(null),bc(a)},f),c.doc?.addEventListener("touchend",bd),c.doc?.addEventListener("pointerdown",be.bind(null,d,e),f),c.doc?.addEventListener("pointermove",bf.bind(null,d,e),f),c.doc?.addEventListener("pointercancel",bg.bind(null,d,e)),c.doc?.addEventListener("pointerup",bh.bind(null,d,e)),c.doc?.addEventListener("selectionchange",bi.bind(null,d,e)),ad.book?.format==="PDF"&&c.doc?.addEventListener("contextmenu",b=>{try{let b=d.getSelection?.();if(b&&!b.isCollapsed){let c=b.getRangeAt(0),d=b.toString();d.trim()&&(aj({key:a,text:d,range:c,index:e,cfi:ae?.getCFI(e,c)}),al(!1),ar(!0),an(!1),ap(!1))}}catch(a){console.warn("PDF context menu translation failed:",a)}return b.preventDefault(),b.stopPropagation(),!1}),c.doc?.addEventListener("contextmenu",bl)},onDrawAnnotation:b=>{let c=Y(a),d=c.isEink,{draw:e,annotation:f,doc:g,range:i}=b.detail,{style:j,color:k}=f,l=(0,E.getHighlightColorHex)(P,k);if(f.note){let{defaultView:a}=g,b=i.startContainer,c=1===b.nodeType?b:b.parentElement,{writingMode:d}=a.getComputedStyle(c);e(h.Overlayer.bubble,{writingMode:d})}else if("highlight"===j)e(h.Overlayer.highlight,{color:d?Q?"#000000":"#ffffff":l});else if(["underline","squiggly"].includes(j)){let{defaultView:a}=g,b=i.startContainer,f=1===b.nodeType?b:b.parentElement,{writingMode:k,lineHeight:m,fontSize:n}=a.getComputedStyle(f),o=parseFloat(n)||c.defaultFontSize,p=parseFloat(m)||c.lineHeight*o,q=O?.isMobile?0:-1,r=O?.isMobile?-1:0,s=c.vertical?(p-o)/2-2+q:(p-o)/2-2+r;e(h.Overlayer[j],{writingMode:k,color:d?Q?"#ffffff":"#000000":l,padding:s})}},onShowAnnotation:b=>{let c=b.detail,{value:d,index:e,range:f}=c,{booknotes:g=[]}=R(a),h=d.startsWith(j.NOTE_PREFIX),i=h?d.replace(j.NOTE_PREFIX,""):d,k=g.filter(a=>"annotation"===a.type&&!a.deletedAt&&a.cfi===i).find(a=>!h&&a.style||h&&a.note);if(!k)return;let{style:l,color:m,text:n,note:o}=k,p={key:a,annotated:!0,text:n??"",note:o??"",rect:h?c.rect:void 0,cfi:i,range:f,index:e};h?(aH(!0),aF(!1),aL(null)):(aH(!1),aJ([]),l&&m&&(aR(l),aT(m)),l&&f&&aL(k)),aj(p),bk()}}),(0,e.useEffect)(()=>{bj(aU)},[aU]),(0,e.useEffect)(()=>{let b=W(a);if(!b?.renderer)return;let c=()=>{aU&&a5()};return b.renderer.addEventListener("scroll",c),()=>{b.renderer.removeEventListener("scroll",c)}},[a,aU,a5]),(0,e.useEffect)(()=>(x.eventDispatcher.on("export-annotations",by),()=>{x.eventDispatcher.off("export-annotations",by)}),[]),(0,e.useEffect)(()=>{if(aF(!!(ai&&ai.annotated)),ai&&ai.text.trim().length>0){let b=document.querySelector(`#gridcell-${a}`);if(!b)return;let c=b.getBoundingClientRect(),d=(0,w.getPosition)(ai,c,aW,af.vertical),e=(0,w.getPopupPosition)(d,c,af.vertical?a4:a3,af.vertical?a3:a4,aV);"down"===e.dir&&"android"===aa&&(d.point.y+=0,e.point.y+=0);let f=(0,w.getPopupPosition)(d,c,aZ,a$,aV),g=(0,w.getPopupPosition)(d,c,a_,a0,aV),h=(0,w.getPopupPosition)(d,c,a1,a2,aV);if(0==d.point.x||0==d.point.y)return;ax(e),az(f),aB(g),aD(h),av(d);let{enableAnnotationQuickActions:i,annotationQuickAction:j}=af;if(i&&j&&a9.current)switch(af.annotationQuickAction){case"copy":bo(!1),bm();break;case"highlight":bm();break;case"search":br();break;case"dictionary":bs();break;case"wikipedia":bt();break;case"translate":bu();break;case"tts":bv(!0)}else bn()}},[ai,a]),(0,e.useEffect)(()=>{if(!ac)return;let{location:a}=ac,{booknotes:b=[]}=ab,c=b.filter(b=>!b.deletedAt&&"annotation"===b.type&&b.style&&(0,C.isCfiInLocation)(b.cfi,a)),d=b.filter(b=>!b.deletedAt&&"annotation"===b.type&&b.note&&b.note.trim().length>0&&(0,C.isCfiInLocation)(b.cfi,a));try{Promise.all(c.map(a=>ae?.addAnnotation(a))),Promise.all(d.map(a=>ae?.addAnnotation({...a,value:`${j.NOTE_PREFIX}${a.cfi}`})))}catch(a){console.warn(a)}},[ac]),(0,e.useEffect)(()=>{if(!ab.booknotes||!ai?.cfi||!aG)return;let a=ab.booknotes.filter(a=>"annotation"===a.type&&!a.deletedAt&&a.cfi===ai.cfi).filter(a=>a.note&&a.note.trim().length>0);aJ(a)},[ai?.cfi,aG,ab.booknotes]);let bn=()=>{O?.isMobile||ah.current?.focus(),al(!0),ar(!1),an(!1),ap(!1)},bo=(d=!0)=>{if(!ai||!ai.text||(setTimeout(()=>{navigator.clipboard?.writeText(ai.text)},100),d&&bm(),!af?.copyToNotebook))return;x.eventDispatcher.dispatch("toast",{type:"info",message:b("Copied to notebook"),className:"whitespace-nowrap",timeout:2e3});let{booknotes:e=[]}=ab,f=ae?.getCFI(ai.index,ai.range);if(!f)return;let g={id:(0,k.uniqueId)(),type:"excerpt",cfi:f,text:ai.text,note:"",createdAt:Date.now(),updatedAt:Date.now()},h=e.findIndex(a=>a.cfi===f&&"excerpt"===a.type&&!a.deletedAt);-1!==h?e[h]=g:e.push(g);let i=U(a,e);i&&S(c,a,i,P),O?.isMobile||Z(!0)},bp=(b=!1,d)=>{if(!ai||!ai.text)return;aF(!0);let{booknotes:e=[]}=ab,f=ae?.getCFI(ai.index,ai.range);if(!f)return;let g=d||P.globalReadSettings.highlightStyle,h=P.globalReadSettings.highlightStyles[g],i={id:(0,k.uniqueId)(),type:"annotation",cfi:f,style:g,color:h,text:ai.text,note:"",createdAt:Date.now(),updatedAt:Date.now()},j=e.findIndex(a=>a.cfi===f&&"annotation"===a.type&&a.style&&!a.deletedAt),l=X(a.split("-")[0]);-1!==j?(l.forEach(a=>a?.addAnnotation(i,!0)),b?(i.id=e[j].id,e[j]=i,l.forEach(a=>a?.addAnnotation(i))):(e[j].deletedAt=Date.now(),a8())):(e.push(i),l.forEach(a=>a?.addAnnotation(i)),aj({...ai,cfi:f,annotated:!0}));let m=U(a,e);m&&S(c,a,m,P)},bq=()=>{if(!ai||!ai.text)return;let{sectionHref:a}=ac;ai.href=a,bp(!0),Z(!0),$(ai),a8()},br=()=>{if(!ai||!ai.text)return;bm();let b=ai.text,c=af.convertChineseVariant;c&&"none"!==c&&(b=(0,A.runSimpleCC)(b,c,!0)),x.eventDispatcher.dispatch("search-term",{term:b,bookKey:a})},bs=()=>{ai&&ai.text&&(al(!1),an(!0))},bt=()=>{ai&&ai.text&&(al(!1),ap(!0))},bu=()=>{ai&&ai.text&&(al(!1),ar(!0))},bv=async(b=!1)=>{ai&&ai.text&&(al(!1),x.eventDispatcher.dispatch("tts-speak",{bookKey:a,range:ai.range,oneTime:b}))},bw=()=>{if(ai&&ai.text&&(al(!1),at(!0),(0,B.getWordCount)(ai.text)>30))return void x.eventDispatcher.dispatch("toast",{type:"warning",message:b("Word limit of 30 words exceeded."),timeout:3e3})},bx=(0,e.useCallback)(()=>{al(!1)},[]);(0,L.default)({onHighlightSelection:()=>{bp(!1,"highlight")},onUnderlineSelection:()=>{bp(!1,"underline")},onAnnotateSelection:()=>{bq()},onSearchSelection:()=>{br()},onCopySelection:()=>{bo(!1)},onTranslateSelection:()=>{bu()},onDictionarySelection:()=>{bs()},onWikipediaSelection:()=>{bt()},onReadAloudSelection:()=>{bv()},onProofreadSelection:()=>{bw()}},[ai?.text]);let by=async c=>{let{bookKey:d}=c.detail;if(a!==d)return;let{bookDoc:e,book:f}=ad;if(!e||!f||!e.toc)return;let{booknotes:h=[]}=R(a),i=h.filter(a=>!a.deletedAt);if(0===i.length)return void x.eventDispatcher.dispatch("toast",{type:"info",message:b("No annotations to export"),className:"whitespace-nowrap",timeout:2e3});let j={};for(let a of i){let b=(0,y.findTocItemBS)(e.toc??[],a.cfi),c=b?.href||"",d=b?.label||"",f=b?.id||0;j[c]||(j[c]={id:f,href:c,label:d,booknotes:[]}),j[c].booknotes.push(a)}Object.values(j).forEach(a=>{a.booknotes.sort((a,b)=>g.compare(a.cfi,b.cfi))}),aP({booknotes:i,booknoteGroups:j}),aN(!0)},bz=async a=>{let{book:c}=ad;if(!c)return;setTimeout(()=>{navigator.clipboard?.writeText(a)},100);let d=`${(0,k.makeSafeFilename)(c.title)}.md`,e=await O?.saveFile(d,a,"text/markdown");x.eventDispatcher.dispatch("toast",{type:"info",message:e?b("Exported successfully"):b("Copied to clipboard"),timeout:2e3}),aN(!1),aP(null)},bA=ai?.annotated,bB=F.annotationToolButtons.map(({type:a,label:c,Icon:d})=>{switch(a){case"copy":return{tooltipText:b(c),Icon:d,onClick:bo};case"highlight":return{tooltipText:bA?b("Delete Highlight"):b(c),Icon:bA?f.RiDeleteBinLine:d,onClick:bp,disabled:ad.book?.format==="PDF"};case"annotate":return{tooltipText:b(c),Icon:d,onClick:bq,disabled:ad.book?.format==="PDF"};case"search":return{tooltipText:b(c),Icon:d,onClick:br,disabled:ad.book?.format==="PDF"};case"dictionary":return{tooltipText:b(c),Icon:d,onClick:bs};case"wikipedia":return{tooltipText:b(c),Icon:d,onClick:bt};case"translate":return{tooltipText:b(c),Icon:d,onClick:bu};case"tts":return{tooltipText:b(c),Icon:d,onClick:bv,disabled:ad.book?.format==="PDF"};case"proofread":return{tooltipText:b(c),Icon:d,onClick:bw,disabled:ad.book?.format!=="EPUB"};default:return{tooltipText:"",Icon:d,onClick:()=>{}}}});return(0,d.jsxs)("div",{ref:ah,role:"toolbar",tabIndex:-1,children:[am&&au&&ay&&(0,d.jsx)(I.default,{word:ai?.text,lang:ad.bookDoc?.metadata.language,position:ay,trianglePosition:au,popupWidth:aZ,popupHeight:a$,onDismiss:bm}),ao&&au&&ay&&(0,d.jsx)(J.default,{text:ai?.text,lang:ad.bookDoc?.metadata.language,position:ay,trianglePosition:au,popupWidth:aZ,popupHeight:a$,onDismiss:bm}),aq&&au&&aA&&(0,d.jsx)(K.default,{text:ai?.text,position:aA,trianglePosition:au,popupWidth:a_,popupHeight:a0,onDismiss:bm}),ak&&au&&aw&&(0,d.jsx)(H.default,{bookKey:a,dir:af.rtl?"rtl":"ltr",isVertical:af.vertical,buttons:bB,notes:aI,position:aw,trianglePosition:au,highlightOptionsVisible:aE,selectedStyle:aQ,selectedColor:aS,popupWidth:a3,popupHeight:a4,onHighlight:bp,onDismiss:bm}),as&&au&&aC&&ai&&(0,d.jsx)(M.default,{bookKey:a,selection:ai,position:aC,trianglePosition:au,popupWidth:a1,popupHeight:a2,onDismiss:bm}),aK&&aK.color&&ai&&(0,d.jsx)(G.default,{bookKey:a,isVertical:af.vertical,annotation:aK,selection:ai,handleColor:aS,getAnnotationText:a7,setSelection:aj,onStartEdit:bx}),aM&&aO&&ad.book&&(0,d.jsx)(N.default,{bookKey:a,isOpen:aM,bookTitle:ad.book.title,bookAuthor:ad.book.author||"",booknotes:aO.booknotes,booknoteGroups:aO.booknoteGroups,onCancel:()=>{aN(!1),aP(null)},onExport:bz})]})}]),c()}catch(a){c(a)}},!1),617461,a=>{"use strict";let b=a=>new Set([...a?.getAttributeNS?.("http://www.idpf.org/2007/ops","type")?.split(" ")??[],...a?.attributes?.getNamedItem?.("epub:type")?.value?.split(" ")??[]]),c=a=>new Set(a?.getAttribute?.("role")?.split(" ")),d=a=>{if(a.matches("sup"))return!0;let{verticalAlign:b}=getComputedStyle(a);return"super"===b||"top"===b||"text-top"===b||/^\d/.test(b)},e=["biblioref","glossref","noteref"],f=["doc-biblioref","doc-glossref","doc-noteref"],g="a, span, sup, sub, em, strong, i, b, small, big";class h extends EventTarget{detectFootnotes=!0;#z(a,{index:d,anchor:e},f){let g=document.createElement("foliate-view");return new Promise((h,i)=>{g.addEventListener("load",a=>{try{let d,i,{doc:j}=a.detail,k=e(j),l=(d=b(k),(i=c(k)).has("doc-biblioentry")||d.has("biblioentry")?"biblioentry":i.has("definition")||d.has("glossdef")?"definition":i.has("doc-endnote")||d.has("endnote")||d.has("rearnote")?"endnote":i.has("doc-footnote")||d.has("footnote")?"footnote":i.has("note")||d.has("note")?"note":null),m=k?.matches?.("aside")&&"footnote"===l;if(k){let a;if(k.startContainer)a=k;else if(k.matches("li, aside"))(a=j.createRange()).selectNodeContents(k);else if(k.matches("dt")){(a=j.createRange()).setStartBefore(k);let b=k.nextElementSibling,c=null;for(;b&&b.matches("dd");)c=b,b=b.nextElementSibling;a.setEndAfter(c||k)}else if(k.closest("li"))(a=j.createRange()).selectNodeContents(k.closest("li"));else if(k.closest(".note"))(a=j.createRange()).selectNodeContents(k.closest(".note"));else if(k.querySelector("a")){(a=j.createRange()).setStartBefore(k);let b=k.nextElementSibling;for(;b&&!b.querySelector("a");)b=b.nextElementSibling;b?a.setEndBefore(b):a.setEndAfter(k.parentNode.lastChild)}else a=j.createRange(),!(k.textContent?.trim()||k.children.length>0)&&k.parentElement?a.selectNodeContents(k.parentElement):a.selectNode(k);let b=a.extractContents();j.body.replaceChildren(),j.body.appendChild(b)}this.dispatchEvent(new CustomEvent("render",{detail:{view:g,href:f,type:l,hidden:m,target:k}})),h()}catch(a){i(a)}}),g.open(a).then(()=>this.dispatchEvent(new CustomEvent("before-render",{detail:{view:g}}))).then(()=>g.goTo(d)).catch(i)})}handle(a,h){let i,j,{a:k,href:l,follow:m}=h.detail,{yes:n,maybe:o}=(i=b(k),j=c(k),{yes:f.some(a=>j.has(a))||e.some(a=>i.has(a)),maybe:()=>!i.has("backlink")&&!j.has("doc-backlink")&&(d(k)||1===k.children.length&&d(k.children[0])||d(k.parentElement))});return n||m?(h.preventDefault(),Promise.resolve(a.resolveHref(l)).then(b=>this.#z(a,b,l))):this.detectFootnotes&&o()?(h.preventDefault(),Promise.resolve(a.resolveHref(l)).then(({index:b,anchor:c})=>this.#z(a,{index:b,anchor:a=>((a,b)=>{let c=b(a),d=c;for(;c.matches(g);){let a=c.parentElement;if(!a)break;c=a}if(c===a.body){let a=d.nextElementSibling;if(a&&!a.matches(g))return a;throw Error("Failed to extract footnote")}return c})(a,c)},l))):void 0}}a.s(["FootnoteHandler",()=>h])},488846,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(466759),g=a.i(862871),h=a.i(366109),i=a.i(505244),j=a.i(173947),k=a.i(478474),l=a.i(617461),m=a.i(201993),n=a.i(765918),o=a.i(890392),p=a.i(240009),q=a.i(726001),r=b([f,g,i,j,o,p,q]);[f,g,i,j,o,p,q]=r.then?(await r)():r,a.s(["default",0,({bookKey:a,bookDoc:b})=>{let c=(0,e.useRef)(null),r=(0,e.useRef)(null),[s,t]=(0,e.useState)(),[u,v]=(0,e.useState)(),[w,x]=(0,e.useState)(!1),{getBookData:y}=(0,g.useBookDataStore)(),{getView:z,getViewSettings:A}=(0,f.useReaderStore)(),{getLoadedFonts:B}=(0,i.useCustomFontStore)(),C=z(a),D=A(a),E=new l.FootnoteHandler,F=(0,e.useRef)(null),[G,H]=(0,e.useState)(null),[I,J]=(0,e.useState)(360),[K,L]=(0,e.useState)(88),M=(a,b)=>{let c=b?window.innerWidth/2:window.innerHeight/2;return Math.min(a,c-10-12)},N=a=>Math.min(a,window.innerWidth-10-12),O=a=>Math.min(a,window.innerHeight-10-12);(0,e.useEffect)(()=>{let d=d=>{let{view:e}=d.detail;e.addEventListener("link",c=>{c.preventDefault();let{detail:d}=c;d.follow=!0,E.handle(b,c)?.catch(b=>{console.warn(b),z(a)?.goTo(d.href)})}),e.addEventListener("load",b=>{let{doc:c}=b.detail,d=y(a);(0,m.mountAdditionalFonts)(c,(0,o.isCJKLang)(d.book?.primaryLanguage)),B().forEach(a=>{(0,m.mountCustomFont)(c,a)})}),r.current=e,c.current?.replaceChildren(e);let{renderer:f}=e;f.setAttribute("flow","scrolled"),f.setAttribute("margin-top","0px"),f.setAttribute("margin-right","0px"),f.setAttribute("margin-bottom","0px"),f.setAttribute("margin-left","0px"),f.setAttribute("gap","0%");let g=A(a),h={...(0,j.getThemeCode)()},i=document.getElementById("popup-container");i&&(h.bg=getComputedStyle(i).backgroundColor);let k=(0,j.getStyles)(g,h),l=(0,j.getFootnoteStyles)();f.setStyles?.(`${k}
${l}`)},e=b=>{let{view:c}=b.detail;c.addEventListener("relocate",()=>{let{renderer:b}=c;A(a).vertical?J(N(M(b.viewSize,!0))):L(O(M(b.viewSize,!1))),x(!0)})};return E.addEventListener("before-render",d),E.addEventListener("render",e),()=>{E.removeEventListener("before-render",d),E.removeEventListener("render",e)}},[C]),(0,e.useEffect)(()=>{w&&F.current?.focus()},[w]),(0,e.useEffect)(()=>{D.vertical?(J(N(88)),L(O(Math.max(360,window.innerHeight/4)))):(J(N(Math.max(360,window.innerWidth/4))),L(O(88)))},[D]),(0,e.useEffect)(()=>{if(s&&G){let a=(0,k.getPopupPosition)(s,G,I,K,10);v(a)}},[s,G,I,K]);let P=async c=>{let d=c.detail,e=document.querySelector(`#gridcell-${a}`);if(!e)return;let f=e.getBoundingClientRect(),g=A(a),h=(0,k.getPosition)(d.a,f,10,g.vertical);H(f),t(h);let{a:i}=d;["duokan-footnote","footnote-link","footnote"].some(a=>i.classList.contains(a))&&(d.follow=!0),E.handle(b,c)?.catch(a=>{console.warn(a);let b=c.detail;C?.goTo(b.href)})},Q=()=>{let a;a=c.current?.querySelector("foliate-view"),a?.close(),a?.remove(),H(null),v(null),t(null),x(!1)},R=b=>{let{element:d,footnote:e}=b.detail,f=document.querySelector(`#gridcell-${a}`);if(!f)return;let g=f.getBoundingClientRect(),h=A(a),i=(0,k.getPosition)(d,g,10,h.vertical);if(c.current){let a=document.createElement("p");a.textContent=e,a.setAttribute("style","padding: 1em; hanging-punctuation: allow-end last;"),a.style.visibility="hidden",h.vertical?a.style.height=`${K}px`:a.style.width=`${I}px`,document.body.appendChild(a);let b=a.getBoundingClientRect();h.vertical?J(M(b.width,!0)):L(M(b.height,!1)),document.body.removeChild(a),a.style.visibility="visible",c.current.replaceChildren(a),H(g),t(i),x(!0)}};return(0,h.useFoliateEvents)(C,{onLinkClick:P}),(0,e.useEffect)(()=>(window.addEventListener("resize",Q),n.eventDispatcher.on("footnote-popup",R),()=>{window.removeEventListener("resize",Q),n.eventDispatcher.off("footnote-popup",R)}),[]),(0,e.useEffect)(()=>{r.current&&c.current?.replaceChildren(r.current)},[c]),(0,d.jsxs)("div",{ref:F,role:"toolbar",tabIndex:-1,children:[w&&(0,d.jsx)(p.Overlay,{onDismiss:Q}),(0,d.jsx)(q.default,{isOpen:w,width:I,height:K,position:w?u:void 0,trianglePosition:w?s:void 0,className:"select-text overflow-y-auto",onDismiss:Q,children:(0,d.jsx)("div",{className:"footnote-content",ref:c,style:{width:`${I}px`,height:`${K}px`}})})]})}]),c()}catch(a){c(a)}},!1),268603,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(162650),i=a.i(765918),j=b([e,h]);[e,h]=j.then?(await j)():j,a.s(["default",0,({bookKey:a,showDoubleBorder:b,isScrolled:c,isVertical:j,isEink:k,horizontalGap:l,contentInsets:m,gridInsets:n})=>{let{appService:o}=(0,g.useEnv)(),{systemUIVisible:p,statusBarHeight:q}=(0,h.useThemeStore)(),r=Math.max(n.top,o?.isAndroidApp&&p?q/2:0),[s,t]=f.default.useState(null),u=(0,f.useRef)(2e3),v=(0,f.useRef)(null),w=b=>{let{message:c,bookKey:d,timeout:e=2e3}=b.detail;d===a&&(t(c),u.current=e)};return((0,f.useEffect)(()=>(i.eventDispatcher.on("hint",w),()=>{i.eventDispatcher.off("hint",w)}),[]),(0,f.useEffect)(()=>(v.current&&clearTimeout(v.current),v.current=setTimeout(()=>t(""),u.current),()=>{v.current&&clearTimeout(v.current)}),[s]),s)?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:(0,e.default)("absolute left-0 right-0 top-0 z-10",s?"":"bg-transparent"),style:{height:`${r}px`}}),(0,d.jsx)("div",{className:(0,e.default)("hintinfo absolute flex items-center justify-end overflow-hidden ps-2",s?"":"bg-transparent",j?"writing-vertical-rl":"top-0 h-[44px]",c?j?"h-full":"w-full":j?"max-h-[50%]":"max-w-[50%]"),style:j?{bottom:`${(m.bottom-n.bottom)*1.5}px`,right:b?`calc(${m.right}px)`:`calc(${Math.max(0,m.right-32)}px)`,width:b?"30px":`${m.right}px`}:{top:`${r}px`,insetInlineEnd:`calc(${l/2}% + ${m.right/2}px)`},children:(0,d.jsx)("h2",{className:(0,e.default)("text-center font-sans",k?"text-sm font-normal":"text-neutral-content text-xs font-light"),children:s||""})})]}):null}]),c()}catch(a){c(a)}},!1),619090,a=>{"use strict";var b=a.i(508171);a.s(["default",0,({borderColor:a,showHeader:c,showFooter:d,insets:e})=>(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"borderframe pointer-events-none absolute",style:{border:`4px solid ${a}`,height:`calc(100% - ${e.top+e.bottom}px + 20px)`,top:`calc(${e.top}px - 10px)`,left:`calc(${e.left}px - 10px)`,right:`calc(${e.right}px - 10px)`}}),(0,b.jsx)("div",{className:"borderframe pointer-events-none absolute",style:{border:`1px solid ${a}`,height:`calc(100% - ${e.top+e.bottom}px)`,top:`${e.top}px`,left:`calc(${e.left+32*!!d}px`,right:`calc(${e.right+32*!!c}px`}}),d&&(0,b.jsx)("div",{className:"borderframe pointer-events-none absolute",style:{borderTop:`1px solid ${a}`,borderBottom:`1px solid ${a}`,borderLeft:`1px solid ${a}`,width:"32px",height:`calc(100% - ${e.top+e.bottom}px)`,top:`${e.top}px`,left:`calc(${e.left}px)`}}),c&&(0,b.jsx)("div",{className:"borderframe pointer-events-none absolute",style:{borderTop:`1px solid ${a}`,borderBottom:`1px solid ${a}`,borderRight:`1px solid ${a}`,width:"32px",height:`calc(100% - ${e.top+e.bottom}px)`,top:`${e.top}px`,left:`calc(100% - ${e.right}px - 32px)`}})]})])},626565,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(162650),i=a.i(466759),j=a.i(715715),k=a.i(862871),l=a.i(915302),m=a.i(348234),n=a.i(370014),o=a.i(264400),p=a.i(838407),q=a.i(44947),r=a.i(19832),s=a.i(205205),t=a.i(432219),u=a.i(218517),v=a.i(641287),w=a.i(415842),x=a.i(488846),y=a.i(268603),z=a.i(619090),A=b([e,h,i,j,k,o,p,q,r,s,t,u,v,w,x,y]);[e,h,i,j,k,o,p,q,r,s,t,u,v,w,x,y]=A.then?(await A)():A,a.s(["default",0,({bookKeys:a,onCloseBook:b})=>{let c=(0,l.useTranslation)(),{appService:A}=(0,g.useEnv)(),{getConfig:B,getBookData:C}=(0,k.useBookDataStore)(),{getProgress:D,getViewState:E,getViewSettings:F}=(0,i.useReaderStore)(),{setGridInsets:G,hoveredBookKey:H}=(0,i.useReaderStore)(),{sideBarBookKey:I}=(0,j.useSidebarStore)(),{safeAreaInsets:J}=(0,h.useThemeStore)(),K=window.innerWidth/window.innerHeight,L=(0,m.getGridTemplate)(a.length,K);(0,f.useEffect)(()=>{if(!I)return;let a=C(I);a&&a.book&&(document.title=a.book.title)},[I]);let M=(a,b)=>{if(!J)return{top:0,right:0,bottom:0,left:0};let{top:c,right:d,bottom:e,left:f}=(0,m.getInsetEdges)(a,b,K);return{top:c?J.top:0,right:d?J.right:0,bottom:e?J.bottom:0,left:f?J.left:0}};return((0,f.useEffect)(()=>{J&&a.forEach((b,c)=>{let d=M(c,a.length);G(b,d)})},[a,J]),J)?(0,d.jsx)("div",{className:(0,e.default)("books-grid bg-base-100 relative grid h-full flex-grow"),style:{gridTemplateColumns:L.columns,gridTemplateRows:L.rows},role:"main","aria-label":c("Books Content"),children:a.map((c,f)=>{let g=C(c),h=B(c),i=D(c),j=F(c),k=E(c),l=M(f,a.length),{book:m,bookDoc:G}=g||{};if(!m||!h||!G||!j||!k)return null;let{section:I,pageinfo:J,timeinfo:K,sectionLabel:L}=i||{},N=k.ribbonVisible,O=k.viewerKey,P=j.gapPercent,Q=(0,n.getViewInsets)(j),R={top:l.top+Q.top,right:l.right+Q.right,bottom:l.bottom+Q.bottom,left:l.left+Q.left},S=j.scrolled,T=j.showBarsOnScroll,U=j.showHeader&&(!S||T),V=j.showFooter&&(!S||T);return(0,d.jsxs)("div",{id:`gridcell-${c}`,className:(0,e.default)("relative h-full w-full overflow-hidden",A?.hasRoundedWindow&&"rounded-window"),children:[N&&!H&&(0,d.jsx)(v.default,{width:`${P}%`}),(0,d.jsx)(s.default,{bookKey:c,bookTitle:m.title,isTopLeft:0===f,isHoveredAnim:a.length>2,onCloseBook:b,gridInsets:l}),(0,d.jsx)(q.default,{bookKey:c,bookDoc:G,config:h,gridInsets:l,contentInsets:R},O),j.vertical&&j.scrolled&&(0,d.jsxs)(d.Fragment,{children:[(V||j.doubleBorder)&&(0,d.jsx)("div",{className:"bg-base-100 absolute left-0 top-0 h-full",style:{width:`calc(${R.left+32*!!V}px)`,height:"calc(100%)"}}),(U||j.doubleBorder)&&(0,d.jsx)("div",{className:"bg-base-100 absolute right-0 top-0 h-full",style:{width:`calc(${R.right+32*!!U}px)`,height:"calc(100%)"}})]}),j.vertical&&j.doubleBorder&&(0,d.jsx)(z.default,{showHeader:U,showFooter:V,borderColor:j.borderColor,horizontalGap:P,insets:Q}),U&&(0,d.jsx)(r.default,{bookKey:c,section:L,showDoubleBorder:j.vertical&&j.doubleBorder,isScrolled:j.scrolled,isVertical:j.vertical,isEink:j.isEink,horizontalGap:P,contentInsets:R,gridInsets:l}),(0,d.jsx)(y.default,{bookKey:c,showDoubleBorder:j.vertical&&j.doubleBorder,isScrolled:j.scrolled,isVertical:j.vertical,isEink:j.isEink,horizontalGap:P,contentInsets:R,gridInsets:l}),V&&(0,d.jsx)(u.default,{bookKey:c,section:I,pageinfo:J,timeinfo:K,horizontalGap:P,contentInsets:R,gridInsets:l}),(0,d.jsx)(w.default,{bookKey:c}),(0,d.jsx)(o.default,{bookKey:c,gridInsets:l}),(0,d.jsx)(p.default,{bookKey:c,gridInsets:l,toc:G.toc||[]}),(0,d.jsx)(x.default,{bookKey:c,bookDoc:G}),(0,d.jsx)(t.default,{bookKey:c,bookFormat:m.format,section:I,pageinfo:J,isHoveredAnim:!1,gridInsets:l})]},c)})}):null}]),c()}catch(a){c(a)}},!1),864771,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8 1.003a7 7 0 0 0-7 7v.43c.09 1.51 1.91 1.79 3 .7a1.87 1.87 0 0 1 2.64 2.64c-1.1 1.16-.79 3.07.8 3.2h.6a7 7 0 1 0 0-14l-.04.03zm0 13h-.52a.58.58 0 0 1-.36-.14.56.56 0 0 1-.15-.3 1.24 1.24 0 0 1 .35-1.08 2.87 2.87 0 0 0 0-4 2.87 2.87 0 0 0-4.06 0 1 1 0 0 1-.9.34.41.41 0 0 1-.22-.12.42.42 0 0 1-.1-.29v-.37a6 6 0 1 1 6 6l-.04-.04zM9 3.997a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 7.007a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-7-5a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm7-1a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM13 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"},child:[]}]})(a)}a.s(["VscSymbolColor",()=>c])},86381,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 13 2 C 11.355469 2 10 3.355469 10 5 L 10 16.8125 L 9.34375 16.125 L 9.09375 15.90625 C 7.941406 14.753906 6.058594 14.753906 4.90625 15.90625 C 3.753906 17.058594 3.753906 18.941406 4.90625 20.09375 L 4.90625 20.125 L 13.09375 28.21875 L 13.15625 28.25 L 13.1875 28.3125 C 14.535156 29.324219 16.253906 30 18.1875 30 L 19.90625 30 C 24.441406 30 28.09375 26.347656 28.09375 21.8125 L 28.09375 14 C 28.09375 12.355469 26.738281 11 25.09375 11 C 24.667969 11 24.273438 11.117188 23.90625 11.28125 C 23.578125 9.980469 22.394531 9 21 9 C 20.234375 9 19.53125 9.300781 19 9.78125 C 18.46875 9.300781 17.765625 9 17 9 C 16.648438 9 16.316406 9.074219 16 9.1875 L 16 5 C 16 3.355469 14.644531 2 13 2 Z M 13 4 C 13.554688 4 14 4.445313 14 5 L 14 16 L 16 16 L 16 12 C 16 11.445313 16.445313 11 17 11 C 17.554688 11 18 11.445313 18 12 L 18 16 L 20 16 L 20 12 C 20 11.445313 20.445313 11 21 11 C 21.554688 11 22 11.445313 22 12 L 22 16 L 24.09375 16 L 24.09375 14 C 24.09375 13.445313 24.539063 13 25.09375 13 C 25.648438 13 26.09375 13.445313 26.09375 14 L 26.09375 21.8125 C 26.09375 25.277344 23.371094 28 19.90625 28 L 18.1875 28 C 16.722656 28 15.457031 27.476563 14.40625 26.6875 L 6.3125 18.6875 C 5.867188 18.242188 5.867188 17.757813 6.3125 17.3125 C 6.757813 16.867188 7.242188 16.867188 7.6875 17.3125 L 12 21.625 L 12 5 C 12 4.445313 12.445313 4 13 4 Z"},child:[]}]})(a)}a.s(["LiaHandPointerSolid",()=>c])},560840,a=>{"use strict";var b=a.i(591509);function c(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"circle",attr:{cx:"256",cy:"56",r:"40",fill:"none",strokeLinejoin:"round",strokeWidth:"32"},child:[]},{tag:"path",attr:{fill:"none",strokeLinejoin:"round",strokeWidth:"32",d:"M204.23 274.44c2.9-18.06 4.2-35.52-.5-47.59-4-10.38-12.7-16.19-23.2-20.15L88 176.76c-12-4-23.21-10.7-24-23.94-1-17 14-28 29-24 0 0 88 31.14 163 31.14s162-31 162-31c18-5 30 9 30 23.79 0 14.21-11 19.21-24 23.94l-88 31.91c-8 3-21 9-26 18.18-6 10.75-5 29.53-2.1 47.59l5.9 29.63 37.41 163.9c2.8 13.15-6.3 25.44-19.4 27.74S308 489 304.12 476.28l-37.56-115.93q-2.71-8.34-4.8-16.87L256 320l-5.3 21.65q-2.52 10.35-5.8 20.48L208 476.18c-4 12.85-14.5 21.75-27.6 19.46s-22.4-15.59-19.46-27.74l37.39-163.83z"},child:[]}]})(a)}function d(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"rect",attr:{width:"256",height:"480",x:"128",y:"16",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",rx:"48",ry:"48",transform:"rotate(-90 256 256)"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M16 336v-24a8 8 0 0 1 8-8h0a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16h0a8 8 0 0 1-8-8v-24"},child:[]}]})(a)}function e(a){return(0,b.GenIcon)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"rect",attr:{width:"256",height:"480",x:"128",y:"16",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",rx:"48",ry:"48"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 16h24a8 8 0 0 1 8 8h0a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16h0a8 8 0 0 1 8-8h24"},child:[]}]})(a)}a.s(["IoAccessibilityOutline",()=>c,"IoPhoneLandscapeOutline",()=>d,"IoPhonePortraitOutline",()=>e])},51926,a=>{"use strict";var b=a.i(178552);a.s(["useResetViewSettings",0,()=>{let{appService:a}=(0,b.useEnv)();return b=>{if(!a)return;let c=a.getDefaultViewSettings();Object.entries(b).forEach(([a,b])=>{let d=c[a];void 0!==d&&b(d)})}}])},180018,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(687134),h=a.i(915302),i=b([e]);[e]=i.then?(await i)():i,a.s(["default",0,({className:a,inputClassName:b,label:c,iconSize:i,value:j,onChange:k,min:l,max:m,step:n,disabled:o})=>{let p=(0,h.useTranslation)(),[q,r]=(0,f.useState)(j),s=n||1;return(0,f.useEffect)(()=>{r(j)},[j]),(0,d.jsxs)("div",{className:(0,e.default)("config-item",a),children:[(0,d.jsx)("span",{className:"text-base-content line-clamp-2",children:c}),i&&(0,d.jsx)("span",{style:{minWidth:`${i}px`}}),(0,d.jsxs)("div",{className:"text-base-content flex items-center gap-2",children:[(0,d.jsx)("input",{type:"text",inputMode:"decimal",disabled:o,value:q,onChange:a=>{let b=a.target.value;if(""===b||/^[1-9]\d*\.?\d*$|^0?\.?\d*$/.test(b)){let a=""===b?0:parseFloat(b);if(r(a),!isNaN(a)){let b=Math.round(10*a)/10;k(Math.max(l,Math.min(m,b)))}}},onBlur:()=>{let a=Math.max(l,Math.min(m,q));r(a),k(a)},className:(0,e.default)("input input-ghost settings-content text-base-content w-16 max-w-xs rounded border-0 bg-transparent pe-3 !outline-none",c&&"py-1 ps-1 text-right",o&&"input-disabled cursor-not-allowed disabled:bg-transparent",b),onFocus:a=>a.target.select()}),(0,d.jsx)("button",{tabIndex:o?-1:0,"aria-label":p("Decrease"),onClick:()=>{let a=Math.max(l,q-s),b=Math.round(10*a)/10;r(b),k(b)},className:`btn btn-circle btn-sm ${j<=l||o?"btn-disabled !bg-opacity-5":""}`,children:(0,d.jsx)(g.FiMinus,{className:"h-4 w-4"})}),(0,d.jsx)("button",{tabIndex:o?-1:0,"aria-label":p("Increase"),onClick:()=>{let a=Math.min(m,q+s),b=Math.round(10*a)/10;r(b),k(b)},className:`btn btn-circle btn-sm ${j>=m||o?"btn-disabled !bg-opacity-5":""}`,children:(0,d.jsx)(g.FiPlus,{className:"h-4 w-4"})})]})]})}]),c()}catch(a){c(a)}},!1),500441,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(508479),h=a.i(687134),i=a.i(547274),j=a.i(178552),k=a.i(915302),l=a.i(106865),m=b([e]);[e]=m.then?(await m)():m;let n=({index:a,style:b,data:c})=>{let{options:e,selected:f,onSelect:g,onGetFontFamily:h,family:j,iconSize:k}=c,l=e[a];return(0,d.jsx)("li",{role:"option","aria-selected":f===l.option,className:"px-2",style:b,children:(0,d.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>g(l.option),onKeyDown:a=>{("Enter"===a.key||" "===a.key)&&g(l.option)},"aria-label":l.label||l.option,className:"flex w-full items-center overflow-hidden !px-0 text-sm",children:[(0,d.jsx)("span",{style:{minWidth:`${k}px`},children:f===l.option&&(0,d.jsx)(i.MdCheck,{className:"text-base-content",size:k})}),(0,d.jsx)("span",{className:"line-clamp-1 overflow-visible break-all leading-loose",style:{fontFamily:h(l.option,j)},title:l.label||l.option,children:l.label||l.option})]})},l.option)};a.s(["default",0,({family:a,selected:b,options:c,moreOptions:i,onSelect:m,onGetFontFamily:o})=>{let p=(0,k.useTranslation)(),{appService:q}=(0,j.useEnv)(),r=(0,l.useResponsiveSize)(16),s=[...c,...i??[]],t=s.find(a=>a.option===b)??s[0],u=(0,f.useMemo)(()=>({options:c,selected:b,onSelect:m,onGetFontFamily:o,family:a??"",iconSize:r,appService:q}),[c,b,m,o,a,r,q]),v=(0,f.useMemo)(()=>({options:i??[],selected:b,onSelect:m,onGetFontFamily:o,family:a??"",iconSize:r}),[i,b,m,o,a,r]);return(0,d.jsxs)("div",{className:"dropdown dropdown-top",children:[(0,d.jsx)("button",{tabIndex:0,className:"btn btn-sm flex items-center px-[10px] font-normal normal-case sm:px-[20px]",onClick:a=>a.currentTarget.focus(),children:(0,d.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,d.jsx)("span",{className:"line-clamp-1 break-all leading-loose",style:{fontFamily:o(t.option,a??"")},children:t.label}),(0,d.jsx)(h.FiChevronUp,{size:r})]})}),(0,d.jsxs)("ul",{role:"listbox",tabIndex:0,className:(0,e.default)("dropdown-content bgcolor-base-200 no-triangle menu rounded-box absolute z-[1] mt-4 shadow","right-[-32px] w-[46vw] !px-0 sm:right-0 sm:w-44",i?.length?"":"inline overflow-hidden"),children:[(0,d.jsx)("div",{style:{height:Math.min(40*c.length,320)},children:(0,d.jsx)(g.FixedSizeList,{width:"100%",height:Math.min(40*c.length,320),itemCount:c.length,itemSize:40,itemData:u,children:n})}),i&&i.length>0&&(0,d.jsxs)("li",{className:"dropdown dropdown-left dropdown-top px-2",children:[(0,d.jsxs)("div",{className:"flex items-center px-0 text-sm",children:[(0,d.jsx)("span",{style:{minWidth:`${r}px`},children:(0,d.jsx)(h.FiChevronLeft,{size:r})}),(0,d.jsx)("span",{children:p("System Fonts")})]}),(0,d.jsx)("ul",{role:"listbox",tabIndex:0,className:(0,e.default)("dropdown-content bgcolor-base-200 menu rounded-box relative z-[1] shadow","!mr-4 mb-[-46px] inline w-[46vw] overflow-hidden !px-0 sm:w-[200px]"),children:(0,d.jsx)("div",{style:{height:Math.min(40*i.length,320)},children:(0,d.jsx)(g.FixedSizeList,{width:"100%",height:Math.min(40*i.length,320),itemCount:i.length,itemSize:40,itemData:v,children:n})})})]})]})]})}]),c()}catch(a){c(a)}},!1),185144,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(547274),h=a.i(950678),i=a.i(178552),j=a.i(466759),k=a.i(915302),l=a.i(866736),m=a.i(505244),n=a.i(495697),o=a.i(937944),p=a.i(201993),q=b([e,j,l,m,o]);[e,j,l,m,o]=q.then?(await q)():q,a.s(["default",0,({bookKey:a,onBack:b})=>{let c=(0,k.useTranslation)(),{appService:q,envConfig:r}=(0,i.useEnv)(),{settings:s}=(0,l.useSettingsStore)(),{fonts:t,addFont:u,loadFont:v,removeFont:w,getAvailableFonts:x,saveCustomFonts:y}=(0,m.useCustomFontStore)(),{getViewSettings:z}=(0,j.useReaderStore)(),A=z(a)||s.globalViewSettings,[B,C]=(0,f.useState)(!1),{selectFiles:D}=(0,n.useFileSelector)(q,c),E="serif"===A.defaultFont.toLowerCase()?"serif":"sans-serif",F="serif"===E?A.serifFont:A.sansSerifFont,G=t.filter(a=>!a.deletedAt).sort((a,b)=>(b.downloadedAt||0)-(a.downloadedAt||0)),H=(a=>{let b=new Map;for(let c of a){let a=c.family||c.name;b.has(a)||b.set(a,[]),b.get(a).push(c.id)}return Array.from(b.entries()).map(([b,c])=>({name:b,fonts:c.map(b=>a.find(a=>a.id===b)).filter(a=>!!a)}))})(G);return(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsxs)("div",{className:"mb-6 flex h-8 items-center justify-between",children:[(0,d.jsx)("div",{className:"breadcrumbs py-1",children:(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:(0,d.jsx)("button",{className:"font-semibold",onClick:b,children:c("Font")})}),(0,d.jsx)("li",{className:"font-medium",children:c("Custom Fonts")})]})}),G.length>0&&(0,d.jsx)("button",{onClick:()=>{C(!B)},className:"btn btn-ghost btn-sm text-base-content gap-2",title:B?c("Cancel Delete"):c("Delete Font"),children:B?(0,d.jsx)(d.Fragment,{children:c("Cancel")}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.MdDelete,{className:"h-4 w-4"}),c("Delete")]})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,d.jsx)("div",{className:"card border-primary/50 hover:border-primary/75 group h-12 border-2 transition-colors",children:(0,d.jsx)("button",{className:"card-body flex cursor-pointer items-center justify-center p-2 text-center",onClick:()=>{D({type:"fonts",multiple:!0}).then(async a=>{if(!a.error&&0!==a.files.length){for(let b of a.files){let a=await q?.importFont(b.path||b.file);if(!a)continue;let c=u(a.path,{name:a.name,family:a.family,style:a.style,weight:a.weight,variable:a.variable});if(console.log("Added custom font:",c),c&&!c.error){let a=await v(r,c.id);(0,p.mountCustomFont)(document,a)}}y(r)}})},children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"flex items-center justify-center",children:(0,d.jsx)(g.MdAdd,{className:"text-primary/85 group-hover:text-primary h-6 w-6"})}),(0,d.jsx)("div",{className:"text-primary/85 group-hover:text-primary line-clamp-1 font-medium",children:c("Import Font")})]})})}),H.map(b=>(0,d.jsx)("div",{role:"none",className:(0,e.default)("card h-12 border shadow-sm",F===b.name?"border-primary/50 bg-primary/50":`border-base-200 bg-base-200 ${B?"":"cursor-pointer"}`),onClick:B?void 0:()=>{"serif"===E?(0,o.saveViewSettings)(r,a,"serifFont",b.name):(0,o.saveViewSettings)(r,a,"sansSerifFont",b.name)},title:b.fonts.map(a=>a.name).join("\n"),children:(0,d.jsxs)("div",{className:"card-body flex items-center justify-center p-2",children:[(0,d.jsx)("div",{style:{fontFamily:`"${b.name}", sans-serif`,fontWeight:400},className:"text-base-content line-clamp-1 break-all",children:b.name}),B&&(0,d.jsx)("button",{onClick:()=>(a=>{for(let b of a.fonts)b&&w(b.id)&&(q?.deleteFont(b),y(r),0===x().length&&C(!1))})(b),className:"btn btn-ghost btn-xs absolute right-[-10px] top-[-10px] h-6 min-h-0 w-6 p-0 hover:bg-transparent",title:c("Delete Font"),children:(0,d.jsx)(h.IoMdCloseCircleOutline,{className:"text-base-content/75 h-6 w-6"})})]})},b.name))]}),(0,d.jsx)("div",{className:"bg-base-200/30 my-8 rounded-lg p-4",children:(0,d.jsxs)("div",{className:"text-base-content/70 text-sm sm:text-xs",children:[(0,d.jsxs)("div",{className:"mb-1 indent-2 font-medium",children:[c("Tips"),":"]}),(0,d.jsxs)("ul",{className:"list-outside list-disc space-y-1 ps-2",children:[(0,d.jsx)("li",{children:c("Supported font formats: .ttf, .otf, .woff, .woff2")}),(0,d.jsx)("li",{children:c("Custom fonts can be selected from the Font Face menu")})]})]})})]})}]),c()}catch(a){c(a)}},!1),482949,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(547274),h=a.i(654617),i=a.i(178552),j=a.i(466759),k=a.i(915302),l=a.i(866736),m=a.i(505244),n=a.i(106865),o=a.i(465863),p=a.i(545251),q=a.i(890392),r=a.i(557469),s=a.i(51926),t=a.i(937944),u=a.i(180018),v=a.i(500441),w=a.i(185144),x=b([e,j,l,m,q,t,u,v,w]);[e,j,l,m,q,t,u,v,w]=x.then?(await x)():x;let y=a=>Array.from(new Set([...a,...h.CJK_SERIF_FONTS,...h.CJK_SANS_SERIF_FONTS])).filter(a=>h.CJK_FONTS_PATTENS.test(a)||(0,q.isCJKStr)(a)).filter(a=>!h.CJK_EXCLUDE_PATTENS.test(a)).sort((a,b)=>a.localeCompare(b)),z=(a,b)=>`'${a}', ${b}`,A=a=>!["android","linux"].includes((0,o.getOSPlatform)())||!h.NON_FREE_FONTS.includes(a),B=({className:a,family:b,label:c,options:f,moreOptions:g,selected:h,onSelect:i})=>{let j=(0,k.useTranslation)();return(0,d.jsxs)("div",{className:(0,e.default)("config-item",a),children:[(0,d.jsx)("span",{className:"line-clamp-2 min-w-10",children:c}),(0,d.jsx)(v.default,{family:b,options:f.map(a=>({option:a,label:j(a)})),moreOptions:g?.map(a=>({option:a,label:a}))??[],selected:h,onSelect:i,onGetFontFamily:z})]})};a.s(["default",0,({bookKey:a,onRegisterReset:b})=>{let c=(0,k.useTranslation)(),{envConfig:e,appService:q}=(0,i.useEnv)(),{getView:x,getViewSettings:z}=(0,j.useReaderStore)(),{settings:C,fontPanelView:D,setFontPanelView:E}=(0,l.useSettingsStore)(),{fonts:F,getFontFamilies:G}=(0,m.useCustomFontStore)(),H=z(a)||C.globalViewSettings,I=x(a),J=(0,n.useResponsiveSize)(18),K=[{option:"Serif",label:c("Serif Font")},{option:"Sans-serif",label:c("Sans-Serif Font")}],L=(0,o.getOSPlatform)(),M=[];switch(L){case"macos":M=h.MACOS_FONTS;break;case"windows":M=h.WINDOWS_FONTS;break;case"linux":M=h.LINUX_FONTS;break;case"ios":M=h.IOS_FONTS;break;case"android":M=[]}let[N,O]=(0,f.useState)(M),[P,Q]=(0,f.useState)(H.defaultFont),[R,S]=(0,f.useState)(H.defaultFontSize),[T,U]=(0,f.useState)(H.minimumFontSize),[V,W]=(0,f.useState)(H.overrideFont),[X,Y]=(0,f.useState)(H.defaultCJKFont),[Z,$]=(0,f.useState)(H.serifFont),[_,aa]=(0,f.useState)(H.sansSerifFont),[ab,ac]=(0,f.useState)(H.monospaceFont),[ad,ae]=(0,f.useState)(H.fontWeight),[af,ag]=(0,f.useState)(G()),[ah,ai]=(0,f.useState)(()=>y([...af,...N])),aj=(0,s.useResetViewSettings)(),ak=()=>{aj({defaultFont:Q,defaultFontSize:S,minimumFontSize:U,overrideFont:W,defaultCJKFont:Y,serifFont:$,sansSerifFont:aa,monospaceFont:ac,fontWeight:ae})};return((0,f.useEffect)(()=>{b(ak)},[q]),(0,f.useEffect)(()=>{ai(a=>{let b=y([...af,...N]);return a.length!==b.length?b:a})},[af,N]),(0,f.useEffect)(()=>{ag(G())},[F,G]),(0,f.useEffect)(()=>{$(H.serifFont),aa(H.sansSerifFont),ac(H.monospaceFont)},[H.serifFont,H.sansSerifFont,H.monospaceFont]),(0,f.useEffect)(()=>{(0,r.isTauriAppPlatform)()&&q&&!q.isAndroidApp&&(0,p.getSysFontsList)().then(a=>{if(a.error||0===Object.keys(a.fonts).length)return void console.error("Failed to get system fonts list:",a.error);let b=[];Object.entries(a.fonts).forEach(([c,d])=>{if(!c||/emoji|icons|symbol|dingbats|ornaments|webdings|wingdings|miuiex/i.test(c))return;let e=Object.entries(a.fonts).filter(([a,b])=>b===d);1===e.length?b.push(d):b.push(c)}),O([...new Set(b)].sort((a,b)=>a.localeCompare(b)))})},[q]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"defaultFont",P)},[P]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"defaultCJKFont",X)},[X]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"defaultFontSize",R)},[R]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"minimumFontSize",T)},[T]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"fontWeight",ad)},[ad]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"serifFont",Z)},[Z]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"sansSerifFont",_)},[_]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"monospaceFont",ab)},[ab]),(0,f.useEffect)(()=>{(0,t.saveViewSettings)(e,a,"overrideFont",V)},[V]),"custom-fonts"===D)?(0,d.jsx)("div",{className:"my-4 w-full",children:(0,d.jsx)(w.default,{bookKey:a,onBack:()=>{E("main-fonts")}})}):(0,d.jsxs)("div",{className:"my-4 w-full space-y-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"font-medium",children:c("Override Book Font")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:V,onChange:()=>W(!V)})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Font Size")}),(0,d.jsx)("div",{className:"card border-base-200 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsx)(u.default,{label:c("Default Font Size"),value:R,onChange:S,min:T,max:120}),(0,d.jsx)(u.default,{label:c("Minimum Font Size"),value:T,onChange:U,min:1,max:120})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Font Weight")}),(0,d.jsx)("div",{className:"card border-base-200 border shadow",children:(0,d.jsx)("div",{className:"divide-base-200 divide-y",children:(0,d.jsx)(u.default,{label:c("Font Weight"),value:ad,onChange:ae,min:100,max:900,step:100})})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Font Family")}),(0,d.jsx)("div",{className:"card border-base-200 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Default Font")}),(0,d.jsx)(v.default,{options:K,selected:P,onSelect:Q,onGetFontFamily:a=>{switch(a){case"Serif":return`'${Z}', serif`;case"Sans-serif":return`'${_}', sans-serif`;case"Monospace":return`'${ab}', monospace`;default:return""}}})]}),((0,o.isCJKEnv)()||I?.language.isCJK)&&(0,d.jsx)(B,{className:"config-item-top",family:"serif",label:c("CJK Font"),options:ah,selected:X,onSelect:Y})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"font-medium",children:c("Font Face")}),(0,d.jsx)("button",{onClick:()=>{E("custom-fonts")},className:"btn btn-ghost btn-xs gap-1 hover:bg-transparent",title:c("Manage Custom Fonts"),children:(0,d.jsx)(g.MdSettings,{size:J})})]}),(0,d.jsx)("div",{className:"card border-base-200 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsx)(B,{className:"config-item-top",family:"serif",label:c("Serif Font"),options:[...af,...h.SERIF_FONTS.filter(A),...h.CJK_SERIF_FONTS],moreOptions:N,selected:Z,onSelect:$}),(0,d.jsx)(B,{family:"sans-serif",label:c("Sans-Serif Font"),options:[...af,...h.SANS_SERIF_FONTS.filter(A),...h.CJK_SANS_SERIF_FONTS],moreOptions:N,selected:_,onSelect:aa}),(0,d.jsx)(B,{className:"config-item-bottom",family:"monospace",label:c("Monospace Font"),options:[...af,...h.MONOSPACE_FONTS],moreOptions:N,selected:ab,onSelect:ac})]})})]})]})}]),c()}catch(a){c(a)}},!1),871893,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(547274),g=a.i(560840),h=a.i(564645),i=a.i(178552),j=a.i(466759),k=a.i(862871),l=a.i(866736),m=a.i(915302),n=a.i(51926),o=a.i(465863),p=a.i(173947),q=a.i(714617),r=a.i(545251),s=a.i(937944),t=a.i(936114),u=a.i(654617),v=a.i(986872),w=a.i(180018),x=b([j,k,l,p,s,t,v,w]);[j,k,l,p,s,t,v,w]=x.then?(await x)():x,a.s(["default",0,({bookKey:a,onRegisterReset:b})=>{let c=(0,m.useTranslation)(),{envConfig:x,appService:y}=(0,i.useEnv)(),{settings:z}=(0,l.useSettingsStore)(),{getView:A,getViewSettings:B,getGridInsets:C}=(0,j.useReaderStore)(),{setViewSettings:D,recreateViewer:E}=(0,j.useReaderStore)(),{getBookData:F}=(0,k.useBookDataStore)(),G=B(a)||z.globalViewSettings,H=A(a),I=F(a),J=C(a)||{top:0,bottom:0,left:0,right:0},[K,L]=(0,e.useState)(G.paragraphMargin),[M,N]=(0,e.useState)(G.lineHeight),[O,P]=(0,e.useState)(G.wordSpacing),[Q,R]=(0,e.useState)(G.letterSpacing),[S,T]=(0,e.useState)(G.textIndent),[U,V]=(0,e.useState)(G.fullJustification),[W,X]=(0,e.useState)(G.hyphenation),[Y,Z]=(0,e.useState)(G.marginPx||G.marginTopPx),[$,_]=(0,e.useState)(G.marginBottomPx),[aa,ab]=(0,e.useState)(G.marginLeftPx),[ac,ad]=(0,e.useState)(G.marginRightPx),[ae,af]=(0,e.useState)(G.compactMarginPx||G.compactMarginTopPx),[ag,ah]=(0,e.useState)(G.compactMarginBottomPx),[ai,aj]=(0,e.useState)(G.gapPercent),[ak,al]=(0,e.useState)(G.compactMarginLeftPx),[am,an]=(0,e.useState)(G.compactMarginRightPx),[ao,ap]=(0,e.useState)(G.maxColumnCount),[aq,ar]=(0,e.useState)(G.maxInlineSize),[as,at]=(0,e.useState)(G.maxBlockSize),[au,av]=(0,e.useState)(G.writingMode),[aw,ax]=(0,e.useState)(G.overrideLayout),[ay,az]=(0,e.useState)(G.doubleBorder),[aA,aB]=(0,e.useState)(G.borderColor),[aC,aD]=(0,e.useState)(G.showHeader),[aE,aF]=(0,e.useState)(G.showFooter),[aG,aH]=(0,e.useState)(G.showBarsOnScroll),[aI,aJ]=(0,e.useState)(G.showMarginsOnScroll),[aK,aL]=(0,e.useState)(G.showRemainingTime),[aM,aN]=(0,e.useState)(G.showRemainingPages),[aO,aP]=(0,e.useState)(G.showProgressInfo),[aQ,aR]=(0,e.useState)(G.tapToToggleFooter),[aS,aT]=(0,e.useState)(G.progressStyle),[aU,aV]=(0,e.useState)(G.screenOrientation),aW=(0,n.useResetViewSettings)(),aX=()=>{aW({paragraphMargin:L,lineHeight:N,wordSpacing:P,letterSpacing:R,textIndent:T,fullJustification:V,hyphenation:X,marginTopPx:Z,marginBottomPx:_,marginLeftPx:ab,marginRightPx:ad,compactMarginTopPx:af,compactMarginBottomPx:ah,compactMarginLeftPx:al,compactMarginRightPx:an,gapPercent:aj,maxColumnCount:ap,maxInlineSize:ar,maxBlockSize:at,overrideLayout:ax,doubleBorder:az,borderColor:aB,showHeader:aD,showFooter:aF,showBarsOnScroll:aH,showRemainingTime:aL,showRemainingPages:aN,showProgressInfo:aP,tapToToggleFooter:aR,showMarginsOnScroll:aJ})};(0,e.useEffect)(()=>{b(aX)},[]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"paragraphMargin",K)},[K]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"lineHeight",M)},[M]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"wordSpacing",O)},[O]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"letterSpacing",Q)},[Q]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"textIndent",S)},[S]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"fullJustification",U)},[U]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"hyphenation",W)},[W]),(0,e.useEffect)(()=>{Y!==G.marginTopPx&&(void 0!==G.marginPx&&(0,s.saveViewSettings)(x,a,"marginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"marginTopPx",Y,!1,!1))},[Y]),(0,e.useEffect)(()=>{$!==G.marginBottomPx&&(void 0!==G.marginPx&&(0,s.saveViewSettings)(x,a,"marginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"marginBottomPx",$,!1,!1))},[$]),(0,e.useEffect)(()=>{ac!==G.marginRightPx&&(void 0!==G.marginPx&&(0,s.saveViewSettings)(x,a,"marginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"marginRightPx",ac,!1,!1))},[ac]),(0,e.useEffect)(()=>{aa!==G.marginLeftPx&&(void 0!==G.marginPx&&(0,s.saveViewSettings)(x,a,"marginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"marginLeftPx",aa,!1,!1))},[aa]),(0,e.useEffect)(()=>{ae!==G.compactMarginTopPx&&(void 0!==G.compactMarginPx&&(0,s.saveViewSettings)(x,a,"compactMarginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"compactMarginTopPx",ae,!1,!1))},[ae]),(0,e.useEffect)(()=>{ag!==G.compactMarginBottomPx&&(void 0!==G.compactMarginPx&&(0,s.saveViewSettings)(x,a,"compactMarginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"compactMarginBottomPx",ag,!1,!1))},[ag]),(0,e.useEffect)(()=>{am!==G.compactMarginRightPx&&(void 0!==G.compactMarginPx&&(0,s.saveViewSettings)(x,a,"compactMarginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"compactMarginRightPx",am,!1,!1))},[am]),(0,e.useEffect)(()=>{ak!==G.compactMarginLeftPx&&(void 0!==G.compactMarginPx&&(0,s.saveViewSettings)(x,a,"compactMarginPx",void 0,!1,!1),(0,s.saveViewSettings)(x,a,"compactMarginLeftPx",ak,!1,!1))},[ak]),(0,e.useEffect)(()=>{ai!==G.gapPercent&&((0,s.saveViewSettings)(x,a,"gapPercent",ai,!1,!1),H?.renderer.setAttribute("gap",`${ai}%`),G.scrolled&&H?.renderer.setAttribute("flow","scrolled"))},[ai]),(0,e.useEffect)(()=>{if(ao===G.maxColumnCount)return;(0,s.saveViewSettings)(x,a,"maxColumnCount",ao,!1,!1);let b=B(a);H?.renderer.setAttribute("max-column-count",ao),H?.renderer.setAttribute("max-inline-size",`${(0,q.getMaxInlineSize)(b)}px`)},[ao]),(0,e.useEffect)(()=>{if(aq===G.maxInlineSize)return;(0,s.saveViewSettings)(x,a,"maxInlineSize",aq,!1,!1);let b=B(a);H?.renderer.setAttribute("max-inline-size",`${(0,q.getMaxInlineSize)(b)}px`)},[aq]),(0,e.useEffect)(()=>{as!==G.maxBlockSize&&((0,s.saveViewSettings)(x,a,"maxBlockSize",as,!1,!1),H?.renderer.setAttribute("max-block-size",`${as}px`))},[as]),(0,e.useEffect)(()=>{if(au===G.writingMode)return;let b=G.writingMode;au.includes("vertical")?G.vertical=!0:G.vertical=!1,(0,s.saveViewSettings)(x,a,"writingMode",au,!0).then(()=>{if(H){let b=B(a);H.renderer.setStyles?.((0,p.getStyles)(b)),H.book.dir=(0,t.getBookDirFromWritingMode)(au)}b!==au&&(["horizontal-rl","vertical-rl"].includes(au)||["horizontal-rl","vertical-rl"].includes(b))&&E(x,a)})},[au]),(0,e.useEffect)(()=>{aw!==G.overrideLayout&&(0,s.saveViewSettings)(x,a,"overrideLayout",aw)},[aw]),(0,e.useEffect)(()=>{ay!==G.doubleBorder&&(0,s.saveViewSettings)(x,a,"doubleBorder",ay,!1,!1)},[ay]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"borderColor",aA,!1,!1)},[aA]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"showBarsOnScroll",aG,!1,!1)},[aG]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"showMarginsOnScroll",aI,!1,!1)},[aI]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"showRemainingTime",aK,!1,!1)},[aK]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"showRemainingPages",aM,!1,!1)},[aM]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"showProgressInfo",aO,!1,!1)},[aO]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"progressStyle",aS,!1,!1)},[aS]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"tapToToggleFooter",aQ,!1,!1)},[aQ]),(0,e.useEffect)(()=>{if(aC!==G.showHeader){if(aC&&!G.vertical){let b=Math.max(0,4*Math.round((44-J.top)/4));G.marginTopPx=Math.max(G.marginTopPx,b),Z(G.marginTopPx),D(a,G)}(0,s.saveViewSettings)(x,a,"showHeader",aC,!1,!1)}},[aC]),(0,e.useEffect)(()=>{if(aE!==G.showFooter){if(aE&&!G.vertical){let b=Math.max(0,4*Math.round((44-J.bottom)/4));G.marginBottomPx=Math.max(G.marginBottomPx,b),_(G.marginBottomPx),D(a,G)}(0,s.saveViewSettings)(x,a,"showFooter",aE,!1,!1)}},[aE]),(0,e.useEffect)(()=>{(0,s.saveViewSettings)(x,a,"screenOrientation",aU,!1,!1),y?.isMobileApp&&(0,r.lockScreenOrientation)({orientation:aU})},[aU]);let aY=(0,t.getBookLangCode)(I?.bookDoc?.metadata?.language),aZ=u.MIGHT_BE_RTL_LANGS.includes(aY)||(0,o.isCJKEnv)(),a$=G.vertical||au.includes("vertical");return(0,d.jsxs)("div",{className:"my-4 w-full space-y-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"font-medium",children:c("Override Book Layout")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aw,onChange:()=>ax(!aw)})]}),aZ&&(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"font-medium",children:c("Writing Mode")}),(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("button",{title:c("Default"),className:`btn btn-ghost btn-circle btn-sm ${"auto"===au?"btn-active bg-base-300":""}`,onClick:()=>av("auto"),children:(0,d.jsx)(f.MdOutlineAutoMode,{})}),(0,d.jsx)("button",{title:c("Horizontal Direction"),className:`btn btn-ghost btn-circle btn-sm ${"horizontal-tb"===au?"btn-active bg-base-300":""}`,onClick:()=>av("horizontal-tb"),children:(0,d.jsx)(f.MdOutlineTextRotationNone,{})}),(0,d.jsx)("button",{title:c("Vertical Direction"),className:`btn btn-ghost btn-circle btn-sm ${"vertical-rl"===au?"btn-active bg-base-300":""}`,onClick:()=>av("vertical-rl"),children:(0,d.jsx)(f.MdTextRotateVertical,{})}),(0,d.jsx)("button",{title:c("RTL Direction"),className:`btn btn-ghost btn-circle btn-sm ${"horizontal-rl"===au?"btn-active bg-base-300":""}`,onClick:()=>av("horizontal-rl"),children:(0,d.jsx)(h.TbTextDirectionRtl,{})})]})]}),G.vertical&&(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Border Frame")}),(0,d.jsx)("div",{className:"card bg-base-100 border-base-200 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Double Border")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:ay,onChange:()=>az(!ay)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Border Color")}),(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("button",{className:`btn btn-circle btn-sm bg-red-300 hover:bg-red-500 ${"red"===aA?"btn-active !bg-red-500":""}`,onClick:()=>aB("red")}),(0,d.jsx)("button",{className:`btn btn-circle btn-sm bg-black/50 hover:bg-black ${"black"===aA?"btn-active !bg-black":""}`,onClick:()=>aB("black")})]})]})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Paragraph")}),(0,d.jsx)("div",{className:"card bg-base-100 border-base-200 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsx)(w.default,{label:c("Paragraph Margin"),value:K,onChange:L,min:0,max:4,step:.1}),(0,d.jsx)(w.default,{label:c("Line Spacing"),value:M,onChange:N,min:1,max:3,step:.1}),"zh"!==aY&&(0,d.jsx)(w.default,{label:c("Word Spacing"),value:O,onChange:P,min:-4,max:8,step:.5}),(0,d.jsx)(w.default,{label:c("Letter Spacing"),value:Q,onChange:R,min:-2,max:4,step:.5}),(0,d.jsx)(w.default,{label:c("Text Indent"),value:S,onChange:T,min:-2,max:4,step:1}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Full Justification")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:U,onChange:()=>V(!U)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Hyphenation")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:W,onChange:()=>X(!W)})]})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Page")}),(0,d.jsx)("div",{className:"card bg-base-100 border-base-200 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsx)(w.default,{label:c("Top Margin (px)"),value:aC&&!a$?Y:ae,onChange:aC&&!a$?Z:af,min:aC&&!a$?Math.max(0,4*Math.round((44-J.top)/4)):0,max:88,step:4}),(0,d.jsx)(w.default,{label:c("Bottom Margin (px)"),value:aE&&!a$?$:ag,onChange:aE&&!a$?_:ah,min:aE&&!a$?Math.max(0,4*Math.round((44-J.bottom)/4)):0,max:88,step:4}),(0,d.jsx)(w.default,{label:c("Left Margin (px)"),value:aE&&a$?aa:ak,onChange:aE&&a$?ab:al,min:0,max:88,step:4}),(0,d.jsx)(w.default,{label:c("Right Margin (px)"),value:aC&&a$?ac:am,onChange:aC&&a$?ad:an,min:0,max:88,step:4}),(0,d.jsx)(w.default,{label:c("Column Gap (%)"),value:ai,onChange:aj,min:0,max:30}),(0,d.jsx)(w.default,{label:c("Maximum Number of Columns"),value:ao,onChange:ap,min:1,max:4}),(0,d.jsx)(w.default,{label:c(G.vertical?"Maximum Column Height":"Maximum Column Width"),value:aq,onChange:ar,disabled:!1,min:200,max:9999,step:50}),(0,d.jsx)(w.default,{label:c(G.vertical?"Maximum Column Width":"Maximum Column Height"),value:as,onChange:at,disabled:!1,min:400,max:9999,step:50}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Apply also in Scrolled Mode")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aI,onChange:()=>aJ(!aI)})]})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Header & Footer")}),(0,d.jsx)("div",{className:"card bg-base-100 border-base-200 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Show Header")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aC,onChange:()=>aD(!aC)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Show Footer")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aE,onChange:()=>aF(!aE)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Show Remaining Time")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aK,disabled:!aE,onChange:()=>{aK?aL(!1):(aL(!0),aN(!1))}})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Show Remaining Pages")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aM,disabled:!aE,onChange:()=>{aM?aN(!1):(aN(!0),aL(!1))}})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Show Reading Progress")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aO,disabled:!aE,onChange:()=>aP(!aO)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Reading Progress Style")}),(0,d.jsx)(v.default,{value:aS,onChange:a=>aT(a.target.value),options:[{value:"fraction",label:c("Page Number")},{value:"percentage",label:c("Percentage")}],disabled:!aO})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Tap to Toggle Footer")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aQ,disabled:!aE,onChange:()=>aR(!aQ)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Apply also in Scrolled Mode")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:aG,onChange:()=>aH(!aG)})]})]})})]}),y?.hasOrientationLock&&(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Screen")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsx)("div",{className:"divide-base-200 divide-y",children:(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Orientation")}),(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("div",{className:"lg:tooltip lg:tooltip-bottom","data-tip":c("Auto"),children:(0,d.jsx)("button",{className:`btn btn-ghost btn-circle btn-sm ${"auto"===aU?"btn-active bg-base-300":""}`,onClick:()=>aV("auto"),children:(0,d.jsx)(f.MdOutlineScreenRotation,{})})}),(0,d.jsx)("div",{className:"lg:tooltip lg:tooltip-bottom","data-tip":c("Portrait"),children:(0,d.jsx)("button",{className:`btn btn-ghost btn-circle btn-sm ${"portrait"===aU?"btn-active bg-base-300":""}`,onClick:()=>aV("portrait"),children:(0,d.jsx)(g.IoPhonePortraitOutline,{})})}),(0,d.jsx)("div",{className:"lg:tooltip lg:tooltip-bottom","data-tip":c("Landscape"),children:(0,d.jsx)("button",{className:`btn btn-ghost btn-circle btn-sm ${"landscape"===aU?"btn-active bg-base-300":""}`,onClick:()=>aV("landscape"),children:(0,d.jsx)(g.IoPhoneLandscapeOutline,{})})})]})]})})})]})]})}]),c()}catch(a){c(a)}},!1),804590,(a,b,c)=>{b.exports=a.x("react-color",()=>require("react-color"))},627799,a=>{"use strict";var b=a.i(508171),c=a.i(127669),d=a.i(804590);a.s(["default",0,({label:a,value:e,onChange:f,compact:g=!1,pickerPosition:h="left"})=>{let[i,j]=(0,c.useState)(!1),k=(0,c.useRef)(null);(0,c.useEffect)(()=>{function a(a){k.current&&!k.current.contains(a.target)&&j(!1)}return i?document.addEventListener("mousedown",a):document.removeEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[i]);let l=a=>{f(a.hex)};return g?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"text",value:e,spellCheck:!1,onChange:a=>f(a.target.value),onClick:()=>j(!i),className:"bg-base-100 text-base-content border-base-200/75 w-16 cursor-pointer rounded border px-1 py-0.5 text-center font-mono text-xs"}),i&&(0,b.jsx)("div",{ref:k,className:`absolute top-full z-50 py-1 ${"right"===h?"right-0":"center"===h?"left-1/2 -translate-x-1/2":"left-0"}`,children:(0,b.jsx)(d.SketchPicker,{width:"200px",color:e,onChange:l,disableAlpha:!0})})]}):(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("label",{className:"mb-1 block text-sm font-medium",children:a}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("button",{className:"border-base-200/75 relative mr-2 flex h-7 w-8 cursor-pointer items-center justify-center overflow-hidden rounded border",style:{backgroundColor:e},onClick:()=>j(!i)}),(0,b.jsx)("input",{type:"text",value:e,spellCheck:!1,onChange:a=>f(a.target.value),className:"bg-base-100 text-base-content border-base-200/75 min-w-4 max-w-36 flex-1 rounded border p-1 font-mono text-sm"})]}),i&&(0,b.jsx)("div",{ref:k,className:"relative z-50 mt-2",children:(0,b.jsx)("div",{className:"absolute",children:(0,b.jsx)(d.SketchPicker,{width:"100%",color:e,onChange:l,disableAlpha:!0})})})]})}])},582684,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(915302),g=a.i(907105),h=a.i(654617),i=a.i(866736),j=a.i(76868),k=a.i(627799),l=b([i,j]);[i,j]=l.then?(await l)():l;let m=({textColor:a,backgroundColor:b,primaryColor:c,label:e})=>{let g=(0,f.useTranslation)();return(0,d.jsxs)("div",{className:"mb-2 mt-4",children:[(0,d.jsx)("label",{className:"mb-1 block text-sm font-medium",children:e}),(0,d.jsx)("div",{className:"border-base-300 overflow-hidden rounded border p-2",style:{backgroundColor:b,color:a},children:(0,d.jsxs)("p",{className:"mb-2 whitespace-pre-line text-xs",children:[g("All the world's a stage,\nAnd all the men and women merely players;\nThey have their exits and their entrances,\nAnd one man in his time plays many parts,\nHis acts being seven ages.\n\n William Shakespeare"),"\n\n",(0,d.jsx)("span",{className:"mt-4 cursor-pointer italic",style:{color:c},children:g("(from 'As You Like It', Act II)")})]})})]})};a.s(["default",0,({customTheme:a,onSave:b,onDelete:c,onCancel:l})=>{let n=(0,f.useTranslation)(),{settings:o}=(0,i.useSettingsStore)(),[p]=(0,e.useState)(()=>h.CUSTOM_THEME_TEMPLATES[Math.floor(Math.random()*h.CUSTOM_THEME_TEMPLATES.length)]),[q,r]=(0,e.useState)(a?.colors.light.fg||p.light.fg),[s,t]=(0,e.useState)(a?.colors.light.bg||p.light.bg),[u,v]=(0,e.useState)(a?.colors.light.primary||p.light.primary),[w,x]=(0,e.useState)(a?.colors.dark.fg||p.dark.fg),[y,z]=(0,e.useState)(a?.colors.dark.bg||p.dark.bg),[A,B]=(0,e.useState)(a?.colors.dark.primary||p.dark.primary),[C,D]=(0,e.useState)(a?.label||n("Custom")),E=()=>({name:(0,g.md5Fingerprint)(C),label:C,colors:{light:{fg:q,bg:s,primary:u},dark:{fg:w,bg:y,primary:A}}});return(0,d.jsxs)("div",{className:"mt-6 rounded-lg",children:[(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,d.jsx)("label",{className:"font-medium",children:n("Custom Theme")}),(0,d.jsxs)("div",{className:"flex w-[calc(50%-12px)] justify-between",children:[(0,d.jsx)("button",{className:"btn btn-ghost btn-sm text-base-content px-2",onClick:()=>b(E()),children:n("Save")}),o.globalReadSettings.customThemes.find(a=>a.name===(0,g.md5Fingerprint)(C))&&(0,d.jsx)("button",{className:(0,j.default)("btn btn-ghost btn-sm px-2"),onClick:()=>c(E()),children:n("Delete")}),(0,d.jsx)("button",{className:"btn btn-ghost btn-sm px-2",onClick:l,children:n("Cancel")})]})]}),(0,d.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,d.jsx)("label",{className:"font-medium",children:n("Theme Name")}),(0,d.jsx)("input",{type:"text",value:C,onChange:a=>D(a.target.value),className:"bg-base-100 text-base-content border-base-200 w-[calc(50%-12px)] rounded border p-2 text-sm"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{className:"bg-base-200 rounded-lg p-3",children:[(0,d.jsx)("h3",{className:"mb-3 text-center font-medium",children:n("Light Mode")}),(0,d.jsx)(k.default,{label:n("Text Color"),value:q,onChange:r}),(0,d.jsx)(k.default,{label:n("Background Color"),value:s,onChange:t}),(0,d.jsx)(k.default,{label:n("Link Color"),value:u,onChange:v}),(0,d.jsx)(m,{textColor:q,backgroundColor:s,primaryColor:u,label:n("Preview")})]}),(0,d.jsxs)("div",{className:"bg-base-300 rounded-lg p-3",children:[(0,d.jsx)("h3",{className:"mb-3 text-center font-medium",children:n("Dark Mode")}),(0,d.jsx)(k.default,{label:n("Text Color"),value:w,onChange:x}),(0,d.jsx)(k.default,{label:n("Background Color"),value:y,onChange:z}),(0,d.jsx)(k.default,{label:n("Link Color"),value:A,onChange:B}),(0,d.jsx)(m,{textColor:w,backgroundColor:y,primaryColor:A,label:n("Preview")})]})]})]})}]),c()}catch(a){c(a)}},!1),574507,a=>{"use strict";var b=a.i(508171),c=a.i(547274),d=a.i(564645),e=a.i(915302);a.s(["default",0,({themeMode:a,onThemeModeChange:f})=>{let g=(0,e.useTranslation)();return(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"font-medium",children:g("Theme Mode")}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("button",{title:g("Auto Mode"),className:`btn btn-ghost btn-circle btn-sm ${"auto"===a?"btn-active bg-base-300":""}`,onClick:()=>f("auto"),children:(0,b.jsx)(d.TbSunMoon,{})}),(0,b.jsx)("button",{title:g("Light Mode"),className:`btn btn-ghost btn-circle btn-sm ${"light"===a?"btn-active bg-base-300":""}`,onClick:()=>f("light"),children:(0,b.jsx)(c.MdOutlineLightMode,{})}),(0,b.jsx)("button",{title:g("Dark Mode"),className:`btn btn-ghost btn-circle btn-sm ${"dark"===a?"btn-active bg-base-300":""}`,onClick:()=>f("dark"),children:(0,b.jsx)(c.MdOutlineDarkMode,{})})]})]})}])},636485,a=>{"use strict";var b=a.i(508171),c=a.i(591509);function d(a){return(0,c.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M20.3847 2.87868C19.2132 1.70711 17.3137 1.70711 16.1421 2.87868L14.0202 5.00052L13.313 4.29332C12.9225 3.9028 12.2894 3.9028 11.8988 4.29332C11.5083 4.68385 11.5083 5.31701 11.8988 5.70754L17.5557 11.3644C17.9462 11.7549 18.5794 11.7549 18.9699 11.3644C19.3604 10.9739 19.3604 10.3407 18.9699 9.95018L18.2629 9.24316L20.3847 7.12132C21.5563 5.94975 21.5563 4.05025 20.3847 2.87868Z",fill:"currentColor"},child:[]},{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M11.9297 7.09116L4.1515 14.8693C3.22786 15.793 3.03239 17.169 3.5651 18.2842L1.99994 19.8493L3.41415 21.2635L4.97931 19.6984C6.09444 20.2311 7.4705 20.0356 8.39414 19.112L16.1723 11.3338L11.9297 7.09116ZM13.3439 11.3338L11.9297 9.91959L5.56571 16.2835C5.17518 16.6741 5.17518 17.3072 5.56571 17.6978C5.95623 18.0883 6.5894 18.0883 6.97992 17.6978L13.3439 11.3338Z",fill:"currentColor"},child:[]}]})(a)}var e=a.i(547274),f=a.i(394317),g=a.i(915302),h=a.i(106865);a.s(["default",0,({themes:a,themeColor:c,isDarkMode:i,onThemeColorChange:j,onEditTheme:k,onCreateTheme:l})=>{let m=(0,g.useTranslation)(),n=(0,h.useResponsiveSize)(16),o=(0,h.useResponsiveSize)(24);return(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"mb-2 font-medium",children:m("Theme Color")}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[a.map(({name:a,label:f,colors:g,isCustomizale:h})=>(0,b.jsxs)("button",{tabIndex:0,onClick:()=>j(a),onKeyDown:b=>{("Enter"===b.key||" "===b.key)&&j(a),b.stopPropagation()},className:`relative flex cursor-pointer flex-col items-center justify-center rounded-lg px-2 py-4 shadow-md ${c===a?"ring-2 ring-indigo-500 ring-offset-2":""}`,style:{backgroundColor:i?g.dark["base-100"]:g.light["base-100"],color:i?g.dark["base-content"]:g.light["base-content"]},children:[(0,b.jsx)("input",{"aria-label":m(f),type:"radio",name:"theme",value:a,checked:c===a,onChange:()=>j(a),className:"hidden"}),c===a?(0,b.jsx)(e.MdRadioButtonChecked,{size:o}):(0,b.jsx)(e.MdRadioButtonUnchecked,{size:o}),(0,b.jsx)("span",{className:"max-w-full truncate",children:m(f)}),h&&c===a&&(0,b.jsx)("button",{onClick:()=>k(a),children:(0,b.jsx)(d,{size:n,className:"absolute right-2 top-2"})})]},a)),(0,b.jsxs)("button",{className:"relative flex cursor-pointer flex-col items-center justify-center rounded-lg border border-dashed px-2 py-4 shadow-md",onClick:l,children:[(0,b.jsx)(f.PiPlus,{size:o}),(0,b.jsx)("span",{className:"max-w-full truncate",children:m("Custom")})]})]})]})}],636485)},949892,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(547274),f=a.i(915302),g=a.i(106865),h=a.i(986872),i=b([h]);[h]=i.then?(await i)():i,a.s(["default",0,({predefinedTextures:a,customTextures:b,selectedTextureId:c,backgroundOpacity:i,backgroundSize:j,onTextureSelect:k,onOpacityChange:l,onSizeChange:m,onImportImage:n,onDeleteTexture:o})=>{let p=(0,f.useTranslation)(),q=(0,g.useResponsiveSize)(24),r=[...a,...b];return(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:p("Background Image")}),(0,d.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[r.map(b=>(0,d.jsxs)("button",{onClick:()=>k(b.id),className:`bg-base-100 relative flex flex-col items-center justify-center rounded-lg border-2 p-4 shadow-md transition-all ${c===b.id?"ring-2 ring-indigo-500 ring-offset-2":"border-base-300"}`,style:{backgroundImage:b.loaded?`url("${b.blobUrl||b.url}")`:"none",backgroundSize:"cover",backgroundPosition:"top",minHeight:"80px"},children:[c===b.id&&(0,d.jsx)(e.MdRadioButtonChecked,{size:q,className:"absolute right-2 top-2 rounded-full bg-white text-indigo-500"}),!a.find(a=>a.id===b.id)&&(0,d.jsx)("button",{onClick:a=>{a.stopPropagation(),o(b.id)},className:"absolute left-2 top-2 rounded-full bg-red-500 p-1 text-white transition-colors hover:bg-red-600",title:p("Delete"),children:(0,d.jsx)(e.MdClose,{size:16})})]},b.id)),(0,d.jsx)("div",{className:"border-base-300 relative flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed p-4 shadow-md transition-all",style:{minHeight:"80px"},children:(0,d.jsx)("button",{className:"card-body flex cursor-pointer items-center justify-center p-2 text-center",onClick:n,children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"flex items-center justify-center",children:(0,d.jsx)(e.MdAdd,{className:"text-primary/85 group-hover:text-primary h-6 w-6"})}),(0,d.jsx)("div",{className:"text-primary/85 group-hover:text-primary line-clamp-1 font-medium",children:p("Import Image")})]})})})]}),"none"!==c&&(0,d.jsxs)("div",{className:"card border-base-200 bg-base-100 space-y-4 border p-4 shadow",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:p("Opacity")}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",value:i,onChange:a=>l(parseFloat(a.target.value)),className:"range range-sm w-32"}),(0,d.jsxs)("span",{className:"w-12 text-right text-sm",children:[Math.round(100*i),"%"]})]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:p("Size")}),(0,d.jsx)(h.default,{value:j,onChange:a=>m(a.target.value),options:[{value:"auto",label:p("Auto")},{value:"cover",label:p("Cover")},{value:"contain",label:p("Contain")}]})]})]})]})}]),c()}catch(a){c(a)}},!1),923943,a=>{"use strict";var b=a.i(508171),c=a.i(915302),d=a.i(627799);a.s(["default",0,({customHighlightColors:a,onChange:e})=>{let f=(0,c.useTranslation)();return(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"mb-2 font-medium",children:f("Highlight Colors")}),(0,b.jsx)("div",{className:"card border-base-200 bg-base-100 overflow-visible border p-4 shadow",children:(0,b.jsx)("div",{className:"grid grid-cols-3 gap-3 sm:grid-cols-5",children:["red","violet","blue","green","yellow"].map((c,f,g)=>{let h=0===f?"left":f===g.length-1?"right":"center";return(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)("div",{className:"border-base-300 h-8 w-8 rounded-full border-2 shadow-sm",style:{backgroundColor:a[c]}}),(0,b.jsx)(d.default,{label:"",value:a[c],compact:!0,pickerPosition:h,onChange:b=>{e({...a,[c]:b})}})]},c)})})})]})}])},861529,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(547274),f=a.i(915302),g=a.i(986872),h=a.i(627799),i=b([g]);[g]=i.then?(await i)():i,a.s(["default",0,({style:a,color:b,customColors:c,onStyleChange:i,onColorChange:j,onCustomColorsChange:k})=>{let l=(0,f.useTranslation)(),m=[{color:"#FFD700",label:"Gold"},{color:"#00CED1",label:"Cyan"},{color:"#FF69B4",label:"Pink"},{color:"#90EE90",label:"Green"},{color:"#FFA500",label:"Orange"}];return(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:l("TTS Highlighting")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border p-4 shadow",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:l("Style")}),(0,d.jsx)(g.default,{value:a,onChange:a=>i(a.target.value),options:[{value:"highlight",label:l("Highlighter")},{value:"underline",label:l("Underline")},{value:"strikethrough",label:l("Strikethrough")},{value:"squiggly",label:l("Squiggly")},{value:"outline",label:l("Outline")}]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:l("Color")}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"border-base-300 pointer-events-none h-8 w-8 cursor-pointer rounded-full border-2 shadow-sm",style:{backgroundColor:b}}),(0,d.jsx)(h.default,{label:"",value:b,compact:!0,pickerPosition:"center",onChange:j}),(0,d.jsx)("button",{onClick:()=>{if(!c.includes(b)&&!m.some(a=>a.color===b)){let a=[...c,b];k(a)}},disabled:c.includes(b)||m.some(a=>a.color===b),className:"btn btn-ghost btn-sm gap-1 bg-transparent disabled:bg-transparent",title:l("Save Current Color"),children:(0,d.jsx)("span",{className:"text-xs",children:l("Save")})})]})]}),(0,d.jsxs)("div",{className:"border-base-200 flex justify-between border-t pt-4",children:[(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsx)("span",{className:"text-sm font-medium",children:l("Quick Colors")})}),(0,d.jsxs)("div",{className:"flex max-w-[70%] flex-wrap justify-end gap-2",children:[m.map(({color:a})=>(0,d.jsx)("button",{onClick:()=>j(a),className:`h-8 w-8 rounded-full border-2 transition-all hover:scale-110 ${b===a?"ring-2 ring-indigo-500 ring-offset-2":"border-base-300"}`,style:{backgroundColor:a}},a)),c.map(a=>(0,d.jsxs)("div",{className:"group relative",children:[(0,d.jsx)("button",{onClick:()=>j(a),className:`h-8 w-8 rounded-full border-2 transition-all hover:scale-110 ${b===a?"ring-2 ring-indigo-500 ring-offset-2":"border-base-300"}`,style:{backgroundColor:a}}),(0,d.jsx)("button",{onClick:()=>{let b;return b=c.filter(b=>b!==a),void k(b)},className:"absolute -right-1 -top-1 rounded-full bg-red-500 p-0.5 text-white opacity-0 transition-opacity hover:opacity-100 group-hover:opacity-100",title:l("Delete"),children:(0,d.jsx)(e.MdClose,{size:12})})]},a))]})]})]})})]})}]),c()}catch(a){c(a)}},!1),85299,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(663048),f=a.i(915302),g=a.i(986872),h=b([g]);[g]=h.then?(await h)():h,a.s(["default",0,({codeHighlighting:a,codeLanguage:b,onToggle:c,onLanguageChange:h})=>{let i=(0,f.useTranslation)();return(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:i("Code Highlighting")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{children:i("Enable Highlighting")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:a,onChange:()=>c(!a)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{children:i("Code Language")}),(0,d.jsx)(g.default,{value:b,onChange:a=>h(a.target.value),options:e.CODE_LANGUAGES.map(a=>({value:a,label:"auto-detect"===a?i("Auto"):a})),disabled:!a})]})]})})]})}]),c()}catch(a){c(a)}},!1),158821,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(713551),g=a.i(178552),h=a.i(162650),i=a.i(466759),j=a.i(915302),k=a.i(866736),l=a.i(51926),m=a.i(170427),n=a.i(937944),o=a.i(663048),p=a.i(495697),q=a.i(265150),r=a.i(654617),s=a.i(582684),t=a.i(574507),u=a.i(636485),v=a.i(949892),w=a.i(923943),x=a.i(861529),y=a.i(85299),z=b([f,h,i,k,m,n,s,v,x,y]);[f,h,i,k,m,n,s,v,x,y]=z.then?(await z)():z,a.s(["default",0,({bookKey:a,onRegisterReset:b})=>{let c=(0,j.useTranslation)(),{themeMode:z,themeColor:A,isDarkMode:B,setThemeMode:C,setThemeColor:D,saveCustomTheme:E}=(0,h.useThemeStore)(),{envConfig:F,appService:G}=(0,g.useEnv)(),{settings:H,setSettings:I,saveSettings:J}=(0,k.useSettingsStore)(),{getView:K,getViewSettings:L}=(0,i.useReaderStore)(),M=L(a)||H.globalViewSettings,[N,O]=(0,e.useState)(M.invertImgColorInDark),[P,Q]=(0,e.useState)(null),[R,S]=(0,e.useState)([]),[T,U]=(0,e.useState)(!1),[V,W]=(0,e.useState)(M.overrideColor),[X,Y]=(0,e.useState)(M.codeHighlighting),[Z,$]=(0,e.useState)(M.codeLanguage),[_,aa]=(0,e.useState)(M.backgroundTextureId),[ab,ac]=(0,e.useState)(M.backgroundOpacity),[ad,ae]=(0,e.useState)(M.backgroundSize),[af,ag]=(0,e.useState)(M.ttsHighlightOptions.style),[ah,ai]=(0,e.useState)(M.ttsHighlightOptions.color),[aj,ak]=(0,e.useState)(H.globalReadSettings.customHighlightColors),[al,am]=(0,e.useState)(H.globalReadSettings.customTtsHighlightColors||[]),{textures:an,addTexture:ao,loadTexture:ap,applyTexture:aq,removeTexture:ar,loadCustomTextures:as,saveCustomTextures:at}=(0,m.useCustomTextureStore)(),au=(0,l.useResetViewSettings)(),{selectFiles:av}=(0,p.useFileSelector)(G,c),aw=()=>{au({overrideColor:W,invertImgColorInDark:O,codeHighlighting:Y,codeLanguage:$}),D("default"),C("auto"),aa("none"),ac(.6),ae("cover"),ak(r.HIGHLIGHT_COLOR_HEX)};(0,e.useEffect)(()=>{b(aw)},[]),(0,e.useEffect)(()=>{as(F)},[as,F]),(0,e.useEffect)(()=>{N!==M.invertImgColorInDark&&(0,n.saveViewSettings)(F,a,"invertImgColorInDark",N)},[N]),(0,e.useEffect)(()=>{V!==M.overrideColor&&(0,n.saveViewSettings)(F,a,"overrideColor",V)},[V]),(0,e.useEffect)(()=>{let b=!1;if(X!==M.codeHighlighting&&((0,n.saveViewSettings)(F,a,"codeHighlighting",X),b=!0),Z!==M.codeLanguage&&((0,n.saveViewSettings)(F,a,"codeLanguage",Z),b=!0),!b)return;let c=K(a);c&&c.renderer.getContents().forEach(({doc:a})=>(0,o.manageSyntaxHighlighting)(a,M))},[X,Z]),(0,e.useEffect)(()=>{_!==M.backgroundTextureId&&((0,n.saveViewSettings)(F,a,"backgroundTextureId",_),ax())},[_]),(0,e.useEffect)(()=>{ab!==M.backgroundOpacity&&((0,n.saveViewSettings)(F,a,"backgroundOpacity",ab),ax())},[ab]),(0,e.useEffect)(()=>{ad!==M.backgroundSize&&((0,n.saveViewSettings)(F,a,"backgroundSize",ad),ax())},[ad]);let ax=()=>{aq(F,_),document.documentElement.style.setProperty("--bg-texture-opacity",`${ab}`),document.documentElement.style.setProperty("--bg-texture-size",ad)};return(0,e.useEffect)(()=>{let a=H.globalReadSettings.customThemes??[];S(a.map(a=>({name:a.name,label:a.label,colors:{light:(0,f.generateLightPalette)(a.colors.light),dark:(0,f.generateDarkPalette)(a.colors.dark)},isCustomizale:!0})))},[H]),(0,d.jsx)("div",{className:"my-4 w-full space-y-6",children:T?(0,d.jsx)(s.default,{customTheme:P,onSave:a=>{(0,f.applyCustomTheme)(a),E(F,H,a),I({...H}),D(a.name),U(!1)},onDelete:a=>{E(F,H,a,!0),I({...H}),D("default"),U(!1)},onCancel:()=>U(!1)}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.default,{themeMode:z,onThemeModeChange:C}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"font-medium",children:c("Invert Image In Dark Mode")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:N,disabled:!B,onChange:()=>O(!N)})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"font-medium",children:c("Override Book Color")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:V,onChange:()=>W(!V)})]}),(0,d.jsx)(u.default,{themes:f.themes.concat(R),themeColor:A,isDarkMode:B,onThemeColorChange:D,onEditTheme:a=>{let b=H.globalReadSettings.customThemes.find(b=>b.name===a);b&&(Q(b),U(!0))},onCreateTheme:()=>U(!0)}),(0,d.jsx)(v.default,{predefinedTextures:q.PREDEFINED_TEXTURES,customTextures:an.filter(a=>!a.deletedAt),selectedTextureId:_,backgroundOpacity:ab,backgroundSize:ad,onTextureSelect:aa,onOpacityChange:ac,onSizeChange:ae,onImportImage:()=>{av({type:"images",multiple:!0}).then(async a=>{if(!a.error&&0!==a.files.length){for(let b of a.files){let a=await G?.importImage(b.path||b.file);if(!a)continue;let c=ao(a.path);console.log("Added custom texture:",c),c&&!c.error&&await ap(F,c.id)}at(F)}})},onDeleteTexture:a=>{ar(a),H.customTextures=an.filter(b=>b.id!==a),I(H),_===a&&aa("none"),at(F)}}),(0,d.jsx)(w.default,{customHighlightColors:aj,onChange:a=>{ak(a),H.globalReadSettings.customHighlightColors=a,I(H),J(F,H)}}),(0,d.jsx)(x.default,{style:af,color:ah,customColors:al,onStyleChange:b=>{ag(b),(0,n.saveViewSettings)(F,a,"ttsHighlightOptions",{style:b,color:ah})},onColorChange:b=>{ai(b),(0,n.saveViewSettings)(F,a,"ttsHighlightOptions",{style:af,color:b})},onCustomColorsChange:a=>{am(a),H.globalReadSettings.customTtsHighlightColors=a,I(H),J(F,H)}}),(0,d.jsx)(y.default,{codeHighlighting:X,codeLanguage:Z,onToggle:Y,onLanguageChange:$})]})})}]),c()}catch(a){c(a)}},!1),606144,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(547274),g=a.i(178552),h=a.i(866736),i=a.i(915302),j=a.i(505244),k=a.i(106865),l=a.i(937065),m=b([e,h,j,l]);[e,h,j,l]=m.then?(await m)():m,a.s(["default",0,({activePanel:a,setIsDropdownOpen:b,onReset:c,resetLabel:m})=>{let n=(0,i.useTranslation)(),{envConfig:o,appService:p}=(0,g.useEnv)(),q=(0,k.useResponsiveSize)(16),{setFontPanelView:r,isSettingsGlobal:s,setSettingsGlobal:t}=(0,h.useSettingsStore)(),{getAllFonts:u,removeFont:v,saveCustomFonts:w}=(0,j.useCustomFontStore)();return(0,d.jsxs)("div",{className:(0,e.default)("dropdown-content dropdown-right no-triangle border-base-200 z-20 mt-1 border shadow-2xl","text-base sm:text-sm"),children:[(0,d.jsx)(l.default,{label:n("Global Settings"),tooltip:n(s?"Apply to All Books":"Apply to This Book"),buttonClass:"lg:tooltip",Icon:s?(0,d.jsx)(f.MdCheck,{size:q,className:"text-base-content"}):null,onClick:()=>{t(!s),b?.(!1)}}),(0,d.jsx)(l.default,{label:m||n("Reset Settings"),onClick:()=>{c(),b?.(!1)}}),"Font"===a&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.default,{label:n("Clear Custom Fonts"),onClick:()=>{u().forEach(a=>{v(a.id)&&p.deleteFont(a)}),w(o),b?.(!1)}}),(0,d.jsx)(l.default,{label:n("Manage Custom Fonts"),onClick:()=>{r("custom-fonts"),b?.(!1)}})]})]})}]),c()}catch(a){c(a)}},!1),480217,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(178552),g=a.i(466759),h=a.i(108328),i=a.i(915302),j=a.i(862871),k=a.i(866736),l=a.i(51926),m=a.i(428956),n=a.i(173947),o=a.i(714617),p=a.i(937944),q=a.i(258312),r=a.i(180018),s=a.i(986872),t=b([g,h,j,k,m,n,p,r,s]);[g,h,j,k,m,n,p,r,s]=t.then?(await t)():t,a.s(["default",0,({bookKey:a,onRegisterReset:b})=>{let c=(0,i.useTranslation)(),{envConfig:t,appService:u}=(0,f.useEnv)(),{getView:v,getViewSettings:w,recreateViewer:x}=(0,g.useReaderStore)(),{getBookData:y}=(0,j.useBookDataStore)(),{settings:z}=(0,k.useSettingsStore)(),{applyEinkMode:A}=(0,m.useEinkMode)(),{acquireVolumeKeyInterception:B,releaseVolumeKeyInterception:C}=(0,h.useDeviceControlStore)(),D=y(a),E=w(a)||z.globalViewSettings,[F,G]=(0,e.useState)(E.scrolled),[H,I]=(0,e.useState)(E.continuousScroll),[J,K]=(0,e.useState)(E.scrollingOverlap),[L,M]=(0,e.useState)(E.volumeKeysToFlip),[N,O]=(0,e.useState)(E.disableClick),[P,Q]=(0,e.useState)(E.fullscreenClickArea),[R,S]=(0,e.useState)(E.swapClickArea),[T,U]=(0,e.useState)(E.disableDoubleClick),[V,W]=(0,e.useState)(E.enableAnnotationQuickActions),[X,Y]=(0,e.useState)(E.annotationQuickAction),[Z,$]=(0,e.useState)(E.copyToNotebook),[_,aa]=(0,e.useState)(E.animated),[ab,ac]=(0,e.useState)(E.isEink),[ad,ae]=(0,e.useState)(z.autoScreenBrightness),[af,ag]=(0,e.useState)(E.allowScript),ah=(0,l.useResetViewSettings)(),ai=()=>{ah({scrolled:G,continuousScroll:I,scrollingOverlap:K,volumeKeysToFlip:M,disableClick:O,swapClickArea:S,animated:aa,isEink:ac,allowScript:ag,fullscreenClickArea:Q,disableDoubleClick:U,enableAnnotationQuickActions:W,copyToNotebook:$})};return(0,e.useEffect)(()=>{b(ai)},[]),(0,e.useEffect)(()=>{F!==E.scrolled&&((0,p.saveViewSettings)(t,a,"scrolled",F),v(a)?.renderer.setAttribute("flow",F?"scrolled":"paginated"),v(a)?.renderer.setAttribute("max-inline-size",`${(0,o.getMaxInlineSize)(E)}px`),v(a)?.renderer.setStyles?.((0,n.getStyles)(E)))},[F]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"continuousScroll",H,!1,!1)},[H]),(0,e.useEffect)(()=>{J!==E.scrollingOverlap&&(0,p.saveViewSettings)(t,a,"scrollingOverlap",J,!1,!1)},[J]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"volumeKeysToFlip",L,!1,!1),u?.isMobileApp&&(L?B():C())},[L]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"disableClick",N,!1,!1)},[N]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"disableDoubleClick",T,!1,!1)},[T]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"fullscreenClickArea",P,!1,!1)},[P]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"swapClickArea",R,!1,!1)},[R]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"animated",_,!1,!1),_?v(a)?.renderer.setAttribute("animated",""):v(a)?.renderer.removeAttribute("animated")},[_]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"isEink",ab),ab?v(a)?.renderer.setAttribute("eink",""):v(a)?.renderer.removeAttribute("eink"),A(ab)},[ab]),(0,e.useEffect)(()=>{ad!==z.autoScreenBrightness&&(0,p.saveSysSettings)(t,"autoScreenBrightness",ad)},[ad]),(0,e.useEffect)(()=>{E.allowScript!==af&&(0,p.saveViewSettings)(t,a,"allowScript",af,!0,!1).then(()=>{x(t,a)})},[af]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"enableAnnotationQuickActions",V,!1,!1)},[V]),(0,e.useEffect)(()=>{(0,p.saveViewSettings)(t,a,"copyToNotebook",Z,!1,!1)},[Z]),(0,d.jsxs)("div",{className:"my-4 w-full space-y-6",children:[(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Scroll")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Scrolled Mode")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:F,disabled:D?.isFixedLayout,onChange:()=>G(!F)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Continuous Scroll")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:H,disabled:D?.isFixedLayout,onChange:()=>I(!H)})]}),(0,d.jsx)(r.default,{label:c("Overlap Pixels"),value:J,onChange:K,disabled:!E.scrolled,min:0,max:200,step:10})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Pagination")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:u?.isMobileApp?c("Tap to Paginate"):c("Click to Paginate")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:!N,onChange:()=>O(!N)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:u?.isMobileApp?c("Tap Both Sides"):c("Click Both Sides")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:P,disabled:N,onChange:()=>Q(!P)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:u?.isMobileApp?c("Swap Tap Sides"):c("Swap Click Sides")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:R,disabled:N||P,onChange:()=>S(!R)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:u?.isMobileApp?c("Disable Double Tap"):c("Disable Double Click")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:T,onChange:()=>U(!T)})]}),u?.isMobileApp&&(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Volume Keys for Page Flip")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:L,onChange:()=>M(!L)})]})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Annotation Tools")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Enable Quick Actions")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:V,onChange:()=>W(!V)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Quick Action")}),(0,d.jsx)(s.default,{value:X||"",onChange:b=>{let c=b.target.value;Y(c),(0,p.saveViewSettings)(t,a,"annotationQuickAction",c,!1,!0)},options:[{value:"",label:c("None")},...q.annotationToolQuickActions.map(a=>({value:a.type,label:c(a.label)}))],disabled:!V})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Copy to Notebook")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:Z,onChange:()=>$(!Z)})]})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Animation")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsx)("div",{className:"divide-base-200 divide-y",children:(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Paging Animation")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:_,onChange:()=>aa(!_)})]})})})]}),(u?.isMobileApp||u?.appPlatform==="web")&&(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Device")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200 divide-y",children:[(u?.isAndroidApp||u?.appPlatform==="web")&&(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("E-Ink Mode")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:ab,onChange:()=>ac(!ab)})]}),u?.isMobileApp&&(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:c("Auto Screen Brightness")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:ad,onChange:()=>ae(!ad)})]})]})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:c("Security")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsx)("div",{className:"divide-base-200 divide-y",children:(0,d.jsxs)("div",{className:"config-item !h-16",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,d.jsx)("span",{className:"",children:c("Allow JavaScript")}),(0,d.jsx)("span",{className:"text-xs",children:c("Enable only if you trust the file.")})]}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:af,disabled:D?.book?.format!=="EPUB",onChange:()=>ag(!af)})]})})})]})]})}]),c()}catch(a){c(a)}},!1),872495,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(77946),i=a.i(466759),j=a.i(915302),k=a.i(866736),l=a.i(937944),m=a.i(81402),n=a.i(947334),o=a.i(51926),p=a.i(654617),q=a.i(465863),r=a.i(986872),s=b([e,i,k,l,m,n,r]);[e,i,k,l,m,n,r]=s.then?(await s)():s,a.s(["default",0,({bookKey:a,onRegisterReset:b})=>{let c,m,s,t,u,v,w=(0,j.useTranslation)(),{token:x}=(0,h.useAuth)(),{envConfig:y}=(0,g.useEnv)(),{settings:z,applyUILanguage:A}=(0,k.useSettingsStore)(),{getView:B,getViewSettings:C,setViewSettings:D,recreateViewer:E}=(0,i.useReaderStore)(),F=B(a),G=C(a)||z.globalViewSettings,[H,I]=(0,f.useState)(G.uiLanguage),[J,K]=(0,f.useState)(G.translationEnabled),[L,M]=(0,f.useState)(G.translationProvider),[N,O]=(0,f.useState)(G.translateTargetLang),[P,Q]=(0,f.useState)(G.showTranslateSource),[R,S]=(0,f.useState)(G.ttsReadAloudText),[T,U]=(0,f.useState)(G.replaceQuotationMarks),[V,W]=(0,f.useState)(G.convertChineseVariant),X=(0,o.useResetViewSettings)(),Y=()=>{X({uiLanguage:I,translationEnabled:K,translationProvider:M,translateTargetLang:O,showTranslateSource:Q,ttsReadAloudText:S,replaceQuotationMarks:U})};(0,f.useEffect)(()=>{b(Y)},[]);let Z=a=>{let b=Object.entries(a).map(([a,b])=>({value:a,label:b}));return b.sort((a,b)=>a.label.localeCompare(b.label)),b.unshift({value:"",label:w("System Language")}),b},$=()=>(0,n.getTranslators)().map(a=>{let b=a.label;return a.authRequired&&!x?b=`${b} (${w("Login Required")})`:a.quotaExceeded&&(b=`${b} (${w("Quota Exceeded")})`),{value:a.name,label:b}});(0,f.useEffect)(()=>{H!==G.uiLanguage&&((0,l.saveViewSettings)(y,a,"uiLanguage",H,!1,!1),A(H))},[H]),(0,f.useEffect)(()=>{J!==G.translationEnabled&&(0,l.saveViewSettings)(y,a,"translationEnabled",J,!0,!1).then(()=>{!P&&J&&E(y,a)})},[J]),(0,f.useEffect)(()=>{P!==G.showTranslateSource&&(0,l.saveViewSettings)(y,a,"showTranslateSource",P,!1,!1).then(()=>{E(y,a)})},[P]),(0,f.useEffect)(()=>{R!==G.ttsReadAloudText&&(0,l.saveViewSettings)(y,a,"ttsReadAloudText",R,!1,!1)},[R]),(0,f.useEffect)(()=>{T!==G.replaceQuotationMarks&&(0,l.saveViewSettings)(y,a,"replaceQuotationMarks",T,!1,!1).then(()=>{E(y,a)})},[T]);let _=()=>[{value:"none",label:w("No Conversion")},{value:"s2t",label:w("Simplified to Traditional")},{value:"t2s",label:w("Traditional to Simplified")},{value:"s2tw",label:w("Simplified to Traditional (Taiwan)")},{value:"s2hk",label:w("Simplified to Traditional (Hong Kong)")},{value:"s2twp",label:w("Simplified to Traditional (Taiwan), with phrases")},{value:"tw2s",label:w("Traditional (Taiwan) to Simplified")},{value:"hk2s",label:w("Traditional (Hong Kong) to Simplified")},{value:"tw2sp",label:w("Traditional (Taiwan) to Simplified, with phrases")}];return(0,f.useEffect)(()=>{V!==G.convertChineseVariant&&(0,l.saveViewSettings)(y,a,"convertChineseVariant",V,!1,!1).then(()=>{E(y,a)})},[V]),(0,d.jsxs)("div",{className:(0,e.default)("my-4 w-full space-y-6"),children:[(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:w("Language")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsx)("div",{className:"divide-base-200 divide-y",children:(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:w("Interface Language")}),(0,d.jsx)(r.default,{value:{value:c=G.uiLanguage,label:""===c?w("Auto"):p.TRANSLATED_LANGS[c]}.value,onChange:a=>{let b=a.target.value;I(b)},options:Z(p.TRANSLATED_LANGS)})]})})})]}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:w("Translation")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsxs)("div",{className:"divide-base-200",children:[(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:w("Enable Translation")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:J,onChange:()=>K(!J),disabled:!a})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:w("Show Source Text")}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:P,onChange:()=>Q(!P)})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:w("TTS Text")}),(0,d.jsx)(r.default,{value:R,onChange:b=>{let c=b.target.value;S(c),(0,l.saveViewSettings)(y,a,"ttsReadAloudText",c,!1,!1)},options:[{value:"both",label:w("Source and Translated")},{value:"translated",label:w("Translated Only")},{value:"source",label:w("Source Only")}]})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:w("Translation Service")}),(0,d.jsx)(r.default,{value:(m=$(),t=(s=(0,n.getTranslators)().filter(a=>(!a.authRequired||!!x)&&!a.quotaExceeded)).find(a=>a.name===L)?L:s[0]?.name,m.find(a=>a.value===t)||m[0]).value,onChange:b=>{let c=b.target.value;M(c),(0,l.saveViewSettings)(y,a,"translationProvider",c,!1,!1),G.translationProvider=c,D(a,{...G})},options:$()})]}),(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:w("Translate To")}),(0,d.jsx)(r.default,{value:((u=Z(p.TRANSLATOR_LANGS)).find(a=>a.value===N)||u[0]).value,onChange:b=>{let c=b.target.value;O(c),(0,l.saveViewSettings)(y,a,"translateTargetLang",c,!1,!1),G.translateTargetLang=c,D(a,{...G})},options:Z(p.TRANSLATOR_LANGS)})]})]})})]}),((0,q.isCJKEnv)()||F?.language.isCJK)&&(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:w("Punctuation")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsx)("div",{className:"divide-base-200",children:(0,d.jsxs)("div",{className:"config-item !h-16",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,d.jsx)("span",{className:"",children:w("Replace Quotation Marks")}),(0,d.jsx)("span",{className:"text-xs",children:w("Enabled only in vertical layout.")})]}),(0,d.jsx)("input",{type:"checkbox",className:"toggle",checked:T,onChange:()=>U(!T)})]})})})]}),((0,q.isCJKEnv)()||F?.language.isCJK)&&(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium",children:w("Convert Simplified and Traditional Chinese")}),(0,d.jsx)("div",{className:"card border-base-200 bg-base-100 border shadow",children:(0,d.jsx)("div",{className:"divide-base-200",children:(0,d.jsxs)("div",{className:"config-item",children:[(0,d.jsx)("span",{className:"",children:w("Convert Mode")}),(0,d.jsx)(r.default,{value:((v=_()).find(a=>a.value===V)||v[0]).value,onChange:a=>{let b=a.target.value;W(b)},options:_()})]})})})]})]})}]),c()}catch(a){c(a)}},!1),479357,a=>{"use strict";let b=a=>{let c;a=a.replace(/\/\*[\s\S]*?\*\//g,"").trim();let d=/^[\s\n]*[-\w]+\s*:\s*[^;]+;?$/;if(!a)return{isValid:!1,error:"Empty CSS"};if((a.match(/{/g)||[]).length!==(a.match(/}/g)||[]).length)return{isValid:!1,error:"Unbalanced curly braces"};let e=/@[\w-]+[^{]*\{/g,f="",g=0;for(;null!==(c=e.exec(a));){let d=c.index,h=a.slice(g,d).trim();h&&(f+=h+"\n");let i=e.lastIndex,j=1;for(;i<a.length&&j>0;)"{"===a[i]?j++:"}"===a[i]&&j--,i++;if(0!==j)return{isValid:!1,error:"Unbalanced curly braces in at-rule"};let k=b(a.slice(e.lastIndex,i-1).trim());if(!k.isValid)return k;g=i}for(let b of(f+=a.slice(g).trim(),(a=f).split("}").map(a=>a.trim()).filter(Boolean))){let a=b.split("{").map(a=>a.trim());if(2!==a.length)return{isValid:!1,error:"Invalid CSS structure"};let[c,e]=a;if(!c)return{isValid:!1,error:"Missing selector"};if(!e)return{isValid:!1,error:`Missing declarations for selector: ${c}`};let f=e.split(";").map(a=>a.trim()).filter(Boolean);if(0===f.length)return{isValid:!1,error:`No valid properties for selector: ${c}`};for(let a of f){if(!a.includes(":"))return{isValid:!1,error:`Missing property or value: ${a}`};let[b,c]=a.split(":").map(a=>a.trim());if(!b)return{isValid:!1,error:`Missing property name: ${a}`};if(!c)return{isValid:!1,error:`Missing property value: ${a}`};if(!d.test(a.endsWith(";")?a:a+";"))return{isValid:!1,error:`Invalid property: ${a}`}}}return{isValid:!0,error:null}};a.s(["formatCSS",0,a=>{let b="",c=0,d=!1;a=(a=(a=a.replace(/\s*\n\s*/g,"")).replace(/\s{2,}/g," ").trim()).replace(/([^\s{};][^{};]*:[^{};]+)\s*}/g,"$1;}");for(let e=0;e<a.length;e++){let f=a[e],g=a.slice(e,e+2);if("/*"===g){d=!0,b+="\n"+"	".repeat(c)+"/*",e++;continue}if("*/"===g&&d){d=!1,b+="*/\n"+"	".repeat(c),e++;continue}if(d){b+=f;continue}if("{"===f)c++,b+=" {\n"+"	".repeat(c);else if("}"===f)c--,b+="\n"+"	".repeat(c)+"}\n"+"	".repeat(c);else if(";"===f)for(b+=";\n"+"	".repeat(c);" "===a[e+1]||";"===a[e+1];)e++;else b+=f}return b.replace(/\n([ \t]*\n)+/g,"\n").replace(/[ ]{2,}/g," ").trim()},"validateCSS",0,b])},655028,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(466759),i=a.i(866736),j=a.i(915302),k=a.i(51926),l=a.i(937944),m=a.i(479357),n=a.i(173947),o=b([e,h,i,l,n]);[e,h,i,l,n]=o.then?(await o)():o,a.s(["default",0,({bookKey:a,onRegisterReset:b})=>{let c=(0,j.useTranslation)(),{appService:o,envConfig:p}=(0,g.useEnv)(),{settings:q,isSettingsGlobal:r,setSettings:s}=(0,i.useSettingsStore)(),{getView:t,getViewSettings:u,setViewSettings:v}=(0,h.useReaderStore)(),w=u(a)||q.globalViewSettings,[x,y]=(0,f.useState)(w.userStylesheet),[z,A]=(0,f.useState)(!0),[B,C]=(0,f.useState)(null),[D,E]=(0,f.useState)(w.userUIStylesheet),[F,G]=(0,f.useState)(!0),[H,I]=(0,f.useState)(null),[J,K]=(0,f.useState)(!1),L=(0,f.useRef)(null),M=(0,f.useRef)(null),N=(0,k.useResetViewSettings)(),O=()=>{N({userStylesheet:y,userUIStylesheet:E}),Q("book",!0),Q("reader",!0)};(0,f.useEffect)(()=>{b(O)},[]);let P=a=>{if(!a.trim())return{isValid:!0};try{let{isValid:b,error:c}=(0,m.validateCSS)(a);if(!b)return{isValid:!1,error:c||"Invalid CSS"};return{isValid:!0}}catch(a){if(a instanceof Error)return{isValid:!1,error:a.message};return{isValid:!1,error:"Invalid CSS: Please check your input."}}},Q=(b,c=!1)=>{let d=(0,m.formatCSS)(c?"":"book"===b?x:D);"book"===b?(y(d),A(!0),w.userStylesheet=d,r&&(q.globalViewSettings.userStylesheet=d,s(q))):(E(d),G(!0),w.userUIStylesheet=d,r&&(q.globalViewSettings.userUIStylesheet=d,s(q))),v(a,{...w}),t(a)?.renderer.setStyles?.((0,n.getStyles)(w)),(0,l.saveViewSettings)(p,a,"book"===b?"userStylesheet":"userUIStylesheet",d,!1,!1)},R=a=>{a.stopPropagation(),a.nativeEvent.stopImmediatePropagation()},S=()=>{o?.isAndroidApp&&setTimeout(()=>{K(!1)},100)},T=(a,b,f,g,h,i,j)=>(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("h2",{className:"mb-2 font-medium","aria-label":c(b),children:c(b)}),(0,d.jsx)("div",{className:`card border-base-200 bg-base-100 border shadow ${h?"border-red-500":""}`,children:(0,d.jsxs)("div",{className:"relative p-1",children:[(0,d.jsx)("textarea",{ref:j,className:(0,e.default)("textarea textarea-ghost h-48 w-full border-0 p-3 text-base !outline-none sm:text-sm","placeholder:text-base-content/70"),placeholder:c(f),spellCheck:"false",value:g,onFocus:()=>{o?.isAndroidApp&&K(!0),setTimeout(()=>{j.current?.scrollIntoView({behavior:"instant",block:"center"})},300)},onBlur:S,onInput:R,onKeyDown:R,onKeyUp:R,onChange:b=>((a,b)=>{let c=a.target.value;if("book"===b){y(c),A(!1);let{isValid:a,error:b}=P(c);C(a?null:b||"Invalid CSS")}else{E(c),G(!1);let{isValid:a,error:b}=P(c);I(a?null:b||"Invalid CSS")}})(b,a)}),(0,d.jsx)("button",{className:(0,e.default)("btn btn-ghost bg-base-200 absolute bottom-2 right-4 h-8 min-h-8 px-4 py-2",i?"hidden":"",h?"btn-disabled":""),onClick:()=>Q(a),disabled:!!h,children:c("Apply")})]})}),h&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-500",children:h})]});return(0,d.jsxs)("div",{className:(0,e.default)("my-4 w-full space-y-6",J&&"h-[50%] overflow-y-auto pb-[200px]"),children:[T("book",c("Custom Content CSS"),c("Enter CSS for book content styling..."),x,B,z,L),T("reader",c("Custom Reader UI CSS"),c("Enter CSS for reader interface styling..."),D,H,F,M)]})}]),c()}catch(a){c(a)}},!1),597378,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(178552),h=a.i(866736),i=a.i(106865),j=a.i(915302),k=a.i(540438),l=a.i(864771),m=a.i(394317),n=a.i(86381),o=a.i(560840),p=a.i(547274),q=a.i(773288),r=a.i(482949),s=a.i(871893),t=a.i(158821),u=a.i(320776),v=a.i(381322),w=a.i(606144),x=a.i(480217),y=a.i(872495),z=a.i(655028),A=b([e,h,r,s,t,u,v,w,x,y,z]);[e,h,r,s,t,u,v,w,x,y,z]=A.then?(await A)():A,a.s(["default",0,({bookKey:a})=>{let b=(0,j.useTranslation)(),{appService:c}=(0,g.useEnv)(),A=(0,i.useResponsiveSize)(16),[B]=(0,f.useState)(()=>"rtl"===(0,q.getDirFromUILanguage)()),C=(0,f.useRef)(null),[D,E]=(0,f.useState)(!1),{setFontPanelView:F,setSettingsDialogOpen:G}=(0,h.useSettingsStore)(),H=[{tab:"Font",icon:k.RiFontSize,label:b("Font")},{tab:"Layout",icon:k.RiDashboardLine,label:b("Layout")},{tab:"Color",icon:l.VscSymbolColor,label:b("Color")},{tab:"Control",icon:n.LiaHandPointerSolid,label:b("Behavior")},{tab:"Language",icon:k.RiTranslate,label:b("Language")},{tab:"Custom",icon:o.IoAccessibilityOutline,label:b("Custom")}],[I,J]=(0,f.useState)(()=>{let a=localStorage.getItem("lastConfigPanel");return a&&H.some(b=>b.tab===a)?a:"Font"}),[K,L]=(0,f.useState)({Font:null,Layout:null,Color:null,Control:null,Language:null,Custom:null}),M=(a,b)=>{L(c=>({...c,[a]:b}))},N=()=>{G(!1)};(0,f.useEffect)(()=>{F("main-fonts");let a=C.current;if(!a)return;let b=()=>{let b=(a.clientWidth-64)*.22,c=Array.from(a.querySelectorAll("button")).some(a=>{let c=a.querySelector("span"),d=c?.textContent||"",e=a.cloneNode(!0);e.style.position="absolute",e.style.visibility="hidden",e.style.width="auto";let f=e.querySelector("span");f&&(f.classList.remove("hidden"),f.textContent=d),document.body.appendChild(e);let g=e.scrollWidth;return document.body.removeChild(e),g>b});E(!c)};b();let c=new ResizeObserver(b);c.observe(a);let d=new MutationObserver(b);return d.observe(a,{subtree:!0,characterData:!0}),()=>{c.disconnect(),d.disconnect()}},[F]);let O=H.find(a=>a.tab===I);return(0,d.jsx)(v.default,{isOpen:!0,onClose:N,className:"modal-open",bgClassName:a?"sm:!bg-black/20":"sm:!bg-black/50",boxClassName:(0,e.default)("sm:min-w-[520px]",c?.isMobile&&"sm:max-w-[90%] sm:w-3/4"),snapHeight:c?.isMobile?.7:void 0,header:(0,d.jsxs)("div",{className:"flex w-full flex-col items-center",children:[(0,d.jsx)("div",{className:"tab-title flex pb-2 text-base font-semibold sm:hidden",children:O?.label||""}),(0,d.jsxs)("div",{className:"flex w-full flex-row items-center justify-between",children:[(0,d.jsx)("button",{tabIndex:-1,"aria-label":b("Close"),onClick:N,className:"btn btn-ghost btn-circle flex h-8 min-h-8 w-8 hover:bg-transparent focus:outline-none sm:hidden",children:B?(0,d.jsx)(p.MdArrowForwardIos,{}):(0,d.jsx)(p.MdArrowBackIosNew,{})}),(0,d.jsx)("div",{ref:C,role:"group","aria-label":b("Settings Panels")+" - "+(O?.label||""),className:(0,e.default)("dialog-tabs ms-1 flex h-10 w-full items-center gap-1 sm:ms-0"),children:H.map(({tab:a,icon:b,label:c})=>(0,d.jsxs)("button",{"data-tab":a,tabIndex:0,title:c,className:(0,e.default)("btn btn-ghost text-base-content btn-sm gap-1 px-2",I===a?"btn-active":""),onClick:()=>{J(a),F("main-fonts"),localStorage.setItem("lastConfigPanel",a)},children:[(0,d.jsx)(b,{className:"mr-0"}),(0,d.jsx)("span",{className:(0,e.default)(window.innerWidth<640&&"hidden",!(D||I===a)&&"hidden"),children:c})]},a))}),(0,d.jsxs)("div",{className:"flex h-full items-center justify-end gap-x-2",children:[(0,d.jsx)(u.default,{label:b("Settings Menu"),className:"dropdown-bottom dropdown-end",buttonClassName:"btn btn-ghost h-8 min-h-8 w-8 p-0 flex items-center justify-center",toggleButton:(0,d.jsx)(m.PiDotsThreeVerticalBold,{}),children:(0,d.jsx)(w.default,{activePanel:I,onReset:()=>{let a=K[I];a&&a()},resetLabel:O?b("Reset {{settings}}",{settings:O.label}):void 0})}),(0,d.jsx)("button",{onClick:N,"aria-label":b("Close"),className:"bg-base-300/65 btn btn-ghost btn-circle hidden h-6 min-h-6 w-6 p-0 sm:flex",children:(0,d.jsx)(p.MdClose,{size:A})})]})]})]}),children:(0,d.jsxs)("div",{role:"group","aria-label":`${b(O?.label||"")} - ${b("Settings")}`,children:["Font"===I&&(0,d.jsx)(r.default,{bookKey:a,onRegisterReset:a=>M("Font",a)}),"Layout"===I&&(0,d.jsx)(s.default,{bookKey:a,onRegisterReset:a=>M("Layout",a)}),"Color"===I&&(0,d.jsx)(t.default,{bookKey:a,onRegisterReset:a=>M("Color",a)}),"Control"===I&&(0,d.jsx)(x.default,{bookKey:a,onRegisterReset:a=>M("Control",a)}),"Language"===I&&(0,d.jsx)(y.default,{bookKey:a,onRegisterReset:a=>M("Language",a)}),"Custom"===I&&(0,d.jsx)(z.default,{bookKey:a,onRegisterReset:a=>M("Custom",a)})]})})}]),c()}catch(a){c(a)}},!1),244423,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(667180),g=a.i(178552),h=a.i(866736),i=a.i(862871),j=a.i(466759),k=a.i(715715),l=a.i(915302),m=a.i(792410),n=a.i(662210),o=a.i(756009),p=a.i(557469),q=a.i(465863),r=a.i(452125),s=a.i(765918),t=a.i(187897),u=a.i(687323),v=a.i(654617),w=a.i(166185),x=a.i(136635),y=a.i(956099),z=a.i(44406),A=a.i(793179),B=a.i(189747),C=a.i(352128),D=a.i(626565),E=a.i(597378),F=b([h,i,j,k,u,w,x,y,z,A,B,C,D,E]);[h,i,j,k,u,w,x,y,z,A,B,C,D,E]=F.then?(await F)():F,a.s(["default",0,({ids:a,settings:b})=>{let c=(0,l.useTranslation)(),w=(0,f.useRouter)(),F=(0,f.useSearchParams)(),{envConfig:G,appService:H}=(0,g.useEnv)(),{bookKeys:I,dismissBook:J,getNextBookKey:K}=(0,y.default)(),{sideBarBookKey:L,setSideBarBookKey:M}=(0,k.useSidebarStore)(),{saveSettings:N}=(0,h.useSettingsStore)(),{getConfig:O,getBookData:P,saveConfig:Q}=(0,i.useBookDataStore)(),{getView:R,setBookKeys:S,getViewSettings:T}=(0,j.useReaderStore)(),{initViewState:U,getViewState:V,clearViewState:W}=(0,j.useReaderStore)(),{isSettingsDialogOpen:X,settingsDialogBookKey:Y}=(0,h.useSettingsStore)(),[Z,$]=(0,e.useState)(null),_=(0,e.useRef)(!1),[aa,ab]=(0,e.useState)(!1),[ac,ad]=(0,e.useState)(!1);(0,z.default)({sideBarBookKey:L,bookKeys:I}),(0,e.useEffect)(()=>{if(_.current)return;_.current=!0;let b=window.location.pathname,d=(a||F?.get("ids")||b.split("/reader/")[1]||"").split(v.BOOK_IDS_SEPARATOR).filter(Boolean).map(a=>`${a}-${(0,q.uniqueId)()}`);S(d);let e=new Set;console.log("Initialize books",d),d.forEach((a,b)=>{let d=a.split("-")[0],f=!e.has(d);e.add(d),V(a)||(U(G,d,a,f).catch(b=>{console.log("Error initializing book",a,b),ad(!0),s.eventDispatcher.dispatch("toast",{message:c("Unable to open book"),callback:()=>ag(),timeout:2e3,type:"error"})}),0===b&&M(a))})},[]),(0,e.useEffect)(()=>{let a=a=>($(a.detail),!0);return s.eventDispatcher.onSync("show-book-details",a),()=>{s.eventDispatcher.offSync("show-book-details",a)}},[]),(0,e.useEffect)(()=>{let a;if(I&&I.length>0){let a=h.useSettingsStore.getState().settings,b=I.map(a=>a.split("-")[0]);a.lastOpenBooks?.toString()!==b.toString()&&(a.lastOpenBooks=b,N(G,a))}return(0,p.isTauriAppPlatform)()&&(a=(0,o.tauriHandleOnCloseWindow)(ah)),window.addEventListener("beforeunload",ah),s.eventDispatcher.on("beforereload",ah),s.eventDispatcher.on("close-reader",ah),s.eventDispatcher.on("quit-app",ah),()=>{window.removeEventListener("beforeunload",ah),s.eventDispatcher.off("beforereload",ah),s.eventDispatcher.off("close-reader",ah),s.eventDispatcher.off("quit-app",ah),a?.then(a=>a())}},[I]);let ae=async a=>{let b=O(a),{book:c}=P(a)||{},{isPrimary:d}=V(a)||{};if(d&&c&&b){let c=h.useSettingsStore.getState().settings;s.eventDispatcher.dispatch("sync-book-progress",{bookKey:a}),s.eventDispatcher.dispatch("flush-kosync",{bookKey:a}),await Q(G,a,b,c)}},af=async a=>{console.log("Closing book",a);let b=V(a);b?.isPrimary&&H?.isDesktopApp&&await (0,u.clearDiscordPresence)(H);try{R(a)?.close(),R(a)?.remove()}catch{console.info("Error closing book",a)}s.eventDispatcher.dispatch("tts-stop",{bookKey:a}),await ae(a),W(a)},ag=()=>{(0,t.navigateToLibrary)(w,"",void 0,!0)},ah=(0,r.throttle)(async()=>{let a=h.useSettingsStore.getState().settings;await Promise.all(I.map(async a=>await af(a))),await N(G,a)},200),ai=async a=>{if(af(a),L===a&&M(K(L)),J(a),0==I.filter(b=>b!==a).length){let a=await (0,m.parseOpenWithFiles)(H)||[];if(H?.hasWindow){if(a.length>0)return(0,o.tauriHandleOnCloseWindow)(ah),await (0,o.tauriHandleClose)();let b=(0,n.getCurrentWindow)();if(b.label.startsWith("reader"))return await b.close()}N(G,b),ag()}};if(!I||0===I.length)return null;let aj=P(I[0]),ak=T(I[0]);return aj&&aj.book&&aj.bookDoc&&ak?(0,d.jsxs)("div",{className:"reader-content full-height flex",children:[(0,d.jsx)(B.default,{onGoToLibrary:()=>{if(ah(),(0,p.isTauriAppPlatform)()){let a=(0,n.getCurrentWindow)();"main"===a.label?ag():a.close()}else ag()}}),(0,d.jsx)(D.default,{bookKeys:I,onCloseBook:ai}),X&&(0,d.jsx)(E.default,{bookKey:Y}),(0,d.jsx)(C.default,{}),Z&&(0,d.jsx)(x.BookDetailModal,{isOpen:!!Z,book:Z,onClose:()=>$(null)})]}):(setTimeout(()=>ab(!0),200),aa&&!ac&&(0,d.jsx)("div",{className:"hero hero-content full-height",children:(0,d.jsx)(A.default,{loading:!0})}))}]),c()}catch(a){c(a)}},!1),598171,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(76868),f=a.i(127669),g=a.i(667180),h=a.i(178552),i=a.i(786654),j=a.i(127225),k=a.i(162650),l=a.i(466759),m=a.i(715715),n=a.i(925426),o=a.i(866736),p=a.i(108328),q=a.i(254858),r=a.i(401798),s=a.i(765918),t=a.i(991959),u=a.i(201993),v=a.i(557469),w=a.i(545251),x=a.i(645760),y=a.i(142125),z=a.i(953365),A=a.i(175416),B=a.i(330528),C=a.i(465863),D=a.i(695901),E=a.i(244423),F=b([e,i,j,k,l,m,n,o,p,r,x,y,z,A,B,E]);[e,i,j,k,l,m,n,o,p,r,x,y,z,A,B,E]=F.then?(await F)():F,a.s(["default",0,({ids:a})=>{let b=(0,g.useRouter)(),{appService:c}=(0,h.useEnv)(),{settings:F}=(0,o.useSettingsStore)(),{libraryLoaded:G}=(0,j.useLibrary)(),{sideBarBookKey:H}=(0,m.useSidebarStore)(),{hoveredBookKey:I}=(0,l.useReaderStore)(),{showSystemUI:J,dismissSystemUI:K}=(0,k.useThemeStore)(),{getScreenBrightness:L,setScreenBrightness:M}=(0,p.useDeviceControlStore)(),{acquireBackKeyInterception:N,releaseBackKeyInterception:O}=(0,p.useDeviceControlStore)(),{isSideBarVisible:P,isSideBarPinned:Q}=(0,m.useSidebarStore)(),{getIsSideBarVisible:R,setSideBarVisible:S}=(0,m.useSidebarStore)(),{isNotebookVisible:T,isNotebookPinned:U}=(0,n.useNotebookStore)(),{getIsNotebookVisible:V,setNotebookVisible:W}=(0,n.useNotebookStore)(),{isDarkMode:X,systemUIAlwaysHidden:Y,isRoundedWindow:Z}=(0,k.useThemeStore)();(0,i.useTheme)({systemUIVisible:F.alwaysShowStatusBar,appThemeColor:"base-100"}),(0,q.useScreenWakeLock)(F.screenWakeLock),(0,r.useTransferQueue)(G,5e3),(0,f.useEffect)(()=>{(0,u.mountAdditionalFonts)(document),(0,t.interceptWindowOpen)(),(0,v.isTauriAppPlatform)()&&setTimeout(w.getSysFontsList,3e3),(0,D.initDayjs)((0,C.getLocale)())},[]),(0,f.useEffect)(()=>{let a=F.screenBrightness,b=F.autoScreenBrightness;c?.hasScreenBrightness&&!b&&a>=0&&M(a/100);let d=-1;return c?.isIOSApp&&L().then(a=>{d=a}),()=>{c?.hasScreenBrightness&&!b&&M(d)}},[c]);let $=a=>"Back"===a.detail.keyName&&(R()&&!Q?S(!1):V()&&!U?W(!1):(s.eventDispatcher.dispatch("close-reader"),b.back()),!0);return(0,f.useEffect)(()=>{if(c?.isAndroidApp)return N(),()=>{O()}},[c?.isAndroidApp]),(0,f.useEffect)(()=>(c?.isAndroidApp&&s.eventDispatcher.onSync("native-key-down",$),()=>{c?.isAndroidApp&&s.eventDispatcher.offSync("native-key-down",$)}),[c?.isAndroidApp,H,Q,P,U,T]),(0,f.useEffect)(()=>{if(!c?.isMobileApp)return;let a=!!((I||F.alwaysShowStatusBar)&&!Y);(0,w.setSystemUIVisibility)({visible:a,darkMode:X}),a?J():K()},[I]),G&&F.globalReadSettings?(0,d.jsx)("div",{className:(0,e.default)("reader-page bg-base-100 text-base-content full-height select-none overflow-hidden",c?.hasRoundedWindow&&Z&&"window-border rounded-window"),children:(0,d.jsxs)(f.Suspense,{fallback:(0,d.jsx)("div",{className:"full-height"}),children:[(0,d.jsx)(E.default,{ids:a,settings:F}),(0,d.jsx)(x.AboutWindow,{}),(0,d.jsx)(y.UpdaterWindow,{}),(0,d.jsx)(z.KOSyncSettingsWindow,{}),(0,d.jsx)(A.ProofreadRulesManager,{}),(0,d.jsx)(B.Toast,{})]})}):(0,d.jsx)("div",{className:(0,e.default)("full-height",!c?.isLinuxApp&&"bg-base-100")})}]),c()}catch(a){c(a)}},!1),440407,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(481592),f=a.i(77946),g=a.i(178552),h=a.i(210997),i=a.i(107625),j=a.i(598171),k=b([j]);function l(){let a=(0,e.useRouter)().query.ids;return(0,d.jsx)(h.CSPostHogProvider,{children:(0,d.jsx)(g.EnvProvider,{children:(0,d.jsx)(f.AuthProvider,{children:(0,d.jsx)(i.SyncProvider,{children:(0,d.jsx)(j.default,{ids:a})})})})})}[j]=k.then?(await k)():k,a.s(["default",()=>l]),c()}catch(a){c(a)}},!1),892532,a=>a.a(async(b,c)=>{try{var d=a.i(997774),e=a.i(299675),f=a.i(630272),g=a.i(629674),h=a.i(929388),i=a.i(440407),j=a.i(999298),k=b([h,i]);[h,i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/reader/[ids]",pathname:"/reader/[ids]",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/reader/[ids]",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__2e132fc5._.js.map