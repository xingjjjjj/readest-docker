module.exports=[927791,a=>{"use strict";let b=(a,{startIndex:b,startOffset:c,endIndex:d,endOffset:e})=>{let f=a[b],g=a[d],h=f===g?f.slice(c,e):f.slice(c)+a.slice(f+1,g).join("")+g.slice(0,e),i=f.slice(0,c).replace(/\s+/g," ").trimStart(),j=g.slice(e).replace(/\s+/g," ").trimEnd(),k=i.length<50?"":"…",l=j.length<50?"":"…";return{pre:`${k}${i.slice(-50)}`,match:h,post:`${j.slice(0,50)}${l}`}},c=function*(a,c,d={}){let{locales:e="en",sensitivity:f}=d,g="variant"===f,h=a.join(""),i=g?h:h.toLocaleLowerCase(e),j=g?c:c.toLocaleLowerCase(e),k=j.length,l=-1,m=-1,n=0;do if((l=i.indexOf(j,l+1))>-1){for(;n<=l;)n+=a[++m].length;let c=m,d=l-(n-a[m].length),e=l+k;for(;n<=e;)n+=a[++m].length;let f={startIndex:c,startOffset:d,endIndex:m,endOffset:e-(n-a[m].length)};yield{range:f,excerpt:b(a,f)}}while(l>-1)},d=function*(a,c,d={}){let e,f,{locales:g="en",granularity:h="word",sensitivity:i="base"}=d;try{e=new Intl.Segmenter(g,{usage:"search",granularity:h}),f=new Intl.Collator(g,{sensitivity:i})}catch(a){console.warn(a),e=new Intl.Segmenter("en",{usage:"search",granularity:h}),f=new Intl.Collator("en",{sensitivity:i})}let j=Array.from(e.segment(c)).length,k=[],l=0,m=e.segment(a[l])[Symbol.iterator]();a:for(;l<a.length;){for(;k.length<j;){let{done:b,value:c}=m.next();if(b){if(++l<a.length){m=e.segment(a[l])[Symbol.iterator]();continue}break a}let{index:d,segment:f}=c;if(/[^\p{Format}]/u.test(f)){if(/\s/u.test(f)){/\s/u.test(k[k.length-1]?.segment)||k.push({strIndex:l,index:d,segment:" "});continue}c.strIndex=l,k.push(c)}}let d=k.map(a=>a.segment).join("");if(0===f.compare(c,d)){let c=l,d=k[k.length-1],e=d.index+d.segment.length,f={startIndex:k[0].strIndex,startOffset:k[0].index,endIndex:c,endOffset:e};yield{range:f,excerpt:b(a,f)}}k.shift()}},e=(a,b,e)=>{let{granularity:f="grapheme",sensitivity:g="base"}=e;return Intl?.Segmenter&&("grapheme"!==f||"variant"!==g&&"accent"!==g)?d(a,b,e):c(a,b,e)};a.s(["search",0,e,"searchMatcher",0,(a,b)=>{let{defaultLocale:c,matchCase:d,matchDiacritics:f,matchWholeWords:g,acceptNode:h}=b;return function*(b,i){for(let j of a(b,function*(a,h){for(let j of e(a,i,{locales:b.body.lang||b.documentElement.lang||c||"en",granularity:g?"word":"grapheme",sensitivity:f&&d?"variant":f&&!d?"accent":!f&&d?"case":"base"})){let{startIndex:a,startOffset:b,endIndex:c,endOffset:d}=j.range;j.range=h(a,b,c,d),yield j}},h))yield j}}])}];

//# sourceMappingURL=packages_foliate-js_search_18b4fc4c.js.map