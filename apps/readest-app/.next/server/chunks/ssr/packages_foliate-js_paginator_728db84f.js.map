{"version":3,"sources":["../../../../../../packages/foliate-js/paginator.js"],"sourcesContent":["const wait = ms => new Promise(resolve => setTimeout(resolve, ms))\n\nconst debounce = (f, wait, immediate) => {\n    let timeout\n    return (...args) => {\n        const later = () => {\n            timeout = null\n            if (!immediate) f(...args)\n        }\n        const callNow = immediate && !timeout\n        if (timeout) clearTimeout(timeout)\n        timeout = setTimeout(later, wait)\n        if (callNow) f(...args)\n    }\n}\n\nconst lerp = (min, max, x) => x * (max - min) + min\nconst easeOutQuad = x => 1 - (1 - x) * (1 - x)\nconst animate = (a, b, duration, ease, render) => new Promise(resolve => {\n    let start\n    const step = now => {\n        if (document.hidden) {\n            render(lerp(a, b, 1))\n            return resolve()\n        }\n        start ??= now\n        const fraction = Math.min(1, (now - start) / duration)\n        render(lerp(a, b, ease(fraction)))\n        if (fraction < 1) requestAnimationFrame(step)\n        else resolve()\n    }\n    if (document.hidden) {\n        render(lerp(a, b, 1))\n        return resolve()\n    }\n    requestAnimationFrame(step)\n})\n\n// collapsed range doesn't return client rects sometimes (or always?)\n// try make get a non-collapsed range or element\nconst uncollapse = range => {\n    if (!range?.collapsed) return range\n    const { endOffset, endContainer } = range\n    if (endContainer.nodeType === 1) {\n        const node = endContainer.childNodes[endOffset]\n        if (node?.nodeType === 1) return node\n        return endContainer\n    }\n    if (endOffset + 1 < endContainer.length) range.setEnd(endContainer, endOffset + 1)\n    else if (endOffset > 1) range.setStart(endContainer, endOffset - 1)\n    else return endContainer.parentNode\n    return range\n}\n\nconst makeRange = (doc, node, start, end = start) => {\n    const range = doc.createRange()\n    range.setStart(node, start)\n    range.setEnd(node, end)\n    return range\n}\n\n// use binary search to find an offset value in a text node\nconst bisectNode = (doc, node, cb, start = 0, end = node.nodeValue.length) => {\n    if (end - start === 1) {\n        const result = cb(makeRange(doc, node, start), makeRange(doc, node, end))\n        return result < 0 ? start : end\n    }\n    const mid = Math.floor(start + (end - start) / 2)\n    const result = cb(makeRange(doc, node, start, mid), makeRange(doc, node, mid, end))\n    return result < 0 ? bisectNode(doc, node, cb, start, mid)\n        : result > 0 ? bisectNode(doc, node, cb, mid, end) : mid\n}\n\nconst { SHOW_ELEMENT, SHOW_TEXT, SHOW_CDATA_SECTION,\n    FILTER_ACCEPT, FILTER_REJECT, FILTER_SKIP } = NodeFilter\n\nconst filter = SHOW_ELEMENT | SHOW_TEXT | SHOW_CDATA_SECTION\n\n// needed cause there seems to be a bug in `getBoundingClientRect()` in Firefox\n// where it fails to include rects that have zero width and non-zero height\n// (CSSOM spec says \"rectangles [...] of which the height or width is not zero\")\n// which makes the visible range include an extra space at column boundaries\nconst getBoundingClientRect = target => {\n    let top = Infinity, right = -Infinity, left = Infinity, bottom = -Infinity\n    for (const rect of target.getClientRects()) {\n        left = Math.min(left, rect.left)\n        top = Math.min(top, rect.top)\n        right = Math.max(right, rect.right)\n        bottom = Math.max(bottom, rect.bottom)\n    }\n    return new DOMRect(left, top, right - left, bottom - top)\n}\n\nconst getVisibleRange = (doc, start, end, mapRect) => {\n    // first get all visible nodes\n    const acceptNode = node => {\n        const name = node.localName?.toLowerCase()\n        // ignore all scripts, styles, and their children\n        if (name === 'script' || name === 'style') return FILTER_REJECT\n        if (node.nodeType === 1) {\n            const { left, right } = mapRect(node.getBoundingClientRect())\n            // no need to check child nodes if it's completely out of view\n            if (right < start || left > end) return FILTER_REJECT\n            // elements must be completely in view to be considered visible\n            // because you can't specify offsets for elements\n            if (left >= start && right <= end) return FILTER_ACCEPT\n            // TODO: it should probably allow elements that do not contain text\n            // because they can exceed the whole viewport in both directions\n            // especially in scrolled mode\n        } else {\n            // ignore empty text nodes\n            if (!node.nodeValue?.trim()) return FILTER_SKIP\n            // create range to get rect\n            const range = doc.createRange()\n            range.selectNodeContents(node)\n            const { left, right } = mapRect(range.getBoundingClientRect())\n            // it's visible if any part of it is in view\n            if (right >= start && left <= end) return FILTER_ACCEPT\n        }\n        return FILTER_SKIP\n    }\n    const walker = doc.createTreeWalker(doc.body, filter, { acceptNode })\n    const nodes = []\n    for (let node = walker.nextNode(); node; node = walker.nextNode())\n        nodes.push(node)\n\n    // we're only interested in the first and last visible nodes\n    const from = nodes[0] ?? doc.body\n    const to = nodes[nodes.length - 1] ?? from\n\n    // find the offset at which visibility changes\n    const startOffset = from.nodeType === 1 ? 0\n        : bisectNode(doc, from, (a, b) => {\n            const p = mapRect(getBoundingClientRect(a))\n            const q = mapRect(getBoundingClientRect(b))\n            if (p.right < start && q.left > start) return 0\n            return q.left > start ? -1 : 1\n        })\n    const endOffset = to.nodeType === 1 ? 0\n        : bisectNode(doc, to, (a, b) => {\n            const p = mapRect(getBoundingClientRect(a))\n            const q = mapRect(getBoundingClientRect(b))\n            if (p.right < end && q.left > end) return 0\n            return q.left > end ? -1 : 1\n        })\n\n    const range = doc.createRange()\n    range.setStart(from, startOffset)\n    range.setEnd(to, endOffset)\n    return range\n}\n\nconst selectionIsBackward = sel => {\n    const range = document.createRange()\n    range.setStart(sel.anchorNode, sel.anchorOffset)\n    range.setEnd(sel.focusNode, sel.focusOffset)\n    return range.collapsed\n}\n\nconst setSelectionTo = (target, collapse) => {\n    let range\n    if (target.startContainer) range = target.cloneRange()\n    else if (target.nodeType) {\n        range = document.createRange()\n        range.selectNode(target)\n    }\n    if (range) {\n        const sel = range.startContainer.ownerDocument?.defaultView.getSelection()\n        if (sel) {\n            sel.removeAllRanges()\n            if (collapse === -1) range.collapse(true)\n            else if (collapse === 1) range.collapse()\n            sel.addRange(range)\n        }\n    }\n}\n\nconst getDirection = doc => {\n    const { defaultView } = doc\n    const { writingMode, direction } = defaultView.getComputedStyle(doc.body)\n    const vertical = writingMode === 'vertical-rl'\n        || writingMode === 'vertical-lr'\n    const rtl = doc.body.dir === 'rtl'\n        || direction === 'rtl'\n        || doc.documentElement.dir === 'rtl'\n    return { vertical, rtl }\n}\n\nconst getBackground = doc => {\n    const bodyStyle = doc.defaultView.getComputedStyle(doc.body)\n    return bodyStyle.backgroundColor === 'rgba(0, 0, 0, 0)'\n        && bodyStyle.backgroundImage === 'none'\n        ? doc.defaultView.getComputedStyle(doc.documentElement).background\n        : bodyStyle.background\n}\n\nconst makeMarginals = (length, part) => Array.from({ length }, () => {\n    const div = document.createElement('div')\n    const child = document.createElement('div')\n    div.append(child)\n    child.setAttribute('part', part)\n    return div\n})\n\nconst setStylesImportant = (el, styles) => {\n    const { style } = el\n    for (const [k, v] of Object.entries(styles)) style.setProperty(k, v, 'important')\n}\n\nclass View {\n    #observer = new ResizeObserver(() => this.expand())\n    #element = document.createElement('div')\n    #iframe = document.createElement('iframe')\n    #contentRange = document.createRange()\n    #overlayer\n    #vertical = false\n    #rtl = false\n    #column = true\n    #size\n    #layout = {}\n    constructor({ container, onExpand }) {\n        this.container = container\n        this.onExpand = onExpand\n        this.#iframe.setAttribute('part', 'filter')\n        this.#element.append(this.#iframe)\n        Object.assign(this.#element.style, {\n            boxSizing: 'content-box',\n            position: 'relative',\n            overflow: 'hidden',\n            flex: '0 0 auto',\n            width: '100%', height: '100%',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n        })\n        Object.assign(this.#iframe.style, {\n            overflow: 'hidden',\n            border: '0',\n            display: 'none',\n            width: '100%', height: '100%',\n        })\n        // `allow-scripts` is needed for events because of WebKit bug\n        // https://bugs.webkit.org/show_bug.cgi?id=218086\n        this.#iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts')\n        this.#iframe.setAttribute('scrolling', 'no')\n    }\n    get element() {\n        return this.#element\n    }\n    get document() {\n        return this.#iframe.contentDocument\n    }\n    async load(src, data, afterLoad, beforeRender) {\n        if (typeof src !== 'string') throw new Error(`${src} is not string`)\n        return new Promise(resolve => {\n            this.#iframe.addEventListener('load', () => {\n                const doc = this.document\n                afterLoad?.(doc)\n\n                this.#iframe.setAttribute('aria-label', doc.title)\n                // it needs to be visible for Firefox to get computed style\n                this.#iframe.style.display = 'block'\n                const { vertical, rtl } = getDirection(doc)\n                this.docBackground = getBackground(doc)\n                doc.body.style.background = 'none'\n                const background = this.docBackground\n                this.#iframe.style.display = 'none'\n\n                this.#vertical = vertical\n                this.#rtl = rtl\n\n                this.#contentRange.selectNodeContents(doc.body)\n                const layout = beforeRender?.({ vertical, rtl, background })\n                this.#iframe.style.display = 'block'\n                this.render(layout)\n                this.#observer.observe(doc.body)\n\n                // the resize observer above doesn't work in Firefox\n                // (see https://bugzilla.mozilla.org/show_bug.cgi?id=1832939)\n                // until the bug is fixed we can at least account for font load\n                doc.fonts.ready.then(() => this.expand())\n\n                resolve()\n            }, { once: true })\n            if (data) {\n                this.#iframe.srcdoc = data\n            } else {\n                this.#iframe.src = src\n            }\n        })\n    }\n    render(layout) {\n        if (!layout || !this.document) return\n        this.#column = layout.flow !== 'scrolled'\n        this.#layout = layout\n        if (this.#column) this.columnize(layout)\n        else this.scrolled(layout)\n    }\n    scrolled({ marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }) {\n        const vertical = this.#vertical\n        const doc = this.document\n        setStylesImportant(doc.documentElement, {\n            'box-sizing': 'border-box',\n            'padding': vertical\n                ? `${marginTop * 1.5}px ${marginRight}px ${marginBottom * 1.5}px ${marginLeft}px`\n                : `${marginTop}px ${gap / 2 + marginRight / 2}px ${marginBottom}px ${gap / 2 + marginLeft / 2}px`,\n            'column-width': 'auto',\n            'height': 'auto',\n            'width': 'auto',\n            '--page-margin-top': `${vertical ? marginTop * 1.5 : marginTop}px`,\n            '--page-margin-right': `${vertical ? marginRight : marginRight + gap /2}px`,\n            '--page-margin-bottom': `${vertical ? marginBottom * 1.5 : marginBottom}px`,\n            '--page-margin-left': `${vertical ? marginLeft : marginLeft + gap / 2}px`,\n            '--available-width': `${Math.trunc(Math.min(window.innerWidth, columnWidth) - marginLeft - marginRight - gap - 60)}`,\n            '--available-height': `${Math.trunc(window.innerHeight - marginTop - marginBottom)}`,\n        })\n        setStylesImportant(doc.body, {\n            [vertical ? 'max-height' : 'max-width']: `${columnWidth}px`,\n            'margin': 'auto',\n        })\n        this.setImageSize()\n        this.expand()\n    }\n    columnize({ width, height, marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }) {\n        const vertical = this.#vertical\n        this.#size = vertical ? height : width\n\n        const doc = this.document\n        setStylesImportant(doc.documentElement, {\n            'box-sizing': 'border-box',\n            'column-width': `${Math.trunc(columnWidth)}px`,\n            'column-gap': vertical ? `${(marginTop + marginBottom) * 1.5}px` : `${gap + marginRight / 2 + marginLeft / 2}px`,\n            'column-fill': 'auto',\n            ...(vertical\n                ? { 'width': `${width}px` }\n                : { 'height': `${height}px` }),\n            'padding': vertical\n                ? `${marginTop * 1.5}px ${marginRight}px ${marginBottom * 1.5}px ${marginLeft}px`\n                : `${marginTop}px ${gap / 2 + marginRight / 2}px ${marginBottom}px ${gap / 2 + marginLeft / 2}px`,\n            'overflow': 'hidden',\n            // force wrap long words\n            'overflow-wrap': 'break-word',\n            // reset some potentially problematic props\n            'position': 'static', 'border': '0', 'margin': '0',\n            'max-height': 'none', 'max-width': 'none',\n            'min-height': 'none', 'min-width': 'none',\n            // fix glyph clipping in WebKit\n            '-webkit-line-box-contain': 'block glyphs replaced',\n            '--page-margin-top': `${vertical ? marginTop * 1.5 : marginTop}px`,\n            '--page-margin-right': `${vertical ? marginRight : marginRight / 2 + gap /2}px`,\n            '--page-margin-bottom': `${vertical ? marginBottom * 1.5 : marginBottom}px`,\n            '--page-margin-left': `${vertical ? marginLeft : marginLeft / 2 + gap / 2}px`,\n            '--available-width': `${Math.trunc(columnWidth - marginLeft - marginRight - gap)}`,\n            '--available-height': `${Math.trunc(height - marginTop - marginBottom)}`,\n        })\n        setStylesImportant(doc.body, {\n            'max-height': 'none',\n            'max-width': 'none',\n            'margin': '0',\n        })\n        this.setImageSize()\n        this.expand()\n    }\n    setImageSize() {\n        const { width, height, marginTop, marginRight, marginBottom, marginLeft } = this.#layout\n        const vertical = this.#vertical\n        const doc = this.document\n        for (const el of doc.body.querySelectorAll('img, svg, video')) {\n            // preserve max size if they are already set\n            const { maxHeight, maxWidth } = doc.defaultView.getComputedStyle(el)\n            setStylesImportant(el, {\n                'max-height': vertical\n                    ? (maxHeight !== 'none' && maxHeight !== '0px' ? maxHeight : '100%')\n                    : `${height - marginTop - marginBottom }px`,\n                'max-width': vertical\n                    ? `${width - marginLeft - marginRight }px`\n                    : (maxWidth !== 'none' && maxWidth !== '0px' ? maxWidth : '100%'),\n                'object-fit': 'contain',\n                'page-break-inside': 'avoid',\n                'break-inside': 'avoid',\n                'box-sizing': 'border-box',\n            })\n        }\n    }\n    get #zoom() {\n        // Safari does not zoom the client rects, while Chrome, Edge and Firefox does\n        if (/^((?!chrome|android).)*AppleWebKit/i.test(navigator.userAgent) && !window.chrome) {\n            return window.getComputedStyle(this.document.body).zoom || 1.0\n        }\n        return 1.0\n    }\n    expand() {\n        if (!this.document) return\n        const { documentElement } = this.document\n        if (this.#column) {\n            const side = this.#vertical ? 'height' : 'width'\n            const otherSide = this.#vertical ? 'width' : 'height'\n            const contentRect = this.#contentRange.getBoundingClientRect()\n            const rootRect = documentElement.getBoundingClientRect()\n            // offset caused by column break at the start of the page\n            // which seem to be supported only by WebKit and only for horizontal writing\n            const contentStart = this.#vertical ? 0\n                : this.#rtl ? rootRect.right - contentRect.right : contentRect.left - rootRect.left\n            const contentSize = (contentStart + contentRect[side]) * this.#zoom\n            const pageCount = Math.ceil(contentSize / this.#size)\n            const expandedSize = pageCount * this.#size\n            this.#element.style.padding = '0'\n            this.#iframe.style[side] = `${expandedSize}px`\n            this.#element.style[side] = `${expandedSize + this.#size * 2}px`\n            this.#iframe.style[otherSide] = '100%'\n            this.#element.style[otherSide] = '100%'\n            documentElement.style[side] = `${this.#size}px`\n            if (this.#overlayer) {\n                this.#overlayer.element.style.margin = '0'\n                this.#overlayer.element.style.left = this.#vertical ? '0' : `${this.#size}px`\n                this.#overlayer.element.style.top = this.#vertical ? `${this.#size}px` : '0'\n                this.#overlayer.element.style[side] = `${expandedSize}px`\n                this.#overlayer.redraw()\n            }\n        } else {\n            const side = this.#vertical ? 'width' : 'height'\n            const otherSide = this.#vertical ? 'height' : 'width'\n            const contentSize = documentElement.getBoundingClientRect()[side]\n            const expandedSize = contentSize\n            this.#element.style.padding = '0'\n            this.#iframe.style[side] = `${expandedSize}px`\n            this.#element.style[side] = `${expandedSize}px`\n            this.#iframe.style[otherSide] = '100%'\n            this.#element.style[otherSide] = '100%'\n            if (this.#overlayer) {\n                this.#overlayer.element.style.margin = '0'\n                this.#overlayer.element.style.left = '0'\n                this.#overlayer.element.style.top = '0'\n                this.#overlayer.element.style[side] = `${expandedSize}px`\n                this.#overlayer.redraw()\n            }\n        }\n        this.onExpand()\n    }\n    set overlayer(overlayer) {\n        this.#overlayer = overlayer\n        this.#element.append(overlayer.element)\n    }\n    get overlayer() {\n        return this.#overlayer\n    }\n    destroy() {\n        if (this.document) this.#observer.unobserve(this.document.body)\n    }\n}\n\n// NOTE: everything here assumes the so-called \"negative scroll type\" for RTL\nexport class Paginator extends HTMLElement {\n    static observedAttributes = [\n        'flow', 'gap', 'margin-top', 'margin-bottom', 'margin-left', 'margin-right',\n        'max-inline-size', 'max-block-size', 'max-column-count',\n    ]\n    #root = this.attachShadow({ mode: 'open' })\n    #observer = new ResizeObserver(() => this.render())\n    #top\n    #background\n    #container\n    #header\n    #footer\n    #view\n    #vertical = false\n    #rtl = false\n    #marginTop = 0\n    #marginBottom = 0\n    #index = -1\n    #anchor = 0 // anchor view to a fraction (0-1), Range, or Element\n    #justAnchored = false\n    #locked = false // while true, prevent any further navigation\n    #styles\n    #styleMap = new WeakMap()\n    #mediaQuery = matchMedia('(prefers-color-scheme: dark)')\n    #mediaQueryListener\n    #scrollBounds\n    #touchState\n    #touchScrolled\n    #lastVisibleRange\n    #scrollLocked = false\n    constructor() {\n        super()\n        this.#root.innerHTML = `<style>\n        :host {\n            display: block;\n            container-type: size;\n        }\n        :host, #top {\n            box-sizing: border-box;\n            position: relative;\n            overflow: hidden;\n            width: 100%;\n            height: 100%;\n        }\n        #top {\n            --_gap: 7%;\n            --_margin-top: 48px;\n            --_margin-right: 48px;\n            --_margin-bottom: 48px;\n            --_margin-left: 48px;\n            --_max-inline-size: 720px;\n            --_max-block-size: 1440px;\n            --_max-column-count: 2;\n            --_max-column-count-portrait: var(--_max-column-count);\n            --_max-column-count-spread: var(--_max-column-count);\n            --_half-gap: calc(var(--_gap) / 2);\n            --_half-margin-left: calc(var(--_margin-left) / 2);\n            --_half-margin-right: calc(var(--_margin-right) / 2);\n            --_max-width: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            --_max-height: var(--_max-block-size);\n            display: grid;\n            grid-template-columns:\n                minmax(0, 1fr)\n                var(--_margin-left)\n                minmax(0, calc(var(--_max-width) - var(--_gap)))\n                var(--_margin-right)\n                minmax(0, 1fr);\n            grid-template-rows:\n                minmax(var(--_margin-top), 1fr)\n                minmax(0, var(--_max-height))\n                minmax(var(--_margin-bottom), 1fr);\n            &.vertical {\n                --_max-column-count-spread: var(--_max-column-count-portrait);\n                --_max-width: var(--_max-block-size);\n                --_max-height: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            }\n            @container (orientation: portrait) {\n                & {\n                    --_max-column-count-spread: var(--_max-column-count-portrait);\n                }\n                &.vertical {\n                    --_max-column-count-spread: var(--_max-column-count);\n                }\n            }\n        }\n        #background {\n            grid-column: 1 / -1;\n            grid-row: 1 / -1;\n        }\n        #container {\n            grid-column: 2 / 5;\n            grid-row: 1 / -1;\n            overflow: hidden;\n        }\n        :host([flow=\"scrolled\"]) #container {\n            grid-column: 2 / 5;\n            grid-row: 1 / -1;\n            overflow: auto;\n        }\n        #header {\n            grid-column: 3 / 4;\n            grid-row: 1;\n        }\n        #footer {\n            grid-column: 3 / 4;\n            grid-row: 3;\n            align-self: end;\n        }\n        #header {\n            display: grid;\n            height: var(--_margin-top);\n        }\n        #footer {\n            display: grid;\n            height: var(--_margin-bottom);\n        }\n        :is(#header, #footer) > * {\n            display: flex;\n            align-items: center;\n            min-width: 0;\n        }\n        :is(#header, #footer) > * > * {\n            width: 100%;\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            text-align: center;\n            font-size: .75em;\n            opacity: .6;\n        }\n        </style>\n        <div id=\"top\">\n            <div id=\"background\" part=\"filter\"></div>\n            <div id=\"header\"></div>\n            <div id=\"container\" part=\"container\"></div>\n            <div id=\"footer\"></div>\n        </div>\n        `\n\n        this.#top = this.#root.getElementById('top')\n        this.#background = this.#root.getElementById('background')\n        this.#container = this.#root.getElementById('container')\n        this.#header = this.#root.getElementById('header')\n        this.#footer = this.#root.getElementById('footer')\n\n        this.#observer.observe(this.#container)\n        this.#container.addEventListener('scroll', () => this.dispatchEvent(new Event('scroll')))\n        this.#container.addEventListener('scroll', debounce(() => {\n            if (this.scrolled) {\n                if (this.#justAnchored) this.#justAnchored = false\n                else this.#afterScroll('scroll')\n            }\n        }, 250))\n\n        const opts = { passive: false }\n        this.addEventListener('touchstart', this.#onTouchStart.bind(this), opts)\n        this.addEventListener('touchmove', this.#onTouchMove.bind(this), opts)\n        this.addEventListener('touchend', this.#onTouchEnd.bind(this))\n        this.addEventListener('load', ({ detail: { doc } }) => {\n            doc.addEventListener('touchstart', this.#onTouchStart.bind(this), opts)\n            doc.addEventListener('touchmove', this.#onTouchMove.bind(this), opts)\n            doc.addEventListener('touchend', this.#onTouchEnd.bind(this))\n        })\n\n        this.addEventListener('relocate', ({ detail }) => {\n            if (detail.reason === 'selection') setSelectionTo(this.#anchor, 0)\n            else if (detail.reason === 'navigation') {\n                if (this.#anchor === 1) setSelectionTo(detail.range, 1)\n                else if (typeof this.#anchor === 'number')\n                    setSelectionTo(detail.range, -1)\n                else setSelectionTo(this.#anchor, -1)\n            }\n        })\n        const checkPointerSelection = debounce((range, sel) => {\n            if (!sel.rangeCount) return\n            const selRange = sel.getRangeAt(0)\n            const backward = selectionIsBackward(sel)\n            if (backward && selRange.compareBoundaryPoints(Range.START_TO_START, range) < 0)\n                this.prev()\n            else if (!backward && selRange.compareBoundaryPoints(Range.END_TO_END, range) > 0)\n                this.next()\n        }, 700)\n        this.addEventListener('load', ({ detail: { doc } }) => {\n            let isPointerSelecting = false\n            doc.addEventListener('pointerdown', () => isPointerSelecting = true)\n            doc.addEventListener('pointerup', () => isPointerSelecting = false)\n            let isKeyboardSelecting = false\n            doc.addEventListener('keydown', () => isKeyboardSelecting = true)\n            doc.addEventListener('keyup', () => isKeyboardSelecting = false)\n            doc.addEventListener('selectionchange', () => {\n                if (this.scrolled) return\n                const range = this.#lastVisibleRange\n                if (!range) return\n                const sel = doc.getSelection()\n                if (!sel.rangeCount) return\n                // FIXME: this won't work on Android WebView, disable for now\n                if (!isPointerSelecting && isPointerSelecting && sel.type === 'Range')\n                    checkPointerSelection(range, sel)\n                else if (isKeyboardSelecting) {\n                    const selRange = sel.getRangeAt(0).cloneRange()\n                    const backward = selectionIsBackward(sel)\n                    if (!backward) selRange.collapse()\n                    this.#scrollToAnchor(selRange)\n                }\n            })\n            doc.addEventListener('focusin', e => {\n                if (this.scrolled) return null\n                if (this.#container && this.#container.contains(e.target)) {\n                    // NOTE: `requestAnimationFrame` is needed in WebKit\n                    requestAnimationFrame(() => this.#scrollToAnchor(e.target))\n                }\n            })\n        })\n\n        this.#mediaQueryListener = () => {\n            if (!this.#view) return\n            this.#replaceBackground(this.#view.docBackground, this.columnCount)\n        }\n        this.#mediaQuery.addEventListener('change', this.#mediaQueryListener)\n    }\n    attributeChangedCallback(name, _, value) {\n        switch (name) {\n            case 'flow':\n                this.render()\n                break\n            case 'gap':\n            case 'margin-top':\n            case 'margin-bottom':\n            case 'margin-left':\n            case 'margin-right':\n            case 'max-block-size':\n            case 'max-column-count':\n                this.#top.style.setProperty('--_' + name, value)\n                this.render()\n                break\n            case 'max-inline-size':\n                // needs explicit `render()` as it doesn't necessarily resize\n                this.#top.style.setProperty('--_' + name, value)\n                this.render()\n                break\n        }\n    }\n    open(book) {\n        this.bookDir = book.dir\n        this.sections = book.sections\n        book.transformTarget?.addEventListener('data', ({ detail }) => {\n            if (detail.type !== 'text/css') return\n            detail.data = Promise.resolve(detail.data).then(data => data\n                // unprefix as most of the props are (only) supported unprefixed\n                .replace(/([{\\s;])-epub-/gi, '$1')\n                // `page-break-*` unsupported in columns; replace with `column-break-*`\n                .replace(/page-break-(after|before|inside)\\s*:/gi, (_, x) =>\n                    `-webkit-column-break-${x}:`)\n                .replace(/break-(after|before|inside)\\s*:\\s*(avoid-)?page/gi, (_, x, y) =>\n                    `break-${x}: ${y ?? ''}column`))\n        })\n    }\n    #createView() {\n        if (this.#view) {\n            this.#view.destroy()\n            this.#container.removeChild(this.#view.element)\n        }\n        this.#view = new View({\n            container: this,\n            onExpand: () => this.#scrollToAnchor(this.#anchor),\n        })\n        this.#container.append(this.#view.element)\n        return this.#view\n    }\n    #replaceBackground(background, columnCount) {\n        const doc = this.#view?.document\n        if (!doc) return\n        const htmlStyle = doc.defaultView.getComputedStyle(doc.documentElement)\n        const themeBgColor = htmlStyle.getPropertyValue('--theme-bg-color')\n        const overrideColor = htmlStyle.getPropertyValue('--override-color') === 'true'\n        const bgTextureId = htmlStyle.getPropertyValue('--bg-texture-id')\n        const isDarkMode = htmlStyle.getPropertyValue('color-scheme') === 'dark'\n        if (background && themeBgColor) {\n            const parsedBackground = background.split(/\\s(?=(?:url|rgb|hsl|#[0-9a-fA-F]{3,6}))/)\n            if ((isDarkMode || overrideColor) && (bgTextureId === 'none' || !bgTextureId)) {\n                parsedBackground[0] = themeBgColor\n            }\n            background = parsedBackground.join(' ')\n        }\n        this.#background.innerHTML = ''\n        this.#background.style.display = 'grid'\n        this.#background.style.gridTemplateColumns = `repeat(${columnCount}, 1fr)`\n        for (let i = 0; i < columnCount; i++) {\n            const column = document.createElement('div')\n            column.style.background = background\n            column.style.width = '100%'\n            column.style.height = '100%'\n            this.#background.appendChild(column)\n        }\n    }\n    #beforeRender({ vertical, rtl, background }) {\n        this.#vertical = vertical\n        this.#rtl = rtl\n        this.#top.classList.toggle('vertical', vertical)\n\n        const { width, height } = this.#container.getBoundingClientRect()\n        const size = vertical ? height : width\n\n        const style = getComputedStyle(this.#top)\n        const maxInlineSize = parseFloat(style.getPropertyValue('--_max-inline-size'))\n        const maxColumnCount = parseInt(style.getPropertyValue('--_max-column-count-spread'))\n        const marginTop = parseFloat(style.getPropertyValue('--_margin-top'))\n        const marginRight = parseFloat(style.getPropertyValue('--_margin-right'))\n        const marginBottom = parseFloat(style.getPropertyValue('--_margin-bottom'))\n        const marginLeft = parseFloat(style.getPropertyValue('--_margin-left'))\n        this.#marginTop = marginTop\n        this.#marginBottom = marginBottom\n\n        const g = parseFloat(style.getPropertyValue('--_gap')) / 100\n        // The gap will be a percentage of the #container, not the whole view.\n        // This means the outer padding will be bigger than the column gap. Let\n        // `a` be the gap percentage. The actual percentage for the column gap\n        // will be (1 - a) * a. Let us call this `b`.\n        //\n        // To make them the same, we start by shrinking the outer padding\n        // setting to `b`, but keep the column gap setting the same at `a`. Then\n        // the actual size for the column gap will be (1 - b) * a. Repeating the\n        // process again and again, we get the sequence\n        //     x₁ = (1 - b) * a\n        //     x₂ = (1 - x₁) * a\n        //     ...\n        // which converges to x = (1 - x) * a. Solving for x, x = a / (1 + a).\n        // So to make the spacing even, we must shrink the outer padding with\n        //     f(x) = x / (1 + x).\n        // But we want to keep the outer padding, and make the inner gap bigger.\n        // So we apply the inverse, f⁻¹ = -x / (x - 1) to the column gap.\n        const gap = -g / (g - 1) * size\n\n        const flow = this.getAttribute('flow')\n        if (flow === 'scrolled') {\n            // FIXME: vertical-rl only, not -lr\n            this.setAttribute('dir', vertical ? 'rtl' : 'ltr')\n            this.#top.style.padding = '0'\n            const columnWidth = maxInlineSize\n\n            this.heads = null\n            this.feet = null\n            this.#header.replaceChildren()\n            this.#footer.replaceChildren()\n\n            return { flow, marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }\n        }\n\n        const divisor = Math.min(maxColumnCount + (vertical ? 1 : 0), Math.ceil(Math.floor(size) / Math.floor(maxInlineSize)))\n        const columnWidth = vertical\n            ? (size / divisor - marginTop * 1.5 - marginBottom * 1.5)\n            : (size / divisor - gap - marginRight / 2 - marginLeft / 2)\n        this.setAttribute('dir', rtl ? 'rtl' : 'ltr')\n\n        // set background to `doc` background\n        // this is needed because the iframe does not fill the whole element\n        this.columnCount = divisor\n        this.#replaceBackground(background, this.columnCount)\n\n        const marginalDivisor = vertical\n            ? Math.min(2, Math.ceil(Math.floor(width) / Math.floor(maxInlineSize)))\n            : divisor\n        const marginalStyle = {\n            gridTemplateColumns: `repeat(${marginalDivisor}, 1fr)`,\n            gap: `${gap}px`,\n            direction: this.bookDir === 'rtl' ? 'rtl' : 'ltr',\n        }\n        Object.assign(this.#header.style, marginalStyle)\n        Object.assign(this.#footer.style, marginalStyle)\n        const heads = makeMarginals(marginalDivisor, 'head')\n        const feet = makeMarginals(marginalDivisor, 'foot')\n        this.heads = heads.map(el => el.children[0])\n        this.feet = feet.map(el => el.children[0])\n        this.#header.replaceChildren(...heads)\n        this.#footer.replaceChildren(...feet)\n\n        return { height, width, marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }\n    }\n    render() {\n        if (!this.#view) return\n        this.#view.render(this.#beforeRender({\n            vertical: this.#vertical,\n            rtl: this.#rtl,\n            background: this.#view.docBackground,\n        }))\n        this.#scrollToAnchor(this.#anchor)\n    }\n    get scrolled() {\n        return this.getAttribute('flow') === 'scrolled'\n    }\n    get scrollProp() {\n        const { scrolled } = this\n        return this.#vertical ? (scrolled ? 'scrollLeft' : 'scrollTop')\n            : scrolled ? 'scrollTop' : 'scrollLeft'\n    }\n    get sideProp() {\n        const { scrolled } = this\n        return this.#vertical ? (scrolled ? 'width' : 'height')\n            : scrolled ? 'height' : 'width'\n    }\n    get size() {\n        return this.#container.getBoundingClientRect()[this.sideProp]\n    }\n    get viewSize() {\n        if (!this.#view || !this.#view.element) return 0\n        return this.#view.element.getBoundingClientRect()[this.sideProp]\n    }\n    get start() {\n        return Math.abs(this.#container[this.scrollProp])\n    }\n    get end() {\n        return this.start + this.size\n    }\n    get page() {\n        return Math.floor(((this.start + this.end) / 2) / this.size)\n    }\n    get pages() {\n        return Math.round(this.viewSize / this.size)\n    }\n    get containerPosition() {\n        return this.#container[this.scrollProp]\n    }\n    get isOverflowX() {\n        return false\n    }\n    get isOverflowY() {\n        return false\n    }\n    set containerPosition(newVal) {\n        this.#container[this.scrollProp] = newVal\n    }\n    set scrollLocked(value) {\n        this.#scrollLocked = value\n    }\n\n    scrollBy(dx, dy) {\n        const delta = this.#vertical ? dy : dx\n        const [offset, a, b] = this.#scrollBounds\n        const rtl = this.#rtl\n        const min = rtl ? offset - b : offset - a\n        const max = rtl ? offset + a : offset + b\n        this.containerPosition = Math.max(min, Math.min(max,\n            this.containerPosition + delta))\n    }\n\n    snap(vx, vy) {\n        const velocity = this.#vertical ? vy : vx\n        const horizontal = Math.abs(vx) * 2 > Math.abs(vy)\n        const orthogonal = this.#vertical ? !horizontal : horizontal\n        const [offset, a, b] = this.#scrollBounds\n        const { start, end, pages, size } = this\n        const min = Math.abs(offset) - a\n        const max = Math.abs(offset) + b\n        const d = velocity * (this.#rtl ? -size : size) * (orthogonal ? 1 : 0)\n        const page = Math.floor(\n            Math.max(min, Math.min(max, (start + end) / 2\n                + (isNaN(d) ? 0 : d * 2))) / size)\n\n        this.#scrollToPage(page, 'snap').then(() => {\n            const dir = page <= 0 ? -1 : page >= pages - 1 ? 1 : null\n            if (dir) return this.#goTo({\n                index: this.#adjacentIndex(dir),\n                anchor: dir < 0 ? () => 1 : () => 0,\n            })\n        })\n    }\n    #onTouchStart(e) {\n        const touch = e.changedTouches[0]\n        this.#touchState = {\n            x: touch?.screenX, y: touch?.screenY,\n            t: e.timeStamp,\n            vx: 0, xy: 0,\n            dx: 0, dy: 0,\n        }\n    }\n    #onTouchMove(e) {\n        const state = this.#touchState\n        if (state.pinched) return\n        state.pinched = globalThis.visualViewport.scale > 1\n        if (this.scrolled || state.pinched) return\n        if (e.touches.length > 1) {\n            if (this.#touchScrolled) e.preventDefault()\n            return\n        }\n        const doc = this.#view?.document\n        const selection = doc?.getSelection()\n        if (selection && selection.rangeCount > 0 && !selection.isCollapsed) {\n            return\n        }\n        const touch = e.changedTouches[0]\n        const isStylus = touch.touchType === 'stylus'\n        if (!isStylus) e.preventDefault()\n        if (this.#scrollLocked) return\n        const x = touch.screenX, y = touch.screenY\n        const dx = state.x - x, dy = state.y - y\n        const dt = e.timeStamp - state.t\n        state.x = x\n        state.y = y\n        state.t = e.timeStamp\n        state.vx = dx / dt\n        state.vy = dy / dt\n        state.dx += dx\n        state.dy += dy\n        this.#touchScrolled = true\n        if (!this.hasAttribute('animated') || this.hasAttribute('eink')) return\n        if (!this.#vertical && Math.abs(state.dx) >= Math.abs(state.dy) && !this.hasAttribute('eink') && (!isStylus || Math.abs(dx) > 1)) {\n            this.scrollBy(dx, 0)\n        } else if (this.#vertical && Math.abs(state.dx) < Math.abs(state.dy) && !this.hasAttribute('eink') && (!isStylus || Math.abs(dy) > 1)) {\n            this.scrollBy(0, dy)\n        }\n    }\n    #onTouchEnd() {\n        if (!this.#touchScrolled) return\n        this.#touchScrolled = false\n        if (this.scrolled) return\n\n        // XXX: Firefox seems to report scale as 1... sometimes...?\n        // at this point I'm basically throwing `requestAnimationFrame` at\n        // anything that doesn't work\n        requestAnimationFrame(() => {\n            if (globalThis.visualViewport.scale === 1)\n                this.snap(this.#touchState.vx, this.#touchState.vy)\n        })\n    }\n    // allows one to process rects as if they were LTR and horizontal\n    #getRectMapper() {\n        if (this.scrolled) {\n            const size = this.viewSize\n            const marginTop = this.#marginTop\n            const marginBottom = this.#marginBottom\n            return this.#vertical\n                ? ({ left, right }) =>\n                    ({ left: size - right - marginTop, right: size - left - marginBottom })\n                : ({ top, bottom }) => ({ left: top - marginTop, right: bottom - marginBottom })\n        }\n        const pxSize = this.pages * this.size\n        return this.#rtl\n            ? ({ left, right }) =>\n                ({ left: pxSize - right, right: pxSize - left })\n            : this.#vertical\n                ? ({ top, bottom }) => ({ left: top, right: bottom })\n                : f => f\n    }\n    async #scrollToRect(rect, reason) {\n        if (this.scrolled) {\n            const offset = this.#getRectMapper()(rect).left - 4\n            return this.#scrollTo(offset, reason)\n        }\n        const offset = this.#getRectMapper()(rect).left\n        return this.#scrollToPage(Math.floor(offset / this.size) + (this.#rtl ? -1 : 1), reason)\n    }\n    async #scrollTo(offset, reason, smooth) {\n        const { size } = this\n        if (this.containerPosition === offset) {\n            this.#scrollBounds = [offset, this.atStart ? 0 : size, this.atEnd ? 0 : size]\n            this.#afterScroll(reason)\n            return\n        }\n        // FIXME: vertical-rl only, not -lr\n        if (this.scrolled && this.#vertical) offset = -offset\n        if ((reason === 'snap' || smooth) && this.hasAttribute('animated') && !this.hasAttribute('eink')) return animate(\n            this.containerPosition, offset, 300, easeOutQuad,\n            x => this.containerPosition = x,\n        ).then(() => {\n            this.#scrollBounds = [offset, this.atStart ? 0 : size, this.atEnd ? 0 : size]\n            this.#afterScroll(reason)\n        })\n        else {\n            this.containerPosition = offset\n            this.#scrollBounds = [offset, this.atStart ? 0 : size, this.atEnd ? 0 : size]\n            this.#afterScroll(reason)\n        }\n    }\n    async #scrollToPage(page, reason, smooth) {\n        const offset = this.size * (this.#rtl ? -page : page)\n        return this.#scrollTo(offset, reason, smooth)\n    }\n    async scrollToAnchor(anchor, select) {\n        return this.#scrollToAnchor(anchor, select ? 'selection' : 'navigation')\n    }\n    async #scrollToAnchor(anchor, reason = 'anchor') {\n        this.#anchor = anchor\n        const rects = uncollapse(anchor)?.getClientRects?.()\n        // if anchor is an element or a range\n        if (rects) {\n            // when the start of the range is immediately after a hyphen in the\n            // previous column, there is an extra zero width rect in that column\n            const rect = Array.from(rects)\n                .find(r => r.width > 0 && r.height > 0 && r.x >= 0 && r.y >= 0) || rects[0]\n            if (!rect) return\n            await this.#scrollToRect(rect, reason)\n            // focus the element when navigating with keyboard or screen reader\n            if (reason === 'navigation') {\n                let node = anchor.focus ? anchor : undefined\n                if (!node && anchor.startContainer) {\n                    node = anchor.startContainer\n                    if (node.nodeType === Node.TEXT_NODE) {\n                        node = node.parentElement\n                    }\n                }\n                if (node && node.focus) {\n                    node.tabIndex = -1\n                    node.style.outline = 'none'\n                    node.focus({ preventScroll: true })\n                }\n            }\n            return\n        }\n        // if anchor is a fraction\n        if (this.scrolled) {\n            await this.#scrollTo(anchor * this.viewSize, reason)\n            return\n        }\n        const { pages } = this\n        if (!pages) return\n        const textPages = pages - 2\n        const newPage = Math.round(anchor * (textPages - 1))\n        await this.#scrollToPage(newPage + 1, reason)\n    }\n    #getVisibleRange() {\n        if (this.scrolled) return getVisibleRange(this.#view.document,\n            this.start, this.end, this.#getRectMapper())\n        const size = this.#rtl ? -this.size : this.size\n        return getVisibleRange(this.#view.document,\n            this.start - size, this.end - size, this.#getRectMapper())\n    }\n    #afterScroll(reason) {\n        const range = this.#getVisibleRange()\n        this.#lastVisibleRange = range\n        // don't set new anchor if relocation was to scroll to anchor\n        if (reason !== 'selection' && reason !== 'navigation' && reason !== 'anchor')\n            this.#anchor = range\n        else this.#justAnchored = true\n\n        const index = this.#index\n        const detail = { reason, range, index }\n        if (this.scrolled) detail.fraction = this.start / this.viewSize\n        else if (this.pages > 0) {\n            const { page, pages } = this\n            this.#header.style.visibility = page > 1 ? 'visible' : 'hidden'\n            detail.fraction = (page - 1) / (pages - 2)\n            detail.size = 1 / (pages - 2)\n        }\n        this.dispatchEvent(new CustomEvent('relocate', { detail }))\n    }\n    async #display(promise) {\n        const { index, src, data, anchor, onLoad, select } = await promise\n        this.#index = index\n        const hasFocus = this.#view?.document?.hasFocus()\n        if (src) {\n            const view = this.#createView()\n            const afterLoad = doc => {\n                if (doc.head) {\n                    const $styleBefore = doc.createElement('style')\n                    doc.head.prepend($styleBefore)\n                    const $style = doc.createElement('style')\n                    doc.head.append($style)\n                    this.#styleMap.set(doc, [$styleBefore, $style])\n                }\n                onLoad?.({ doc, index })\n            }\n            const beforeRender = this.#beforeRender.bind(this)\n            await view.load(src, data, afterLoad, beforeRender)\n            this.dispatchEvent(new CustomEvent('create-overlayer', {\n                detail: {\n                    doc: view.document, index,\n                    attach: overlayer => view.overlayer = overlayer,\n                },\n            }))\n            this.#view = view\n        }\n        await this.scrollToAnchor((typeof anchor === 'function'\n            ? anchor(this.#view.document) : anchor) ?? 0, select)\n        if (hasFocus) this.focusView()\n    }\n    #canGoToIndex(index) {\n        return index >= 0 && index <= this.sections.length - 1\n    }\n    async #goTo({ index, anchor, select }) {\n        if (index === this.#index) await this.#display({ index, anchor, select })\n        else {\n            const oldIndex = this.#index\n            const onLoad = detail => {\n                this.sections[oldIndex]?.unload?.()\n                this.setStyles(this.#styles)\n                this.dispatchEvent(new CustomEvent('load', { detail }))\n            }\n            await this.#display(Promise.resolve(this.sections[index].load())\n                .then(async src => {\n                    const data = await this.sections[index].loadContent?.()\n                    return { index, src, data, anchor, onLoad, select }\n                }).catch(e => {\n                    console.warn(e)\n                    console.warn(new Error(`Failed to load section ${index}`))\n                    return {}\n                }))\n        }\n    }\n    async goTo(target) {\n        if (this.#locked) return\n        const resolved = await target\n        if (this.#canGoToIndex(resolved.index)) return this.#goTo(resolved)\n    }\n    #scrollPrev(distance) {\n        if (!this.#view) return true\n        if (this.scrolled) {\n            if (this.start > 0) return this.#scrollTo(\n                Math.max(0, this.start - (distance ?? this.size)), null, true)\n            return !this.atStart\n        }\n        if (this.atStart) return\n        const page = this.page - 1\n        return this.#scrollToPage(page, 'page', true).then(() => page <= 0)\n    }\n    #scrollNext(distance) {\n        if (!this.#view) return true\n        if (this.scrolled) {\n            if (this.viewSize - this.end > 2) return this.#scrollTo(\n                Math.min(this.viewSize, distance ? this.start + distance : this.end), null, true)\n            return !this.atEnd\n        }\n        if (this.atEnd) return\n        const page = this.page + 1\n        const pages = this.pages\n        return this.#scrollToPage(page, 'page', true).then(() => page >= pages - 1)\n    }\n    get atStart() {\n        return this.#adjacentIndex(-1) == null && this.page <= 1\n    }\n    get atEnd() {\n        return this.#adjacentIndex(1) == null && this.page >= this.pages - 2\n    }\n    #adjacentIndex(dir) {\n        for (let index = this.#index + dir; this.#canGoToIndex(index); index += dir)\n            if (this.sections[index]?.linear !== 'no') return index\n    }\n    async #turnPage(dir, distance) {\n        if (this.#locked) return\n        this.#locked = true\n        const prev = dir === -1\n        const shouldGo = await (prev ? this.#scrollPrev(distance) : this.#scrollNext(distance))\n        if (shouldGo) await this.#goTo({\n            index: this.#adjacentIndex(dir),\n            anchor: prev ? () => 1 : () => 0,\n        })\n        if (shouldGo || !this.hasAttribute('animated')) await wait(100)\n        this.#locked = false\n    }\n    async prev(distance) {\n        return await this.#turnPage(-1, distance)\n    }\n    async next(distance) {\n        return await this.#turnPage(1, distance)\n    }\n    async pan(dx, dy) {\n        if (this.#locked) return\n        this.#locked = true\n        this.scrollBy(dx, dy)\n        this.#locked = false\n    }\n    prevSection() {\n        return this.goTo({ index: this.#adjacentIndex(-1) })\n    }\n    nextSection() {\n        return this.goTo({ index: this.#adjacentIndex(1) })\n    }\n    firstSection() {\n        const index = this.sections.findIndex(section => section.linear !== 'no')\n        return this.goTo({ index })\n    }\n    lastSection() {\n        const index = this.sections.findLastIndex(section => section.linear !== 'no')\n        return this.goTo({ index })\n    }\n    getContents() {\n        if (this.#view) return [{\n            index: this.#index,\n            overlayer: this.#view.overlayer,\n            doc: this.#view.document,\n        }]\n        return []\n    }\n    setStyles(styles) {\n        this.#styles = styles\n        const $$styles = this.#styleMap.get(this.#view?.document)\n        if (!$$styles) return\n        const [$beforeStyle, $style] = $$styles\n        if (Array.isArray(styles)) {\n            const [beforeStyle, style] = styles\n            $beforeStyle.textContent = beforeStyle\n            $style.textContent = style\n        } else $style.textContent = styles\n\n        // NOTE: needs `requestAnimationFrame` in Chromium\n        requestAnimationFrame(() => {\n            this.#replaceBackground(this.#view.docBackground, this.columnCount)\n        })\n\n        // needed because the resize observer doesn't work in Firefox\n        this.#view?.document?.fonts?.ready?.then(() => this.#view.expand())\n    }\n    focusView() {\n        this.#view.document.defaultView.focus()\n    }\n    destroy() {\n        this.#observer.unobserve(this)\n        this.#view.destroy()\n        this.#view = null\n        this.sections[this.#index]?.unload?.()\n        this.#mediaQuery.removeEventListener('change', this.#mediaQueryListener)\n    }\n}\n\ncustomElements.define('foliate-paginator', Paginator)\n"],"names":[],"mappings":"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"}