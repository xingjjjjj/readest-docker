{"version":3,"sources":["../../../../../../node_modules/.pnpm/construct-style-sheets-polyfill%403.1.0/node_modules/construct-style-sheets-polyfill/dist/adoptedStyleSheets.js","../../../../../../packages/foliate-js/fixed-layout.js"],"sourcesContent":["(function () {\n    'use strict';\n\n    if (typeof document === 'undefined' || 'adoptedStyleSheets' in document) { return; }\n\n    var hasShadyCss = 'ShadyCSS' in window && !ShadyCSS.nativeShadow;\n    var bootstrapper = document.implementation.createHTMLDocument('');\n    var closedShadowRootRegistry = new WeakMap();\n    var _DOMException = typeof DOMException === 'object' ? Error : DOMException;\n    var defineProperty = Object.defineProperty;\n    var forEach = Array.prototype.forEach;\n\n    var importPattern = /@import.+?;?$/gm;\n    function rejectImports(contents) {\n        var _contents = contents.replace(importPattern, '');\n        if (_contents !== contents) {\n            console.warn('@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418');\n        }\n        return _contents.trim();\n    }\n    function isElementConnected(element) {\n        return 'isConnected' in element\n            ? element.isConnected\n            : document.contains(element);\n    }\n    function unique(arr) {\n        return arr.filter(function (value, index) { return arr.indexOf(value) === index; });\n    }\n    function diff(arr1, arr2) {\n        return arr1.filter(function (value) { return arr2.indexOf(value) === -1; });\n    }\n    function removeNode(node) {\n        node.parentNode.removeChild(node);\n    }\n    function getShadowRoot(element) {\n        return element.shadowRoot || closedShadowRootRegistry.get(element);\n    }\n\n    var cssStyleSheetMethods = [\n        'addRule',\n        'deleteRule',\n        'insertRule',\n        'removeRule',\n    ];\n    var NonConstructedStyleSheet = CSSStyleSheet;\n    var nonConstructedProto = NonConstructedStyleSheet.prototype;\n    nonConstructedProto.replace = function () {\n        return Promise.reject(new _DOMException(\"Can't call replace on non-constructed CSSStyleSheets.\"));\n    };\n    nonConstructedProto.replaceSync = function () {\n        throw new _DOMException(\"Failed to execute 'replaceSync' on 'CSSStyleSheet': Can't call replaceSync on non-constructed CSSStyleSheets.\");\n    };\n    function isCSSStyleSheetInstance(instance) {\n        return typeof instance === 'object'\n            ? proto$1.isPrototypeOf(instance) ||\n                nonConstructedProto.isPrototypeOf(instance)\n            : false;\n    }\n    function isNonConstructedStyleSheetInstance(instance) {\n        return typeof instance === 'object'\n            ? nonConstructedProto.isPrototypeOf(instance)\n            : false;\n    }\n    var $basicStyleElement = new WeakMap();\n    var $locations = new WeakMap();\n    var $adoptersByLocation = new WeakMap();\n    var $appliedMethods = new WeakMap();\n    function addAdopterLocation(sheet, location) {\n        var adopter = document.createElement('style');\n        $adoptersByLocation.get(sheet).set(location, adopter);\n        $locations.get(sheet).push(location);\n        return adopter;\n    }\n    function getAdopterByLocation(sheet, location) {\n        return $adoptersByLocation.get(sheet).get(location);\n    }\n    function removeAdopterLocation(sheet, location) {\n        $adoptersByLocation.get(sheet).delete(location);\n        $locations.set(sheet, $locations.get(sheet).filter(function (_location) { return _location !== location; }));\n    }\n    function restyleAdopter(sheet, adopter) {\n        requestAnimationFrame(function () {\n            adopter.textContent = $basicStyleElement.get(sheet).textContent;\n            $appliedMethods\n                .get(sheet)\n                .forEach(function (command) {\n                return adopter.sheet[command.method].apply(adopter.sheet, command.args);\n            });\n        });\n    }\n    function checkInvocationCorrectness(self) {\n        if (!$basicStyleElement.has(self)) {\n            throw new TypeError('Illegal invocation');\n        }\n    }\n    function ConstructedStyleSheet() {\n        var self = this;\n        var style = document.createElement('style');\n        bootstrapper.body.appendChild(style);\n        $basicStyleElement.set(self, style);\n        $locations.set(self, []);\n        $adoptersByLocation.set(self, new WeakMap());\n        $appliedMethods.set(self, []);\n    }\n    var proto$1 = ConstructedStyleSheet.prototype;\n    proto$1.replace = function replace(contents) {\n        try {\n            this.replaceSync(contents);\n            return Promise.resolve(this);\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    };\n    proto$1.replaceSync = function replaceSync(contents) {\n        checkInvocationCorrectness(this);\n        if (typeof contents === 'string') {\n            var self_1 = this;\n            $basicStyleElement.get(self_1).textContent = rejectImports(contents);\n            $appliedMethods.set(self_1, []);\n            $locations.get(self_1).forEach(function (location) {\n                if (location.isConnected()) {\n                    restyleAdopter(self_1, getAdopterByLocation(self_1, location));\n                }\n            });\n        }\n    };\n    defineProperty(proto$1, 'cssRules', {\n        configurable: true,\n        enumerable: true,\n        get: function cssRules() {\n            checkInvocationCorrectness(this);\n            return $basicStyleElement.get(this).sheet.cssRules;\n        },\n    });\n    defineProperty(proto$1, 'media', {\n        configurable: true,\n        enumerable: true,\n        get: function media() {\n            checkInvocationCorrectness(this);\n            return $basicStyleElement.get(this).sheet.media;\n        },\n    });\n    cssStyleSheetMethods.forEach(function (method) {\n        proto$1[method] = function () {\n            var self = this;\n            checkInvocationCorrectness(self);\n            var args = arguments;\n            $appliedMethods.get(self).push({ method: method, args: args });\n            $locations.get(self).forEach(function (location) {\n                if (location.isConnected()) {\n                    var sheet = getAdopterByLocation(self, location).sheet;\n                    sheet[method].apply(sheet, args);\n                }\n            });\n            var basicSheet = $basicStyleElement.get(self).sheet;\n            return basicSheet[method].apply(basicSheet, args);\n        };\n    });\n    defineProperty(ConstructedStyleSheet, Symbol.hasInstance, {\n        configurable: true,\n        value: isCSSStyleSheetInstance,\n    });\n\n    var defaultObserverOptions = {\n        childList: true,\n        subtree: true,\n    };\n    var locations = new WeakMap();\n    function getAssociatedLocation(element) {\n        var location = locations.get(element);\n        if (!location) {\n            location = new Location(element);\n            locations.set(element, location);\n        }\n        return location;\n    }\n    function attachAdoptedStyleSheetProperty(constructor) {\n        defineProperty(constructor.prototype, 'adoptedStyleSheets', {\n            configurable: true,\n            enumerable: true,\n            get: function () {\n                return getAssociatedLocation(this).sheets;\n            },\n            set: function (sheets) {\n                getAssociatedLocation(this).update(sheets);\n            },\n        });\n    }\n    function traverseWebComponents(node, callback) {\n        var iter = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT, function (foundNode) {\n            return getShadowRoot(foundNode)\n                ? NodeFilter.FILTER_ACCEPT\n                : NodeFilter.FILTER_REJECT;\n        },\n        null, false);\n        for (var next = void 0; (next = iter.nextNode());) {\n            callback(getShadowRoot(next));\n        }\n    }\n    var $element = new WeakMap();\n    var $uniqueSheets = new WeakMap();\n    var $observer = new WeakMap();\n    function isExistingAdopter(self, element) {\n        return (element instanceof HTMLStyleElement &&\n            $uniqueSheets.get(self).some(function (sheet) { return getAdopterByLocation(sheet, self); }));\n    }\n    function getAdopterContainer(self) {\n        var element = $element.get(self);\n        return element instanceof Document ? element.body : element;\n    }\n    function adopt(self) {\n        var styleList = document.createDocumentFragment();\n        var sheets = $uniqueSheets.get(self);\n        var observer = $observer.get(self);\n        var container = getAdopterContainer(self);\n        observer.disconnect();\n        sheets.forEach(function (sheet) {\n            styleList.appendChild(getAdopterByLocation(sheet, self) || addAdopterLocation(sheet, self));\n        });\n        container.insertBefore(styleList, null);\n        observer.observe(container, defaultObserverOptions);\n        sheets.forEach(function (sheet) {\n            restyleAdopter(sheet, getAdopterByLocation(sheet, self));\n        });\n    }\n    function Location(element) {\n        var self = this;\n        self.sheets = [];\n        $element.set(self, element);\n        $uniqueSheets.set(self, []);\n        $observer.set(self, new MutationObserver(function (mutations, observer) {\n            if (!document) {\n                observer.disconnect();\n                return;\n            }\n            mutations.forEach(function (mutation) {\n                if (!hasShadyCss) {\n                    forEach.call(mutation.addedNodes, function (node) {\n                        if (!(node instanceof Element)) {\n                            return;\n                        }\n                        traverseWebComponents(node, function (root) {\n                            getAssociatedLocation(root).connect();\n                        });\n                    });\n                }\n                forEach.call(mutation.removedNodes, function (node) {\n                    if (!(node instanceof Element)) {\n                        return;\n                    }\n                    if (isExistingAdopter(self, node)) {\n                        adopt(self);\n                    }\n                    if (!hasShadyCss) {\n                        traverseWebComponents(node, function (root) {\n                            getAssociatedLocation(root).disconnect();\n                        });\n                    }\n                });\n            });\n        }));\n    }\n    Location.prototype = {\n        isConnected: function () {\n            var element = $element.get(this);\n            return element instanceof Document\n                ? element.readyState !== 'loading'\n                : isElementConnected(element.host);\n        },\n        connect: function () {\n            var container = getAdopterContainer(this);\n            $observer.get(this).observe(container, defaultObserverOptions);\n            if ($uniqueSheets.get(this).length > 0) {\n                adopt(this);\n            }\n            traverseWebComponents(container, function (root) {\n                getAssociatedLocation(root).connect();\n            });\n        },\n        disconnect: function () {\n            $observer.get(this).disconnect();\n        },\n        update: function (sheets) {\n            var self = this;\n            var locationType = $element.get(self) === document ? 'Document' : 'ShadowRoot';\n            if (!Array.isArray(sheets)) {\n                throw new TypeError(\"Failed to set the 'adoptedStyleSheets' property on \" + locationType + \": Iterator getter is not callable.\");\n            }\n            if (!sheets.every(isCSSStyleSheetInstance)) {\n                throw new TypeError(\"Failed to set the 'adoptedStyleSheets' property on \" + locationType + \": Failed to convert value to 'CSSStyleSheet'\");\n            }\n            if (sheets.some(isNonConstructedStyleSheetInstance)) {\n                throw new TypeError(\"Failed to set the 'adoptedStyleSheets' property on \" + locationType + \": Can't adopt non-constructed stylesheets\");\n            }\n            self.sheets = sheets;\n            var oldUniqueSheets = $uniqueSheets.get(self);\n            var uniqueSheets = unique(sheets);\n            var removedSheets = diff(oldUniqueSheets, uniqueSheets);\n            removedSheets.forEach(function (sheet) {\n                removeNode(getAdopterByLocation(sheet, self));\n                removeAdopterLocation(sheet, self);\n            });\n            $uniqueSheets.set(self, uniqueSheets);\n            if (self.isConnected() && uniqueSheets.length > 0) {\n                adopt(self);\n            }\n        },\n    };\n\n    window.CSSStyleSheet = ConstructedStyleSheet;\n    attachAdoptedStyleSheetProperty(Document);\n    if ('ShadowRoot' in window) {\n        attachAdoptedStyleSheetProperty(ShadowRoot);\n        var proto = Element.prototype;\n        var attach_1 = proto.attachShadow;\n        proto.attachShadow = function attachShadow(init) {\n            var root = attach_1.call(this, init);\n            if (init.mode === 'closed') {\n                closedShadowRootRegistry.set(this, root);\n            }\n            return root;\n        };\n    }\n    var documentLocation = getAssociatedLocation(document);\n    if (documentLocation.isConnected()) {\n        documentLocation.connect();\n    }\n    else {\n        document.addEventListener('DOMContentLoaded', documentLocation.connect.bind(documentLocation));\n    }\n\n}());\n","import 'construct-style-sheets-polyfill'\n\nconst parseViewport = str => str\n    ?.split(/[,;\\s]/) // NOTE: technically, only the comma is valid\n    ?.filter(x => x)\n    ?.map(x => x.split('=').map(x => x.trim()))\n\nconst getViewport = (doc, viewport) => {\n    // use `viewBox` for SVG\n    if (doc.documentElement.localName === 'svg') {\n        const [, , width, height] = doc.documentElement\n            .getAttribute('viewBox')?.split(/\\s/) ?? []\n        return { width, height }\n    }\n\n    // get `viewport` `meta` element\n    const meta = parseViewport(doc.querySelector('meta[name=\"viewport\"]')\n        ?.getAttribute('content'))\n    if (meta) return Object.fromEntries(meta)\n\n    // fallback to book's viewport\n    if (typeof viewport === 'string') return parseViewport(viewport)\n    if (viewport?.width && viewport.height) return viewport\n\n    // if no viewport (possibly with image directly in spine), get image size\n    const img = doc.querySelector('img')\n    if (img) return { width: img.naturalWidth, height: img.naturalHeight }\n\n    // just show *something*, i guess...\n    console.warn(new Error('Missing viewport properties'))\n    return { width: 1000, height: 2000 }\n}\n\nexport class FixedLayout extends HTMLElement {\n    static observedAttributes = ['zoom', 'scale-factor', 'spread']\n    #root = this.attachShadow({ mode: 'open' })\n    #observer = new ResizeObserver(() => this.#render())\n    #spreads\n    #index = -1\n    defaultViewport\n    spread\n    #portrait = false\n    #left\n    #right\n    #center\n    #side\n    #zoom\n    #scaleFactor = 1.0\n    #totalScaleFactor = 1.0\n    #scrollLocked = false\n    #isOverflowX = false\n    #isOverflowY = false\n    #preloadCache = new Map()\n    #prerenderedSpreads = new Map()\n    #spreadAccessTime = new Map()\n    #maxConcurrentPreloads = 1\n    #numPrerenderedSpreads = 1\n    #maxCachedSpreads = 2\n    #preloadQueue = []\n    #activePreloads = 0\n    constructor() {\n        super()\n\n        const sheet = new CSSStyleSheet()\n        this.#root.adoptedStyleSheets = [sheet]\n        sheet.replaceSync(`:host {\n            width: 100%;\n            height: 100%;\n            display: flex;\n            justify-content: flex-start;\n            align-items: center;\n            overflow: auto;\n        }\n        @supports (justify-content: safe center) {\n          :host {\n            justify-content: safe center;\n          }\n        }`)\n\n        this.#observer.observe(this)\n    }\n    attributeChangedCallback(name, _, value) {\n        switch (name) {\n            case 'zoom':\n                this.#zoom = value !== 'fit-width' && value !== 'fit-page'\n                    ? parseFloat(value) : value\n                this.#render()\n                break\n            case 'scale-factor':\n                this.#scaleFactor = parseFloat(value) / 100\n                this.#render()\n                break\n            case 'spread':\n                this.#respread(value)\n                break\n        }\n    }\n    async #createFrame({ index, src: srcOption, detached = false }) {\n        const srcOptionIsString = typeof srcOption === 'string'\n        const src = srcOptionIsString ? srcOption : srcOption?.src\n        const data = srcOptionIsString ? null : srcOption?.data\n        const onZoom = srcOptionIsString ? null : srcOption?.onZoom\n        const element = document.createElement('div')\n        element.setAttribute('dir', 'ltr')\n        const iframe = document.createElement('iframe')\n        element.append(iframe)\n        Object.assign(iframe.style, {\n            border: '0',\n            display: 'none',\n            overflow: 'hidden',\n        })\n        // `allow-scripts` is needed for events because of WebKit bug\n        // https://bugs.webkit.org/show_bug.cgi?id=218086\n        iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts')\n        iframe.setAttribute('scrolling', 'no')\n        iframe.setAttribute('part', 'filter')\n        this.#root.append(element)\n\n        if (detached) {\n            Object.assign(element.style, {\n                position: 'absolute',\n                visibility: 'hidden',\n                pointerEvents: 'none',\n            })\n        }\n\n        if (!src) return { blank: true, element, iframe }\n        return new Promise(resolve => {\n            iframe.addEventListener('load', () => {\n                const doc = iframe.contentDocument\n                this.dispatchEvent(new CustomEvent('load', { detail: { doc, index } }))\n                const { width, height } = getViewport(doc, this.defaultViewport)\n                resolve({\n                    element, iframe,\n                    width: parseFloat(width),\n                    height: parseFloat(height),\n                    onZoom,\n                    detached,\n                })\n            }, { once: true })\n            if (data) {\n                iframe.srcdoc = data\n            } else {\n                iframe.src = src\n            }\n        })\n    }\n    #render(side = this.#side) {\n        if (!side) return\n        const left = this.#left ?? {}\n        const right = this.#center ?? this.#right ?? {}\n        const target = side === 'left' ? left : right\n        const { width, height } = this.getBoundingClientRect()\n        // for unfolded devices with slightly taller height than width also use landscape layout\n        const portrait = this.spread !== 'both' && this.spread !== 'portrait'\n            && height > width * 1.2\n        this.#portrait = portrait\n        const blankWidth = left.width ?? right.width ?? 0\n        const blankHeight = left.height ?? right.height ?? 0\n\n        let scale = typeof this.#zoom === 'number' && !isNaN(this.#zoom)\n            ? this.#zoom\n            : (this.#zoom === 'fit-width'\n                ? (portrait || this.#center\n                    ? width / (target.width ?? blankWidth)\n                    : width / ((left.width ?? blankWidth) + (right.width ?? blankWidth)))\n                : (portrait || this.#center\n                    ? Math.min(\n                        width / (target.width ?? blankWidth),\n                        height / (target.height ?? blankHeight))\n                    : Math.min(\n                        width / ((left.width ?? blankWidth) + (right.width ?? blankWidth)),\n                        height / Math.max(\n                            left.height ?? blankHeight,\n                            right.height ?? blankHeight)))\n            ) || 1\n\n        scale *= this.#scaleFactor\n        this.#totalScaleFactor = scale\n\n        const transform = ({frame, styles}) => {\n            let { element, iframe, width, height, blank, onZoom } = frame\n            if (!iframe) return\n            if (onZoom) onZoom({ doc: frame.iframe.contentDocument, scale })\n            const iframeScale = onZoom ? scale : 1\n            const zoomedOut = this.#scaleFactor < 1.0\n            Object.assign(iframe.style, {\n                width: `${width * iframeScale}px`,\n                height: `${height * iframeScale}px`,\n                transform: onZoom ? 'none' : `scale(${scale})`,\n                transformOrigin: 'top left',\n                display: blank ? 'none' : 'block',\n            })\n            Object.assign(element.style, {\n                width: `${(width ?? blankWidth) * scale}px`,\n                height: `${(height ?? blankHeight) * scale}px`,\n                flexShrink: '0',\n                display: zoomedOut ? 'flex' : 'block',\n                marginBlock: zoomedOut ? undefined : 'auto',\n                alignItems: zoomedOut ? 'center' : undefined,\n                justifyContent: zoomedOut ? 'center' : undefined,\n                ...styles,\n            })\n            if (portrait && frame !== target) {\n                element.style.display = 'none'\n            }\n\n            const container= element.parentNode.host\n            const containerWidth = container.clientWidth\n            const containerHeight = container.clientHeight\n            container.scrollLeft = (element.clientWidth - containerWidth) / 2\n\n            return {\n                width: element.clientWidth,\n                height: element.clientHeight,\n                containerWidth,\n                containerHeight,\n            }\n        }\n        if (this.#center) {\n            const dimensions = transform({frame: this.#center, styles: { marginInline: 'auto' }})\n            const {width, height, containerWidth, containerHeight} = dimensions\n            this.#isOverflowX = width > containerWidth\n            this.#isOverflowY = height > containerHeight\n        } else {\n            const leftDimensions = transform({frame: left, styles: { marginInlineStart: 'auto' }})\n            const rightDimensions = transform({frame: right, styles: { marginInlineEnd: 'auto' }})\n            const {width: leftWidth, height: leftHeight, containerWidth, containerHeight} = leftDimensions\n            const {width: rightWidth, height: rightHeight} = rightDimensions\n            this.#isOverflowX = leftWidth + rightWidth > containerWidth\n            this.#isOverflowY = Math.max(leftHeight, rightHeight) > containerHeight\n        }\n    }\n    async #showSpread({ left, right, center, side, spreadIndex }) {\n        this.#left = null\n        this.#right = null\n        this.#center = null\n\n        const cacheKey = spreadIndex !== undefined ? `spread-${spreadIndex}` : null\n        const prerendered = cacheKey ? this.#prerenderedSpreads.get(cacheKey) : null\n\n        if (prerendered) {\n            this.#spreadAccessTime.set(cacheKey, Date.now())\n            if (prerendered.center) {\n                this.#center = prerendered.center\n            } else {\n                this.#left = prerendered.left\n                this.#right = prerendered.right\n            }\n        } else {\n            if (center) {\n                this.#center = await this.#createFrame(center)\n                if (cacheKey) {\n                    this.#prerenderedSpreads.set(cacheKey, { center: this.#center })\n                    this.#spreadAccessTime.set(cacheKey, Date.now())\n                }\n            } else {\n                this.#left = await this.#createFrame(left)\n                this.#right = await this.#createFrame(right)\n                if (cacheKey) {\n                    this.#prerenderedSpreads.set(cacheKey, { left: this.#left, right: this.#right })\n                    this.#spreadAccessTime.set(cacheKey, Date.now())\n                }\n            }\n        }\n\n        this.#side = center ? 'center' : this.#left.blank ? 'right'\n            : this.#right.blank ? 'left' : side\n        const visibleFrames = center\n            ? [this.#center?.element]\n            : [this.#left?.element, this.#right?.element]\n\n        Array.from(this.#root.children).forEach(child => {\n            const isVisible = visibleFrames.includes(child)\n            Object.assign(child.style, {\n                position: isVisible ? 'relative' : 'absolute',\n                visibility: isVisible ? 'visible' : 'hidden',\n                pointerEvents: isVisible ? 'auto' : 'none',\n            })\n        })\n        this.#render()\n    }\n    #goLeft() {\n        if (this.#center || this.#left?.blank) return\n        if (this.#portrait && this.#left?.element?.style?.display === 'none') {\n            this.#side = 'left'\n            this.#render()\n            this.#reportLocation('page')\n            return true\n        }\n    }\n    #goRight() {\n        if (this.#center || this.#right?.blank) return\n        if (this.#portrait && this.#right?.element?.style?.display === 'none') {\n            this.#side = 'right'\n            this.#render()\n            this.#reportLocation('page')\n            return true\n        }\n    }\n    open(book) {\n        this.book = book\n        this.defaultViewport = book.rendition?.viewport\n        this.rtl = book.dir === 'rtl'\n\n        this.#spread()\n    }\n    #spread(mode) {\n        const book = this.book\n        const { rendition } = book\n        const rtl = this.rtl\n        const ltr = !rtl\n        this.spread = mode || rendition?.spread\n\n        if (this.spread === 'none')\n            this.#spreads = book.sections.map(section => ({ center: section }))\n        else this.#spreads = book.sections.reduce((arr, section, i) => {\n            const last = arr[arr.length - 1]\n            const { pageSpread } = section\n            const newSpread = () => {\n                const spread = {}\n                arr.push(spread)\n                return spread\n            }\n            if (pageSpread === 'center') {\n                const spread = last.left || last.right ? newSpread() : last\n                spread.center = section\n            }\n            else if (pageSpread === 'left') {\n                const spread = last.center || last.left || ltr && i ? newSpread() : last\n                spread.left = section\n            }\n            else if (pageSpread === 'right') {\n                const spread = last.center || last.right || rtl && i ? newSpread() : last\n                spread.right = section\n            }\n            else if (ltr) {\n                if (last.center || last.right) newSpread().left = section\n                else if (last.left || !i) last.right = section\n                else last.left = section\n            }\n            else {\n                if (last.center || last.left) newSpread().right = section\n                else if (last.right || !i) last.left = section\n                else last.right = section\n            }\n            return arr\n        }, [{}])\n    }\n    #respread(spreadMode) {\n        if (this.#index === -1) return\n        const section = this.book.sections[this.index]\n        this.#spread(spreadMode)\n        const { index } = this.getSpreadOf(section)\n        this.#index = -1\n        this.#preloadCache.clear()\n        for (const frames of this.#prerenderedSpreads.values()) {\n            if (frames.center) {\n                frames.center.element?.remove()\n            } else {\n                frames.left?.element?.remove()\n                frames.right?.element?.remove()\n            }\n        }\n        this.#prerenderedSpreads.clear()\n        this.#spreadAccessTime.clear()\n        this.goToSpread(index, this.rtl ? 'right' : 'left', 'page')\n    }\n    get index() {\n        const spread = this.#spreads[this.#index]\n        const section = spread?.center ?? (this.#side === 'left'\n            ? spread.left ?? spread.right : spread.right ?? spread.left)\n        return this.book.sections.indexOf(section)\n    }\n    get scrollLocked() {\n        return this.#scrollLocked\n    }\n    set scrollLocked(value) {\n        this.#scrollLocked = value\n    }\n    get isOverflowX() {\n        return this.#isOverflowX\n    }\n    get isOverflowY() {\n        return this.#isOverflowY\n    }\n    #reportLocation(reason) {\n        this.dispatchEvent(new CustomEvent('relocate', { detail:\n            { reason, range: null, index: this.index, fraction: 0, size: 1 } }))\n    }\n    getSpreadOf(section) {\n        const spreads = this.#spreads\n        for (let index = 0; index < spreads.length; index++) {\n            const { left, right, center } = spreads[index]\n            if (left === section) return { index, side: 'left' }\n            if (right === section) return { index, side: 'right' }\n            if (center === section) return { index, side: 'center' }\n        }\n    }\n    async goToSpread(index, side, reason) {\n        if (index < 0 || index > this.#spreads.length - 1) return\n        if (index === this.#index) {\n            this.#render(side)\n            return\n        }\n        this.#index = index\n        const spread = this.#spreads[index]\n        const cacheKey = `spread-${index}`\n        const cached = this.#preloadCache.get(cacheKey)\n        if (cached && cached !== 'loading') {\n            if (cached.center) {\n                const sectionIndex = this.book.sections.indexOf(spread.center)\n                await this.#showSpread({ center: { index: sectionIndex, src: cached.center }, spreadIndex: index, side })\n            } else {\n                const indexL = this.book.sections.indexOf(spread.left)\n                const indexR = this.book.sections.indexOf(spread.right)\n                const left = { index: indexL, src: cached.left }\n                const right = { index: indexR, src: cached.right }\n                await this.#showSpread({ left, right, side, spreadIndex: index })\n            }\n        } else {\n            if (spread.center) {\n                const sectionIndex = this.book.sections.indexOf(spread.center)\n                const src = await spread.center?.load?.()\n                await this.#showSpread({ center: { index: sectionIndex, src }, spreadIndex: index, side })\n            } else {\n                const indexL = this.book.sections.indexOf(spread.left)\n                const indexR = this.book.sections.indexOf(spread.right)\n                const srcL = await spread.left?.load?.()\n                const srcR = await spread.right?.load?.()\n                const left = { index: indexL, src: srcL }\n                const right = { index: indexR, src: srcR }\n                await this.#showSpread({ left, right, side, spreadIndex: index })\n            }\n        }\n\n        this.#reportLocation(reason)\n        this.#preloadNextSpreads()\n    }\n    #preloadNextSpreads() {\n        this.#cleanupPreloadCache()\n\n        if (this.#numPrerenderedSpreads <= 0) return\n\n        const toPreload = []\n        const forwardPreloadCount = Math.max(1, this.#numPrerenderedSpreads - 1)\n        const backwardPreloadCount = Math.max(0, this.#numPrerenderedSpreads - forwardPreloadCount)\n        for (let distance = 1; distance <= forwardPreloadCount; distance++) {\n            const forwardIndex = this.#index + distance\n            if (forwardIndex >= 0 && forwardIndex < this.#spreads.length) {\n                toPreload.push({ index: forwardIndex, direction: 'forward', distance })\n            }\n        }\n        for (let distance = 1; distance <= backwardPreloadCount; distance++) {\n            const backwardIndex = this.#index - distance\n            if (backwardIndex >= 0 && backwardIndex < this.#spreads.length) {\n                toPreload.push({ index: backwardIndex, direction: 'backward', distance })\n            }\n        }\n        for (const { index: targetIndex, direction } of toPreload) {\n            const cacheKey = `spread-${targetIndex}`\n            if (this.#prerenderedSpreads.has(cacheKey)) continue\n            const spread = this.#spreads[targetIndex]\n            if (!spread) continue\n            this.#preloadQueue.push({ targetIndex, direction, spread, cacheKey })\n        }\n\n        this.#processPreloadQueue()\n    }\n\n    async #processPreloadQueue() {\n        while (this.#preloadQueue.length > 0 && this.#activePreloads < this.#maxConcurrentPreloads) {\n            const task = this.#preloadQueue.shift()\n            if (!task) break\n\n            const { spread, cacheKey } = task\n            this.#preloadCache.set(cacheKey, 'loading')\n            this.#activePreloads++\n            Promise.resolve().then(async () => {\n                try {\n                    if (spread.center) {\n                        const src = await spread.center?.load?.()\n                        this.#preloadCache.set(cacheKey, { center: src })\n\n                        const sectionIndex = this.book.sections.indexOf(spread.center)\n                        const frame = await this.#createFrame({ index: sectionIndex, src, detached: true })\n\n                        this.#prerenderedSpreads.set(cacheKey, { center: frame })\n                        this.#spreadAccessTime.set(cacheKey, Date.now())\n                        if (frame.onZoom) {\n                            const doc = frame.iframe.contentDocument\n                            frame.onZoom({ doc, scale: this.#totalScaleFactor })\n                        }\n                    } else {\n                        const srcL = await spread.left?.load?.()\n                        const srcR = await spread.right?.load?.()\n                        this.#preloadCache.set(cacheKey, { left: srcL, right: srcR })\n\n                        const indexL = this.book.sections.indexOf(spread.left)\n                        const indexR = this.book.sections.indexOf(spread.right)\n                        const leftFrame = await this.#createFrame({ index: indexL, src: srcL, detached: true })\n                        const rightFrame = await this.#createFrame({ index: indexR, src: srcR, detached: true })\n\n                        this.#prerenderedSpreads.set(cacheKey, { left: leftFrame, right: rightFrame })\n                        this.#spreadAccessTime.set(cacheKey, Date.now())\n\n                        if (leftFrame.onZoom) {\n                            const docL = leftFrame.iframe.contentDocument\n                            leftFrame.onZoom({ doc: docL, scale: this.#totalScaleFactor })\n                        }\n                        if (rightFrame.onZoom) {\n                            const docR = rightFrame.iframe.contentDocument\n                            rightFrame.onZoom({ doc: docR, scale: this.#totalScaleFactor })\n                        }\n                    }\n                } catch {\n                    this.#preloadCache.delete(cacheKey)\n                    this.#prerenderedSpreads.delete(cacheKey)\n                } finally {\n                    this.#activePreloads--\n                    this.#processPreloadQueue()\n                }\n            })\n        }\n    }\n    #cleanupPreloadCache() {\n        const maxSpreads = this.#maxCachedSpreads\n        if (this.#prerenderedSpreads.size <= maxSpreads) {\n            return\n        }\n\n        const framesByAge = Array.from(this.#prerenderedSpreads.keys())\n            .map(key => ({\n                key,\n                accessTime: this.#spreadAccessTime.get(key) || 0,\n            }))\n            .sort((a, b) => a.accessTime - b.accessTime)\n\n        const numToRemove = this.#prerenderedSpreads.size - maxSpreads\n        const framesToDelete = framesByAge.slice(0, numToRemove).map(item => item.key)\n\n        if (framesToDelete.length > 0) {\n            framesToDelete.forEach(key => {\n                const frames = this.#prerenderedSpreads.get(key)\n                if (frames) {\n                    if (frames.center) {\n                        frames.center.element?.remove()\n                    } else {\n                        frames.left?.element?.remove()\n                        frames.right?.element?.remove()\n                    }\n                }\n\n                this.#prerenderedSpreads.delete(key)\n                this.#spreadAccessTime.delete(key)\n                this.#preloadCache.delete(key)\n            })\n        }\n    }\n    async select(target) {\n        await this.goTo(target)\n        // TODO\n    }\n    async goTo(target) {\n        const { book } = this\n        const resolved = await target\n        const section = book.sections[resolved.index]\n        if (!section) return\n        const { index, side } = this.getSpreadOf(section)\n        await this.goToSpread(index, side)\n    }\n    async next() {\n        const s = this.rtl ? this.#goLeft() : this.#goRight()\n        if (!s) return this.goToSpread(this.#index + 1, this.rtl ? 'right' : 'left', 'page')\n    }\n    async prev() {\n        const s = this.rtl ? this.#goRight() : this.#goLeft()\n        if (!s) return this.goToSpread(this.#index - 1, this.rtl ? 'left' : 'right', 'page')\n    }\n    async pan(dx, dy) {\n        if (this.#scrollLocked) return\n        this.#scrollLocked = true\n\n        const transform = frame => {\n            let { element, iframe } = frame\n            if (!iframe || !element) return\n\n            const scrollableContainer = element.parentNode.host\n            scrollableContainer.scrollLeft += dx\n            scrollableContainer.scrollTop += dy\n        }\n\n        transform(this.#center ?? this.#right ?? {})\n        this.#scrollLocked = false\n    }\n    getContents() {\n        return Array.from(this.#root.querySelectorAll('iframe'), frame => ({\n            doc: frame.contentDocument,\n            // TODO: index, overlayer\n        }))\n    }\n    destroy() {\n        this.#observer.unobserve(this)\n        for (const frames of this.#prerenderedSpreads.values()) {\n            if (frames.center) {\n                frames.center.element?.remove()\n            } else {\n                frames.left?.element?.remove()\n                frames.right?.element?.remove()\n            }\n        }\n        this.#prerenderedSpreads.clear()\n        this.#preloadCache.clear()\n        this.#spreadAccessTime.clear()\n    }\n}\n\ncustomElements.define('foliate-fxl', FixedLayout)\n"],"names":[],"mappings":"kCAAC,WACG,aAEA,GAAwB,AAApB,oBAAO,YAA4B,uBAAwB,QAAA,GAAU,AAEzE,IAAI,EAAc,aAAc,QAAU,CAAC,SAAS,YAAY,CAC5D,EAAe,SAAS,cAAc,CAAC,kBAAkB,CAAC,IAC1D,EAA2B,IAAI,QAC/B,EAAwC,UAAxB,OAAO,aAA4B,MAAQ,aAC3D,EAAiB,OAAO,cAAc,CACtC,EAAU,MAAM,SAAS,CAAC,OAAO,CAEjC,EAAgB,kBAiChB,EAD2B,AACL,cAAyB,SAAS,CAC5D,EAAoB,OAAO,CAAG,WAC1B,OAAO,QAAQ,MAAM,CAAC,IAAI,EAAc,yDAC5C,EACA,EAAoB,WAAW,CAAG,WAC9B,MAAM,IAAI,EAAc,gHAC5B,EAYA,IAAI,EAAqB,IAAI,QACzB,EAAa,IAAI,QACjB,EAAsB,IAAI,QAC1B,EAAkB,IAAI,QAsCtB,EAAU,EAAsB,SAAS,CAC7C,EAAQ,OAAO,CAAG,SAAS,AAAQ,CAAQ,EACvC,GAAI,CAEA,OADA,IAAI,CAAC,WAAW,CAAC,GACV,QAAQ,OAAO,CAAC,IAAI,CAC/B,CACA,MAAO,EAAG,CACN,OAAO,QAAQ,MAAM,CAAC,EAC1B,CACJ,EACA,EAAQ,WAAW,CAAG,SAAS,AAAY,CAAQ,EAE/C,GADA,EAA2B,IAAI,EACP,UAApB,OAAO,EAAuB,CAC9B,QAAI,EAAS,IAAI,CACjB,EAAmB,GAAG,CAAC,GAAQ,WAAW,EAvG1C,CAuG6C,AAxG7C,EAAY,CADG,EAyG4C,GAxGtC,GADE,IACK,CAAC,EAAe,OAC9B,GACd,OADwB,CAChB,IAAI,CAAC,2HAEV,EAAU,IAAI,IAqGjB,EAAgB,GAAG,CAAC,EAAQ,EAAE,EAC9B,EAAW,GAAG,CAAC,GAAQ,OAAO,CAAC,SAAU,CAAQ,EACzC,EAAS,WAAW,IAAI,AACxB,EAAe,EAAQ,EAAqB,EAAQ,GAE5D,EACJ,CACJ,EACA,EAAe,EAAS,WAAY,CAChC,cAAc,EACd,YAAY,EACZ,IAAK,SAAS,EAEV,OADA,EAA2B,IAAI,EACxB,EAAmB,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,QAAQ,AACtD,CACJ,GACA,EAAe,EAAS,QAAS,CAC7B,cAAc,EACd,YAAY,EACZ,IAAK,SAAS,EAEV,OADA,EAA2B,IAAI,EACxB,EAAmB,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,AACnD,CACJ,GACA,AAzG2B,CACvB,UACA,aACA,aACA,aACH,CAoGoB,OAAO,CAAC,SAAU,CAAM,EACzC,CAAO,CAAC,EAAO,CAAG,WACd,IAAI,EAAO,IAAI,CACf,EAA2B,GAC3B,IAAI,EAAO,UACX,EAAgB,GAAG,CAAC,GAAM,IAAI,CAAC,CAAE,OAAQ,EAAQ,KAAM,CAAK,GAC5D,EAAW,GAAG,CAAC,GAAM,OAAO,CAAC,SAAU,CAAQ,EAC3C,GAAI,EAAS,WAAW,GAAI,CACxB,IAAI,EAAQ,EAAqB,EAAM,GAAU,KAAK,CACtD,CAAK,CAAC,EAAO,CAAC,KAAK,CAAC,EAAO,EAC/B,CACJ,GACA,IAAI,EAAa,EAAmB,GAAG,CAAC,GAAM,KAAK,CACnD,OAAO,CAAU,CAAC,EAAO,CAAC,KAAK,CAAC,EAAY,EAChD,CACJ,GACA,EAAe,EAAuB,OAAO,WAAW,CAAE,CACtD,cAAc,EACd,MAAO,CACX,GAEA,IAAI,EAAyB,CACzB,WAAW,EACX,SAAS,CACb,EACI,EAAY,IAAI,QAgChB,EAAW,IAAI,QACf,EAAgB,IAAI,QACpB,EAAY,IAAI,QA8GpB,GAjDA,EAAS,SAAS,CAAG,CACjB,YAAa,WACT,MAAI,EAAU,EAAS,GAAG,CAAC,IAAI,EAC/B,OAAO,aAAmB,SACG,YAAvB,AACA,EADQ,UAAU,CAtPrB,gBADiB,CACA,CAuPK,EAAQ,GAxPN,CAwPU,EAtPnC,EAAQ,WAAW,CACnB,SAAS,QAAQ,CAAC,EAsPxB,EACA,QAAS,WACL,IAAI,EAAY,EAAoB,IAAI,EACxC,EAAU,GAAG,CAAC,IAAI,EAAE,OAAO,CAAC,EAAW,GACnC,EAAc,GAAG,CAAC,IAAI,EAAE,MAAM,CAAG,GAAG,AACpC,EAAM,IAAI,EAEd,EAAsB,EAAW,SAAU,CAAI,EAC3C,EAAsB,GAAM,OAAO,EACvC,EACJ,EACA,WAAY,WACR,EAAU,GAAG,CAAC,IAAI,EAAE,UAAU,EAClC,EACA,OAAQ,SAAU,CAAM,EACpB,MAhQM,EAAM,EAAF,AAgQN,EAhQY,AAgQL,IAAI,CACX,EAAe,EAAS,GAAG,CAAC,KAAU,SAAW,WAAa,aAClE,GAAI,CAAC,MAAM,OAAO,CAAC,GACf,MAAU,AAAJ,AADkB,UACJ,sDAAwD,EAAe,sCAE/F,GAAI,CAAC,EAAO,KAAK,CAAC,GACd,MAAM,AAAI,UAAU,OADoB,+CACoC,EAAe,gDAE/F,GAAI,EAAO,IAAI,CAAC,GACZ,MAAM,AAAI,UAAU,kBAD6B,oCAC2B,EAAe,6CAE/F,EAAK,MAAM,CAAG,EACd,IAAI,EAAkB,EAAc,GAAG,CAAC,GACpC,EA/QD,CADK,EAgRkB,CAhRf,EACJ,MAAM,CAAC,AA+QK,SA/QK,CAAK,CAAE,CAAK,EAAI,OAAO,EAAI,OAAO,CAAC,KAAW,CAAO,GAiR7E,GADyB,IAAiB,EA7QvC,EAAK,MAAM,CAAC,SAAU,CAAK,EAAI,OAA+B,CAAC,IAAzB,EAAK,OAAO,CAAC,EAAe,IA8QvD,OAAO,CAAC,SAAU,CAAK,UA/NP,EA5ClC,CADgB,EA6QG,EAAqB,AA7QpB,CA6CsB,CAgOK,IA5Q1C,UAAU,CAAC,WAAW,CAAC,GA4CD,EAiOG,GAjOE,CAiOK,EAhOrC,EAAoB,GAAG,CAAC,GAAO,MAAM,CAAC,GACtC,EAAW,GAAG,CAAC,EAAO,EAAW,GAAG,CAAC,GAAO,MAAM,CAAC,SAAU,CAAS,EAAI,OAAO,IAAc,CAAU,GAgOrG,GACA,EAAc,GAAG,CAAC,EAAM,GACpB,EAAK,WAAW,IAAM,EAAa,MAAM,CAAG,GAAG,AAC/C,EAAM,EAEd,CACJ,EAEA,OAAO,aAAa,CAAG,EACvB,EAAgC,UAC5B,eAAgB,OAAQ,CACxB,EAAgC,YAChC,IAAI,EAAQ,QAAQ,SAAS,CACzB,EAAW,EAAM,YAAY,CACjC,EAAM,YAAY,CAAG,SAAS,AAAa,CAAI,EAC3C,IAAI,EAAO,EAAS,IAAI,CAAC,IAAI,CAAE,GAI/B,MAHkB,UAAU,CAAxB,EAAK,IAAI,EACT,EAAyB,GAAG,CAAC,IAAI,CAAE,GAEhC,CACX,CACJ,CACA,IAAI,EAAmB,EAAsB,UACzC,EAAiB,WAAW,GAC5B,CADgC,CACf,OAAO,GAGxB,SAAS,gBAAgB,CAAC,mBAAoB,EAAiB,OAAO,CAAC,IAAI,CAAC,IAvShF,SAAS,EAAc,CAAO,EAC1B,OAAO,EAAQ,UAAU,EAAI,EAAyB,GAAG,CAAC,EAC9D,CAgBA,SAAS,EAAwB,CAAQ,EACrC,MAA2B,UAApB,OAAO,IACR,EAAQ,aAAa,CAAC,IACpB,EAAoB,aAAa,CAAC,EAAA,CAE9C,CACA,EAFU,OAED,EAAmC,CAAQ,EAChD,MAA2B,UAApB,OAAO,GACR,EAAoB,aAAa,CAAC,EAE5C,CAWA,SAZU,AAYD,EAAqB,CAAK,CAAE,CAAQ,EACzC,OAAO,EAAoB,GAAG,CAAC,GAAO,GAAG,CAAC,EAC9C,CAKA,SAAS,EAAe,CAAK,CAAE,CAAO,EAClC,sBAAsB,WAClB,EAAQ,WAAW,CAAG,EAAmB,GAAG,CAAC,GAAO,WAAW,CAC/D,EACK,GAAG,CAAC,GACJ,OAAO,CAAC,SAAU,CAAO,EAC1B,OAAO,EAAQ,KAAK,CAAC,EAAQ,MAAM,CAAC,CAAC,KAAK,CAAC,EAAQ,KAAK,CAAE,EAAQ,IAAI,CAC1E,EACJ,EACJ,CACA,SAAS,EAA2B,CAAI,EACpC,GAAI,CAAC,EAAmB,GAAG,CAAC,GACxB,IAD+B,EACzB,AAAI,UAAU,qBAE5B,CACA,SAAS,IAEL,IAAI,EAAQ,SAAS,aAAa,CAAC,SACnC,EAAa,IAAI,CAAC,WAAW,CAAC,GAC9B,EAAmB,GAAG,CAAC,KAAM,GAC7B,EAAW,GAAG,CAAC,KAAM,EAAE,EACvB,EAAoB,GAAG,CAAC,IALT,CAKe,IAAI,SAClC,EAAgB,GAAG,CANR,AAMS,KAAM,EAAE,CAChC,CAkEA,SAAS,EAAsB,CAAO,EAClC,IAAI,EAAW,EAAU,GAAG,CAAC,GAK7B,OAJK,IACD,EAAW,IAAI,AADJ,EACa,GACxB,EAAU,GAAG,CAAC,EAAS,IAEpB,CACX,CACA,SAAS,EAAgC,CAAW,EAChD,EAAe,EAAY,SAAS,CAAE,qBAAsB,CACxD,aAAc,GACd,YAAY,EACZ,IAAK,WACD,OAAO,EAAsB,IAAI,EAAE,MAAM,AAC7C,EACA,IAAK,SAAU,CAAM,EACjB,EAAsB,IAAI,EAAE,MAAM,CAAC,EACvC,CACJ,EACJ,CACA,SAAS,EAAsB,CAAI,CAAE,CAAQ,EAOzC,IAAK,IAND,EAAO,SAAS,kBAAkB,CAAC,EAAM,WAAW,YAAY,CAAE,SAAU,CAAS,EACrF,OAAO,EAAc,GACf,WAAW,aAAa,CACxB,WAAW,aAAa,AAClC,EACA,MAAM,GACG,EAAO,KAAK,EAAI,EAAO,EAAK,QAAQ,IAAM,AAC/C,EAAS,EAAc,GAE/B,CAQA,SAAS,EAAoB,CAAI,EAC7B,IAAI,EAAU,EAAS,GAAG,CAAC,GAC3B,OAAO,aAAmB,SAAW,EAAQ,IAAI,CAAG,CACxD,CACA,SAAS,EAAM,CAAI,EACf,IAAI,EAAY,SAAS,sBAAsB,GAC3C,EAAS,EAAc,GAAG,CAAC,GAC3B,EAAW,EAAU,GAAG,CAAC,GACzB,EAAY,EAAoB,GACpC,EAAS,UAAU,GACnB,EAAO,OAAO,CAAC,SAAU,CAAK,QAC1B,EAAU,WAAW,CAAC,EAAqB,EAAO,KAtJlD,EAAU,EAsJiD,OAtJxC,aAAa,CAAC,SACrC,EAAoB,GAAG,CAAC,GAAO,GAAG,CAAC,EAAU,GAC7C,EAAW,GAAG,CAAC,AAoJmE,GApJ5D,IAAI,CAAC,AAoJ8D,GAnJlF,GAoJP,GACA,EAAU,YAAY,CAAC,EAAW,MAClC,EAAS,OAAO,CAAC,EAAW,GAC5B,EAAO,OAAO,CAAC,SAAU,CAAK,EAC1B,EAAe,EAAO,EAAqB,EAAO,GACtD,EACJ,CACA,SAAS,EAAS,CAAO,EACrB,IAAI,EAAO,IAAI,AACf,GAAK,MAAM,CAAG,EAAE,CAChB,EAAS,GAAG,CAAC,EAAM,GACnB,EAAc,GAAG,CAAC,EAAM,EAAE,EAC1B,EAAU,GAAG,CAAC,EAAM,IAAI,iBAAiB,SAAU,CAAS,CAAE,CAAQ,EAC7D,AAAL,IAAI,KAIJ,CAJe,CAIL,OAAO,CAAC,SAAU,CAAQ,EAC5B,AAAC,GACD,EAAQ,IAAI,CAAC,EAAS,CADR,SACkB,CAAE,SAAU,CAAI,EACtC,aAAgB,OAAO,EAG7B,CAHgC,CAGV,EAAM,SAAU,CAAI,EACtC,EAAsB,GAAM,OAAO,EACvC,EACJ,GAEJ,EAAQ,IAAI,CAAC,EAAS,YAAY,CAAE,SAAU,CAAI,EACxC,aAAgB,OAAO,GAAG,AAGJ,OAAO,MA/CpB,kBACvB,EAAc,GAAG,CA8Ca,AA9CZ,GAAM,IAAI,CAAC,SAAU,CAAK,EAAI,OAAO,EAAqB,IAAc,GAAP,CA+CvE,EAAM,GAEN,AAAC,GACD,EAAsB,EAAM,MADd,GACwB,CAAI,EACtC,EAAsB,GAAM,UAAU,EAC1C,GAER,EACJ,GA3BI,EAAS,UAAU,EA4B3B,GACJ,CAsEJ,CAAA,4BC5UA,EAAA,CAAA,CAAA,QAEA,IAAM,EAAgB,GAAO,GACvB,MAAM,UAAU,CAChB,OAAO,GAAK,IACZ,IAAI,GAAK,EAAE,KAAK,CAAC,KAAK,GAAG,CAAC,GAAK,EAAE,CAF4B,GAExB,IA4BpC,OAAM,UAAoB,YAC7B,OAAO,mBAAqB,CAAC,OAAQ,eAAgB,SAAS,EAC9D,CAAA,AAAK,CAAG,IAAI,CAAC,YAAY,CAAC,CAAE,KAAM,MAAO,EAAE,EAC3C,CAAA,AAAS,CAAG,IAAI,eAAe,IAAM,IAAI,EAAC,CAAA,AAAO,GAAG,EACpD,CAAA,AAAQ,EACR,CAAA,AAAM,CAAG,CAAC,CAAC,CACX,eAAe,CACf,MAAM,EACN,CAAA,AAAS,EAAG,CAAK,EACjB,CAAA,AAAK,AACL,CAAA,EAAM,EACN,CAAA,AAAO,EACP,CAAA,AAAK,EACL,CAAA,AAAK,EACL,CAAA,AAAY,CAAG,CAAG,EAClB,CAAA,AAAiB,CAAG,CAAG,AACvB,CAAA,EAAa,EAAG,CAAK,EACrB,CAAA,AAAY,EAAG,CAAK,EACpB,CAAA,AAAY,EAAG,CAAK,AACpB,CAAA,EAAa,CAAG,IAAI,GAAK,EACzB,CAAmB,AAAnB,CAAsB,IAAI,GAAK,EAC/B,CAAA,AAAiB,CAAG,IAAI,GAAK,EAC7B,CAAA,AAAsB,CAAG,CAAC,EAC1B,CAAA,AAAsB,CAAG,CAAC,EAC1B,CAAA,AAAiB,CAAG,CAAC,EACrB,CAAA,AAAa,CAAG,EAAE,EAClB,CAAA,AAAe,CAAG,CAAC,AACnB,cAAc,CACV,KAAK,GAEL,MAAM,EAAQ,IAAI,cAClB,IAAI,EAAC,CAAA,AAAK,CAAC,kBAAkB,CAAG,CAAC,EAAM,CACvC,EAAM,WAAW,CAAC,CAAC;;;;;;;;;;;;SAYlB,CAAC,EAEF,IAAI,EAAC,CAAA,AAAS,CAAC,OAAO,CAAC,IAAI,CAC/B,CACA,yBAAyB,CAAI,CAAE,CAAC,CAAE,CAAK,CAAE,CACrC,OAAQ,GACJ,IAAK,OACD,IAAI,EAAC,CAAA,AAAK,CAAa,cAAV,GAAmC,aAAV,EAChC,WAAW,GAAS,EAC1B,IAAI,EAAC,CAAA,AAAO,GACZ,KACJ,KAAK,eACD,IAAI,EAAC,CAAA,AAAY,CAAG,WAAW,GAAS,IACxC,IAAI,EAAC,CAAA,AAAO,GACZ,KACJ,KAAK,SACD,IAAI,EAAC,CAAS,AAAT,CAAU,EAEvB,CACJ,CACA,OAAM,CAAA,AAAY,CAAC,OAAE,CAAK,CAAE,IAAK,CAAS,CAAE,YAAW,CAAK,CAAE,EAC1D,IAAM,EAAyC,UAArB,OAAO,EAC3B,EAAM,EAAoB,EAAY,GAAW,IACjD,EAAO,EAAoB,KAAO,GAAW,KAC7C,EAAS,EAAoB,KAAO,GAAW,OAC/C,EAAU,SAAS,aAAa,CAAC,OACvC,EAAQ,YAAY,CAAC,MAAO,OAC5B,IAAM,EAAS,SAAS,aAAa,CAAC,gBAsBtC,CArBA,EAAQ,CAqBJ,KArBU,CAAC,GACf,OAAO,MAAM,CAAC,EAAO,KAAK,CAAE,CACxB,OAAQ,IACR,QAAS,OACT,SAAU,QACd,GAGA,EAAO,YAAY,CAAC,UAAW,mCAC/B,EAAO,YAAY,CAAC,YAAa,MACjC,EAAO,YAAY,CAAC,OAAQ,UAC5B,IAAI,EAAC,CAAA,AAAK,CAAC,MAAM,CAAC,GAEd,GACA,OADU,AACH,MAAM,CAAC,EAAQ,KAAK,CAAE,CACzB,SAAU,WACV,WAAY,SACZ,cAAe,MACnB,GAGC,GACE,EADG,EACC,QAAQ,IACf,EAAO,gBAAgB,CAAC,OAAQ,KAC5B,IAAM,EAAM,EAAO,eAAe,CAClC,IAAI,CAAC,aAAa,CAAC,IAAI,YAAY,OAAQ,CAAE,OAAQ,CAAE,YAAK,CAAM,CAAE,IACpE,GAAM,OAAE,CAAK,QAAE,CAAM,CAAE,CAAG,CA5HtB,CAAC,EAAK,KAEtB,GAAsC,QAAlC,EAAI,eAAe,CAAC,SAAS,CAAY,CACzC,GAAM,GAAK,EAAO,EAAO,CAAG,EAAI,eAAe,CAC1C,YAAY,CAAC,YAAY,MAAM,OAAS,EAAE,CAC/C,MAAO,OAAE,SAAO,CAAO,CAC3B,CAGA,IAAM,EAAO,EAAc,EAAI,aAAa,CAAC,0BACvC,aAAa,YACnB,GAAI,EAAM,OAAO,OAAO,WAAW,CAAC,GAGpC,GAAwB,UAApB,OAAO,EAAuB,OAAO,EAAc,GACvD,GAAI,GAAU,OAAS,EAAS,MAAM,CAAE,OAAO,EAG/C,IAAM,EAAM,EAAI,aAAa,CAAC,cAC9B,AAAI,EAAY,CAAE,EAAT,IAAgB,EAAI,YAAY,CAAE,OAAQ,EAAI,aAAa,AAAC,GAGrE,QAAQ,IAAI,CAAC,AAAI,MAAM,gCAChB,CAAE,MAAO,IAAM,OAAQ,GAAK,GACvC,EAoGsD,EAAK,IAAI,CAAC,eAAe,EAC/D,EAAQ,SACJ,EAAS,SACT,MAAO,WAAW,GAClB,OAAQ,WAAW,UACnB,WACA,CACJ,EACJ,EAAG,CAAE,MAAM,CAAK,GACZ,EACA,EAAO,EADD,IACO,CAAG,EAEhB,EAAO,GAAG,CAAG,CAErB,GAnBiB,CAAE,OAAO,EAAM,iBAAS,CAAO,CAoBpD,EACA,CAAA,AAAO,CAAC,EAAO,IAAI,EAAC,CAAA,AAAK,EACrB,GAAI,CAAC,EAAM,OACX,IAAM,EAAO,IAAI,EAAC,CAAA,AAAK,EAAI,CAAC,EACtB,EAAQ,IAAI,EAAC,CAAA,AAAO,EAAI,IAAI,EAAC,CAAA,AAAM,EAAI,CAAC,EACxC,EAAkB,SAAT,EAAkB,EAAO,EAClC,OAAE,CAAK,QAAE,CAAM,CAAE,CAAG,IAAI,CAAC,qBAAqB,GAE9C,EAA2B,SAAhB,IAAI,CAAC,MAAM,EAA+B,AAAhB,iBAAI,CAAC,MAAM,EAC/C,EAAiB,IAAR,EAChB,IAAI,EAAC,CAAA,AAAS,CAAG,EACjB,IAAM,EAAa,EAAK,KAAK,EAAI,EAAM,KAAK,EAAI,EAC1C,EAAc,EAAK,MAAM,EAAI,EAAM,MAAM,EAAI,EAE/C,EAA8B,AAAtB,YAAkC,KAA3B,IAAI,CAAC,CAAA,CAAK,EAAkB,MAAM,IAAI,EAAC,CAAA,AAAK,EAEzD,CAAgB,cAAf,IAAI,CAAC,CAAA,CAAK,CACN,GAAY,IAAI,EAAC,CAAA,AAAO,CACrB,GAAS,EAAO,GAAR,EAAa,EAAI,CAAA,CAAU,CACnC,EAAS,EAAC,EAAK,EAAP,GAAY,EAAI,CAAA,CAAU,EAAK,EAAD,AAAO,KAAK,EAAI,CAAA,CAAU,CAAC,CACpE,GAAY,IAAI,CAAC,CAAA,CAAO,CACrB,KAAK,GAAG,CACN,GAAS,EAAO,GAAR,EAAa,EAAI,CAAA,CAAU,CACnC,GAAU,EAAO,IAAR,EAAc,EAAI,CAAA,CAAW,EACxC,KAAK,GAAG,CACN,GAAS,CAAC,EAAK,EAAP,GAAY,EAAI,CAAA,CAAU,EAAK,EAAD,AAAO,KAAK,EAAI,CAAA,CAAU,CAAC,CACjE,EAAS,KAAK,GAAG,CACb,EAAK,MAAM,EAAI,EACf,EAAM,MAAM,EAAI,GAAA,CAChC,EAAK,EAdH,IAAI,EAAC,CAAA,AAAK,CAgBhB,GAAS,IAAI,EAAC,CAAA,AAAY,CAC1B,IAAI,EAAC,CAAA,AAAiB,CAAG,EAEzB,IAAM,EAAY,CAAC,OAAC,CAAK,QAAE,CAAM,CAAC,IAC9B,GAAI,SAAE,CAAO,QAAE,CAAM,OAAE,CAAK,QAAE,CAAM,OAAE,CAAK,QAAE,CAAM,CAAE,CAAG,EACxD,GAAI,CAAC,EAAQ,OACT,GAAQ,EAAO,CAAE,IAAK,EAAM,MAAM,CAAC,eAAe,OAAE,CAAM,GAC9D,IAAM,EAAc,EAAS,EAAQ,EAC/B,EAAY,IAAI,EAAC,CAAA,AAAY,CAAG,EACtC,OAAO,MAAM,CAAC,EAAO,KAAK,CAAE,CACxB,MAAO,CAAA,EAAG,EAAQ,EAAY,EAAE,CAAC,CACjC,OAAQ,CAAA,EAAG,EAAS,EAAY,EAAE,CAAC,CACnC,UAAW,EAAS,OAAS,CAAC,MAAM,EAAE,EAAM,CAAC,CAAC,CAC9C,gBAAiB,WACjB,QAAS,EAAQ,OAAS,OAC9B,GACA,OAAO,MAAM,CAAC,EAAQ,KAAK,CAAE,CACzB,MAAO,CAAA,EAAG,CAAC,GAAS,CAAA,CAAU,CAAI,EAAM,EAAE,CAAC,CAC3C,OAAQ,CAAA,EAAG,CAAC,GAAU,CAAA,CAAW,CAAI,EAAM,EAAE,CAAC,CAC9C,WAAY,IACZ,QAAS,EAAY,OAAS,QAC9B,YAAa,OAAY,EAAY,OACrC,WAAY,EAAY,cAAW,EACnC,eAAgB,EAAY,cAAW,EACvC,GAAG,CAAM,AACb,GACI,GAAY,IAAU,IACtB,EAAQ,EADsB,GACjB,CAAC,OAAO,CAAG,MAAA,EAG5B,IAAM,EAAW,EAAQ,UAAU,CAAC,IAAI,CAClC,EAAiB,EAAU,WAAW,CACtC,EAAkB,EAAU,YAAY,CAG9C,OAFA,EAAU,UAAU,CAAG,CAAC,EAAQ,WAAW,CAAG,CAAA,CAAc,CAAI,EAEzD,CACH,MAAO,EAAQ,WAAW,CAC1B,OAAQ,EAAQ,YAAY,gBAC5B,kBACA,CACJ,CACJ,EACA,GAAI,IAAI,EAAC,CAAA,AAAO,CAAE,CAEd,GAAM,OAAC,CAAK,QAAE,CAAM,CAAE,gBAAc,iBAAE,CAAe,CAAC,CADnC,EAAU,AAC4B,CAD3B,MAAO,IAAI,EAAC,CAAA,AAAO,CAAE,OAAQ,CAAE,aAAc,MAAO,CAAC,GAEnF,IAAI,EAAC,CAAA,AAAY,CAAG,EAAQ,EAC5B,IAAI,CAAC,CAAA,CAAY,CAAG,EAAS,CACjC,KAAO,CACH,IAAM,EAAiB,EAAU,CAAC,MAAO,EAAM,OAAQ,CAAE,kBAAmB,MAAO,CAAC,GAC9E,EAAkB,EAAU,CAAC,MAAO,EAAO,OAAQ,CAAE,gBAAiB,MAAO,CAAC,GAC9E,CAAC,MAAO,CAAS,CAAE,OAAQ,CAAU,gBAAE,CAAc,iBAAE,CAAe,CAAC,CAAG,EAC1E,CAAC,MAAO,CAAU,CAAE,OAAQ,CAAW,CAAC,CAAG,EACjD,IAAI,EAAC,CAAA,AAAY,CAAG,EAAY,EAAa,EAC7C,IAAI,EAAC,CAAA,AAAY,CAAG,KAAK,GAAG,CAAC,EAAY,GAAe,CAC5D,CACJ,CACA,OAAM,CAAW,AAAX,CAAY,MAAE,CAAI,OAAE,CAAK,QAAE,CAAM,MAAE,CAAI,aAAE,CAAW,CAAE,EACxD,IAAI,EAAC,CAAA,AAAK,CAAG,KACb,IAAI,EAAC,CAAA,AAAM,CAAG,KACd,IAAI,EAAC,CAAA,AAAO,CAAG,KAEf,IAAM,EAA2B,SAAhB,EAA4B,CAAC,OAAO,EAAE,EAAA,CAAa,CAAG,KACjE,EAAc,EAAW,IAAI,EAAC,CAAA,AAAmB,CAAC,GAAG,CAAC,GAAY,KAEpE,GACA,IAAI,EAAC,CAAA,AAAiB,CAAC,EADV,CACa,CAAC,EAAU,KAAK,GAAG,IACzC,EAAY,MAAM,CAClB,CADoB,GAChB,EAAC,CAAA,AAAO,CAAG,EAAY,MAAM,EAEjC,IAAI,EAAC,CAAA,AAAK,CAAG,EAAY,IAAI,CAC7B,IAAI,CAAC,CAAA,CAAM,CAAG,EAAY,KAAK,GAG/B,GACA,IAAI,CADI,CACH,CAAA,AAAO,CAAG,MAAM,IAAI,EAAC,CAAA,AAAY,CAAC,GACnC,IACA,IAAI,EADM,AACL,CAAA,AAAmB,CAAC,GAAG,CAAC,EAAU,CAAE,OAAQ,IAAI,EAAC,CAAA,AAAO,AAAC,GAC9D,IAAI,EAAC,CAAA,AAAiB,CAAC,GAAG,CAAC,EAAU,KAAK,GAAG,OAGjD,IAAI,EAAC,CAAA,AAAK,CAAG,MAAM,IAAI,EAAC,CAAA,AAAY,CAAC,GACrC,IAAI,CAAC,CAAA,CAAM,CAAG,MAAM,IAAI,EAAC,CAAA,AAAY,CAAC,GAClC,IACA,IAAI,EADM,AACL,CAAA,AAAmB,CAAC,GAAG,CAAC,EAAU,CAAE,KAAM,IAAI,CAAC,CAAA,CAAK,CAAE,MAAO,IAAI,EAAC,CAAA,AAAM,AAAC,GAC9E,IAAI,EAAC,CAAA,AAAiB,CAAC,GAAG,CAAC,EAAU,KAAK,GAAG,MAKzD,IAAI,EAAC,CAAA,AAAK,CAAG,EAAS,SAAW,IAAI,EAAC,CAAA,AAAK,CAAC,KAAK,CAAG,QAC9C,IAAI,EAAC,CAAA,AAAM,CAAC,KAAK,CAAG,OAAS,EACnC,IAAM,EAAgB,EAChB,CAAC,IAAI,EAAC,CAAO,AAAP,EAAS,QAAQ,CACvB,CAAC,IAAI,EAAC,CAAA,AAAK,EAAE,QAAS,IAAI,EAAC,CAAA,AAAM,EAAE,QAAQ,CAEjD,MAAM,IAAI,CAAC,IAAI,EAAC,CAAA,AAAK,CAAC,QAAQ,EAAE,OAAO,CAAC,IACpC,IAAM,EAAY,EAAc,QAAQ,CAAC,GACzC,OAAO,MAAM,CAAC,EAAM,KAAK,CAAE,CACvB,SAAU,EAAY,WAAa,WACnC,WAAY,EAAY,UAAY,SACpC,cAAe,EAAY,OAAS,MACxC,EACJ,GACA,IAAI,CAAC,CAAA,CAAO,EAChB,CACA,CAAA,CAAO,GACH,KAAI,IAAI,EAAC,CAAO,AAAP,EAAW,IAAI,EAAC,CAAA,AAAK,EAAE,KAAA,GAAO,AACnC,IAAI,EAAC,CAAA,AAAS,EAAI,IAAI,EAAC,CAAA,AAAK,EAAE,SAAS,OAAO,UAAY,OAI1D,CAJkE,MAClE,IAAI,CAAC,CAAA,CAAK,CAAG,OACb,IAAI,EAAC,CAAO,AAAP,GACL,IAAI,EAAC,CAAA,AAAe,CAAC,SACd,CAEf,EACA,CAAA,AAAQ,GACJ,KAAI,IAAI,EAAC,CAAA,AAAO,EAAI,IAAI,CAAC,CAAA,CAAM,EAAE,KAAA,GAAO,AACpC,IAAI,EAAC,CAAS,AAAT,EAAa,IAAI,EAAC,CAAA,AAAM,EAAE,SAAS,OAAO,UAAY,OAI3D,CAJmE,MACnE,IAAI,EAAC,CAAA,AAAK,CAAG,QACb,IAAI,EAAC,CAAA,AAAO,GACZ,IAAI,EAAC,CAAe,AAAf,CAAgB,SACd,CAEf,CACA,KAAK,CAAI,CAAE,CACP,IAAI,CAAC,IAAI,CAAG,EACZ,IAAI,CAAC,eAAe,CAAG,EAAK,SAAS,EAAE,SACvC,IAAI,CAAC,GAAG,CAAgB,QAAb,EAAK,GAAG,CAEnB,IAAI,EAAC,CAAA,AAAO,EAChB,EACA,CAAA,AAAO,CAAC,CAAI,EACR,IAAM,EAAO,IAAI,CAAC,IAAI,CAChB,WAAE,CAAS,CAAE,CAAG,EAChB,EAAM,IAAI,CAAC,GAAG,CACd,EAAM,CAAC,EACb,IAAI,CAAC,MAAM,CAAG,GAAQ,GAAW,OAEb,SAAhB,IAAI,CAAC,MAAM,CACX,IAAI,EAAC,CAAA,AAAQ,CAAG,EAAK,QAAQ,CAAC,GAAG,CAAC,IAAY,CAAE,KAAH,EAAW,EAAQ,CAAC,EAChE,IAAI,EAAC,CAAA,AAAQ,CAAG,EAAK,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAK,EAAS,KACrD,IAAM,EAAO,CAAG,CAAC,EAAI,MAAM,CAAG,EAAE,CAC1B,YAAE,CAAU,CAAE,CAAG,EACjB,EAAY,KACd,IAAM,EAAS,CAAC,EAEhB,OADA,EAAI,IAAI,CAAC,GACF,CACX,EAuBA,MAtBmB,UAAU,CAAzB,EAEA,CADe,EAAK,IAAI,EAAI,EAAK,KAAK,CAAG,IAAc,CAAA,EAChD,MAAM,CAAG,EAEI,QAAQ,CAAvB,EAEL,CADe,EAAK,MAAM,EAAI,EAAK,IAAI,EAAI,GAAO,EAAI,IAAc,CAAA,EAC7D,IAAI,CAAG,EAEM,SAAS,CAAxB,EAEL,CADe,EAAK,MAAM,EAAI,EAAK,KAAK,EAAI,GAAO,EAAI,IAAc,CAAA,EAC9D,KAAK,CAAG,EAEV,EACD,EAAK,CADC,KACK,EAAI,EAAK,KAAK,CAAE,IAAY,IAAI,CAAG,EACzC,EAAK,IAAI,EAAI,CAAC,EAAG,EAAK,KAAK,CAAG,EAClC,EAAK,IAAI,CAAG,EAGb,EAAK,MAAM,EAAI,EAAK,IAAI,CAAE,IAAY,KAAK,CAAG,EACzC,EAAK,KAAK,EAAI,CAAC,EAAG,EAAK,IAAI,CAAG,EAClC,EAAK,KAAK,CAAG,EAEf,CACX,EAAG,CAAC,CAAC,EAAE,CACX,EACA,CAAA,AAAS,CAAC,CAAU,EAChB,GAAoB,CAAC,IAAjB,IAAI,EAAC,CAAA,AAAM,CAAS,OACxB,IAAM,EAAU,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAC9C,IAAI,EAAC,CAAA,AAAO,CAAC,GACb,GAAM,OAAE,CAAK,CAAE,CAAG,IAAI,CAAC,WAAW,CAAC,GAGnC,IAAK,IAAM,KAFX,IAAI,EAAC,CAAA,AAAM,CAAG,CAAC,EACf,IAAI,EAAC,CAAA,AAAa,CAAC,KAAK,GACH,IAAI,EAAC,CAAA,AAAmB,CAAC,MAAM,GAAI,CAChD,EAAO,MAAM,CACb,CADe,CACR,MAAM,CAAC,OAAO,EAAE,UAEvB,EAAO,IAAI,EAAE,SAAS,SACtB,EAAO,KAAK,EAAE,SAAS,UAG/B,IAAI,EAAC,CAAA,AAAmB,CAAC,KAAK,GAC9B,IAAI,EAAC,CAAA,AAAiB,CAAC,KAAK,GAC5B,IAAI,CAAC,UAAU,CAAC,EAAO,IAAI,CAAC,GAAG,CAAG,QAAU,OAAQ,OACxD,CACA,IAAI,OAAQ,CACR,IAAM,EAAS,IAAI,EAAC,CAAA,AAAQ,CAAC,IAAI,EAAC,CAAA,AAAM,CAAC,CACnC,EAAU,GAAQ,SAA0B,CAAhB,QAAC,IAAI,EAAC,CAAA,AAAK,CACvC,EAAO,IAAI,EAAI,EAAO,KAAK,CAAG,EAAO,KAAK,EAAI,EAAO,IAAA,AAAI,EAC/D,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EACtC,CACA,IAAI,cAAe,CACf,OAAO,IAAI,EAAC,CAAA,AAAa,AAC7B,CACA,IAAI,aAAa,CAAK,CAAE,CACpB,IAAI,EAAC,CAAA,AAAa,CAAG,CACzB,CACA,IAAI,aAAc,CACd,OAAO,IAAI,EAAC,CAChB,AAD4B,AAAZ,CAEhB,IAAI,aAAc,CACd,OAAO,IAAI,EAAC,CAAA,AAAY,AAC5B,EACA,CAAA,AAAe,CAAC,CAAM,EAClB,IAAI,CAAC,aAAa,CAAC,IAAI,YAAY,WAAY,CAAE,OAC7C,QAAE,EAAQ,MAAO,KAAM,MAAO,IAAI,CAAC,KAAK,CAAE,SAAU,EAAG,KAAM,CAAE,CAAE,GACzE,CACA,YAAY,CAAO,CAAE,CACjB,IAAM,EAAU,IAAI,EAAC,CAAA,AAAQ,CAC7B,IAAK,IAAI,EAAQ,EAAG,EAAQ,EAAQ,MAAM,CAAE,IAAS,CACjD,GAAM,CAAE,MAAI,OAAE,CAAK,QAAE,CAAM,CAAE,CAAG,CAAO,CAAC,EAAM,CAC9C,GAAI,IAAS,EAAS,MAAO,OAAE,EAAO,KAAM,MAAO,EACnD,GAAI,IAAU,EAAS,MAAO,CAAE,QAAO,KAAM,OAAQ,EACrD,GAAI,IAAW,EAAS,MAAO,OAAE,EAAO,KAAM,QAAS,CAC3D,CACJ,CACA,MAAM,WAAW,CAAK,CAAE,CAAI,CAAE,CAAM,CAAE,CAClC,GAAI,EAAQ,GAAK,EAAQ,IAAI,CAAC,CAAA,CAAQ,CAAC,MAAM,CAAG,EAAG,OACnD,GAAI,IAAU,IAAI,EAAC,CAAA,AAAM,CAAE,YACvB,IAAI,EAAC,CAAA,AAAO,CAAC,GAGjB,IAAI,EAAC,CAAA,AAAM,CAAG,EACd,IAAM,EAAS,IAAI,EAAC,CAAA,AAAQ,CAAC,EAAM,CAC7B,EAAW,CAAC,OAAO,EAAE,EAAA,CAAO,CAC5B,EAAS,IAAI,EAAC,CAAA,AAAa,CAAC,GAAG,CAAC,GACtC,GAAI,GAAqB,WAAW,CAAtB,EACV,GAAI,EAAO,MAAM,CAAE,CACf,IAAM,EAAe,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,MAAM,CAC7D,OAAM,IAAI,EAAC,CAAA,AAAW,CAAC,CAAE,OAAQ,CAAE,MAAO,EAAc,IAAK,EAAO,MAAM,AAAC,EAAG,YAAa,OAAO,CAAK,EAC3G,KAAO,CACH,IAAM,EAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,IAAI,EAC/C,EAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,KAAK,EAChD,EAAO,CAAE,MAAO,EAAQ,IAAK,EAAO,IAAI,AAAC,EACzC,EAAQ,CAAE,MAAO,EAAQ,IAAK,EAAO,KAAK,AAAC,CACjD,OAAM,IAAI,EAAC,CAAA,AAAW,CAAC,MAAE,EAAM,aAAO,EAAM,YAAa,CAAM,EACnE,MAEA,GAAI,EAAO,MAAM,CAAE,CACf,IAAM,EAAe,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,MAAM,EACvD,EAAM,MAAM,EAAO,MAAM,EAAE,QACjC,OAAM,IAAI,EAAC,CAAW,AAAX,CAAY,CAAE,OAAQ,CAAE,MAAO,MAAc,CAAI,EAAG,YAAa,OAAO,CAAK,EAC5F,KAAO,CACH,IAAM,EAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,IAAI,EAC/C,EAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,KAAK,EAChD,EAAO,MAAM,EAAO,IAAI,EAAE,SAC1B,EAAO,MAAM,EAAO,KAAK,EAAE,QAGjC,OAAM,IAAI,EAAC,CAAA,AAAW,CAAC,CAAE,KAFZ,CAAE,MAAO,EAAQ,IAAK,CAAK,EAET,MADjB,CAAE,MAAO,EAAQ,IAAK,CAAK,OACH,EAAM,YAAa,CAAM,EACnE,CAGJ,IAAI,CAAC,CAAA,CAAe,CAAC,GACrB,IAAI,EAAC,CAAA,AAAmB,EAC5B,EACA,CAAA,AAAmB,GAGf,GAFA,IAAI,EAAC,CAAA,AAAoB,GAErB,IAAI,EAAC,CAAA,AAAsB,EAAI,EAAG,OAEtC,IAAM,EAAY,EAAE,CACd,EAAsB,KAAK,GAAG,CAAC,EAAG,IAAI,EAAC,CAAA,AAAsB,CAAG,GAChE,EAAuB,KAAK,GAAG,CAAC,EAAG,IAAI,EAAC,CAAA,AAAsB,CAAG,GACvE,IAAK,IAAI,EAAW,EAAG,GAAY,EAAqB,IAAY,CAChE,IAAM,EAAe,IAAI,EAAC,CAAA,AAAM,CAAG,EAC/B,GAAgB,GAAK,EAAe,IAAI,EAAC,CAAA,AAAQ,CAAC,MAAM,EAAE,AAC1D,EAAU,IAAI,CAAC,CAAE,MAAO,EAAc,UAAW,mBAAW,CAAS,EAE7E,CACA,IAAK,IAAI,EAAW,EAAG,GAAY,EAAsB,IAAY,CACjE,IAAM,EAAgB,IAAI,EAAC,CAAA,AAAM,CAAG,EAChC,GAAiB,GAAK,EAAgB,IAAI,EAAC,CAAA,AAAQ,CAAC,MAAM,EAC1D,AAD4D,EAClD,IAAI,CAAC,CAAE,MAAO,EAAe,UAAW,oBAAY,CAAS,EAE/E,CACA,IAAK,GAAM,CAAE,MAAO,CAAW,WAAE,CAAS,CAAE,GAAI,EAAW,CACvD,IAAM,EAAW,CAAC,OAAO,EAAE,EAAA,CAAa,CACxC,GAAI,IAAI,EAAC,CAAA,AAAmB,CAAC,GAAG,CAAC,GAAW,SAC5C,IAAM,EAAS,IAAI,EAAC,CAAA,AAAQ,CAAC,EAAY,CACpC,GACL,IAAI,CADS,CACR,CAAA,AAAa,CAAC,IAAI,CAAC,aAAE,EAAa,YAAW,SAAQ,UAAS,EACvE,CAEA,IAAI,EAAC,CAAA,AAAoB,EAC7B,CAEA,OAAM,CAAA,AAAoB,GACtB,KAAO,IAAI,EAAC,CAAA,AAAa,CAAC,MAAM,CAAG,GAAK,IAAI,EAAC,CAAA,AAAe,CAAG,IAAI,EAAC,CAAA,AAAsB,EAAE,CACxF,IAAM,EAAO,IAAI,EAAC,CAAA,AAAa,CAAC,KAAK,GACrC,GAAI,CAAC,EAAM,MAEX,GAAM,QAAE,CAAM,UAAE,CAAQ,CAAE,CAAG,EAC7B,IAAI,EAAC,CAAA,AAAa,CAAC,GAAG,CAAC,EAAU,WACjC,IAAI,CAAC,CAAA,CAAe,GACpB,QAAQ,OAAO,GAAG,IAAI,CAAC,UACnB,GAAI,CACA,GAAI,EAAO,MAAM,CAAE,CACf,IAAM,EAAM,MAAM,EAAO,MAAM,EAAE,SACjC,IAAI,EAAC,CAAA,AAAa,CAAC,GAAG,CAAC,EAAU,CAAE,OAAQ,CAAI,GAE/C,IAAM,EAAe,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,MAAM,EACvD,EAAQ,MAAM,IAAI,EAAC,CAAY,AAAZ,CAAa,CAAE,MAAO,MAAc,EAAK,UAAU,CAAK,GAIjF,GAFA,IAAI,EAAC,CAAA,AAAmB,CAAC,GAAG,CAAC,EAAU,CAAE,OAAQ,CAAM,GACvD,IAAI,CAAC,CAAA,CAAiB,CAAC,GAAG,CAAC,EAAU,KAAK,GAAG,IACzC,EAAM,MAAM,CAAE,CACd,IAAM,EAAM,EAAM,MAAM,CAAC,eAAe,CACxC,EAAM,MAAM,CAAC,KAAE,EAAK,MAAO,IAAI,EAAC,CAAA,AAAiB,AAAC,EACtD,CACJ,KAAO,CACH,IAAM,EAAO,MAAM,EAAO,IAAI,EAAE,SAC1B,EAAO,MAAM,EAAO,KAAK,EAAE,SACjC,IAAI,EAAC,CAAA,AAAa,CAAC,GAAG,CAAC,EAAU,CAAE,KAAM,EAAM,MAAO,CAAK,GAE3D,IAAM,EAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,IAAI,EAC/C,EAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAO,KAAK,EAChD,EAAY,MAAM,IAAI,EAAC,CAAA,AAAY,CAAC,CAAE,MAAO,EAAQ,IAAK,EAAM,UAAU,CAAK,GAC/E,EAAa,MAAM,IAAI,EAAC,CAAA,AAAY,CAAC,CAAE,MAAO,EAAQ,IAAK,EAAM,UAAU,CAAK,GAKtF,GAHA,IAAI,EAAC,CAAA,AAAmB,CAAC,GAAG,CAAC,EAAU,CAAE,KAAM,EAAW,MAAO,CAAW,GAC5E,IAAI,EAAC,CAAA,AAAiB,CAAC,GAAG,CAAC,EAAU,KAAK,GAAG,IAEzC,EAAU,MAAM,CAAE,CAClB,IAAM,EAAO,EAAU,MAAM,CAAC,eAAe,CAC7C,EAAU,MAAM,CAAC,CAAE,IAAK,EAAM,MAAO,IAAI,EAAC,CAAA,AAAiB,AAAC,EAChE,CACA,GAAI,EAAW,MAAM,CAAE,CACnB,IAAM,EAAO,EAAW,MAAM,CAAC,eAAe,CAC9C,EAAW,MAAM,CAAC,CAAE,IAAK,EAAM,MAAO,IAAI,EAAC,CAAA,AAAiB,AAAC,EACjE,CACJ,CACJ,CAAE,KAAM,CACJ,IAAI,EAAC,CAAA,AAAa,CAAC,MAAM,CAAC,GAC1B,IAAI,EAAC,CAAmB,AAAnB,CAAoB,MAAM,CAAC,EACpC,QAAU,CACN,IAAI,EAAC,CAAA,AAAe,GACpB,IAAI,EAAC,CAAA,AAAoB,EAC7B,CACJ,EACJ,CACJ,EACA,CAAA,AAAoB,GAChB,IAAM,EAAa,IAAI,EAAC,CAAA,AAAiB,CACzC,GAAI,IAAI,EAAC,CAAA,AAAmB,CAAC,IAAI,EAAI,EACjC,OAGJ,GAJiD,CAI3C,EAAc,MAAM,IAAI,CAAC,IAAI,EAAC,CAAmB,AAAnB,CAAoB,IAAI,IACvD,GAAG,CAAC,IAAQ,EAAD,GACR,EACA,WAAY,IAAI,EAAC,CAAA,AAAiB,CAAC,GAAG,CAAC,IAAQ,EACnD,CAAC,EACA,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,UAAU,CAAG,EAAE,UAAU,EAEzC,EAAc,IAAI,EAAC,CAAA,AAAmB,CAAC,IAAI,CAAG,EAC9C,EAAiB,EAAY,KAAK,CAAC,EAAG,GAAa,GAAG,CAAC,GAAQ,EAAK,GAAG,EAEzE,EAAe,MAAM,CAAG,GAAG,AAC3B,EAAe,OAAO,CAAC,IACnB,IAAM,EAAS,IAAI,EAAC,CAAA,AAAmB,CAAC,GAAG,CAAC,GACxC,IACI,EAAO,EADH,IACS,CACb,CADe,CACR,MAAM,CAAC,OAAO,EAAE,UAEvB,EAAO,IAAI,EAAE,SAAS,SACtB,EAAO,KAAK,EAAE,SAAS,WAI/B,IAAI,EAAC,CAAA,AAAmB,CAAC,MAAM,CAAC,GAChC,IAAI,EAAC,CAAA,AAAiB,CAAC,MAAM,CAAC,GAC9B,IAAI,EAAC,CAAA,AAAa,CAAC,MAAM,CAAC,EAC9B,EAER,CACA,MAAM,OAAO,CAAM,CAAE,CACjB,MAAM,IAAI,CAAC,IAAI,CAAC,EAEpB,CACA,MAAM,KAAK,CAAM,CAAE,CACf,GAAM,MAAE,CAAI,CAAE,CAAG,IAAI,CACf,EAAW,MAAM,EACjB,EAAU,EAAK,QAAQ,CAAC,EAAS,KAAK,CAAC,CAC7C,GAAI,CAAC,EAAS,OACd,GAAM,OAAE,CAAK,MAAE,CAAI,CAAE,CAAG,IAAI,CAAC,WAAW,CAAC,EACzC,OAAM,IAAI,CAAC,UAAU,CAAC,EAAO,EACjC,CACA,MAAM,MAAO,CAET,GAAI,CAAC,CADK,IAAI,CAAC,GAAG,CAAG,IAAI,EAAC,CAAA,AAAO,GAAK,IAAI,EAAC,CAAA,AAAQ,EAAA,EAC3C,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,EAAC,CAAA,AAAM,CAAG,EAAG,IAAI,CAAC,GAAG,CAAG,QAAU,OAAQ,OACjF,CACA,MAAM,MAAO,CAET,GAAI,CAAC,CADK,IAAI,CAAC,GAAG,CAAG,IAAI,EAAC,CAAA,AAAQ,GAAK,IAAI,EAAC,CAAA,AAAO,EAAA,EAC3C,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,EAAC,CAAA,AAAM,CAAG,EAAG,IAAI,CAAC,GAAG,CAAG,OAAS,QAAS,OACjF,CACA,MAAM,IAAI,CAAE,CAAE,CAAE,CAAE,CACV,IAAI,EAAC,CAAA,AAAa,EAAE,CACxB,IAAI,CAAC,CAAA,CAAa,EAAG,EAWrB,CATkB,IACd,GAAI,SAAE,CAAO,QAAE,CAAM,CAAE,CAAG,EAC1B,GAAI,CAAC,GAAU,CAAC,EAAS,OAEzB,IAAM,EAAsB,EAAQ,UAAU,CAAC,IAAI,CACnD,EAAoB,UAAU,EAAI,EAClC,EAAoB,SAAS,EAAI,EACrC,EAEU,IAAI,EAAC,CAAA,AAAO,EAAI,IAAI,EAAC,CAAA,AAAM,EAAI,CAAC,GAC1C,IAAI,EAAC,CAAA,AAAa,EAAG,EACzB,CACA,aAAc,CACV,OAAO,MAAM,IAAI,CAAC,IAAI,EAAC,CAAA,AAAK,CAAC,gBAAgB,CAAC,UAAW,IAAU,CAC/D,GAD8D,CACzD,EAAM,eAAe,CAE9B,CAAC,CACL,CACA,SAAU,CAEN,IAAK,IAAM,KADX,IAAI,CAAC,CAAA,CAAS,CAAC,SAAS,CAAC,IAAI,EACR,IAAI,EAAC,CAAmB,AAAnB,CAAoB,MAAM,GAAI,CAChD,EAAO,MAAM,CACb,CADe,CACR,MAAM,CAAC,OAAO,EAAE,UAEvB,EAAO,IAAI,EAAE,SAAS,SACtB,EAAO,KAAK,EAAE,SAAS,UAG/B,IAAI,EAAC,CAAA,AAAmB,CAAC,KAAK,GAC9B,IAAI,EAAC,CAAA,AAAa,CAAC,KAAK,GACxB,IAAI,EAAC,CAAA,AAAiB,CAAC,KAAK,EAChC,CACJ,CAEA,eAAe,MAAM,CAAC,cAAe","ignoreList":[0]}