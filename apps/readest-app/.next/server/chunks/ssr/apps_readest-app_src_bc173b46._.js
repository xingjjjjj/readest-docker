module.exports=[858589,a=>{"use strict";a.i(165696);var b=a.i(936630),c=a.i(284696),d=a.i(833047),e=a.i(657123);let f=0,g=(a,d)=>{let e=(0,b.getCurrentWindow)().label,g=new c.WebviewWindow(`${"main"===e?"reader":e}-${f}`,{url:d,width:800,height:600,center:!0,resizable:!0,title:a.isMacOSApp?"":"Readest",decorations:!!a.isMacOSApp,transparent:!a.isMacOSApp,shadow:!a.isMacOSApp||void 0,titleBarStyle:a.isMacOSApp?"overlay":void 0});g.once("tauri://created",()=>{console.log("new window created"),f+=1}),g.once("tauri://error",a=>{console.error("error creating window",a)}),g.once("tauri://destroyed",()=>{f-=1})};a.s(["navigateToLibrary",0,(a,b,c,d)=>{a.replace(`/library${b?`?${b}`:""}`,c)},"navigateToLogin",0,a=>{let b=window.location.pathname,c=window.location.search;a.push(`/auth?redirect=${encodeURIComponent("/auth"!==b?b+c:"/")}`)},"navigateToProfile",0,a=>{a.push("/user")},"navigateToReader",0,(a,b,c,f)=>{let g=b.join(e.BOOK_IDS_SEPARATOR);if((0,d.isWebAppPlatform)()&&!(0,d.isPWA)())a.push(`/reader/${g}${c?`?${c}`:""}`,f);else{let b=new URLSearchParams(c||"");b.set("ids",g),a.push(`/reader?${b.toString()}`,f)}},"showLibraryWindow",0,(a,b)=>{let c=new URLSearchParams;b.forEach(a=>c.append("file",a)),g(a,`/library?${c.toString()}`)},"showReaderWindow",0,(a,b)=>{let c=b.join(e.BOOK_IDS_SEPARATOR),d=new URLSearchParams("");d.set("ids",c),g(a,`/reader?${d.toString()}`)}])},444789,a=>{"use strict";var b=a.i(936630),c=a.i(586360),d=a.i(858630),e=a.i(619974),f=a.i(690557);let g=async()=>{let a=(0,b.getCurrentWindow)(),c=await a.scaleFactor(),d=await a.outerPosition();return{x:d.x/c,y:d.y/c}},h=async()=>{(0,b.getCurrentWindow)().minimize()},i=async()=>{let a=await (0,b.getCurrentWindow)().innerSize();a.width-=1,a.height-=1,await (0,b.getCurrentWindow)().setSize(a),setTimeout(async()=>{let a=await (0,b.getCurrentWindow)().innerSize();a.width+=1,a.height+=1,await (0,b.getCurrentWindow)().setSize(a)},100)},j=async()=>{let a=(0,b.getCurrentWindow)();await a.isFullscreen()?(await a.setFullscreen(!1),await a.unmaximize()):await a.toggleMaximize(),await (0,e.type)()==="linux"&&i()},k=async()=>{(0,b.getCurrentWindow)().close()},l=async a=>{let d=(0,b.getCurrentWindow)();return await d.onCloseRequested(async b=>{b.preventDefault(),await a(),d.label.startsWith("reader")?(await (0,c.emitTo)("main","close-reader-window",{label:d.label}),setTimeout(()=>d.destroy(),300)):"main"===d.label&&await d.destroy()})},m=async()=>{let a=(0,b.getCurrentWindow)(),c=await a.isFullscreen();await a.isMaximized()?await a.unmaximize():await a.setFullscreen(!c),await (0,e.type)()==="linux"&&i()},n=async a=>{let c=(0,b.getCurrentWindow)();await c.setAlwaysOnTop(a)},o=async()=>{await f.eventDispatcher.dispatch("quit-app"),await (0,d.exit)(0)};a.s(["tauriGetWindowLogicalPosition",0,g,"tauriHandleClose",0,k,"tauriHandleMinimize",0,h,"tauriHandleOnCloseWindow",0,l,"tauriHandleSetAlwaysOnTop",0,n,"tauriHandleToggleFullScreen",0,m,"tauriHandleToggleMaximize",0,j,"tauriQuitApp",0,o])},777470,a=>{"use strict";var b=a.i(92585),c=a.i(239337),d=a.i(649970),e=a.i(407027),f=a.i(690557);a.s(["Toast",0,()=>{let{safeAreaInsets:a}=(0,e.useThemeStore)(),[g,h]=(0,d.useState)(""),[i,j]=(0,d.useState)("info"),[k,l]=(0,d.useState)(5e3),[m,n]=(0,d.useState)(""),[o,p]=(0,d.useState)(!1),q=(0,d.useRef)(null),r={info:"toast-info toast-center toast-middle",success:"toast-success toast-top sm:toast-end toast-center",warning:"toast-warning toast-top sm:toast-end toast-center",error:"toast-error toast-top sm:toast-end toast-center"},s={info:(0,b.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),success:(0,b.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),warning:(0,b.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),error:(0,b.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})};(0,d.useEffect)(()=>{g&&setTimeout(()=>{p(!0)},0)},[g]),(0,d.useEffect)(()=>{if(q.current&&clearTimeout(q.current),g){let a=setTimeout(()=>{p(!1),setTimeout(()=>h(""),300)},k);return q.current=a,()=>{a&&clearTimeout(a)}}},[g,k]);let t=async a=>{let{message:b,type:c="info",timeout:d,className:e="",callback:f=null}=a.detail;h(b),j(c),d&&l(d),f&&"function"==typeof f&&setTimeout(()=>f(),d||5e3),n(e)};return(0,d.useEffect)(()=>(f.eventDispatcher.on("toast",t),()=>{f.eventDispatcher.off("toast",t)}),[]),g&&(0,b.jsx)("div",{className:(0,c.default)("toast z-50 w-auto max-w-screen-sm transition-all duration-300",r[i],o?"scale-100 opacity-100":"scale-95 opacity-0"),style:{top:r[i].includes("toast-top")?`${(a?.top||0)+44}px`:void 0},children:(0,b.jsxs)("div",{className:(0,c.default)("alert flex items-center gap-3 shadow-2xl backdrop-blur-sm","min-h-0 rounded-2xl px-5 py-4","not-eink:bg-gradient-to-r border-0",{info:"alert-primary border-base-300",success:"alert-success not-eink:from-green-500 not-eink:to-emerald-500",warning:"alert-warning not-eink:from-amber-500 not-eink:to-orange-500",error:"alert-error not-eink:from-red-500 not-eink:to-rose-500"}[i],"eink:bg-base-100 eink:border eink:border-base-content","info"!==i&&"text-white"),children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:s[i]}),(0,b.jsx)("span",{className:(0,c.default)("max-h-[50vh] flex-1 overflow-y-auto","font-sans text-base font-medium leading-snug sm:text-sm","info"===i?"max-w-[60vw] truncate sm:max-w-[80vw]":"min-w-[60vw] max-w-[80vw] whitespace-normal break-words sm:min-w-40 sm:max-w-80",m),children:g.split("\n").map((a,c)=>(0,b.jsxs)(d.default.Fragment,{children:[a||(0,b.jsx)(b.Fragment,{children:"Â "}),c<g.split("\n").length-1&&(0,b.jsx)("br",{})]},c))}),(0,b.jsx)("button",{onClick:()=>{p(!1),setTimeout(()=>h(""),300),q.current&&clearTimeout(q.current)},className:(0,c.default)("flex-shrink-0 rounded-lg p-1 transition-colors","info"===i?"hover:bg-base-300":"hover:bg-white/20 active:bg-white/30"),"aria-label":"Dismiss",children:(0,b.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})}])},946687,a=>{"use strict";var b=a.i(968366),c=a.i(11491);let d=(0,b.create)((b,d)=>({appService:void 0,isTrafficLightVisible:!1,shouldShowTrafficLight:!1,trafficLightInFullscreen:!1,initializeTrafficLightStore:a=>{b({appService:a,isTrafficLightVisible:a.hasTrafficLight,shouldShowTrafficLight:a.hasTrafficLight})},setTrafficLightVisibility:async(d,e)=>{let{getCurrentWindow:f}=await a.A(736219),g=f(),h=await g.isFullscreen();b({isTrafficLightVisible:!h&&d,shouldShowTrafficLight:d,trafficLightInFullscreen:h}),(0,c.invoke)("set_traffic_lights",{visible:d,x:e?.x??10,y:e?.y??22})},initializeTrafficLightListeners:async()=>{let{getCurrentWindow:c}=await a.A(736219),e=c(),f=await e.listen("will-enter-fullscreen",()=>{b({isTrafficLightVisible:!1,trafficLightInFullscreen:!0})}),g=await e.listen("will-exit-fullscreen",()=>{let{shouldShowTrafficLight:a}=d();b({isTrafficLightVisible:a,trafficLightInFullscreen:!1})});b({unlistenEnterFullScreen:f,unlistenExitFullScreen:g})},cleanupTrafficLightListeners:()=>{let{unlistenEnterFullScreen:a,unlistenExitFullScreen:c}=d();a&&a(),c&&c(),b({unlistenEnterFullScreen:void 0,unlistenExitFullScreen:void 0})}}));a.s(["useTrafficLightStore",0,d])},940333,a=>{"use strict";var b=a.i(92585),c=a.i(239337),d=a.i(649970),e=a.i(592385),f=a.i(444789),g=a.i(833047),h=a.i(506017);let i=({onClick:a,label:c,id:d,children:e})=>(0,b.jsx)("button",{id:d,onClick:a,className:"window-button bg-base-200/35 hover:bg-base-200 text-base-content/85 hover:text-base-content","aria-label":c,children:e});a.s(["default",0,({className:j,headerRef:k,showMinimize:l=!0,showMaximize:m=!0,showClose:n=!0,onMinimize:o,onToggleMaximize:p,onClose:q})=>{let r=(0,h.useTranslation)(),s=(0,d.useRef)(null),{appService:t}=(0,e.useEnv)(),u=(0,d.useRef)({lastPointerTime:0,pointerStartPosition:{x:0,y:0},isDragging:!1}),v=a=>a.closest(".btn")||a.closest(".window-button")||a.closest(".dropdown-container")||a.closest(".exclude-title-bar-mousedown"),w=async b=>{if(v(b.target))return;let{getCurrentWindow:c}=await a.A(736219);1===b.buttons&&(2===b.detail?c().toggleMaximize():c().startDragging())},x=async b=>{if(v(b.target)||"mouse"===b.pointerType)return;b.preventDefault();let c=Date.now(),d=c-u.current.lastPointerTime;if(u.current.pointerStartPosition={x:b.clientX,y:b.clientY},d<300){let{getCurrentWindow:b}=await a.A(736219);b().toggleMaximize();return}u.current.lastPointerTime=c,u.current.isDragging=!1},y=async b=>{if(v(b.target)||u.current.isDragging||"mouse"===b.pointerType)return;b.preventDefault();let c=Math.abs(b.clientX-u.current.pointerStartPosition.x),d=Math.abs(b.clientY-u.current.pointerStartPosition.y);if(c>5||d>5){u.current.isDragging=!0;try{let{getCurrentWindow:b}=await a.A(736219);await b().startDragging()}catch(a){console.warn("Failed to start window dragging:",a)}}},z=()=>{u.current.isDragging=!1};(0,d.useEffect)(()=>{if(!(0,g.isTauriAppPlatform)())return;let a=k?.current;if(a)return a.addEventListener("mousedown",w),a.addEventListener("pointerdown",x),a.addEventListener("pointermove",y),a.addEventListener("pointerup",z),a.addEventListener("pointercancel",z),()=>{a.removeEventListener("mousedown",w),a.removeEventListener("pointerdown",x),a.removeEventListener("pointermove",y),a.removeEventListener("pointerup",z),a.removeEventListener("pointercancel",z)}},[]);let A=async()=>{o?o():(0,f.tauriHandleMinimize)()},B=async()=>{p?p():(0,f.tauriHandleToggleMaximize)()},C=async()=>{q?q():(0,f.tauriHandleClose)()};return(0,b.jsxs)("div",{ref:s,className:(0,c.default)("window-buttons flex h-8 items-center justify-end space-x-2",n||m||l?"visible":"hidden",j),children:[l&&t?.hasWindowBar&&(0,b.jsx)(i,{onClick:A,label:r("Minimize"),id:"titlebar-minimize",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{fill:"currentColor",d:"M20 14H4v-2h16"})})}),m&&t?.hasWindowBar&&(0,b.jsx)(i,{onClick:B,label:r("Maximize or Restore"),id:"titlebar-maximize",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{fill:"currentColor",d:"M4 4h16v16H4zm2 4v10h12V8z"})})}),n&&(t?.hasWindowBar||q)&&(0,b.jsx)(i,{onClick:C,label:r("Close"),id:"titlebar-close",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})})})]})}])}];

//# sourceMappingURL=apps_readest-app_src_bc173b46._.js.map