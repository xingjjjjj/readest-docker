module.exports=[467475,774612,952820,168780,a=>{"use strict";var b=a.i(92585),c=a.i(649970);let d=new class{async pullChanges(a,b,c,d){return console.log("[SyncClient] Cloud sync disabled (local storage mode)"),{books:null,configs:null,notes:null}}async pushChanges(a){return console.log("[SyncClient] Cloud sync disabled (local storage mode)"),{books:null,configs:null,notes:null}}},e=(0,c.createContext)({syncClient:d});a.s(["SyncProvider",0,({children:a})=>(0,b.jsx)(e.Provider,{value:{syncClient:d},children:a}),"useSyncContext",0,()=>(0,c.useContext)(e)],467475);var f=a.i(968366),g=a.i(941287),h=a.i(446338);let i=[{id:"none",name:"None",url:"",loaded:!0},{id:"concrete",name:"Concrete",url:"/images/concrete-texture.png",loaded:!0},{id:"paper",name:"Paper",url:"/images/paper-texture.png",loaded:!0},{id:"sand",name:"Sand",url:"/images/sand-texture.jpg",loaded:!0},{id:"parchment",name:"Parchment",url:"/images/parchment-paper.jpg",loaded:!0},{id:"scrapbook",name:"Scrapbook",url:"/images/scrapbook-texture.jpg",loaded:!0},{id:"leaves",name:"Leaves",url:"/images/leaves-pattern.jpg",loaded:!0},{id:"moon",name:"Moon Sky",url:"/images/moon-sky.jpg",loaded:!0},{id:"night-sky",name:"Night Sky",url:"/images/night-sky.jpg",loaded:!0}];function j(a){let b=(0,g.getFilename)(a).replace(/\.(jpg|jpeg|png|gif|bmp|webp)$/i,"");return{id:(0,h.md5Fingerprint)(b),name:b,path:a}}let k="background-texture",l=(a,b)=>{let c=a.getElementById(k)||a.createElement("style");c.id=k,c.textContent=`
    .sidebar-container, .notebook-container, .foliate-viewer {
      position: relative;
    }

    body::before, .sidebar-container::before, .notebook-container::before,
    .foliate-viewer::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 0;
      background-image: url("${b.blobUrl||b.url}");
      background-repeat: repeat;
      background-size: var(--bg-texture-size, cover);
      mix-blend-mode: var(--bg-texture-blend-mode, multiply);
      opacity: var(--bg-texture-opacity, 0.6);
    }
    body::before {
      height: 100vh;
    }
    `,c.parentNode||a.head.appendChild(c)},m=a=>{let b=a.getElementById(k);b&&b.parentNode&&b.parentNode.removeChild(b)};a.s(["PREDEFINED_TEXTURES",0,i,"createCustomTexture",()=>j,"mountBackgroundTexture",0,l,"unmountBackgroundTexture",0,m],774612);var n=a.i(947218);function o(a){let{blobUrl:b,loaded:c,error:d,...e}=a;return e}let p=(0,f.create)((a,b)=>({textures:[],loading:!1,setTextures:b=>a({textures:b}),addTexture:c=>{let d=j(c),e=b().textures.find(a=>a.id===d.id);if(e)return b().updateTexture(d.id,{...d,path:d.path,downloadedAt:Date.now(),deletedAt:void 0,loaded:!1,blobUrl:void 0,error:void 0}),a(a=>({textures:[...a.textures]})),e;let f={...d,downloadedAt:Date.now()};return a(a=>({textures:[...a.textures,f]})),f},removeTexture:c=>{let d=b().getTexture(c);if(!d)return!1;d.blobUrl&&URL.revokeObjectURL(d.blobUrl);let e=b().updateTexture(c,{deletedAt:Date.now(),blobUrl:void 0,loaded:!1,error:void 0});return a(a=>({textures:[...a.textures]})),e},updateTexture:(c,d)=>{let e=b().textures.findIndex(a=>a.id===c);return -1!==e&&(a(a=>({textures:a.textures.map((a,b)=>b===e?{...a,...d}:a)})),!0)},getTexture:a=>b().textures.find(b=>b.id===a),getAllTextures:()=>b().textures,getAvailableTextures:()=>b().textures.filter(a=>!a.deletedAt),clearAllTextures:()=>{let{textures:c}=b();c.forEach(a=>{a.blobUrl&&URL.revokeObjectURL(a.blobUrl)}),a({textures:[]})},loadTexture:async(a,c)=>{let d=b().getTexture(c);if(!d)throw Error(`Texture with id "${c}" not found`);if(d.deletedAt)throw Error(`Texture "${d.name}" has been deleted`);if(d.loaded&&d.blobUrl&&!d.error)return d;try{b().updateTexture(c,{loaded:!1,error:void 0});let e=await a.getAppService(),f=await e.openFile(d.path,"Images"),g=d.path.split(".").pop()?.toLowerCase(),h=new Blob([await f.arrayBuffer()],{type:{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",bmp:"image/bmp"}[g||""]||"image/jpeg"}),i=URL.createObjectURL(h);return b().updateTexture(c,{blobUrl:i,loaded:!0,error:void 0}),b().getTexture(c)}catch(d){let a=d instanceof Error?d.message:"Unknown error";throw b().updateTexture(c,{loaded:!1,error:a,blobUrl:void 0}),d}},loadTextures:async(c,d)=>{a({loading:!0});try{return(await Promise.allSettled(d.map(a=>b().loadTexture(c,a)))).filter(a=>"fulfilled"===a.status).map(a=>a.value)}finally{a({loading:!1})}},loadAllTextures:async a=>{let c=b().getAvailableTextures().map(a=>a.id);return await b().loadTextures(a,c)},unloadTexture:a=>{let c=b().getTexture(a);return c?.blobUrl&&URL.revokeObjectURL(c.blobUrl),b().updateTexture(a,{blobUrl:void 0,loaded:!1,error:void 0})},unloadAllTextures:()=>{let a=b().getAllTextures();a.forEach(a=>{a.blobUrl&&URL.revokeObjectURL(a.blobUrl)}),a.forEach(a=>{b().updateTexture(a.id,{blobUrl:void 0,loaded:!1,error:void 0})})},getLoadedTextures:()=>b().getAvailableTextures().filter(a=>a.loaded&&!a.error),isTextureLoaded:a=>{let c=b().getTexture(a);return c?.loaded===!0&&!c.error&&!c.deletedAt},applyTexture:async(a,c)=>{let d=b().getAvailableTextures(),e=[...i,...d].find(a=>a.id===c);e&&"none"!==e.id?(d.find(a=>a.id===c)&&!b().isTextureLoaded(c)&&(e=await b().loadTexture(a,c)),l(document,e)):m(document)},loadCustomTextures:async c=>{try{let{settings:d}=n.useSettingsStore.getState(),e=b().textures;if(d?.customTextures){let f=d.customTextures.map(a=>{let b=e.find(b=>b.id===a.id);return{...a,loaded:b?.loaded||!1,error:b?.error,blobUrl:b?.blobUrl}});a({textures:f}),await b().loadAllTextures(c)}}catch(a){console.error("Failed to load custom textures settings:",a)}},saveCustomTextures:async a=>{try{let{settings:c,setSettings:d,saveSettings:e}=n.useSettingsStore.getState(),{textures:f}=b();c.customTextures=f.map(o),d(c),e(a,c)}catch(a){throw console.error("Failed to save custom textures settings:",a),a}}}));a.s(["useCustomTextureStore",0,p],952820);var q=a.i(407027);a.s(["useEinkMode",0,()=>{let{setIsEinkMode:a}=(0,q.useThemeStore)();return{applyEinkMode:(0,c.useCallback)(b=>{a(b),b?document.body.classList.add("no-transitions"):document.body.classList.remove("no-transitions"),document.documentElement.setAttribute("data-eink",b.toString())},[a])}}],168780)},941287,a=>{"use strict";var b=a.i(461937),c=a.i(73552);let d=async(...a)=>await (0,b.join)(...a);a.s(["getBaseFilename",0,a=>{let b=a.replace(/\\/g,"/").split("/").pop()||"",c=b.split(".");return c.length<=1?b:c.slice(0,-1).join(".")},"getDirPath",0,a=>{let b=a.replace(/\\/g,"/").split("/");return b.pop(),b.join("/")},"getFilename",0,a=>(((0,c.isValidURL)(a)||(0,c.isContentURI)(a)||(0,c.isFileURI)(a))&&(a=decodeURI(a)),a.replace(/\\/g,"/").split("/").pop().split("?")[0]),"joinPaths",0,d])},243648,a=>{"use strict";var b=a.i(73552);let c=a=>{if(!a)return"auto";let b=new Set(["ar","he","fa","ur","dv","ps","sd","yi"]),c=a.split("-")[0].toLowerCase();return b.has(c)?"rtl":"auto"};a.s(["getDirFromLanguage",0,c,"getDirFromUILanguage",0,()=>c((0,b.getUserLang)())])},446338,a=>{"use strict";var b=a.i(808091);function c(a){return/^[0-9a-f]{32}$/.test(a)}function d(a){return(0,b.md5)(a).slice(0,7)}async function e(a){let c=b.md5.create();for(let b=-1;b<=10;b++){let d=Math.min(a.size,1024<<2*b),e=Math.min(d+1024,a.size);if(d>=a.size)break;let f=a.slice(d,e),g=new Uint8Array(await f.arrayBuffer());c.update(g)}return c.hex()}a.s(["isMd5",()=>c,"md5Fingerprint",()=>d,"partialMD5",()=>e])},461937,a=>{"use strict";var b,c,d=a.i(11491);async function e(){return(0,d.invoke)("plugin:path|resolve_directory",{directory:c.AppConfig})}async function f(){return(0,d.invoke)("plugin:path|resolve_directory",{directory:c.AppData})}async function g(){return(0,d.invoke)("plugin:path|resolve_directory",{directory:c.AppCache})}async function h(){return(0,d.invoke)("plugin:path|resolve_directory",{directory:c.Document})}async function i(){return(0,d.invoke)("plugin:path|resolve_directory",{directory:c.AppLog})}async function j(){return(0,d.invoke)("plugin:path|resolve_directory",{directory:c.Temp})}async function k(...a){return(0,d.invoke)("plugin:path|join",{paths:a})}async function l(a,b){return(0,d.invoke)("plugin:path|basename",{path:a,ext:b})}(b=c||(c={}))[b.Audio=1]="Audio",b[b.Cache=2]="Cache",b[b.Config=3]="Config",b[b.Data=4]="Data",b[b.LocalData=5]="LocalData",b[b.Document=6]="Document",b[b.Download=7]="Download",b[b.Picture=8]="Picture",b[b.Public=9]="Public",b[b.Video=10]="Video",b[b.Resource=11]="Resource",b[b.Temp=12]="Temp",b[b.AppConfig=13]="AppConfig",b[b.AppData=14]="AppData",b[b.AppLocalData=15]="AppLocalData",b[b.AppCache=16]="AppCache",b[b.AppLog=17]="AppLog",b[b.Desktop=18]="Desktop",b[b.Executable=19]="Executable",b[b.Font=20]="Font",b[b.Home=21]="Home",b[b.Runtime=22]="Runtime",b[b.Template=23]="Template",a.s(["BaseDirectory",()=>c,"appCacheDir",()=>g,"appConfigDir",()=>e,"appDataDir",()=>f,"appLogDir",()=>i,"basename",()=>l,"documentDir",()=>h,"join",()=>k,"tempDir",()=>j])},877048,a=>{"use strict";var b=a.i(680472);a.s(["getAppVersion",0,()=>b.default.version])}];

//# sourceMappingURL=_12cc038b._.js.map