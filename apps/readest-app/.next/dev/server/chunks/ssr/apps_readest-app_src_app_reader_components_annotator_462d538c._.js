module.exports = [
"[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationTools.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "annotationToolButtons",
    ()=>annotationToolButtons,
    "annotationToolQuickActions",
    ()=>annotationToolQuickActions
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fi$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/fi/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$pi$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/pi/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fa$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/fa/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$bs$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/bs/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$tb$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/tb/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fa6$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/fa6/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$io$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/io/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/misc.ts [ssr] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
function createAnnotationToolButtons(buttons) {
    return buttons;
}
const annotationToolButtons = createAnnotationToolButtons([
    {
        type: 'copy',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Copy'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Copy text after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fi$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["FiCopy"]
    },
    {
        type: 'highlight',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Highlight'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Highlight text after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$pi$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["PiHighlighterFill"],
        quickAction: true
    },
    {
        type: 'annotate',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Annotate'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Annotate text after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$bs$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["BsPencilSquare"]
    },
    {
        type: 'search',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Search'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Search text after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fi$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["FiSearch"],
        quickAction: true
    },
    {
        type: 'dictionary',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Dictionary'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Look up text in dictionary after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$tb$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["TbHexagonLetterD"],
        quickAction: true
    },
    {
        type: 'wikipedia',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Wikipedia'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Look up text in Wikipedia after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fa$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["FaWikipediaW"],
        quickAction: true
    },
    {
        type: 'translate',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Translate'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Translate text after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$bs$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["BsTranslate"],
        quickAction: true
    },
    {
        type: 'tts',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Speak'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Read text aloud after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fa6$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["FaHeadphones"],
        quickAction: true
    },
    {
        type: 'proofread',
        label: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Proofread'),
        tooltip: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["stubTranslation"])('Proofread text after selection'),
        Icon: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$io$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["IoIosBuild"]
    }
]);
const annotationToolQuickActions = annotationToolButtons.filter((button)=>button.quickAction);
}),
"[project]/apps/readest-app/src/app/reader/components/annotator/QuickActionMenu.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslation.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationTools$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationTools.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/event.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$MenuItem$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/MenuItem.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Menu$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Menu.tsx [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$MenuItem$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Menu$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$MenuItem$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Menu$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
;
;
;
;
;
;
;
const QuickActionMenu = ({ selectedAction, onActionSelect, setIsDropdownOpen })=>{
    const _ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslation"])();
    const handleActionClick = (action)=>{
        onActionSelect(action);
        if (selectedAction === action) {
            __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('toast', {
                type: 'info',
                timeout: 2000,
                message: _('Quick action disabled')
            });
        } else {
            __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('toast', {
                type: 'info',
                timeout: 2000,
                message: _(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationTools$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["annotationToolQuickActions"].find((btn)=>btn.type === action)?.tooltip || '')
            });
        }
        setIsDropdownOpen?.(false);
    };
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Menu$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
        className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('annotation-quick-action-menu dropdown-content z-20 mt-1 border', 'bgcolor-base-200 shadow-2xl'),
        style: {
            maxWidth: `${window.innerWidth - 40}px`
        },
        onCancel: ()=>setIsDropdownOpen?.(false),
        children: __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationTools$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["annotationToolQuickActions"].map((button)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$MenuItem$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                label: _(button.label),
                tooltip: _(button.tooltip),
                buttonClass: selectedAction === button.type ? 'bg-base-300/85' : '',
                Icon: button.Icon,
                onClick: ()=>handleActionClick(button.type)
            }, button.type, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/QuickActionMenu.tsx",
                lineNumber: 54,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0)))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/QuickActionMenu.tsx",
        lineNumber: 43,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = QuickActionMenu;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/themeStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/settingsStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useResponsiveSize.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useAnnotationEditor$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/hooks/useAnnotationEditor.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$utils$2f$annotatorUtil$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/utils/annotatorUtil.ts [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useAnnotationEditor$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useAnnotationEditor$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
;
;
;
;
const Handle = ({ position, isVertical, type, color, onDragStart, onDrag, onDragEnd })=>{
    const isDragging = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])(false);
    const size = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(24);
    const circleRadius = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(8);
    const stemHeight = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(12);
    const handlePointerDown = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])((e)=>{
        e.preventDefault();
        e.stopPropagation();
        isDragging.current = true;
        onDragStart();
        e.target.setPointerCapture(e.pointerId);
    }, [
        onDragStart
    ]);
    const handlePointerMove = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])((e)=>{
        if (!isDragging.current) return;
        e.preventDefault();
        e.stopPropagation();
        onDrag({
            x: e.clientX,
            y: e.clientY
        });
    }, [
        onDrag
    ]);
    const handlePointerUp = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])((e)=>{
        if (!isDragging.current) return;
        e.preventDefault();
        e.stopPropagation();
        isDragging.current = false;
        e.target.releasePointerCapture(e.pointerId);
        onDragEnd();
    }, [
        onDragEnd
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        className: "pointer-events-auto absolute z-50 cursor-grab touch-none active:cursor-grabbing",
        style: {
            left: isVertical ? type === 'start' ? position.x - size / 2 + stemHeight / 4 : position.x - size / 2 : position.x - size / 2,
            top: isVertical ? type === 'start' ? position.y - size + stemHeight / 2 : position.y - size / 2 - stemHeight / 2 : type === 'start' ? position.y - size : position.y - size / 2 - stemHeight / 8,
            width: size,
            height: size + stemHeight
        },
        onPointerDown: handlePointerDown,
        onPointerMove: handlePointerMove,
        onPointerUp: handlePointerUp,
        onPointerCancel: handlePointerUp,
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("svg", {
            width: size,
            height: size + stemHeight,
            viewBox: `0 0 ${size} ${size + stemHeight}`,
            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])(type === 'start' && 'rotate-180'),
            style: {
                transform: isVertical ? type === 'start' ? 'rotate(270deg)' : 'rotate(90deg)' : type === 'start' ? 'rotate(180deg)' : undefined
            },
            children: [
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("line", {
                    x1: size / 2,
                    y1: 0,
                    x2: size / 2,
                    y2: stemHeight,
                    stroke: color,
                    strokeWidth: 2,
                    strokeLinecap: "round"
                }, void 0, false, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx",
                    lineNumber: 111,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("circle", {
                    cx: size / 2,
                    cy: stemHeight + circleRadius,
                    r: circleRadius,
                    fill: color
                }, void 0, false, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx",
                    lineNumber: 121,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0))
            ]
        }, void 0, true, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx",
            lineNumber: 95,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx",
        lineNumber: 72,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const AnnotationRangeEditor = ({ bookKey, isVertical, annotation, selection, handleColor, getAnnotationText, setSelection, onStartEdit })=>{
    const { settings } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useSettingsStore"])();
    const { isDarkMode } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useThemeStore"])();
    const isEink = settings.globalViewSettings.isEink;
    const einkFgColor = isDarkMode ? '#ffffff' : '#000000';
    const { handlePositions, getHandlePositionsFromRange, handleAnnotationRangeChange } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useAnnotationEditor$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useAnnotationEditor"])({
        bookKey,
        annotation,
        getAnnotationText,
        setSelection
    });
    const initializedRef = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])(false);
    const handleColorHex = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$utils$2f$annotatorUtil$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getHighlightColorHex"])(settings, handleColor) ?? '#FFFF00';
    const draggingRef = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])(null);
    const startRef = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])({
        x: 0,
        y: 0
    });
    const endRef = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])({
        x: 0,
        y: 0
    });
    const [currentStart, setCurrentStart] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])({
        x: 0,
        y: 0
    });
    const [currentEnd, setCurrentEnd] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])({
        x: 0,
        y: 0
    });
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        if (initializedRef.current) return;
        initializedRef.current = true;
        const range = selection.range;
        const positions = getHandlePositionsFromRange(range, isVertical);
        if (positions) {
            setTimeout(()=>{
                setCurrentStart(positions.start);
                setCurrentEnd(positions.end);
            }, 0);
            startRef.current = positions.start;
            endRef.current = positions.end;
        }
    }, [
        annotation,
        selection,
        isVertical,
        getHandlePositionsFromRange
    ]);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        if (!handlePositions || draggingRef.current) return;
        setTimeout(()=>{
            setCurrentStart(handlePositions.start);
            setCurrentEnd(handlePositions.end);
        }, 0);
        startRef.current = handlePositions.start;
        endRef.current = handlePositions.end;
    }, [
        handlePositions
    ]);
    const handleStartDragStart = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])(()=>{
        draggingRef.current = 'start';
        onStartEdit();
    }, [
        onStartEdit
    ]);
    const handleEndDragStart = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])(()=>{
        draggingRef.current = 'end';
        onStartEdit();
    }, [
        onStartEdit
    ]);
    const handleStartDrag = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])((point)=>{
        setCurrentStart(point);
        startRef.current = point;
        handleAnnotationRangeChange(point, endRef.current, isVertical, true);
    }, [
        isVertical,
        handleAnnotationRangeChange
    ]);
    const handleEndDrag = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])((point)=>{
        setCurrentEnd(point);
        endRef.current = point;
        handleAnnotationRangeChange(startRef.current, point, isVertical, true);
    }, [
        isVertical,
        handleAnnotationRangeChange
    ]);
    const handleDragEnd = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])(()=>{
        draggingRef.current = null;
        handleAnnotationRangeChange(startRef.current, endRef.current, isVertical, false);
    }, [
        isVertical,
        handleAnnotationRangeChange
    ]);
    if (currentStart.x === 0 && currentStart.y === 0) {
        return null;
    }
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        className: "pointer-events-none fixed inset-0 z-50",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(Handle, {
                position: currentStart,
                isVertical: isVertical,
                type: "start",
                color: isEink ? einkFgColor : handleColorHex,
                onDragStart: handleStartDragStart,
                onDrag: handleStartDrag,
                onDragEnd: handleDragEnd
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx",
                lineNumber: 228,
                columnNumber: 7
            }, ("TURBOPACK compile-time value", void 0)),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(Handle, {
                position: currentEnd,
                isVertical: isVertical,
                type: "end",
                color: isEink ? einkFgColor : handleColorHex,
                onDragStart: handleEndDragStart,
                onDrag: handleEndDrag,
                onDragEnd: handleDragEnd
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx",
                lineNumber: 237,
                columnNumber: 7
            }, ("TURBOPACK compile-time value", void 0))
        ]
    }, void 0, true, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx",
        lineNumber: 227,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = AnnotationRangeEditor;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationToolButton.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
const AnnotationToolButton = ({ showTooltip, tooltipText, disabled, Icon, onClick })=>{
    const [buttonClicked, setButtonClicked] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const handleClick = ()=>{
        setButtonClicked(true);
        onClick();
    };
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        className: "lg:tooltip lg:tooltip-bottom",
        title: !buttonClicked && showTooltip ? tooltipText : undefined,
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("button", {
            onClick: handleClick,
            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('flex h-8 min-h-8 w-8 items-center justify-center p-0', disabled ? 'cursor-not-allowed opacity-50' : 'not-eink:hover:bg-gray-500 eink:hover:border rounded-md'),
            disabled: disabled,
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(Icon, {}, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationToolButton.tsx",
                lineNumber: 41,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0))
        }, void 0, false, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationToolButton.tsx",
            lineNumber: 31,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationToolButton.tsx",
        lineNumber: 27,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = AnnotationToolButton;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$dayjs__$5b$external$5d$__$28$dayjs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/dayjs [external] (dayjs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/context/EnvContext.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/bookDataStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/readerStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$sidebarStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/sidebarStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useResponsiveSize.ts [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$sidebarStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$sidebarStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
;
;
;
;
;
const AnnotationNotes = ({ bookKey, isVertical, notes, toolsVisible, triangleDir, popupWidth, popupHeight, onDismiss })=>{
    const { appService } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["useEnv"])();
    const { getConfig, setConfig } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useBookDataStore"])();
    const { setHoveredBookKey } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useReaderStore"])();
    const { setSideBarVisible } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$sidebarStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useSidebarStore"])();
    const config = getConfig(bookKey);
    const maxSize = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(250);
    const sortedNotes = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useMemo"])(()=>{
        return [
            ...notes
        ].sort((a, b)=>b.updatedAt - a.updatedAt);
    }, [
        notes
    ]);
    const handleShowAnnotation = (note)=>{
        if (!note.id) return;
        if (appService?.isMobile) {
            onDismiss();
        }
        setHoveredBookKey('');
        setSideBarVisible(true);
        if (config?.viewSettings) {
            setConfig(bookKey, {
                viewSettings: {
                    ...config.viewSettings,
                    sideBarTab: 'annotations'
                }
            });
        }
    };
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('annotation-notes absolute flex rounded-lg text-white'),
        style: {
            ...isVertical ? {
                right: triangleDir === 'left' ? `${toolsVisible ? popupWidth + 16 : 0}px` : undefined,
                left: triangleDir === 'right' ? `${toolsVisible ? popupWidth + 16 : 0}px` : undefined,
                height: `${popupHeight}px`,
                maxWidth: `${maxSize}px`,
                overflowX: 'auto'
            } : {
                top: triangleDir === 'down' ? `${toolsVisible ? popupHeight + 16 : 0}px` : undefined,
                bottom: triangleDir === 'up' ? `${toolsVisible ? popupHeight + 16 : 0}px` : undefined,
                width: `${popupWidth}px`,
                maxHeight: `${maxSize}px`,
                overflowY: 'auto'
            },
            scrollbarWidth: 'thin'
        },
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('flex gap-4', isVertical ? 'h-full flex-row' : 'w-full flex-col'),
            style: isVertical ? {
                display: 'grid',
                gridAutoFlow: 'column',
                gridAutoColumns: 'max-content',
                minWidth: 'min-content',
                height: `${popupHeight}px`,
                maxHeight: `${popupHeight}px`
            } : {},
            children: sortedNotes.map((note, index)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    role: "none",
                    onClick: ()=>handleShowAnnotation?.(note),
                    className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('popup-container cursor-pointer rounded-lg bg-gray-600 shadow-lg transition-colors'),
                    style: isVertical ? {
                        minWidth: 'max-content',
                        height: `${popupHeight}px`,
                        maxHeight: `${popupHeight}px`
                    } : {},
                    children: note.note && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                        dir: "auto",
                        className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('m-4 hyphens-auto text-justify font-sans text-sm', 'not-eink:text-white eink:text-base-content', isVertical && 'writing-vertical-rl'),
                        style: isVertical ? {
                            fontFeatureSettings: "'vrt2' 1, 'vert' 1",
                            minWidth: 'max-content'
                        } : {},
                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('flex flex-col justify-between gap-2'),
                            children: [
                                note.note,
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                    className: "not-eink:text-white/50 eink:text-base-content/50 text-sm sm:text-xs",
                                    children: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$dayjs__$5b$external$5d$__$28$dayjs$2c$__cjs$29$__["default"])(note.createdAt).fromNow()
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx",
                                    lineNumber: 135,
                                    columnNumber: 19
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx",
                            lineNumber: 133,
                            columnNumber: 17
                        }, ("TURBOPACK compile-time value", void 0))
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx",
                        lineNumber: 117,
                        columnNumber: 15
                    }, ("TURBOPACK compile-time value", void 0))
                }, note.id || index, false, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx",
                    lineNumber: 99,
                    columnNumber: 11
                }, ("TURBOPACK compile-time value", void 0)))
        }, void 0, false, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx",
            lineNumber: 83,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx",
        lineNumber: 62,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = AnnotationNotes;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fa$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/fa/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/context/EnvContext.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/themeStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/settingsStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useResponsiveSize.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/helpers/settings.ts [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
;
;
;
;
;
const styles = [
    'highlight',
    'underline',
    'squiggly'
];
const colors = [
    'red',
    'violet',
    'blue',
    'green',
    'yellow'
];
const OPTIONS_HEIGHT_PIX = 28;
const OPTIONS_PADDING_PIX = 16;
const HighlightOptions = ({ isVertical, popupWidth, popupHeight, triangleDir, selectedStyle: _selectedStyle, selectedColor: _selectedColor, onHandleHighlight })=>{
    const { envConfig } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["useEnv"])();
    const { settings } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useSettingsStore"])();
    const { isDarkMode } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useThemeStore"])();
    const globalReadSettings = settings.globalReadSettings;
    const isEink = settings.globalViewSettings.isEink;
    const einkBgColor = isDarkMode ? '#000000' : '#ffffff';
    const einkFgColor = isDarkMode ? '#ffffff' : '#000000';
    const customColors = globalReadSettings.customHighlightColors;
    const [selectedStyle, setSelectedStyle] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(_selectedStyle);
    const [selectedColor, setSelectedColor] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(_selectedColor);
    const size16 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(16);
    const size28 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(28);
    const highlightOptionsHeightPx = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(OPTIONS_HEIGHT_PIX);
    const highlightOptionsPaddingPx = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(OPTIONS_PADDING_PIX);
    const handleSelectStyle = (style)=>{
        const newGlobalReadSettings = {
            ...globalReadSettings,
            highlightStyle: style
        };
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["saveSysSettings"])(envConfig, 'globalReadSettings', newGlobalReadSettings);
        setSelectedStyle(style);
        setSelectedColor(globalReadSettings.highlightStyles[style]);
        onHandleHighlight(true);
    };
    const handleSelectColor = (color)=>{
        const newGlobalReadSettings = {
            ...globalReadSettings,
            highlightStyle: selectedStyle,
            highlightStyles: {
                ...globalReadSettings.highlightStyles,
                [selectedStyle]: color
            }
        };
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["saveSysSettings"])(envConfig, 'globalReadSettings', newGlobalReadSettings);
        setSelectedColor(color);
        onHandleHighlight(true);
    };
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('highlight-options absolute flex items-center justify-between', isVertical ? 'flex-col' : 'flex-row'),
        style: {
            width: `${popupWidth}px`,
            height: `${popupHeight}px`,
            ...isVertical ? {
                left: `${(highlightOptionsHeightPx + highlightOptionsPaddingPx) * (triangleDir === 'left' ? -1 : 1)}px`
            } : {
                top: `${(highlightOptionsHeightPx + highlightOptionsPaddingPx) * (triangleDir === 'up' ? -1 : 1)}px`
            }
        },
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('flex gap-2', isVertical ? 'flex-col' : 'flex-row'),
                style: isVertical ? {
                    width: size28
                } : {
                    height: size28
                },
                children: styles.map((style)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("button", {
                        onClick: ()=>handleSelectStyle(style),
                        className: "not-eink:bg-gray-700 eink-bordered flex items-center justify-center rounded-full p-0",
                        style: {
                            width: size28,
                            height: size28,
                            minHeight: size28
                        },
                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            style: {
                                width: size16,
                                height: size16,
                                ...style === 'highlight' && selectedStyle === 'highlight' && {
                                    backgroundColor: isEink ? einkFgColor : customColors[selectedColor],
                                    color: isEink ? einkBgColor : '#d1d5db',
                                    paddingTop: '2px'
                                },
                                ...style === 'highlight' && selectedStyle !== 'highlight' && {
                                    backgroundColor: '#d1d5db',
                                    paddingTop: '2px'
                                },
                                ...(style === 'underline' || style === 'squiggly') && {
                                    color: isEink ? einkFgColor : '#d1d5db',
                                    textDecoration: 'underline',
                                    textDecorationThickness: '2px',
                                    textDecorationColor: selectedStyle === style ? isEink ? einkFgColor : customColors[selectedColor] : '#d1d5db',
                                    ...style === 'squiggly' && {
                                        textDecorationStyle: 'wavy'
                                    }
                                }
                            },
                            className: "w-4 p-0 text-center leading-none",
                            children: "A"
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx",
                            lineNumber: 105,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0))
                    }, style, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx",
                        lineNumber: 99,
                        columnNumber: 11
                    }, ("TURBOPACK compile-time value", void 0)))
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx",
                lineNumber: 94,
                columnNumber: 7
            }, ("TURBOPACK compile-time value", void 0)),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('not-eink:bg-gray-700 eink-bordered flex items-center justify-center gap-2 rounded-3xl', isVertical ? 'flex-col py-2' : 'flex-row px-2'),
                style: isVertical ? {
                    width: size28
                } : {
                    height: size28
                },
                children: colors.filter((c)=>isEink ? selectedColor === c : true).map((color)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("button", {
                        onClick: ()=>handleSelectColor(color),
                        style: {
                            width: size16,
                            height: size16,
                            backgroundColor: selectedColor !== color ? customColors[color] : 'transparent'
                        },
                        className: "rounded-full p-0",
                        children: selectedColor === color && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$fa$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["FaCheckCircle"], {
                            size: size16,
                            style: {
                                fill: isEink ? einkFgColor : customColors[color]
                            }
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx",
                            lineNumber: 162,
                            columnNumber: 17
                        }, ("TURBOPACK compile-time value", void 0))
                    }, color, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx",
                        lineNumber: 151,
                        columnNumber: 13
                    }, ("TURBOPACK compile-time value", void 0)))
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx",
                lineNumber: 141,
                columnNumber: 7
            }, ("TURBOPACK compile-time value", void 0))
        ]
    }, void 0, true, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx",
        lineNumber: 71,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = HighlightOptions;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Popup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationToolButton$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationToolButton.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationNotes$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationNotes.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$HighlightOptions$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/HighlightOptions.tsx [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationToolButton$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationNotes$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$HighlightOptions$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationToolButton$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationNotes$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$HighlightOptions$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
;
;
;
;
;
;
const AnnotationPopup = ({ bookKey, dir, isVertical, buttons, notes, position, trianglePosition, highlightOptionsVisible, selectedStyle, selectedColor, popupWidth, popupHeight, onHighlight, onDismiss })=>{
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        dir: dir,
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
            width: isVertical ? popupHeight : popupWidth,
            height: isVertical ? popupWidth : popupHeight,
            minHeight: isVertical ? popupWidth : popupHeight,
            position: position,
            trianglePosition: trianglePosition,
            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('selection-popup bg-gray-600 text-white', notes.length > 0 && 'bg-transparent'),
            triangleClassName: "text-gray-600",
            onDismiss: onDismiss,
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('flex h-full gap-4', isVertical ? 'flex-row' : 'flex-col'),
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                        className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('selection-buttons flex h-full w-full items-center justify-between p-2', isVertical ? 'flex-col overflow-y-auto' : 'flex-row overflow-x-auto', notes.length > 0 && 'hidden'),
                        style: {
                            scrollbarWidth: 'none',
                            msOverflowStyle: 'none'
                        },
                        children: buttons.map((button, index)=>{
                            if (button.visible === false) return null;
                            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationToolButton$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                                showTooltip: !highlightOptionsVisible,
                                tooltipText: button.tooltipText,
                                Icon: button.Icon,
                                onClick: button.onClick,
                                disabled: button.disabled
                            }, index, false, {
                                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx",
                                lineNumber: 76,
                                columnNumber: 17
                            }, ("TURBOPACK compile-time value", void 0));
                        })
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx",
                        lineNumber: 65,
                        columnNumber: 11
                    }, ("TURBOPACK compile-time value", void 0)),
                    notes.length > 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationNotes$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                        bookKey: bookKey,
                        isVertical: isVertical,
                        notes: notes,
                        toolsVisible: false,
                        triangleDir: trianglePosition.dir,
                        popupWidth: isVertical ? popupHeight : popupWidth,
                        popupHeight: isVertical ? popupWidth : popupHeight,
                        onDismiss: onDismiss
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx",
                        lineNumber: 88,
                        columnNumber: 13
                    }, ("TURBOPACK compile-time value", void 0)) : highlightOptionsVisible && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$HighlightOptions$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                        isVertical: isVertical,
                        triangleDir: trianglePosition.dir,
                        popupWidth: isVertical ? popupHeight : popupWidth,
                        popupHeight: isVertical ? popupWidth : popupHeight,
                        selectedStyle: selectedStyle,
                        selectedColor: selectedColor,
                        onHandleHighlight: onHighlight
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx",
                        lineNumber: 100,
                        columnNumber: 15
                    }, ("TURBOPACK compile-time value", void 0))
                ]
            }, void 0, true, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx",
                lineNumber: 64,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0))
        }, void 0, false, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx",
            lineNumber: 51,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx",
        lineNumber: 50,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = AnnotationPopup;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslation.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Popup.tsx [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
const WiktionaryPopup = ({ word, lang, position, trianglePosition, popupWidth, popupHeight, onDismiss })=>{
    const _ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslation"])();
    const [lookupWord, setLookupWord] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(word);
    const isLookingUp = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])(false);
    const interceptDictLinks = (definition)=>{
        const container = document.createElement('div');
        container.innerHTML = definition;
        const links = container.querySelectorAll('a[rel="mw:WikiLink"]');
        links.forEach((link)=>{
            const title = link.getAttribute('title');
            if (title) {
                link.addEventListener('click', (event)=>{
                    event.preventDefault();
                    setLookupWord(title);
                    isLookingUp.current = false;
                });
                link.className = 'text-primary underline cursor-pointer';
            }
        });
        return Array.from(container.childNodes);
    };
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        if (isLookingUp.current) {
            return;
        }
        isLookingUp.current = true;
        const main = document.querySelector('main');
        const footer = document.querySelector('footer');
        const fetchDefinitions = async (word, language)=>{
            main.innerHTML = '';
            footer.dataset['state'] = 'loading';
            try {
                const response = await fetch(`https://en.wiktionary.org/api/rest_v1/page/definition/${word}`);
                if (!response.ok) {
                    throw new Error('Failed to fetch definitions');
                }
                const json = await response.json();
                const results = language ? json[language] || json['en'] : json[Object.keys(json)[0]];
                if (!results || results.length === 0) {
                    throw new Error('No results found');
                }
                const hgroup = document.createElement('hgroup');
                const h1 = document.createElement('h1');
                h1.innerText = word;
                h1.className = 'text-lg font-bold';
                const p = document.createElement('p');
                p.innerText = results[0].language;
                p.className = 'text-sm italic opacity-75';
                hgroup.append(h1, p);
                main.append(hgroup);
                results.forEach(({ partOfSpeech, definitions })=>{
                    const h2 = document.createElement('h2');
                    h2.innerText = partOfSpeech;
                    h2.className = 'text-base font-semibold mt-4';
                    const ol = document.createElement('ol');
                    ol.className = 'pl-8 list-decimal';
                    definitions.forEach(({ definition, examples })=>{
                        if (!definition) return;
                        const li = document.createElement('li');
                        const processedContent = interceptDictLinks(definition);
                        li.append(...processedContent);
                        if (examples) {
                            const ul = document.createElement('ul');
                            ul.className = 'pl-8 list-disc text-sm italic opacity-75';
                            examples.forEach((example)=>{
                                const exampleLi = document.createElement('li');
                                exampleLi.innerHTML = example;
                                ul.appendChild(exampleLi);
                            });
                            li.appendChild(ul);
                        }
                        ol.appendChild(li);
                    });
                    main.appendChild(h2);
                    main.appendChild(ol);
                });
                footer.dataset['state'] = 'loaded';
            } catch (error) {
                console.error(error);
                footer.dataset['state'] = 'error';
                const div = document.createElement('div');
                div.className = 'flex flex-col items-center justify-center w-full h-full text-center absolute inset-0';
                const h1 = document.createElement('h1');
                h1.innerText = _('Error');
                h1.className = 'text-lg font-bold';
                const p = document.createElement('p');
                p.innerHTML = _('Unable to load the word. Try searching directly on {{link}}.', {
                    link: `<a href="https://en.wiktionary.org/w/index.php?search=${encodeURIComponent(word)}" target="_blank" rel="noopener noreferrer" class="text-primary underline">Wiktionary</a>`
                });
                div.append(h1, p);
                main.append(div);
            }
        };
        const langCode = typeof lang === 'string' ? lang : lang?.[0];
        fetchDefinitions(lookupWord, langCode);
    }, [
        _,
        lookupWord,
        lang
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
            trianglePosition: trianglePosition,
            width: popupWidth,
            height: popupHeight,
            position: position,
            className: "select-text",
            onDismiss: onDismiss,
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                className: "flex h-full flex-col",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("main", {
                        className: "flex-grow overflow-y-auto p-4 font-sans"
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx",
                        lineNumber: 178,
                        columnNumber: 11
                    }, ("TURBOPACK compile-time value", void 0)),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("footer", {
                        className: "mt-auto hidden data-[state=loaded]:block data-[state=error]:hidden data-[state=loading]:hidden",
                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "flex items-center px-4 py-2 text-sm opacity-60",
                            children: "Source: Wiktionary (CC BY-SA)"
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx",
                            lineNumber: 180,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0))
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx",
                        lineNumber: 179,
                        columnNumber: 11
                    }, ("TURBOPACK compile-time value", void 0))
                ]
            }, void 0, true, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx",
                lineNumber: 177,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0))
        }, void 0, false, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx",
            lineNumber: 169,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx",
        lineNumber: 168,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = WiktionaryPopup;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Popup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslation.ts [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
const WikipediaPopup = ({ text, lang, position, trianglePosition, popupWidth, popupHeight, onDismiss })=>{
    const _ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslation"])();
    const isLoading = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])(false);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        if (isLoading.current) {
            return;
        }
        isLoading.current = true;
        const main = document.querySelector('main');
        const footer = document.querySelector('footer');
        const fetchSummary = async (query, language)=>{
            main.innerHTML = '';
            footer.dataset['state'] = 'loading';
            try {
                const response = await fetch(`https://${language}.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`);
                if (!response.ok) {
                    throw new Error('Failed to fetch Wikipedia summary');
                }
                const data = await response.json();
                const hgroup = document.createElement('hgroup');
                hgroup.style.color = 'white';
                hgroup.style.backgroundPosition = 'center center';
                hgroup.style.backgroundSize = 'cover';
                hgroup.style.backgroundColor = 'rgba(0, 0, 0, .4)';
                hgroup.style.backgroundBlendMode = 'darken';
                hgroup.style.borderRadius = '6px';
                hgroup.style.padding = '12px';
                hgroup.style.marginBottom = '12px';
                hgroup.style.minHeight = '100px';
                const h1 = document.createElement('h1');
                h1.innerHTML = data.titles.display;
                h1.className = 'text-lg font-bold';
                hgroup.append(h1);
                if (data.description) {
                    const description = document.createElement('p');
                    description.innerText = data.description;
                    hgroup.appendChild(description);
                }
                if (data.thumbnail) {
                    hgroup.style.backgroundImage = `url("${data.thumbnail.source}")`;
                }
                const contentDiv = document.createElement('div');
                contentDiv.innerHTML = data.extract_html;
                contentDiv.className = 'p-2 text-sm';
                contentDiv.dir = data.dir;
                main.append(hgroup, contentDiv);
                footer.dataset['state'] = 'loaded';
            } catch (error) {
                console.error(error);
                const errorDiv = document.createElement('div');
                const h1 = document.createElement('h1');
                h1.innerText = _('Error');
                const errorMsg = document.createElement('p');
                errorMsg.innerHTML = _('Unable to load the article. Try searching directly on {{link}}.', {
                    link: `<a href="https://${language}.wikipedia.org/w/index.php?search=${encodeURIComponent(query)}" target="_blank" rel="noopener noreferrer" class="text-primary underline">Wikipedia</a>`
                });
                errorDiv.append(h1, errorMsg);
                main.appendChild(errorDiv);
                footer.dataset['state'] = 'error';
            }
        };
        const bookLang = typeof lang === 'string' ? lang : lang?.[0];
        const langCode = bookLang ? bookLang.split('-')[0] : 'en';
        fetchSummary(text, langCode);
    }, [
        _,
        text,
        lang
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
            width: popupWidth,
            height: popupHeight,
            position: position,
            trianglePosition: trianglePosition,
            className: "select-text",
            onDismiss: onDismiss,
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                className: "text-base-content flex h-full flex-col pt-2",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("main", {
                        className: "flex-grow overflow-y-auto px-2 font-sans"
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx",
                        lineNumber: 123,
                        columnNumber: 11
                    }, ("TURBOPACK compile-time value", void 0)),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("footer", {
                        className: "mt-auto hidden data-[state=loaded]:block data-[state=error]:hidden data-[state=loading]:hidden",
                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "flex items-center px-4 py-2 text-sm opacity-60",
                            children: "Source: Wikipedia (CC BY-SA)"
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx",
                            lineNumber: 125,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0))
                    }, void 0, false, {
                        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx",
                        lineNumber: 124,
                        columnNumber: 11
                    }, ("TURBOPACK compile-time value", void 0))
                ]
            }, void 0, true, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx",
                lineNumber: 122,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0))
        }, void 0, false, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx",
            lineNumber: 114,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx",
        lineNumber: 113,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = WikipediaPopup;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Popup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$AuthContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/context/AuthContext.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/settingsStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslation.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslator$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslator.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$constants$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/services/constants.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$translators$2f$index$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/apps/readest-app/src/services/translators/index.ts [ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$translators$2f$providers$2f$index$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/services/translators/providers/index.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Select.tsx [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslator$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$translators$2f$index$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$translators$2f$providers$2f$index$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslator$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$translators$2f$index$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$translators$2f$providers$2f$index$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
;
;
;
;
;
;
const notSupportedLangs = [
    ''
];
const generateTranslatorLangs = ()=>{
    return Object.fromEntries(Object.entries(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$constants$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["TRANSLATOR_LANGS"]).filter(([code])=>!notSupportedLangs.includes(code)));
};
const translatorLangs = generateTranslatorLangs();
const TranslatorPopup = ({ text, position, trianglePosition, popupWidth, popupHeight, onDismiss })=>{
    const _ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslation"])();
    const { token } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$AuthContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["useAuth"])();
    const { settings, setSettings } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useSettingsStore"])();
    const [providers, setProviders] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])([]);
    const [sourceLang, setSourceLang] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])('AUTO');
    const [targetLang, setTargetLang] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(settings.globalReadSettings.translateTargetLang);
    const [provider, setProvider] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(settings.globalReadSettings.translationProvider);
    const [translation, setTranslation] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(null);
    const [detectedSourceLang, setDetectedSourceLang] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(null);
    const [loading, setLoading] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [error, setError] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(null);
    const { translate, translators } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslator$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslator"])({
        provider,
        sourceLang,
        targetLang
    });
    const handleSourceLangChange = (event)=>{
        setSourceLang(event.target.value);
    };
    const handleTargetLangChange = (event)=>{
        settings.globalReadSettings.translateTargetLang = event.target.value;
        setSettings(settings);
        setTargetLang(event.target.value);
    };
    const handleProviderChange = (event)=>{
        const requestedProvider = event.target.value;
        const availableTranslators = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$translators$2f$providers$2f$index$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getTranslators"])().filter((t)=>(t.authRequired ? !!token : true) && !t.quotaExceeded);
        const selectedTranslator = availableTranslators.find((t)=>t.name === requestedProvider) || availableTranslators[0];
        if (selectedTranslator) {
            settings.globalReadSettings.translationProvider = selectedTranslator.name;
            setSettings(settings);
            setProvider(selectedTranslator.name);
        }
    };
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        const availableProviders = translators.map((t)=>{
            let label = t.label;
            if (t.authRequired && !token) {
                label = `${label} (${_('Login Required')})`;
            } else if (t.quotaExceeded) {
                label = `${label} (${_('Quota Exceeded')})`;
            }
            return {
                name: t.name,
                label
            };
        });
        setProviders(availableProviders);
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        translators
    ]);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        setLoading(true);
        const fetchTranslation = async ()=>{
            setError(null);
            setTranslation(null);
            try {
                const input = text.replaceAll('\n', '').trim();
                const result = await translate([
                    input
                ]);
                const translatedText = result[0];
                const detectedSource = null;
                if (!translatedText) {
                    throw new Error('No translation found');
                }
                setTranslation(translatedText);
                if ("TURBOPACK compile-time falsy", 0) //TURBOPACK unreachable
                ;
            } catch (err) {
                console.error(err);
                if (!token) {
                    setError(_('Unable to fetch the translation. Please log in first and try again.'));
                } else {
                    setError(_('Unable to fetch the translation. Try again later.'));
                }
            } finally{
                setLoading(false);
            }
        };
        fetchTranslation();
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        text,
        token,
        sourceLang,
        targetLang,
        provider,
        translate
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
            trianglePosition: trianglePosition,
            width: popupWidth,
            minHeight: popupHeight,
            maxHeight: 720,
            position: position,
            className: "not-eink:text-white grid h-full select-text grid-rows-[1fr,auto,1fr] bg-gray-600",
            triangleClassName: "text-gray-600",
            onDismiss: onDismiss,
            children: [
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "overflow-y-auto p-4 font-sans",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "mb-2 flex items-center justify-between",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("h1", {
                                    className: "text-sm font-normal",
                                    children: _('Original Text')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                                    lineNumber: 152,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                                    className: "not-eink:bg-gray-600 not-eink:text-white eink:bg-base-100",
                                    value: sourceLang,
                                    onChange: handleSourceLangChange,
                                    options: [
                                        {
                                            value: 'AUTO',
                                            label: _('Auto Detect')
                                        },
                                        ...Object.entries(translatorLangs).sort((a, b)=>a[1].localeCompare(b[1])).map(([code, name])=>{
                                            const label = detectedSourceLang && sourceLang === 'AUTO' && code === 'AUTO' ? `${translatorLangs[detectedSourceLang] || detectedSourceLang} ` + _('(detected)') : name;
                                            return {
                                                value: code,
                                                label
                                            };
                                        })
                                    ]
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                                    lineNumber: 153,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                            lineNumber: 151,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("p", {
                            className: "not-eink:text-white/90 text-base",
                            children: text
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                            lineNumber: 172,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                    lineNumber: 150,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "mx-4 flex-shrink-0 border-t border-gray-500/30"
                }, void 0, false, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                    lineNumber: 175,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "overflow-y-auto px-4 pb-8 pt-4 font-sans",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "mb-2 flex items-center justify-between",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("h2", {
                                    className: "text-sm font-normal",
                                    children: _('Translated Text')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                                    lineNumber: 179,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                                    className: "not-eink:bg-gray-600 not-eink:text-white eink:bg-base-100",
                                    value: targetLang,
                                    onChange: handleTargetLangChange,
                                    options: [
                                        {
                                            value: '',
                                            label: _('System Language')
                                        },
                                        ...Object.entries(translatorLangs).sort((a, b)=>a[1].localeCompare(b[1])).map(([code, name])=>({
                                                value: code,
                                                label: name
                                            }))
                                    ]
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                                    lineNumber: 180,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                            lineNumber: 178,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        loading ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("p", {
                            className: "text-base italic text-gray-500",
                            children: _('Loading...')
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                            lineNumber: 193,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0)) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            children: error ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("p", {
                                className: "text-base text-red-600",
                                children: error
                            }, void 0, false, {
                                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                                lineNumber: 197,
                                columnNumber: 17
                            }, ("TURBOPACK compile-time value", void 0)) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("p", {
                                className: "not-eink:text-white/90 text-base",
                                children: translation || _('No translation available.')
                            }, void 0, false, {
                                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                                lineNumber: 199,
                                columnNumber: 17
                            }, ("TURBOPACK compile-time value", void 0))
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                            lineNumber: 195,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                    lineNumber: 177,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "absolute bottom-0 flex h-8 w-full items-center justify-between px-4",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "line-clamp-1 text-xs opacity-60",
                            children: provider && !loading && !error && _('Translated by {{provider}}.', {
                                provider: providers.find((p)=>p.name === provider)?.label
                            })
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                            lineNumber: 207,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                            className: "not-eink:bg-gray-600 not-eink:text-white eink:bg-base-100",
                            value: provider,
                            onChange: handleProviderChange,
                            options: providers.map(({ name: value, label })=>({
                                    value,
                                    label
                                }))
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                            lineNumber: 215,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
                    lineNumber: 206,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0))
            ]
        }, void 0, true, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
            lineNumber: 140,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx",
        lineNumber: 139,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = TranslatorPopup;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/context/EnvContext.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/readerStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslation.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useAutoFocus$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useAutoFocus.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$proofreadStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/proofreadStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/event.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$word$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/word.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Select.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Popup.tsx [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$proofreadStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$proofreadStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
;
;
;
;
;
;
;
;
const ProofreadPopup = ({ bookKey, selection, position, trianglePosition, popupWidth, popupHeight, onConfirm, onDismiss })=>{
    const _ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslation"])();
    const { envConfig } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["useEnv"])();
    const { getProgress, getView, recreateViewer } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useReaderStore"])();
    const { addRule } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$proofreadStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useProofreadStore"])();
    const progress = getProgress(bookKey);
    const [replacementText, setReplacementText] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])('');
    const [caseSensitive, setCaseSensitive] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(true);
    const [wholeWord, setWholeWord] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(!(0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$word$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["isPunctuationOnly"])(selection?.text || ''));
    const [scope, setScope] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])('selection');
    const [onlyForTTS, setOnlyForTTS] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const inputRef = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useRef"])(null);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useAutoFocus$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useAutoFocus"])({
        ref: inputRef
    });
    const handleInputChange = (e)=>{
        const text = e.target.value;
        setReplacementText(text);
    };
    const handleScopeChange = (event)=>{
        setScope(event.target.value);
    };
    const handleApply = async ()=>{
        if (!selection) return;
        const range = selection?.range;
        if (range) {
            const isValidWholeWord = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$word$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["isWholeWord"])(range, selection?.text || '');
            if (wholeWord && !isValidWholeWord) {
                __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('toast', {
                    type: 'warning',
                    message: 'Please select a whole word or uncheck the "Whole word" option.',
                    timeout: 5000
                });
                return;
            }
            if (scope === 'selection') {
                range.deleteContents();
                const textNode = document.createTextNode(replacementText);
                range.insertNode(textNode);
            }
            const options = {
                scope,
                pattern: selection.text,
                replacement: replacementText.trim(),
                cfi: selection.cfi,
                sectionHref: progress?.sectionHref,
                isRegex: false,
                enabled: true,
                caseSensitive,
                wholeWord: wholeWord,
                onlyForTTS: scope !== 'selection' ? onlyForTTS : undefined
            };
            onConfirm?.(options);
            await addRule(envConfig, bookKey, options);
            onDismiss();
            if (scope !== 'selection' && !onlyForTTS) {
                if (getView(bookKey)) {
                    recreateViewer(envConfig, bookKey);
                }
            }
        }
    };
    const scopeOptions = [
        {
            value: 'selection',
            label: _('Current selection')
        },
        {
            value: 'book',
            label: _('All occurrences in this book')
        },
        {
            value: 'library',
            label: _('All occurrences in your library')
        }
    ];
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Popup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
            trianglePosition: trianglePosition,
            width: popupWidth,
            minHeight: popupHeight,
            position: position,
            className: "not-eink:text-gray-400 flex flex-col justify-between rounded-lg bg-gray-700",
            triangleClassName: "text-gray-700",
            onDismiss: onDismiss,
            children: [
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "flex flex-col gap-6 p-4",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "not-eink:text-gray-400 flex gap-1 text-xs",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                    className: "text-nowrap",
                                    children: _('Selected text:')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 130,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                    className: "not-eink:text-yellow-300 line-clamp-1 select-text break-words font-medium",
                                    children: [
                                        '"',
                                        selection?.text || '',
                                        '"'
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 131,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                            lineNumber: 129,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "flex items-center justify-between gap-2",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    htmlFor: "replacement-input",
                                    className: "text-xs",
                                    children: _('Replace with:')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 137,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                    ref: inputRef,
                                    type: "text",
                                    value: replacementText,
                                    onChange: handleInputChange,
                                    onKeyDown: (e)=>{
                                        if (e.key === 'Enter' && replacementText) {
                                            handleApply();
                                        }
                                    },
                                    placeholder: _('Enter text...'),
                                    className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('w-full flex-1 rounded-md p-2 text-sm placeholder-gray-400 focus:outline-none focus:ring-0', 'not-eink:bg-gray-600 not-eink:text-white eink:border eink:border-base-content')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 140,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("button", {
                                    onClick: handleApply,
                                    disabled: !replacementText,
                                    className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('btn btn-sm btn-ghost btn-primary disabled:text-base-content/75 text-blue-600 disabled:opacity-75', 'bg-transparent hover:bg-transparent disabled:bg-transparent'),
                                    children: _('Apply')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 156,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                            lineNumber: 136,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                    lineNumber: 128,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "flex flex-wrap items-center gap-4 p-4",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                            className: "flex cursor-pointer items-center gap-2",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                    className: "line-clamp-1 text-xs",
                                    title: _('Case sensitive:'),
                                    children: _('Case sensitive:')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 171,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                    type: "checkbox",
                                    className: "toggle toggle-sm bg-gray-500 checked:bg-black hover:bg-gray-500 hover:checked:bg-black",
                                    style: {
                                        '--tglbg': '#4B5563'
                                    },
                                    checked: caseSensitive,
                                    onChange: (e)=>setCaseSensitive(e.target.checked)
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 174,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                            lineNumber: 170,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                            className: "flex cursor-pointer items-center gap-2",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                    className: "line-clamp-1 text-xs",
                                    title: _('Whole word:'),
                                    children: _('Whole word:')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 188,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                    type: "checkbox",
                                    className: "toggle toggle-sm bg-gray-500 checked:bg-black hover:bg-gray-500 hover:checked:bg-black",
                                    style: {
                                        '--tglbg': '#4B5563'
                                    },
                                    checked: wholeWord,
                                    onChange: (e)=>setWholeWord(e.target.checked)
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 191,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                            lineNumber: 187,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                            className: "flex cursor-pointer items-center gap-2",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                    className: "line-clamp-1 text-xs",
                                    title: _('Only for TTS:'),
                                    children: _('Only for TTS:')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 205,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                    type: "checkbox",
                                    disabled: scope === 'selection',
                                    className: "toggle toggle-sm bg-gray-500 checked:bg-black hover:bg-gray-500 hover:checked:bg-black",
                                    style: {
                                        '--tglbg': '#4B5563'
                                    },
                                    checked: onlyForTTS,
                                    onChange: (e)=>setOnlyForTTS(e.target.checked)
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                                    lineNumber: 208,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                            lineNumber: 204,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                    lineNumber: 169,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "flex flex-1 items-center justify-between gap-2 p-4",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                            htmlFor: "scope-select",
                            className: "line-clamp-1 text-xs",
                            title: _('Scope:'),
                            children: _('Scope:')
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                            lineNumber: 223,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Select$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                            className: "not-eink:bg-gray-600 eink:bg-base-100 not-eink:text-white max-w-[85%]",
                            value: scope,
                            onChange: handleScopeChange,
                            options: scopeOptions
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                            lineNumber: 226,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
                    lineNumber: 222,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0))
            ]
        }, void 0, true, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
            lineNumber: 119,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx",
        lineNumber: 118,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = ProofreadPopup;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/clsx [external] (clsx, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$marked__$5b$external$5d$__$28$marked$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/marked [external] (marked, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslation.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Dialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/components/Dialog.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/readerStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$constants$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/services/constants.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/helpers/settings.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/context/EnvContext.tsx [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$externals$5d2f$marked__$5b$external$5d$__$28$marked$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Dialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$externals$5d2f$marked__$5b$external$5d$__$28$marked$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Dialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
;
;
;
;
;
;
const renderTemplate = (template, data)=>{
    const applyFilter = (value, filter, filterArg)=>{
        if (filter === 'date') {
            if (typeof value === 'number') {
                const date = new Date(value);
                if (filterArg) {
                    const format = filterArg;
                    return format.replace('%Y', date.getFullYear().toString()).replace('%m', String(date.getMonth() + 1).padStart(2, '0')).replace('%d', String(date.getDate()).padStart(2, '0')).replace('%H', String(date.getHours()).padStart(2, '0')).replace('%M', String(date.getMinutes()).padStart(2, '0')).replace('%S', String(date.getSeconds()).padStart(2, '0'));
                }
                return date.toLocaleString();
            }
            return value;
        }
        return value;
    };
    const getValue = (path, context)=>{
        const keys = path.trim().split('.');
        let value = context;
        for (const key of keys){
            value = value?.[key];
        }
        return value;
    };
    let result = template;
    // Process {% for %} loops - find first occurrence and recurse
    const forMatch = result.match(/\{%\s*for\s+(\w+)\s+in\s+(\w+(?:\.\w+)*)\s*%\}/);
    if (forMatch) {
        const itemName = forMatch[1];
        const collectionPath = forMatch[2];
        // Find matching {% endfor %} by counting nesting
        let depth = 0;
        let endPos = -1;
        const startPos = forMatch.index + forMatch[0].length;
        for(let i = startPos; i < result.length; i++){
            const remaining = result.slice(i);
            if (remaining.startsWith('{% for ')) {
                depth++;
                i += 6; // skip past "{% for"
            } else if (remaining.startsWith('{% endfor %}')) {
                if (depth === 0) {
                    endPos = i;
                    break;
                }
                depth--;
                i += 11; // skip past "{% endfor %}"
            }
        }
        if (endPos !== -1) {
            const beforeLoop = result.slice(0, forMatch.index);
            const loopContent = result.slice(startPos, endPos);
            const afterLoop = result.slice(endPos + 13); // 13 = length of "{% endfor %}"
            const collection = getValue(collectionPath, data);
            if (Array.isArray(collection)) {
                const renderedItems = collection.map((item)=>{
                    const loopData = {
                        ...data,
                        [itemName]: item
                    };
                    return renderTemplate(loopContent, loopData);
                }).join('');
                result = beforeLoop + renderedItems + afterLoop;
                return renderTemplate(result, data);
            } else {
                // Collection not found or not an array, remove the loop
                result = beforeLoop + afterLoop;
                return renderTemplate(result, data);
            }
        }
    }
    // Process {% if condition %}...{% endif %}
    result = result.replace(/\{%\s*if\s+([^%]+?)\s*%\}([\s\S]*?)\{%\s*endif\s*%\}/g, (_match, condition, content)=>{
        const value = getValue(condition, data);
        return value ? renderTemplate(content, data) : '';
    });
    // Replace {{ variable }}, {{ variable | filter }}, and {{ variable | filter('arg') }}
    result = result.replace(/\{\{\s*([^}|]+?)(?:\s*\|\s*(\w+)(?:\s*\((['"]?)([^)'"]*)\3\))?)?\s*\}\}/g, (_match, path, filter, _quote, filterArg)=>{
        const value = getValue(path, data);
        if (value === undefined || value === null) return '';
        if (filter) {
            return applyFilter(value, filter, filterArg);
        }
        return String(value);
    });
    return result;
};
const ExportMarkdownDialog = ({ bookKey, isOpen, bookTitle, bookAuthor, booknotes, booknoteGroups, onCancel, onExport })=>{
    const _ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslation"])();
    const { envConfig } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["useEnv"])();
    const { getViewSettings } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useReaderStore"])();
    const viewSettings = getViewSettings(bookKey);
    const defaultTemplate = `## {{ title }}
**${_('Author')}**: {{ author }}

**${_('Exported from Readest')}**: {{ exportDate }}

---

### ${_('Highlights & Annotations')}

{% for chapter in chapters %}
#### {{ chapter.title }}
{% for annotation in chapter.annotations %}
> {{ annotation.text }}
{% if annotation.note %}
**${_('Note:')}** {{ annotation.note }}
{% endif %}
*${_('Time:')} {{ annotation.timestamp | date('%Y-%m-%d %H:%M') }}*
{% endfor %}

---
{% endfor %}`;
    const [exportConfig, setExportConfig] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(()=>{
        const noteExportConfig = viewSettings?.noteExportConfig || __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$constants$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["DEFAULT_NOTE_EXPORT_CONFIG"];
        if (!noteExportConfig.customTemplate) {
            return {
                ...noteExportConfig,
                customTemplate: defaultTemplate
            };
        }
        return noteExportConfig;
    });
    const [showSource, setShowSource] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [showAdvanced, setShowAdvanced] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        const customTemplate = exportConfig.customTemplate;
        const newExportConfig = {
            ...exportConfig,
            customTemplate: customTemplate === defaultTemplate ? '' : customTemplate
        };
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$helpers$2f$settings$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["saveViewSettings"])(envConfig, bookKey, 'noteExportConfig', newExportConfig, false, false);
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        exportConfig,
        envConfig,
        bookKey
    ]);
    // Generate markdown preview based on current format settings
    const markdownPreview = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useMemo"])(()=>{
        if (exportConfig.useCustomTemplate) {
            // Prepare data for template rendering
            const sortedGroups = Object.values(booknoteGroups).sort((a, b)=>a.id - b.id);
            const templateData = {
                title: bookTitle,
                author: bookAuthor,
                exportDate: new Date().toISOString().slice(0, 10),
                chapters: sortedGroups.map((group)=>({
                        title: group.label || _('Untitled'),
                        annotations: group.booknotes.map((note)=>({
                                text: note.text || '',
                                note: note.note || '',
                                style: note.style,
                                color: note.color,
                                timestamp: note.updatedAt
                            }))
                    }))
            };
            return renderTemplate(exportConfig.customTemplate, templateData);
        }
        // Default formatting (non-template mode)
        const sortedGroups = Object.values(booknoteGroups).sort((a, b)=>a.id - b.id);
        const lines = [];
        // Add title
        if (exportConfig.includeTitle) {
            lines.push(`# ${bookTitle}`);
        }
        // Add author
        if (exportConfig.includeAuthor && bookAuthor) {
            lines.push(`**${_('Author')}**: ${bookAuthor}`);
            lines.push('');
        }
        // Add export date
        if (exportConfig.includeDate) {
            lines.push(`**${_('Exported from Readest')}**: ${new Date().toISOString().slice(0, 10)}`);
            lines.push('');
        }
        if (exportConfig.includeTitle || exportConfig.includeAuthor || exportConfig.includeDate) {
            lines.push('---');
            lines.push('');
        }
        lines.push(`## ${_('Highlights & Annotations')}`);
        lines.push('');
        for (const group of sortedGroups){
            // Add chapter title
            if (exportConfig.includeChapterTitles) {
                const chapterTitle = group.label || _('Untitled');
                lines.push(`### ${chapterTitle}`);
            }
            for (const note of group.booknotes){
                // Add quote
                if (exportConfig.includeQuotes && note.text) {
                    lines.push(`> ${note.text}`);
                }
                // Add note
                if (exportConfig.includeNotes && note.note) {
                    lines.push('');
                    lines.push(`**${_('Note')}**:: ${note.note}`);
                }
                // Add timestamp
                if (exportConfig.includeTimestamp && note.updatedAt) {
                    const timestamp = new Date(note.updatedAt).toLocaleString();
                    lines.push('');
                    lines.push(`*${_('Time:')} ${timestamp}*`);
                }
                lines.push(exportConfig.noteSeparator);
            }
            if (exportConfig.includeChapterSeparator) {
                lines.push('---');
                lines.push('');
            }
        }
        return lines.join('\n');
    }, [
        exportConfig,
        booknoteGroups,
        bookTitle,
        bookAuthor,
        _
    ]);
    // Convert markdown to HTML for preview
    const htmlPreview = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useMemo"])(()=>{
        if (!markdownPreview) return '';
        return __TURBOPACK__imported__module__$5b$externals$5d2f$marked__$5b$external$5d$__$28$marked$2c$__esm_import$29$__["marked"].parse(markdownPreview);
    }, [
        markdownPreview
    ]);
    const handleToggle = (field)=>{
        setExportConfig((prev)=>({
                ...prev,
                [field]: !prev[field]
            }));
    };
    const handleExport = ()=>{
        onExport(markdownPreview);
    };
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$components$2f$Dialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
        isOpen: isOpen,
        title: _('Export Annotations'),
        onClose: onCancel,
        boxClassName: "sm:!w-[75%] sm:h-auto sm:!max-h-[90vh] sm:!max-w-5xl",
        contentClassName: "sm:!px-8 sm:!py-2",
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
            className: "flex flex-col gap-4",
            children: [
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "space-y-3",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("h3", {
                            className: "font-bold",
                            children: _('Format Options')
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 336,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('grid grid-cols-2 gap-x-6 gap-y-3 sm:grid-cols-3', exportConfig.useCustomTemplate && 'pointer-events-none opacity-50'),
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeTitle,
                                            onChange: ()=>handleToggle('includeTitle'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 345,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Title')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 352,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 344,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeAuthor,
                                            onChange: ()=>handleToggle('includeAuthor'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 356,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Author')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 363,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 355,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeDate,
                                            onChange: ()=>handleToggle('includeDate'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 367,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Export Date')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 374,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 366,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeChapterTitles,
                                            onChange: ()=>handleToggle('includeChapterTitles'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 378,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Chapter Titles')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 385,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 377,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeChapterSeparator,
                                            onChange: ()=>handleToggle('includeChapterSeparator'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 389,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Chapter Separator')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 396,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 388,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeQuotes,
                                            onChange: ()=>handleToggle('includeQuotes'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 400,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Highlights')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 407,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 399,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeNotes,
                                            onChange: ()=>handleToggle('includeNotes'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 411,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Notes')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 418,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 410,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.includeTimestamp,
                                            onChange: ()=>handleToggle('includeTimestamp'),
                                            className: "checkbox checkbox-sm",
                                            disabled: exportConfig.useCustomTemplate
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 422,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Note Date')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 429,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 421,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 338,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                    lineNumber: 335,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "space-y-3",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "flex items-center justify-between",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("h3", {
                                    className: "font-bold",
                                    children: _('Advanced')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 437,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("button", {
                                    onClick: ()=>setShowAdvanced(!showAdvanced),
                                    className: "text-sm text-blue-500 hover:underline",
                                    children: showAdvanced ? _('Hide') : _('Show')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 438,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 436,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        showAdvanced && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "space-y-3",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: exportConfig.useCustomTemplate,
                                            onChange: ()=>handleToggle('useCustomTemplate'),
                                            className: "checkbox checkbox-sm"
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 449,
                                            columnNumber: 17
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm font-medium",
                                            children: _('Use Custom Template')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 455,
                                            columnNumber: 17
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 448,
                                    columnNumber: 15
                                }, ("TURBOPACK compile-time value", void 0)),
                                exportConfig.useCustomTemplate && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["Fragment"], {
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                                            className: "space-y-2",
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                                    className: "text-sm font-medium",
                                                    children: _('Export Template')
                                                }, void 0, false, {
                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                    lineNumber: 461,
                                                    columnNumber: 21
                                                }, ("TURBOPACK compile-time value", void 0)),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("textarea", {
                                                    value: exportConfig.customTemplate,
                                                    onChange: (e)=>setExportConfig({
                                                            ...exportConfig,
                                                            customTemplate: e.target.value
                                                        }),
                                                    className: "textarea textarea-bordered w-full font-mono text-xs",
                                                    rows: 12,
                                                    placeholder: defaultTemplate
                                                }, void 0, false, {
                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                    lineNumber: 462,
                                                    columnNumber: 21
                                                }, ("TURBOPACK compile-time value", void 0))
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 460,
                                            columnNumber: 19
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                                            className: "bg-base-200 space-y-3 rounded-lg p-3 text-xs",
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                                                    children: [
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("p", {
                                                            className: "mb-2 font-bold",
                                                            children: _('Template Syntax:')
                                                        }, void 0, false, {
                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                            lineNumber: 475,
                                                            columnNumber: 23
                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("ul", {
                                                            className: "space-y-1 font-mono",
                                                            children: [
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: '{{ variable }}'
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 478,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Insert value')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 477,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: '{{ variable | date }}'
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 482,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        ' ',
                                                                        "- ",
                                                                        _('Format date (locale)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 481,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "{{ variable | date('%Y-%m-%d') }}"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 488,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        ' ',
                                                                        "- ",
                                                                        _('Format date (custom)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 487,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: '{% if variable %}...{% endif %}'
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 494,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        ' ',
                                                                        "- ",
                                                                        _('Conditional')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 493,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: '{% for item in list %}...{% endfor %}'
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 500,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        ' ',
                                                                        "- ",
                                                                        _('Loop')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 499,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0))
                                                            ]
                                                        }, void 0, true, {
                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                            lineNumber: 476,
                                                            columnNumber: 23
                                                        }, ("TURBOPACK compile-time value", void 0))
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                    lineNumber: 474,
                                                    columnNumber: 21
                                                }, ("TURBOPACK compile-time value", void 0)),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                                                    children: [
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("p", {
                                                            className: "mb-2 font-bold",
                                                            children: _('Available Variables:')
                                                        }, void 0, false, {
                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                            lineNumber: 508,
                                                            columnNumber: 23
                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("ul", {
                                                            className: "space-y-1",
                                                            children: [
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "title"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 511,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Book title')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 510,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "author"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 515,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Book author')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 514,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "exportDate"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 519,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Export date')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 518,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "chapters"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 523,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Array of chapters')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 522,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    className: "ml-4",
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "chapter.title"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 527,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Chapter title')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 526,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    className: "ml-4",
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "chapter.annotations"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 531,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Array of annotations')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 530,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    className: "ml-8",
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "annotation.text"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 535,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Highlighted text')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 534,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    className: "ml-8",
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "annotation.note"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 539,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Annotation note')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 538,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    className: "ml-8",
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "annotation.timestamp"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 543,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Update time')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 542,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0))
                                                            ]
                                                        }, void 0, true, {
                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                            lineNumber: 509,
                                                            columnNumber: 23
                                                        }, ("TURBOPACK compile-time value", void 0))
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                    lineNumber: 507,
                                                    columnNumber: 21
                                                }, ("TURBOPACK compile-time value", void 0)),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                                                    children: [
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("p", {
                                                            className: "mb-2 font-bold",
                                                            children: _('Date Format Tokens:')
                                                        }, void 0, false, {
                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                            lineNumber: 549,
                                                            columnNumber: 23
                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("ul", {
                                                            className: "space-y-1 font-mono",
                                                            children: [
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "%Y"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 552,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Year (4 digits)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 551,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "%m"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 556,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Month (01-12)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 555,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "%d"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 560,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " - ",
                                                                        _('Day (01-31)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 559,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "%H"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 563,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " - ",
                                                                        _('Hour (00-23)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 562,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "%M"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 566,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Minute (00-59)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 565,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0)),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("li", {
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("code", {
                                                                            className: "bg-base-300 rounded px-1",
                                                                            children: "%S"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                            lineNumber: 570,
                                                                            columnNumber: 27
                                                                        }, ("TURBOPACK compile-time value", void 0)),
                                                                        " -",
                                                                        ' ',
                                                                        _('Second (00-59)')
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                                    lineNumber: 569,
                                                                    columnNumber: 25
                                                                }, ("TURBOPACK compile-time value", void 0))
                                                            ]
                                                        }, void 0, true, {
                                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                            lineNumber: 550,
                                                            columnNumber: 23
                                                        }, ("TURBOPACK compile-time value", void 0))
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                                    lineNumber: 548,
                                                    columnNumber: 21
                                                }, ("TURBOPACK compile-time value", void 0))
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 473,
                                            columnNumber: 19
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 447,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                    lineNumber: 435,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "space-y-2",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: "flex items-center justify-between",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("h3", {
                                    className: "font-bold",
                                    children: _('Preview')
                                }, void 0, false, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 585,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0)),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("label", {
                                    className: "flex cursor-pointer items-center gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("input", {
                                            type: "checkbox",
                                            checked: showSource,
                                            onChange: ()=>setShowSource(!showSource),
                                            className: "checkbox checkbox-sm"
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 587,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0)),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("span", {
                                            className: "text-sm",
                                            children: _('Show Source')
                                        }, void 0, false, {
                                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                            lineNumber: 593,
                                            columnNumber: 15
                                        }, ("TURBOPACK compile-time value", void 0))
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                                    lineNumber: 586,
                                    columnNumber: 13
                                }, ("TURBOPACK compile-time value", void 0))
                            ]
                        }, void 0, true, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 584,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        showSource ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('bg-base-200 max-h-[40vh] overflow-y-auto rounded-lg p-4 font-mono text-xs', 'select-text whitespace-pre-wrap break-words'),
                            children: markdownPreview || _('No content to preview')
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 597,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0)) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                            className: (0, __TURBOPACK__imported__module__$5b$externals$5d2f$clsx__$5b$external$5d$__$28$clsx$2c$__esm_import$29$__["default"])('bg-base-200 prose prose-sm max-w-none overflow-y-auto rounded-lg p-4', 'max-h-[40vh] select-text break-words'),
                            dangerouslySetInnerHTML: {
                                __html: htmlPreview || `<p class="text-base-content/50">${_('No content to preview')}</p>`
                            }
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 606,
                            columnNumber: 13
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                    lineNumber: 583,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0)),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
                    className: "mt-4 flex justify-end gap-4",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("button", {
                            onClick: onCancel,
                            className: "btn btn-ghost btn-sm",
                            children: _('Cancel')
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 622,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0)),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("button", {
                            onClick: handleExport,
                            className: "btn btn-primary btn-sm",
                            disabled: booknotes.length === 0,
                            children: _('Export')
                        }, void 0, false, {
                            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                            lineNumber: 625,
                            columnNumber: 11
                        }, ("TURBOPACK compile-time value", void 0))
                    ]
                }, void 0, true, {
                    fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
                    lineNumber: 621,
                    columnNumber: 9
                }, ("TURBOPACK compile-time value", void 0))
            ]
        }, void 0, true, {
            fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
            lineNumber: 333,
            columnNumber: 7
        }, ("TURBOPACK compile-time value", void 0))
    }, void 0, false, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx",
        lineNumber: 326,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = ExportMarkdownDialog;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx [ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react/jsx-dev-runtime [external] (react/jsx-dev-runtime, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/react [external] (react, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$ri$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/react-icons@5.4.0_react@19.2.0/node_modules/react-icons/ri/index.mjs [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$packages$2f$foliate$2d$js$2f$epubcfi$2e$js__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/packages/foliate-js/epubcfi.js [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$packages$2f$foliate$2d$js$2f$overlayer$2e$js__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/packages/foliate-js/overlayer.js [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/context/EnvContext.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$types$2f$view$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/types/view.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/misc.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/themeStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/bookDataStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/settingsStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/readerStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$notebookStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/notebookStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useTranslation.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useResponsiveSize.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$deviceStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/store/deviceStore.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useFoliateEvents$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/hooks/useFoliateEvents.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useNotesSync$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/hooks/useNotesSync.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useTextSelector$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/hooks/useTextSelector.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/sel.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/event.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$toc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/toc.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$throttle$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/throttle.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$simplecc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/simplecc.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$word$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/word.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$cfi$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/utils/cfi.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$transformService$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/services/transformService.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$utils$2f$annotatorUtil$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/utils/annotatorUtil.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationTools$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationTools.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationRangeEditor$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationRangeEditor.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/AnnotationPopup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WiktionaryPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/WiktionaryPopup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WikipediaPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/WikipediaPopup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$TranslatorPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/TranslatorPopup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useShortcuts$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/hooks/useShortcuts.ts [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ProofreadPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/ProofreadPopup.tsx [ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ExportMarkdownDialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/readest-app/src/app/reader/components/annotator/ExportMarkdownDialog.tsx [ssr] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$notebookStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$deviceStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useNotesSync$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useTextSelector$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$transformService$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationRangeEditor$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WiktionaryPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WikipediaPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$TranslatorPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ProofreadPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ExportMarkdownDialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__
]);
[__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$notebookStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$deviceStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useNotesSync$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useTextSelector$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$transformService$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationRangeEditor$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WiktionaryPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WikipediaPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$TranslatorPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ProofreadPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ExportMarkdownDialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
'use client';
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
const Annotator = ({ bookKey })=>{
    const _ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useTranslation$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTranslation"])();
    const { envConfig, appService } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$context$2f$EnvContext$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["useEnv"])();
    const { settings } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$settingsStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useSettingsStore"])();
    const { isDarkMode } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$themeStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useThemeStore"])();
    const { getConfig, saveConfig, getBookData, updateBooknotes } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$bookDataStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useBookDataStore"])();
    const { getProgress, getView, getViewsById, getViewSettings } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$readerStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useReaderStore"])();
    const { setNotebookVisible, setNotebookNewAnnotation } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$notebookStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useNotebookStore"])();
    const { listenToNativeTouchEvents } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$store$2f$deviceStore$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useDeviceControlStore"])();
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useNotesSync$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useNotesSync"])(bookKey);
    const osPlatform = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getOSPlatform"])();
    const config = getConfig(bookKey);
    const progress = getProgress(bookKey);
    const bookData = getBookData(bookKey);
    const view = getView(bookKey);
    const viewSettings = getViewSettings(bookKey);
    const primaryLang = bookData.book?.primaryLanguage || 'en';
    const containerRef = __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["default"].useRef(null);
    const [selection, setSelection] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(null);
    const [showAnnotPopup, setShowAnnotPopup] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [showWiktionaryPopup, setShowWiktionaryPopup] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [showWikipediaPopup, setShowWikipediaPopup] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [showDeepLPopup, setShowDeepLPopup] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [showProofreadPopup, setShowProofreadPopup] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [trianglePosition, setTrianglePosition] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])();
    const [annotPopupPosition, setAnnotPopupPosition] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])();
    const [dictPopupPosition, setDictPopupPosition] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])();
    const [translatorPopupPosition, setTranslatorPopupPosition] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])();
    const [proofreadPopupPosition, setProofreadPopupPosition] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])();
    const [highlightOptionsVisible, setHighlightOptionsVisible] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [showAnnotationNotes, setShowAnnotationNotes] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [annotationNotes, setAnnotationNotes] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])([]);
    const [editingAnnotation, setEditingAnnotation] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(null);
    const [showExportDialog, setShowExportDialog] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(false);
    const [exportData, setExportData] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(null);
    const [selectedStyle, setSelectedStyle] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(settings.globalReadSettings.highlightStyle);
    const [selectedColor, setSelectedColor] = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useState"])(settings.globalReadSettings.highlightStyles[selectedStyle]);
    const showingPopup = showAnnotPopup || showWiktionaryPopup || showWikipediaPopup || showDeepLPopup || showProofreadPopup;
    const popupPadding = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(10);
    const trianglePadding = popupPadding * 2 + 6;
    const maxWidth = window.innerWidth - 2 * popupPadding;
    const maxHeight = window.innerHeight - 2 * popupPadding;
    const dictPopupWidth = Math.min(480, maxWidth);
    const dictPopupHeight = Math.min(300, maxHeight);
    const transPopupWidth = Math.min(480, maxWidth);
    const transPopupHeight = Math.min(265, maxHeight);
    const proofreadPopupWidth = Math.min(440, maxWidth);
    const proofreadPopupHeight = Math.min(200, maxHeight);
    const annotPopupWidth = Math.min((0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(300), maxWidth);
    const annotPopupHeight = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useResponsiveSize$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useResponsiveSize"])(44);
    const androidSelectionHandlerHeight = 0;
    // Reposition popups on scroll without dismissing them
    const repositionPopups = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])(()=>{
        if (!selection || !selection.text) return;
        const gridFrame = document.querySelector(`#gridcell-${bookKey}`);
        if (!gridFrame) return;
        const rect = gridFrame.getBoundingClientRect();
        const triangPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPosition"])(selection, rect, trianglePadding, viewSettings.vertical);
        const annotPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, viewSettings.vertical ? annotPopupHeight : annotPopupWidth, viewSettings.vertical ? annotPopupWidth : annotPopupHeight, popupPadding);
        if (annotPopupPos.dir === 'down' && osPlatform === 'android') {
            triangPos.point.y += androidSelectionHandlerHeight;
            annotPopupPos.point.y += androidSelectionHandlerHeight;
        }
        const dictPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, dictPopupWidth, dictPopupHeight, popupPadding);
        const transPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, transPopupWidth, transPopupHeight, popupPadding);
        const proofreadPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, proofreadPopupWidth, proofreadPopupHeight, popupPadding);
        if (triangPos.point.x == 0 || triangPos.point.y == 0) return;
        setAnnotPopupPosition(annotPopupPos);
        setDictPopupPosition(dictPopupPos);
        setTranslatorPopupPosition(transPopupPos);
        setProofreadPopupPosition(proofreadPopupPos);
        setTrianglePosition(triangPos);
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        selection,
        bookKey,
        viewSettings.vertical
    ]);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        setSelectedStyle(settings.globalReadSettings.highlightStyle);
    }, [
        settings.globalReadSettings.highlightStyle
    ]);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        setSelectedColor(settings.globalReadSettings.highlightStyles[selectedStyle]);
    }, [
        settings.globalReadSettings.highlightStyles,
        selectedStyle
    ]);
    const transformCtx = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useMemo"])(()=>({
            bookKey,
            viewSettings: getViewSettings(bookKey),
            userLocale: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getLocale"])(),
            content: '',
            transformers: [
                'punctuation'
            ],
            reversePunctuationTransform: true
        }), // eslint-disable-next-line react-hooks/exhaustive-deps
    []);
    const getAnnotationText = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])(async (range)=>{
        transformCtx['content'] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getTextFromRange"])(range, primaryLang.startsWith('ja') ? [
            'rt'
        ] : []);
        return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$services$2f$transformService$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["transformContent"])(transformCtx);
    }, [
        primaryLang,
        transformCtx
    ]);
    // eslint-disable-next-line react-hooks/exhaustive-deps
    const handleDismissPopup = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$throttle$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["throttle"])(()=>{
        setSelection(null);
        setShowAnnotPopup(false);
        setShowWiktionaryPopup(false);
        setShowWikipediaPopup(false);
        setShowDeepLPopup(false);
        setShowProofreadPopup(false);
        setEditingAnnotation(null);
    }, 500), []);
    const { isTextSelected, handleScroll, handleTouchStart, handleTouchMove, handleTouchEnd, handlePointerDown, handlePointerMove, handlePointerCancel, handlePointerUp, handleSelectionchange, handleShowPopup, handleUpToPopup, handleContextmenu } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useTextSelector$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useTextSelector"])(bookKey, setSelection, getAnnotationText, handleDismissPopup);
    const handleDismissPopupAndSelection = ()=>{
        handleDismissPopup();
        view?.deselect();
        isTextSelected.current = false;
    };
    const onLoad = (event)=>{
        const detail = event.detail;
        const { doc, index } = detail;
        const handleTouchmove = (ev)=>{
            // Available on iOS, on Android not fired
            // To make the popup not follow the selection while dragging
            setShowAnnotPopup(false);
            setEditingAnnotation(null);
            handleTouchMove(ev);
        };
        const handleNativeTouch = (event)=>{
            const ev = event.detail;
            if (ev.type === 'touchstart') {
                handleTouchStart();
            } else if (ev.type === 'touchend') {
                handleTouchEnd();
                handlePointerUp(doc, index);
            }
        };
        if (appService?.isAndroidApp) {
            listenToNativeTouchEvents();
            __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].on('native-touch', handleNativeTouch);
        }
        // Attach generic selection listeners for all formats, including PDF.
        // For PDF we only guarantee Copy & Translate; highlight/annotate may be limited by CFI support.
        view?.renderer?.addEventListener('scroll', handleScroll);
        // Reposition popups on scroll to keep them in view
        view?.renderer?.addEventListener('scroll', ()=>{
            repositionPopups();
        });
        const opts = {
            passive: false
        };
        detail.doc?.addEventListener('touchstart', handleTouchStart, opts);
        detail.doc?.addEventListener('touchmove', handleTouchmove, opts);
        detail.doc?.addEventListener('touchend', handleTouchEnd);
        detail.doc?.addEventListener('pointerdown', handlePointerDown.bind(null, doc, index), opts);
        detail.doc?.addEventListener('pointermove', handlePointerMove.bind(null, doc, index), opts);
        detail.doc?.addEventListener('pointercancel', handlePointerCancel.bind(null, doc, index));
        detail.doc?.addEventListener('pointerup', handlePointerUp.bind(null, doc, index));
        detail.doc?.addEventListener('selectionchange', handleSelectionchange.bind(null, doc, index));
        // For PDF selections, enable right-click context menu to directly open translator popup.
        if (bookData.book?.format === 'PDF') {
            detail.doc?.addEventListener('contextmenu', (e)=>{
                try {
                    const sel = doc.getSelection?.();
                    if (sel && !sel.isCollapsed) {
                        const range = sel.getRangeAt(0);
                        const text = sel.toString();
                        if (text.trim()) {
                            setSelection({
                                key: bookKey,
                                text,
                                range,
                                index,
                                cfi: view?.getCFI(index, range)
                            });
                            // Show translation popup preferentially for PDF right-click
                            setShowAnnotPopup(false);
                            setShowDeepLPopup(true);
                            setShowWiktionaryPopup(false);
                            setShowWikipediaPopup(false);
                        }
                    }
                } catch (err) {
                    console.warn('PDF context menu translation failed:', err);
                }
                // Prevent native menu to keep experience consistent
                e.preventDefault();
                e.stopPropagation();
                return false;
            });
        }
        // Disable the default context menu on mobile devices (selection handles suffice)
        detail.doc?.addEventListener('contextmenu', handleContextmenu);
    };
    const onDrawAnnotation = (event)=>{
        const viewSettings = getViewSettings(bookKey);
        const isEink = viewSettings.isEink;
        const detail = event.detail;
        const { draw, annotation, doc, range } = detail;
        const { style, color } = annotation;
        const hexColor = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$utils$2f$annotatorUtil$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getHighlightColorHex"])(settings, color);
        const einkBgColor = isDarkMode ? '#000000' : '#ffffff';
        const einkFgColor = isDarkMode ? '#ffffff' : '#000000';
        if (annotation.note) {
            const { defaultView } = doc;
            const node = range.startContainer;
            const el = node.nodeType === 1 ? node : node.parentElement;
            const { writingMode } = defaultView.getComputedStyle(el);
            draw(__TURBOPACK__imported__module__$5b$project$5d2f$packages$2f$foliate$2d$js$2f$overlayer$2e$js__$5b$ssr$5d$__$28$ecmascript$29$__["Overlayer"].bubble, {
                writingMode
            });
        } else if (style === 'highlight') {
            draw(__TURBOPACK__imported__module__$5b$project$5d2f$packages$2f$foliate$2d$js$2f$overlayer$2e$js__$5b$ssr$5d$__$28$ecmascript$29$__["Overlayer"].highlight, {
                color: isEink ? einkBgColor : hexColor
            });
        } else if ([
            'underline',
            'squiggly'
        ].includes(style)) {
            const { defaultView } = doc;
            const node = range.startContainer;
            const el = node.nodeType === 1 ? node : node.parentElement;
            const { writingMode, lineHeight, fontSize } = defaultView.getComputedStyle(el);
            const fontSizeValue = parseFloat(fontSize) || viewSettings.defaultFontSize;
            const lineHeightValue = parseFloat(lineHeight) || viewSettings.lineHeight * fontSizeValue;
            const strokeWidth = 2;
            const verticalCompensation = appService?.isMobile ? 0 : -1;
            const horizontalCompensation = appService?.isMobile ? -1 : 0;
            const padding = viewSettings.vertical ? (lineHeightValue - fontSizeValue) / 2 - strokeWidth + verticalCompensation : (lineHeightValue - fontSizeValue) / 2 - strokeWidth + horizontalCompensation;
            draw(__TURBOPACK__imported__module__$5b$project$5d2f$packages$2f$foliate$2d$js$2f$overlayer$2e$js__$5b$ssr$5d$__$28$ecmascript$29$__["Overlayer"][style], {
                writingMode,
                color: isEink ? einkFgColor : hexColor,
                padding
            });
        }
    };
    const onShowAnnotation = (event)=>{
        const detail = event.detail;
        const { value, index, range } = detail;
        const { booknotes = [] } = getConfig(bookKey);
        const isNote = value.startsWith(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$types$2f$view$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["NOTE_PREFIX"]);
        const cfi = isNote ? value.replace(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$types$2f$view$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["NOTE_PREFIX"], '') : value;
        const annotations = booknotes.filter((booknote)=>booknote.type === 'annotation' && !booknote.deletedAt && booknote.cfi === cfi);
        const annotation = annotations.find((annotation)=>!isNote && annotation.style || isNote && annotation.note);
        if (!annotation) return;
        const { style, color, text, note } = annotation;
        const selection = {
            key: bookKey,
            annotated: true,
            text: text ?? '',
            note: note ?? '',
            rect: isNote ? detail.rect : undefined,
            cfi,
            range,
            index
        };
        if (isNote) {
            setShowAnnotationNotes(true);
            setHighlightOptionsVisible(false);
            setEditingAnnotation(null);
        } else {
            setShowAnnotationNotes(false);
            setAnnotationNotes([]);
            if (style && color) {
                setSelectedStyle(style);
                setSelectedColor(color);
            }
            if (style && range) {
                setEditingAnnotation(annotation);
            }
        }
        setSelection(selection);
        handleUpToPopup();
    };
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$hooks$2f$useFoliateEvents$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["useFoliateEvents"])(view, {
        onLoad,
        onDrawAnnotation,
        onShowAnnotation
    });
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        handleShowPopup(showingPopup);
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        showingPopup
    ]);
    // When popups are visible, update their positions on scroll events
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        const view = getView(bookKey);
        if (!view?.renderer) return;
        const onScroll = ()=>{
            if (showingPopup) {
                repositionPopups();
            }
        };
        view.renderer.addEventListener('scroll', onScroll);
        return ()=>{
            view.renderer.removeEventListener('scroll', onScroll);
        };
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        bookKey,
        showingPopup,
        repositionPopups
    ]);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].on('export-annotations', handleExportMarkdown);
        return ()=>{
            __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].off('export-annotations', handleExportMarkdown);
        };
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, []);
    const handleQuickAction = ()=>{
        const action = viewSettings.annotationQuickAction;
        switch(action){
            case 'copy':
                handleCopy(false);
                handleDismissPopupAndSelection();
                break;
            case 'highlight':
                // highlight is already applied in instant annotating
                handleDismissPopupAndSelection();
                break;
            case 'search':
                handleSearch();
                break;
            case 'dictionary':
                handleDictionary();
                break;
            case 'wikipedia':
                handleWikipedia();
                break;
            case 'translate':
                handleTranslation();
                break;
            case 'tts':
                handleSpeakText(true);
                break;
        }
    };
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        setHighlightOptionsVisible(!!(selection && selection.annotated));
        if (selection && selection.text.trim().length > 0) {
            const gridFrame = document.querySelector(`#gridcell-${bookKey}`);
            if (!gridFrame) return;
            const rect = gridFrame.getBoundingClientRect();
            const triangPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPosition"])(selection, rect, trianglePadding, viewSettings.vertical);
            const annotPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, viewSettings.vertical ? annotPopupHeight : annotPopupWidth, viewSettings.vertical ? annotPopupWidth : annotPopupHeight, popupPadding);
            if (annotPopupPos.dir === 'down' && osPlatform === 'android') {
                triangPos.point.y += androidSelectionHandlerHeight;
                annotPopupPos.point.y += androidSelectionHandlerHeight;
            }
            const dictPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, dictPopupWidth, dictPopupHeight, popupPadding);
            const transPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, transPopupWidth, transPopupHeight, popupPadding);
            const proofreadPopupPos = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$sel$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getPopupPosition"])(triangPos, rect, proofreadPopupWidth, proofreadPopupHeight, popupPadding);
            if (triangPos.point.x == 0 || triangPos.point.y == 0) return;
            setAnnotPopupPosition(annotPopupPos);
            setDictPopupPosition(dictPopupPos);
            setTranslatorPopupPosition(transPopupPos);
            setProofreadPopupPosition(proofreadPopupPos);
            setTrianglePosition(triangPos);
            const { enableAnnotationQuickActions, annotationQuickAction } = viewSettings;
            if (enableAnnotationQuickActions && annotationQuickAction && isTextSelected.current) {
                handleQuickAction();
            } else {
                handleShowAnnotPopup();
            }
        }
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        selection,
        bookKey
    ]);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        if (!progress) return;
        const { location } = progress;
        const { booknotes = [] } = config;
        const annotations = booknotes.filter((item)=>!item.deletedAt && item.type === 'annotation' && item.style && (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$cfi$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["isCfiInLocation"])(item.cfi, location));
        const notes = booknotes.filter((item)=>!item.deletedAt && item.type === 'annotation' && item.note && item.note.trim().length > 0 && (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$cfi$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["isCfiInLocation"])(item.cfi, location));
        try {
            Promise.all(annotations.map((annotation)=>view?.addAnnotation(annotation)));
            Promise.all(notes.map((note)=>view?.addAnnotation({
                    ...note,
                    value: `${__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$types$2f$view$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["NOTE_PREFIX"]}${note.cfi}`
                })));
        } catch (e) {
            console.warn(e);
        }
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        progress
    ]);
    (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useEffect"])(()=>{
        if (!config.booknotes || !selection?.cfi || !showAnnotationNotes) return;
        const annotations = config.booknotes.filter((booknote)=>booknote.type === 'annotation' && !booknote.deletedAt && booknote.cfi === selection.cfi);
        const notes = annotations.filter((item)=>item.note && item.note.trim().length > 0);
        setAnnotationNotes(notes);
    }, [
        selection?.cfi,
        showAnnotationNotes,
        config.booknotes
    ]);
    const handleShowAnnotPopup = ()=>{
        if (!appService?.isMobile) {
            containerRef.current?.focus();
        }
        setShowAnnotPopup(true);
        setShowDeepLPopup(false);
        setShowWiktionaryPopup(false);
        setShowWikipediaPopup(false);
    };
    const handleCopy = (dismissPopup = true)=>{
        if (!selection || !selection.text) return;
        setTimeout(()=>{
            // Delay to ensure it won't be overridden by system clipboard actions
            navigator.clipboard?.writeText(selection.text);
        }, 100);
        if (dismissPopup) {
            handleDismissPopupAndSelection();
        }
        if (!viewSettings?.copyToNotebook) return;
        __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('toast', {
            type: 'info',
            message: _('Copied to notebook'),
            className: 'whitespace-nowrap',
            timeout: 2000
        });
        const { booknotes: annotations = [] } = config;
        const cfi = view?.getCFI(selection.index, selection.range);
        if (!cfi) return;
        const annotation = {
            id: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["uniqueId"])(),
            type: 'excerpt',
            cfi,
            text: selection.text,
            note: '',
            createdAt: Date.now(),
            updatedAt: Date.now()
        };
        const existingIndex = annotations.findIndex((annotation)=>annotation.cfi === cfi && annotation.type === 'excerpt' && !annotation.deletedAt);
        if (existingIndex !== -1) {
            annotations[existingIndex] = annotation;
        } else {
            annotations.push(annotation);
        }
        const updatedConfig = updateBooknotes(bookKey, annotations);
        if (updatedConfig) {
            saveConfig(envConfig, bookKey, updatedConfig, settings);
        }
        if (!appService?.isMobile) {
            setNotebookVisible(true);
        }
    };
    const handleHighlight = (update = false, highlightStyle)=>{
        if (!selection || !selection.text) return;
        setHighlightOptionsVisible(true);
        const { booknotes: annotations = [] } = config;
        const cfi = view?.getCFI(selection.index, selection.range);
        if (!cfi) return;
        const style = highlightStyle || settings.globalReadSettings.highlightStyle;
        const color = settings.globalReadSettings.highlightStyles[style];
        const annotation = {
            id: (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["uniqueId"])(),
            type: 'annotation',
            cfi,
            style,
            color,
            text: selection.text,
            note: '',
            createdAt: Date.now(),
            updatedAt: Date.now()
        };
        const existingIndex = annotations.findIndex((annotation)=>annotation.cfi === cfi && annotation.type === 'annotation' && annotation.style && !annotation.deletedAt);
        const views = getViewsById(bookKey.split('-')[0]);
        if (existingIndex !== -1) {
            views.forEach((view)=>view?.addAnnotation(annotation, true));
            if (update) {
                annotation.id = annotations[existingIndex].id;
                annotations[existingIndex] = annotation;
                views.forEach((view)=>view?.addAnnotation(annotation));
            } else {
                annotations[existingIndex].deletedAt = Date.now();
                handleDismissPopup();
            }
        } else {
            annotations.push(annotation);
            views.forEach((view)=>view?.addAnnotation(annotation));
            setSelection({
                ...selection,
                cfi,
                annotated: true
            });
        }
        const updatedConfig = updateBooknotes(bookKey, annotations);
        if (updatedConfig) {
            saveConfig(envConfig, bookKey, updatedConfig, settings);
        }
    };
    const handleAnnotate = ()=>{
        if (!selection || !selection.text) return;
        const { sectionHref: href } = progress;
        selection.href = href;
        handleHighlight(true);
        setNotebookVisible(true);
        setNotebookNewAnnotation(selection);
        handleDismissPopup();
    };
    const handleSearch = ()=>{
        if (!selection || !selection.text) return;
        handleDismissPopupAndSelection();
        let term = selection.text;
        const convertChineseVariant = viewSettings.convertChineseVariant;
        if (convertChineseVariant && convertChineseVariant !== 'none') {
            term = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$simplecc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["runSimpleCC"])(term, convertChineseVariant, true);
        }
        __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('search-term', {
            term,
            bookKey
        });
    };
    const handleDictionary = ()=>{
        if (!selection || !selection.text) return;
        setShowAnnotPopup(false);
        setShowWiktionaryPopup(true);
    };
    const handleWikipedia = ()=>{
        if (!selection || !selection.text) return;
        setShowAnnotPopup(false);
        setShowWikipediaPopup(true);
    };
    const handleTranslation = ()=>{
        if (!selection || !selection.text) return;
        setShowAnnotPopup(false);
        setShowDeepLPopup(true);
    };
    const handleSpeakText = async (oneTime = false)=>{
        if (!selection || !selection.text) return;
        setShowAnnotPopup(false);
        __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('tts-speak', {
            bookKey,
            range: selection.range,
            oneTime
        });
    };
    const handleProofread = ()=>{
        if (!selection || !selection.text) return;
        setShowAnnotPopup(false);
        setShowProofreadPopup(true);
        if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$word$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["getWordCount"])(selection.text) > 30) {
            __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('toast', {
                type: 'warning',
                message: _('Word limit of 30 words exceeded.'),
                timeout: 3000
            });
            return;
        }
    };
    const handleStartEditAnnotation = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react__$5b$external$5d$__$28$react$2c$__cjs$29$__["useCallback"])(()=>{
        setShowAnnotPopup(false);
    }, []);
    // Keyboard shortcuts: trigger actions only if there's an active selection and popup hidden
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$hooks$2f$useShortcuts$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["default"])({
        onHighlightSelection: ()=>{
            handleHighlight(false, 'highlight');
        },
        onUnderlineSelection: ()=>{
            handleHighlight(false, 'underline');
        },
        onAnnotateSelection: ()=>{
            handleAnnotate();
        },
        onSearchSelection: ()=>{
            handleSearch();
        },
        onCopySelection: ()=>{
            handleCopy(false);
        },
        onTranslateSelection: ()=>{
            handleTranslation();
        },
        onDictionarySelection: ()=>{
            handleDictionary();
        },
        onWikipediaSelection: ()=>{
            handleWikipedia();
        },
        onReadAloudSelection: ()=>{
            handleSpeakText();
        },
        onProofreadSelection: ()=>{
            handleProofread();
        }
    }, [
        selection?.text
    ]);
    const handleExportMarkdown = async (event)=>{
        const { bookKey: exportBookKey } = event.detail;
        if (bookKey !== exportBookKey) return;
        const { bookDoc, book } = bookData;
        if (!bookDoc || !book || !bookDoc.toc) return;
        const config = getConfig(bookKey);
        const { booknotes: allNotes = [] } = config;
        const booknotes = allNotes.filter((note)=>!note.deletedAt);
        if (booknotes.length === 0) {
            __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('toast', {
                type: 'info',
                message: _('No annotations to export'),
                className: 'whitespace-nowrap',
                timeout: 2000
            });
            return;
        }
        // Organize booknotes into groups by chapter
        const booknoteGroups = {};
        for (const booknote of booknotes){
            const tocItem = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$toc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["findTocItemBS"])(bookDoc.toc ?? [], booknote.cfi);
            const href = tocItem?.href || '';
            const label = tocItem?.label || '';
            const id = tocItem?.id || 0;
            if (!booknoteGroups[href]) {
                booknoteGroups[href] = {
                    id,
                    href,
                    label,
                    booknotes: []
                };
            }
            booknoteGroups[href].booknotes.push(booknote);
        }
        Object.values(booknoteGroups).forEach((group)=>{
            group.booknotes.sort((a, b)=>{
                return __TURBOPACK__imported__module__$5b$project$5d2f$packages$2f$foliate$2d$js$2f$epubcfi$2e$js__$5b$ssr$5d$__$28$ecmascript$29$__["compare"](a.cfi, b.cfi);
            });
        });
        setExportData({
            booknotes,
            booknoteGroups
        });
        setShowExportDialog(true);
    };
    const handleConfirmExport = async (markdownContent)=>{
        const { book } = bookData;
        if (!book) return;
        setTimeout(()=>{
            // Delay to ensure it won't be overridden by system clipboard actions
            navigator.clipboard?.writeText(markdownContent);
        }, 100);
        const filename = `${(0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$misc$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["makeSafeFilename"])(book.title)}.md`;
        const saved = await appService?.saveFile(filename, markdownContent, 'text/markdown');
        __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$utils$2f$event$2e$ts__$5b$ssr$5d$__$28$ecmascript$29$__["eventDispatcher"].dispatch('toast', {
            type: 'info',
            message: saved ? _('Exported successfully') : _('Copied to clipboard'),
            timeout: 2000
        });
        setShowExportDialog(false);
        setExportData(null);
    };
    const handleCancelExport = ()=>{
        setShowExportDialog(false);
        setExportData(null);
    };
    const selectionAnnotated = selection?.annotated;
    const toolButtons = __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationTools$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["annotationToolButtons"].map(({ type, label, Icon })=>{
        switch(type){
            case 'copy':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleCopy
                };
            case 'highlight':
                return {
                    tooltipText: selectionAnnotated ? _('Delete Highlight') : _(label),
                    Icon: selectionAnnotated ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$react$2d$icons$40$5$2e$4$2e$0_react$40$19$2e$2$2e$0$2f$node_modules$2f$react$2d$icons$2f$ri$2f$index$2e$mjs__$5b$ssr$5d$__$28$ecmascript$29$__["RiDeleteBinLine"] : Icon,
                    onClick: handleHighlight,
                    disabled: bookData.book?.format === 'PDF'
                };
            case 'annotate':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleAnnotate,
                    disabled: bookData.book?.format === 'PDF'
                };
            case 'search':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleSearch,
                    disabled: bookData.book?.format === 'PDF'
                };
            case 'dictionary':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleDictionary
                };
            case 'wikipedia':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleWikipedia
                };
            case 'translate':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleTranslation
                };
            case 'tts':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleSpeakText,
                    disabled: bookData.book?.format === 'PDF'
                };
            case 'proofread':
                return {
                    tooltipText: _(label),
                    Icon,
                    onClick: handleProofread,
                    disabled: bookData.book?.format !== 'EPUB'
                };
            default:
                return {
                    tooltipText: '',
                    Icon,
                    onClick: ()=>{}
                };
        }
    });
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])("div", {
        ref: containerRef,
        role: "toolbar",
        tabIndex: -1,
        children: [
            showWiktionaryPopup && trianglePosition && dictPopupPosition && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WiktionaryPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                word: selection?.text,
                lang: bookData.bookDoc?.metadata.language,
                position: dictPopupPosition,
                trianglePosition: trianglePosition,
                popupWidth: dictPopupWidth,
                popupHeight: dictPopupHeight,
                onDismiss: handleDismissPopupAndSelection
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
                lineNumber: 876,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0)),
            showWikipediaPopup && trianglePosition && dictPopupPosition && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$WikipediaPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                text: selection?.text,
                lang: bookData.bookDoc?.metadata.language,
                position: dictPopupPosition,
                trianglePosition: trianglePosition,
                popupWidth: dictPopupWidth,
                popupHeight: dictPopupHeight,
                onDismiss: handleDismissPopupAndSelection
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
                lineNumber: 887,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0)),
            showDeepLPopup && trianglePosition && translatorPopupPosition && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$TranslatorPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                text: selection?.text,
                position: translatorPopupPosition,
                trianglePosition: trianglePosition,
                popupWidth: transPopupWidth,
                popupHeight: transPopupHeight,
                onDismiss: handleDismissPopupAndSelection
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
                lineNumber: 898,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0)),
            showAnnotPopup && trianglePosition && annotPopupPosition && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                bookKey: bookKey,
                dir: viewSettings.rtl ? 'rtl' : 'ltr',
                isVertical: viewSettings.vertical,
                buttons: toolButtons,
                notes: annotationNotes,
                position: annotPopupPosition,
                trianglePosition: trianglePosition,
                highlightOptionsVisible: highlightOptionsVisible,
                selectedStyle: selectedStyle,
                selectedColor: selectedColor,
                popupWidth: annotPopupWidth,
                popupHeight: annotPopupHeight,
                onHighlight: handleHighlight,
                onDismiss: handleDismissPopupAndSelection
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
                lineNumber: 908,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0)),
            showProofreadPopup && trianglePosition && proofreadPopupPosition && selection && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ProofreadPopup$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                bookKey: bookKey,
                selection: selection,
                position: proofreadPopupPosition,
                trianglePosition: trianglePosition,
                popupWidth: proofreadPopupWidth,
                popupHeight: proofreadPopupHeight,
                onDismiss: handleDismissPopupAndSelection
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
                lineNumber: 926,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0)),
            editingAnnotation && editingAnnotation.color && selection && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$AnnotationRangeEditor$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                bookKey: bookKey,
                isVertical: viewSettings.vertical,
                annotation: editingAnnotation,
                selection: selection,
                handleColor: selectedColor,
                getAnnotationText: getAnnotationText,
                setSelection: setSelection,
                onStartEdit: handleStartEditAnnotation
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
                lineNumber: 937,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0)),
            showExportDialog && exportData && bookData.book && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$externals$5d2f$react$2f$jsx$2d$dev$2d$runtime__$5b$external$5d$__$28$react$2f$jsx$2d$dev$2d$runtime$2c$__cjs$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$readest$2d$app$2f$src$2f$app$2f$reader$2f$components$2f$annotator$2f$ExportMarkdownDialog$2e$tsx__$5b$ssr$5d$__$28$ecmascript$29$__["default"], {
                bookKey: bookKey,
                isOpen: showExportDialog,
                bookTitle: bookData.book.title,
                bookAuthor: bookData.book.author || '',
                booknotes: exportData.booknotes,
                booknoteGroups: exportData.booknoteGroups,
                onCancel: handleCancelExport,
                onExport: handleConfirmExport
            }, void 0, false, {
                fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
                lineNumber: 949,
                columnNumber: 9
            }, ("TURBOPACK compile-time value", void 0))
        ]
    }, void 0, true, {
        fileName: "[project]/apps/readest-app/src/app/reader/components/annotator/Annotator.tsx",
        lineNumber: 874,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
};
const __TURBOPACK__default__export__ = Annotator;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
];

//# sourceMappingURL=apps_readest-app_src_app_reader_components_annotator_462d538c._.js.map