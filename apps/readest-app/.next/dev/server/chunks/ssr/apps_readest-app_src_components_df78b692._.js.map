{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Overlay.tsx"],"sourcesContent":["import clsx from 'clsx';\nimport React from 'react';\n\ninterface OverlayProps {\n  onDismiss: () => void;\n  dismissLabel?: string;\n  className?: string;\n}\n\nexport const Overlay: React.FC<OverlayProps> = ({ onDismiss, className }) => {\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Escape' || e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault();\n      onDismiss();\n    }\n  };\n\n  return (\n    <div\n      className={clsx('overlay fixed inset-0 cursor-default', className)}\n      role='none'\n      tabIndex={-1}\n      onClick={onDismiss}\n      onContextMenu={onDismiss}\n      onKeyDown={handleKeyDown}\n    />\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;;;AASO,MAAM,UAAkC,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE;IACtE,MAAM,gBAAgB,CAAC;QACrB,IAAI,EAAE,GAAG,KAAK,YAAY,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK;YAC5D,EAAE,cAAc;YAChB;QACF;IACF;IAEA,qBACE,gZAAC;QACC,WAAW,IAAA,iMAAI,EAAC,wCAAwC;QACxD,MAAK;QACL,UAAU,CAAC;QACX,SAAS;QACT,eAAe;QACf,WAAW;;;;;;AAGjB"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Dialog.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { ReactNode, useEffect, useRef, useState } from 'react';\nimport { MdArrowBackIosNew, MdArrowForwardIos } from 'react-icons/md';\nimport { useEnv } from '@/context/EnvContext';\nimport { useDrag } from '@/hooks/useDrag';\nimport { useThemeStore } from '@/store/themeStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useDeviceControlStore } from '@/store/deviceStore';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\nimport { impactFeedback } from '@tauri-apps/plugin-haptics';\nimport { getDirFromUILanguage } from '@/utils/rtl';\nimport { eventDispatcher } from '@/utils/event';\nimport { Overlay } from './Overlay';\n\nconst VELOCITY_THRESHOLD = 0.5;\nconst SNAP_THRESHOLD = 0.2;\n\ninterface DialogProps {\n  id?: string;\n  isOpen: boolean;\n  children: ReactNode;\n  snapHeight?: number;\n  header?: ReactNode;\n  title?: string;\n  className?: string;\n  bgClassName?: string;\n  boxClassName?: string;\n  contentClassName?: string;\n  onClose: () => void;\n}\n\nconst Dialog: React.FC<DialogProps> = ({\n  id,\n  isOpen,\n  children,\n  snapHeight,\n  header,\n  title,\n  className,\n  bgClassName,\n  boxClassName,\n  contentClassName,\n  onClose,\n}) => {\n  const _ = useTranslation();\n  const { appService } = useEnv();\n  const { systemUIVisible, statusBarHeight, safeAreaInsets } = useThemeStore();\n  const { acquireBackKeyInterception, releaseBackKeyInterception } = useDeviceControlStore();\n  const [isFullHeightInMobile, setIsFullHeightInMobile] = useState(!snapHeight);\n  const [isRtl] = useState(() => getDirFromUILanguage() === 'rtl');\n  const dialogRef = useRef<HTMLDialogElement>(null);\n  const previousActiveElementRef = useRef<HTMLElement | null>(null);\n  const iconSize22 = useResponsiveSize(22);\n  const isMobile = window.innerWidth < 640 || window.innerHeight < 640;\n\n  const handleKeyDown = (event: KeyboardEvent | CustomEvent) => {\n    if (event instanceof CustomEvent) {\n      if (event.detail.keyName === 'Back') {\n        onClose();\n        return true;\n      }\n    } else {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n      event.stopPropagation();\n    }\n    return false;\n  };\n\n  useEffect(() => {\n    if (!isOpen) {\n      if (previousActiveElementRef.current) {\n        previousActiveElementRef.current.focus();\n        previousActiveElementRef.current = null;\n      }\n      return;\n    }\n\n    previousActiveElementRef.current = document.activeElement as HTMLElement;\n\n    setIsFullHeightInMobile(!snapHeight && isMobile);\n    window.addEventListener('keydown', handleKeyDown);\n    if (dialogRef.current) {\n      dialogRef.current.addEventListener('keydown', handleKeyDown);\n    }\n    if (appService?.isAndroidApp) {\n      acquireBackKeyInterception();\n      eventDispatcher.onSync('native-key-down', handleKeyDown);\n    }\n\n    const timer = setTimeout(() => {\n      if (dialogRef.current) {\n        dialogRef.current.focus();\n      }\n    }, 100);\n    return () => {\n      clearTimeout(timer);\n      window.removeEventListener('keydown', handleKeyDown);\n      if (appService?.isAndroidApp) {\n        releaseBackKeyInterception();\n        eventDispatcher.offSync('native-key-down', handleKeyDown);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen]);\n\n  const handleDragMove = (data: { clientY: number; deltaY: number }) => {\n    if (!isMobile || !dialogRef.current) return;\n\n    const modal = dialogRef.current.querySelector('.modal-box') as HTMLElement;\n    const overlay = dialogRef.current.querySelector('.overlay') as HTMLElement;\n\n    const heightFraction = data.clientY / window.innerHeight;\n    const newTop = Math.max(0.0, Math.min(1, heightFraction));\n\n    if (modal && overlay) {\n      modal.style.height = '100%';\n      modal.style.transform = `translateY(${newTop * 100}%)`;\n      overlay.style.opacity = `${1 - heightFraction}`;\n\n      setIsFullHeightInMobile(data.clientY < 44);\n      modal.style.transition = `padding-top 0.3s ease-out`;\n    }\n  };\n\n  const handleDragEnd = (data: { velocity: number; clientY: number }) => {\n    if (!isMobile || !dialogRef.current) return;\n    const modal = dialogRef.current.querySelector('.modal-box') as HTMLElement;\n    const overlay = dialogRef.current.querySelector('.overlay') as HTMLElement;\n    if (!modal || !overlay) return;\n\n    const snapUpper = snapHeight ? 1 - snapHeight - SNAP_THRESHOLD : 0.5;\n    const snapLower = snapHeight ? 1 - snapHeight + SNAP_THRESHOLD : 0.5;\n    if (\n      data.velocity > VELOCITY_THRESHOLD ||\n      (data.velocity >= 0 && data.clientY >= window.innerHeight * snapLower)\n    ) {\n      // dialog is dismissed\n      const transitionDuration = 0.15 / Math.max(data.velocity, 0.5);\n      modal.style.height = '100%';\n      modal.style.transition = `transform ${transitionDuration}s ease-out`;\n      modal.style.transform = 'translateY(100%)';\n      overlay.style.transition = `opacity ${transitionDuration}s ease-out`;\n      overlay.style.opacity = '0';\n      onClose();\n      setTimeout(() => {\n        modal.style.transform = 'translateY(0%)';\n      }, 300);\n    } else if (\n      snapHeight &&\n      data.clientY > window.innerHeight * snapUpper &&\n      data.clientY < window.innerHeight * snapLower\n    ) {\n      // dialog is snapped\n      overlay.style.transition = `opacity 0.3s ease-out`;\n      overlay.style.opacity = `${1 - snapHeight}`;\n      modal.style.height = `${snapHeight * 100}%`;\n      modal.style.bottom = '0';\n      modal.style.transition = `transform 0.3s ease-out`;\n      modal.style.transform = '';\n    } else {\n      // dialog is opened without snap\n      setIsFullHeightInMobile(true);\n      modal.style.height = '100%';\n      modal.style.transition = `transform 0.3s ease-out`;\n      modal.style.transform = `translateY(0%)`;\n      overlay.style.opacity = '0';\n    }\n    if (appService?.hasHaptics) {\n      impactFeedback('medium');\n    }\n  };\n\n  const handleDragKeyDown = () => {};\n\n  const { handleDragStart } = useDrag(handleDragMove, handleDragKeyDown, handleDragEnd);\n\n  return (\n    <dialog\n      ref={dialogRef}\n      id={id ?? 'dialog'}\n      tabIndex={-1}\n      open={isOpen}\n      aria-hidden={!isOpen}\n      className={clsx(\n        'modal sm:min-w-90 z-50 h-full w-full !items-start !bg-transparent sm:w-full sm:!items-center',\n        className,\n      )}\n      dir={isRtl ? 'rtl' : undefined}\n    >\n      <Overlay\n        className={clsx(\n          'dialog-overlay z-10 bg-black/50 sm:bg-black/50',\n          appService?.hasRoundedWindow && 'rounded-window',\n          bgClassName,\n        )}\n        onDismiss={onClose}\n      />\n      <div\n        className={clsx(\n          'modal-box settings-content absolute z-20 flex flex-col rounded-none rounded-tl-2xl rounded-tr-2xl p-0 sm:rounded-2xl',\n          'h-full max-h-full w-full max-w-full',\n          window.innerWidth < window.innerHeight\n            ? 'sm:h-[50%] sm:w-3/4'\n            : 'sm:h-[65%] sm:w-1/2 sm:max-w-[600px]',\n          boxClassName,\n        )}\n        style={{\n          paddingTop:\n            appService?.hasSafeAreaInset && isFullHeightInMobile\n              ? `${Math.max(safeAreaInsets?.top || 0, systemUIVisible ? statusBarHeight : 0)}px`\n              : '0px',\n          ...(isMobile ? { height: snapHeight ? `${snapHeight * 100}%` : '100%', bottom: 0 } : {}),\n        }}\n      >\n        {/* eslint-disable-next-line jsx-a11y/no-static-element-interactions */}\n        <div\n          className={clsx(\n            'drag-handle h-10 max-h-10 min-h-10 w-full cursor-row-resize items-center justify-center',\n            'transition-padding-top flex duration-300 ease-out sm:hidden',\n          )}\n          onMouseDown={handleDragStart}\n          onTouchStart={handleDragStart}\n        >\n          <div className='bg-base-content/50 h-1 w-10 rounded-full'></div>\n        </div>\n        <div className='dialog-header sticky top-1 z-10 flex items-center justify-between px-2 sm:px-4'>\n          {header ? (\n            header\n          ) : (\n            <div className='flex h-11 w-full items-center justify-between'>\n              <button\n                aria-label={_('Close')}\n                onClick={onClose}\n                className={\n                  'btn btn-ghost btn-circle flex h-8 min-h-8 w-8 hover:bg-transparent focus:outline-none sm:hidden'\n                }\n              >\n                {isRtl ? (\n                  <MdArrowForwardIos size={iconSize22} />\n                ) : (\n                  <MdArrowBackIosNew size={iconSize22} />\n                )}\n              </button>\n              <div className='z-15 pointer-events-none absolute inset-0 flex h-11 items-center justify-center'>\n                <span className='line-clamp-1 text-center font-bold'>{title ?? ''}</span>\n              </div>\n              <button\n                aria-label={_('Close')}\n                onClick={onClose}\n                className={\n                  'bg-base-300/65 btn btn-ghost btn-circle ml-auto hidden h-6 min-h-6 w-6 focus:outline-none sm:flex'\n                }\n              >\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  width='1em'\n                  height='1em'\n                  viewBox='0 0 24 24'\n                >\n                  <path\n                    fill='currentColor'\n                    d='M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z'\n                  />\n                </svg>\n              </button>\n            </div>\n          )}\n        </div>\n\n        <div\n          className={clsx(\n            'text-base-content my-2 flex-grow overflow-y-auto px-6 sm:px-[10%]',\n            contentClassName,\n          )}\n        >\n          {children}\n        </div>\n      </div>\n    </dialog>\n  );\n};\n\nexport default Dialog;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Link.tsx"],"sourcesContent":["import { isTauriAppPlatform } from '@/services/environment';\nimport { openUrl } from '@tauri-apps/plugin-opener';\n\ninterface LinkProps extends React.AnchorHTMLAttributes<HTMLAnchorElement> {\n  href: string;\n  title?: string;\n}\n\nconst Link: React.FC<LinkProps> = ({ href, children, ...props }) => {\n  const handleClick = async (e: React.MouseEvent<HTMLAnchorElement>) => {\n    if (isTauriAppPlatform()) {\n      e.preventDefault();\n      await openUrl(href);\n    }\n  };\n\n  return (\n    <a href={href} target='_blank' rel='noopener noreferrer' onClick={handleClick} {...props}>\n      {children}\n    </a>\n  );\n};\n\nexport default Link;\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAOA,MAAM,OAA4B,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,OAAO;IAC7D,MAAM,cAAc,OAAO;QACzB,IAAI,IAAA,8KAAkB,KAAI;YACxB,EAAE,cAAc;YAChB,MAAM,IAAA,qQAAO,EAAC;QAChB;IACF;IAEA,qBACE,gZAAC;QAAE,MAAM;QAAM,QAAO;QAAS,KAAI;QAAsB,SAAS;QAAc,GAAG,KAAK;kBACrF;;;;;;AAGP;uCAEe"}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/UpdaterWindow.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport semver from 'semver';\nimport Image from 'next/image';\nimport { useEnv } from '@/context/EnvContext';\nimport { useEffect, useState } from 'react';\nimport { type as osType, arch as osArch } from '@tauri-apps/plugin-os';\nimport { check, Update } from '@tauri-apps/plugin-updater';\nimport { relaunch, exit } from '@tauri-apps/plugin-process';\nimport { fetch as tauriFetch } from '@tauri-apps/plugin-http';\nimport { Command } from '@tauri-apps/plugin-shell';\nimport { invoke } from '@tauri-apps/api/core';\nimport { isTauriAppPlatform } from '@/services/environment';\nimport { useTranslator } from '@/hooks/useTranslator';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useSearchParams } from 'next/navigation';\nimport { getAppVersion } from '@/utils/version';\nimport { tauriDownload } from '@/utils/transfer';\nimport { installPackage } from '@/utils/bridge';\nimport { join } from '@tauri-apps/api/path';\nimport { getLocale } from '@/utils/misc';\nimport { setLastShownReleaseNotesVersion } from '@/helpers/updater';\nimport { READEST_UPDATER_FILE, READEST_CHANGELOG_FILE } from '@/services/constants';\nimport Dialog from '@/components/Dialog';\nimport Link from './Link';\n\ninterface ReleaseNotes {\n  releases: Record<\n    string,\n    {\n      date: string;\n      notes: string[];\n    }\n  >;\n}\n\ninterface Changelog {\n  version: string;\n  date: string;\n  notes: string[];\n}\n\ntype DownloadEvent =\n  | {\n      event: 'Started';\n      data: {\n        contentLength?: number;\n      };\n    }\n  | {\n      event: 'Progress';\n      data: {\n        chunkLength: number;\n      };\n    }\n  | {\n      event: 'Finished';\n    };\n\ninterface GenericUpdate {\n  currentVersion: string;\n  version: string;\n  date?: string;\n  body?: string;\n  downloadAndInstall?(onEvent?: (progress: DownloadEvent) => void): Promise<void>;\n}\n\nexport const UpdaterContent = ({\n  latestVersion,\n  lastVersion,\n  checkUpdate = true,\n}: {\n  latestVersion?: string;\n  lastVersion?: string;\n  checkUpdate?: boolean;\n}) => {\n  const _ = useTranslation();\n  const [targetLang, setTargetLang] = useState('EN');\n  const { translate } = useTranslator({\n    provider: 'azure',\n    sourceLang: 'AUTO',\n    targetLang,\n  });\n  const { appService } = useEnv();\n  const searchParams = useSearchParams();\n  const currentVersion = getAppVersion();\n  const [newVersion, setNewVersion] = useState(\n    latestVersion ?? searchParams?.get('latestVersion') ?? '',\n  );\n  const [oldVersion, setOldVersion] = useState(\n    lastVersion ?? searchParams?.get('lastVersion') ?? '',\n  );\n  const [update, setUpdate] = useState<GenericUpdate | Update | null>(null);\n  const [changelogs, setChangelogs] = useState<Changelog[]>([]);\n  const [progress, setProgress] = useState<number | null>(null);\n  const [contentLength, setContentLength] = useState<number | null>(null);\n  const [isDownloading, setIsDownloading] = useState(false);\n  const [downloaded, setDownloaded] = useState<number | null>(null);\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    setTargetLang(getLocale());\n  }, []);\n\n  useEffect(() => {\n    const checkDesktopUpdate = async () => {\n      const update = await check();\n      if (update) {\n        setUpdate(update);\n      }\n    };\n    const checkAndroidUpdate = async () => {\n      if (!appService) return;\n      const fetch = isTauriAppPlatform() ? tauriFetch : window.fetch;\n      const response = await fetch(READEST_UPDATER_FILE);\n      const data = await response.json();\n      if (semver.gt(data.version, currentVersion)) {\n        const OS_ARCH = osArch();\n        const platformKey = OS_ARCH === 'aarch64' ? 'android-arm64' : 'android-universal';\n        const arch = OS_ARCH === 'aarch64' ? 'arm64' : 'universal';\n        const downloadUrl = data.platforms[platformKey]?.url as string;\n        const apkFilePath = await appService.resolveFilePath(\n          `Readest_${data.version}_${arch}.apk`,\n          'Cache',\n        );\n        setUpdate({\n          currentVersion,\n          version: data.version,\n          date: data.pub_date,\n          body: data.notes,\n          downloadAndInstall: async (onEvent) => {\n            await new Promise<void>(async (resolve, reject) => {\n              let downloaded = 0;\n              let total = 0;\n              await tauriDownload(downloadUrl, apkFilePath, (progress) => {\n                if (!onEvent) return;\n                if (!total && progress.total) {\n                  total = progress.total;\n                  onEvent({\n                    event: 'Started',\n                    data: { contentLength: total },\n                  });\n                } else if (downloaded > 0 && progress.progress === progress.total) {\n                  console.log('APK downloaded to', apkFilePath);\n                  onEvent?.({ event: 'Finished' });\n                  setTimeout(() => {\n                    resolve();\n                  }, 1000);\n                }\n\n                onEvent({\n                  event: 'Progress',\n                  data: { chunkLength: progress.progress - downloaded },\n                });\n                downloaded = progress.progress;\n              }).catch((error) => {\n                console.error('Download failed:', error);\n                reject(error);\n              });\n            });\n\n            const res = await installPackage({\n              path: apkFilePath,\n            });\n            if (res.success) {\n              console.log('APK installed successfully');\n            } else {\n              console.error('Failed to install APK:', res.error);\n            }\n          },\n        } as GenericUpdate);\n      }\n    };\n    const checkWindowsPortableUpdate = async () => {\n      if (!appService) return;\n      const fetch = isTauriAppPlatform() ? tauriFetch : window.fetch;\n      const response = await fetch(READEST_UPDATER_FILE);\n      const data = await response.json();\n      if (semver.gt(data.version, currentVersion)) {\n        const OS_ARCH = osArch();\n        const platformKey =\n          OS_ARCH === 'x86_64' ? 'windows-x86_64-portable' : 'windows-aarch64-portable';\n        const arch = OS_ARCH === 'x86_64' ? 'x64' : 'arm64';\n        const downloadUrl = data.platforms[platformKey]?.url as string;\n        const execDir = await invoke<string>('get_executable_dir');\n        const exeFileName = `Readest_${data.version}_${arch}-portable.exe`;\n        const exeFilePath = await join(execDir, exeFileName);\n        setUpdate({\n          currentVersion,\n          version: data.version,\n          date: data.pub_date,\n          body: data.notes,\n          downloadAndInstall: async (onEvent) => {\n            await new Promise<void>(async (resolve, reject) => {\n              let downloaded = 0;\n              let total = 0;\n              await tauriDownload(downloadUrl, exeFilePath, (progress) => {\n                if (!onEvent) return;\n                if (!total && progress.total) {\n                  total = progress.total;\n                  onEvent({\n                    event: 'Started',\n                    data: { contentLength: total },\n                  });\n                } else if (downloaded > 0 && progress.progress === progress.total) {\n                  console.log('Portable EXE downloaded to', exeFilePath);\n                  onEvent?.({ event: 'Finished' });\n                  setTimeout(() => {\n                    resolve();\n                  }, 1000);\n                }\n\n                onEvent({\n                  event: 'Progress',\n                  data: { chunkLength: progress.progress - downloaded },\n                });\n                downloaded = progress.progress;\n              }).catch((error) => {\n                console.error('Download failed:', error);\n                reject(error);\n              });\n            });\n\n            try {\n              console.log('Launching new executable:', exeFilePath);\n              const command = Command.create('start-readest', ['/C', 'start', '', exeFilePath]);\n              await command.spawn();\n              console.log('New executable launched, exiting current app...');\n              setTimeout(async () => {\n                await exit(0);\n              }, 500);\n            } catch (error) {\n              console.error('Failed to launch new executable:', error);\n            }\n          },\n        } as GenericUpdate);\n      }\n    };\n    const checkForUpdates = async () => {\n      const OS_TYPE = osType();\n      if (appService?.isPortableApp && OS_TYPE === 'windows') {\n        checkWindowsPortableUpdate();\n      } else if (['macos', 'windows', 'linux'].includes(OS_TYPE)) {\n        checkDesktopUpdate();\n      } else if (OS_TYPE === 'android') {\n        checkAndroidUpdate();\n      }\n    };\n    if (appService?.hasUpdater && checkUpdate) {\n      checkForUpdates();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [appService?.hasUpdater]);\n\n  useEffect(() => {\n    if (latestVersion) {\n      setNewVersion(latestVersion);\n    }\n    if (lastVersion) {\n      setOldVersion(lastVersion);\n    }\n    if (!checkUpdate) {\n      setUpdate({\n        currentVersion,\n        version: latestVersion,\n        date: '',\n        body: '',\n      } as GenericUpdate);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [latestVersion, lastVersion, checkUpdate]);\n\n  useEffect(() => {\n    const fetchChangelogs = async (fromVersion: string): Promise<Changelog[]> => {\n      try {\n        const fetch = isTauriAppPlatform() ? tauriFetch : window.fetch;\n        const res = await fetch(READEST_CHANGELOG_FILE);\n        const data: ReleaseNotes = await res.json();\n        const releases = data.releases;\n\n        let entries = Object.entries(releases)\n          .filter(([ver]) => semver.gt(ver, fromVersion))\n          .sort(([a], [b]) => semver.rcompare(a, b));\n        entries = entries.length ? entries : Object.entries(releases).slice(0, 3);\n        return entries.map(([version, info]) => ({\n          version,\n          date: new Date(info.date).toLocaleDateString(),\n          notes: info.notes,\n        }));\n      } catch (error) {\n        console.error('Failed to fetch changelog:', error);\n        return [];\n      }\n    };\n    const parseNumberedList = (input: string): string[] => {\n      return input\n        .split(/(?:^|\\s)\\d+\\.\\s/)\n        .map((item) => item.trim())\n        .filter((item) => item.length > 0);\n    };\n    const updateChangelogs = async (update: GenericUpdate) => {\n      setNewVersion(update.version);\n      let changelogs = await fetchChangelogs(oldVersion || currentVersion);\n      if (changelogs.length === 0 && update.date && update.body) {\n        changelogs = [\n          {\n            version: update.version,\n            date: new Date(update.date).toLocaleDateString(),\n            notes: parseNumberedList(update.body ?? ''),\n          },\n        ];\n      }\n      if (!targetLang.toLowerCase().startsWith('en')) {\n        for (const entry of changelogs) {\n          try {\n            entry.notes = await translate(entry.notes, { useCache: true });\n          } catch (error) {\n            console.log('Failed to translate changelog:', error);\n          }\n        }\n      }\n\n      setChangelogs(changelogs);\n      setLastShownReleaseNotesVersion(newVersion);\n    };\n    if (update) {\n      updateChangelogs(update);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [update]);\n\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  const handleDownloadInstall = async () => {\n    if (!update) {\n      return;\n    }\n    let downloaded = 0;\n    let contentLength = 0;\n    let lastLogged = 0;\n    setProgress(0);\n    setIsDownloading(true);\n    await update.downloadAndInstall?.((event) => {\n      switch (event.event) {\n        case 'Started':\n          contentLength = event.data.contentLength!;\n          setContentLength(contentLength);\n          break;\n        case 'Progress':\n          downloaded += event.data.chunkLength;\n          setDownloaded(downloaded);\n          const percent = Math.floor((downloaded / contentLength) * 100);\n          setProgress(percent);\n          if (downloaded - lastLogged >= 1 * 1024 * 1024) {\n            console.log(`downloaded ${downloaded} bytes from ${contentLength}`);\n            lastLogged = downloaded;\n          }\n          break;\n        case 'Finished':\n          console.log('download finished');\n          setProgress(100);\n          break;\n      }\n    });\n    console.log('package installed');\n    if (!appService?.isAndroidApp && process.env['NODE_ENV'] === 'production') {\n      await relaunch();\n    }\n  };\n\n  if (!isMounted || !newVersion) {\n    return null;\n  }\n\n  return (\n    <div className='bg-base-100 flex min-h-screen justify-center'>\n      <div className='flex w-full max-w-2xl flex-col gap-4'>\n        <div className='flex flex-col justify-center gap-4 sm:flex-row sm:items-start'>\n          <div className='flex items-center justify-center'>\n            <Image src='/icon.png' alt='Logo' className='h-20 w-20' width={64} height={64} />\n          </div>\n\n          {checkUpdate ? (\n            <div className='text-base-content flex-grow text-sm'>\n              <h2 className='mb-4 text-center font-bold sm:text-start'>\n                {_('A new version of Readest is available!')}\n              </h2>\n              <p className='mb-2'>\n                {_('Readest {{newVersion}} is available (installed version {{currentVersion}}).', {\n                  newVersion,\n                  currentVersion,\n                })}\n              </p>\n              <p className='mb-2'>{_('Download and install now?')}</p>\n\n              <div className='flex w-full flex-row items-center justify-end gap-4'>\n                {progress !== null && (\n                  <div className='flex flex-grow flex-col'>\n                    <progress\n                      className='progress my-1 h-4 w-full'\n                      value={progress}\n                      max='100'\n                    ></progress>\n                    <p className='text-base-content/75 flex items-center justify-center text-sm'>\n                      {progress < 100\n                        ? _('Downloading {{downloaded}} of {{contentLength}}', {\n                            downloaded: downloaded\n                              ? `${Math.floor(downloaded / 1024 / 1024)} MB`\n                              : '0 MB',\n                            contentLength: contentLength\n                              ? `${Math.floor(contentLength / 1024 / 1024)} MB`\n                              : '0 MB',\n                          })\n                        : _('Download finished')}\n                    </p>\n                  </div>\n                )}\n\n                <div className='card-actions'>\n                  <button\n                    className={clsx(\n                      'btn btn-warning text-base-100 px-6 font-bold',\n                      (!update || isDownloading) && 'btn-disabled',\n                    )}\n                    onClick={handleDownloadInstall}\n                  >\n                    {_('DOWNLOAD & INSTALL')}\n                  </button>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className='text-base-content flex h-full flex-grow flex-col text-sm sm:flex-row'>\n              <div className='flex flex-col items-center justify-center gap-4 p-1 sm:items-start sm:gap-2'>\n                <h2 className='text-center font-bold sm:text-start'>\n                  {_('Version {{version}}', { version: currentVersion })}\n                </h2>\n\n                {changelogs.length > 0 && semver.gt(changelogs[0]!.version, currentVersion) ? (\n                  <div className='flex gap-2'>\n                    {(appService?.isIOSApp || appService?.isMacOSApp) && (\n                      <Link\n                        href='https://apps.apple.com/app/id6738622779'\n                        target='_blank'\n                        rel='noopener noreferrer'\n                        className='btn btn-primary btn-sm'\n                      >\n                        {_('Check Update')}\n                      </Link>\n                    )}\n\n                    {appService?.isAndroidApp && (\n                      <Link\n                        href='https://play.google.com/store/apps/details?id=com.bilingify.readest'\n                        target='_blank'\n                        rel='noopener noreferrer'\n                        className='btn btn-primary btn-sm'\n                      >\n                        {_('Check Update')}\n                      </Link>\n                    )}\n                  </div>\n                ) : (\n                  <div className='flex'>\n                    <p className='text-sm font-bold'>{_('Already the latest version')}</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n        <div className='text-base-content text-sm'>\n          <h3 className='mb-2 font-bold'>{_('Changelog')}</h3>\n          <div className='not-eink:bg-base-200 not-eink:px-4 mb-4 rounded-lg pb-2 pt-4'>\n            {changelogs.length > 0 ? (\n              changelogs.map((entry: Changelog) => (\n                <div key={entry.version} className='mb-4'>\n                  <h4 className='mb-2 font-bold'>\n                    {entry.version} ({entry.date})\n                  </h4>\n                  <ul className='list-disc space-y-1 ps-6 text-sm'>\n                    {entry.notes.map((note: string, i: number) => (\n                      <li key={i}>{note}</li>\n                    ))}\n                  </ul>\n                </div>\n              ))\n            ) : (\n              <div className='flex h-56 w-full flex-col gap-4'>\n                <div className='skeleton h-4 w-28'></div>\n                <div className='skeleton h-4 w-full'></div>\n                <div className='skeleton h-4 w-full'></div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const setUpdaterWindowVisible = (\n  visible: boolean,\n  latestVersion: string,\n  lastVersion?: string,\n  checkUpdate = true,\n) => {\n  const dialog = document.getElementById('updater_window');\n  if (dialog) {\n    const event = new CustomEvent('setDialogVisibility', {\n      detail: { visible, latestVersion, lastVersion, checkUpdate },\n    });\n    dialog.dispatchEvent(event);\n  }\n};\n\nexport const UpdaterWindow = () => {\n  const _ = useTranslation();\n  const [latestVersion, setLatestVersion] = useState('');\n  const [lastVersion, setLastVersion] = useState('');\n  const [checkUpdate, setCheckUpdate] = useState(true);\n  const [isOpen, setIsOpen] = useState(false);\n\n  useEffect(() => {\n    const handleCustomEvent = (event: CustomEvent) => {\n      const { visible, latestVersion, lastVersion, checkUpdate } = event.detail;\n      setIsOpen(visible);\n      setCheckUpdate(checkUpdate);\n      if (latestVersion) {\n        setLatestVersion(latestVersion);\n      }\n      if (lastVersion) {\n        setLastVersion(lastVersion);\n      }\n    };\n\n    const el = document.getElementById('updater_window');\n    if (el) {\n      el.addEventListener('setDialogVisibility', handleCustomEvent as EventListener);\n    }\n\n    return () => {\n      if (el) {\n        el.removeEventListener('setDialogVisibility', handleCustomEvent as EventListener);\n      }\n    };\n  }, []);\n\n  return (\n    <Dialog\n      id='updater_window'\n      isOpen={isOpen}\n      title={checkUpdate ? _('Software Update') : _(\"What's New in Readest\")}\n      onClose={() => setIsOpen(false)}\n      boxClassName='sm:!w-[75%] sm:h-auto sm:!max-h-[85vh] sm:!max-w-2xl'\n    >\n      {isOpen && (\n        <UpdaterContent\n          latestVersion={latestVersion ?? undefined}\n          lastVersion={lastVersion ?? undefined}\n          checkUpdate={checkUpdate}\n        />\n      )}\n    </Dialog>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1093, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/SupportLinks.tsx"],"sourcesContent":["import { FaGithub, FaDiscord, FaReddit } from 'react-icons/fa';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\nimport Link from './Link';\n\nconst SupportLinks = () => {\n  const _ = useTranslation();\n  const iconSize = useResponsiveSize(24);\n\n  return (\n    <div className='my-2 flex flex-col items-center gap-2'>\n      <p className='text-neutral-content text-sm'>{_('Get Help from the Readest Community')}</p>\n      <div className='flex gap-4'>\n        <Link\n          href='https://github.com/readest/readest'\n          className='flex items-center gap-2 rounded-full bg-gray-800 p-1.5 text-white transition-colors hover:bg-gray-700'\n          title='GitHub'\n          aria-label='GitHub'\n        >\n          <FaGithub size={iconSize} />\n        </Link>\n        <Link\n          href='https://discord.gg/gntyVNk3BJ'\n          className='flex items-center gap-2 rounded-full bg-indigo-600 p-1.5 text-white transition-colors hover:bg-indigo-500'\n          title='Discord'\n          aria-label='Discord'\n        >\n          <FaDiscord size={iconSize} />\n        </Link>\n        <Link\n          href='https://reddit.com/r/readest/'\n          className='flex items-center gap-2 rounded-full bg-orange-600 p-1.5 text-white transition-colors hover:bg-orange-500'\n          title='Reddit'\n          aria-label='Reddit'\n        >\n          <FaReddit size={iconSize} />\n        </Link>\n      </div>\n    </div>\n  );\n};\n\nexport default SupportLinks;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;AAEA,MAAM,eAAe;IACnB,MAAM,IAAI,IAAA,0KAAc;IACxB,MAAM,WAAW,IAAA,gLAAiB,EAAC;IAEnC,qBACE,gZAAC;QAAI,WAAU;;0BACb,gZAAC;gBAAE,WAAU;0BAAgC,EAAE;;;;;;0BAC/C,gZAAC;gBAAI,WAAU;;kCACb,gZAAC,+JAAI;wBACH,MAAK;wBACL,WAAU;wBACV,OAAM;wBACN,cAAW;kCAEX,cAAA,gZAAC,2OAAQ;4BAAC,MAAM;;;;;;;;;;;kCAElB,gZAAC,+JAAI;wBACH,MAAK;wBACL,WAAU;wBACV,OAAM;wBACN,cAAW;kCAEX,cAAA,gZAAC,4OAAS;4BAAC,MAAM;;;;;;;;;;;kCAEnB,gZAAC,+JAAI;wBACH,MAAK;wBACL,WAAU;wBACV,OAAM;wBACN,cAAW;kCAEX,cAAA,gZAAC,2OAAQ;4BAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;AAK1B;uCAEe"}},
    {"offset": {"line": 1193, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/LegalLinks.tsx"],"sourcesContent":["import { useEnv } from '@/context/EnvContext';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport Link from './Link';\n\nconst LegalLinks = () => {\n  const _ = useTranslation();\n  const { appService } = useEnv();\n\n  const termsUrl =\n    appService?.isIOSApp || appService?.isMacOSApp\n      ? 'https://www.apple.com/legal/internet-services/itunes/dev/stdeula/'\n      : 'https://readest.com/terms-of-service';\n\n  return (\n    <div className='my-2 flex flex-wrap justify-center gap-4 text-sm sm:text-xs'>\n      <Link href={termsUrl} className='text-blue-500 underline hover:text-blue-600'>\n        {_('Terms of Service')}\n      </Link>\n      <Link\n        href='https://readest.com/privacy-policy'\n        className='text-blue-500 underline hover:text-blue-600'\n      >\n        {_('Privacy Policy')}\n      </Link>\n    </div>\n  );\n};\n\nexport default LegalLinks;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAEA,MAAM,aAAa;IACjB,MAAM,IAAI,IAAA,0KAAc;IACxB,MAAM,EAAE,UAAU,EAAE,GAAG,IAAA,iKAAM;IAE7B,MAAM,WACJ,YAAY,YAAY,YAAY,aAChC,sEACA;IAEN,qBACE,gZAAC;QAAI,WAAU;;0BACb,gZAAC,+JAAI;gBAAC,MAAM;gBAAU,WAAU;0BAC7B,EAAE;;;;;;0BAEL,gZAAC,+JAAI;gBACH,MAAK;gBACL,WAAU;0BAET,EAAE;;;;;;;;;;;;AAIX;uCAEe"}},
    {"offset": {"line": 1242, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/AboutWindow.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport Image from 'next/image';\nimport { useEnv } from '@/context/EnvContext';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { checkForAppUpdates, checkAppReleaseNotes } from '@/helpers/updater';\nimport { parseWebViewInfo } from '@/utils/ua';\nimport { getAppVersion } from '@/utils/version';\nimport SupportLinks from './SupportLinks';\nimport LegalLinks from './LegalLinks';\nimport Dialog from './Dialog';\nimport Link from './Link';\n\nexport const setAboutDialogVisible = (visible: boolean) => {\n  const dialog = document.getElementById('about_window');\n  if (dialog) {\n    const event = new CustomEvent('setDialogVisibility', {\n      detail: { visible },\n    });\n    dialog.dispatchEvent(event);\n  }\n};\n\ntype UpdateStatus = 'checking' | 'updating' | 'updated' | 'error';\n\nexport const AboutWindow = () => {\n  const _ = useTranslation();\n  const { appService } = useEnv();\n  const [updateStatus, setUpdateStatus] = useState<UpdateStatus | null>(null);\n  const [browserInfo, setBrowserInfo] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n\n  useEffect(() => {\n    setBrowserInfo(parseWebViewInfo(appService));\n\n    const handleCustomEvent = (event: CustomEvent) => {\n      setIsOpen(event.detail.visible);\n    };\n\n    const el = document.getElementById('about_window');\n    if (el) {\n      el.addEventListener('setDialogVisibility', handleCustomEvent as EventListener);\n    }\n\n    return () => {\n      if (el) {\n        el.removeEventListener('setDialogVisibility', handleCustomEvent as EventListener);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleCheckUpdate = async () => {\n    setUpdateStatus('checking');\n    try {\n      const hasUpdate = await checkForAppUpdates(_, false);\n      if (hasUpdate) {\n        handleClose();\n      } else {\n        setUpdateStatus('updated');\n      }\n    } catch (error) {\n      console.info('Error checking for updates:', error);\n      setUpdateStatus('error');\n    }\n  };\n\n  const handleShowRecentUpdates = async () => {\n    const hasNotes = await checkAppReleaseNotes(false);\n    if (hasNotes) {\n      handleClose();\n    } else {\n      setUpdateStatus('error');\n    }\n  };\n\n  const handleClose = () => {\n    setIsOpen(false);\n    setUpdateStatus(null);\n  };\n\n  return (\n    <Dialog\n      id='about_window'\n      isOpen={isOpen}\n      title={_('About Readest')}\n      onClose={handleClose}\n      boxClassName='sm:!w-[480px] sm:!max-w-screen-sm sm:h-auto'\n    >\n      {isOpen && (\n        <div className='about-content flex flex-col items-center justify-center gap-4 pb-10 sm:pb-0'>\n          <div className='flex flex-1 flex-col items-center justify-end gap-2 px-8 py-2'>\n            <div className='mb-2 mt-6'>\n              <Image src='/icon.png' alt='App Logo' className='h-20 w-20' width={64} height={64} />\n            </div>\n            <div className='flex select-text flex-col items-center'>\n              <h2 className='mb-2 text-2xl font-bold'>Readest</h2>\n              <p className='text-neutral-content text-center text-sm'>\n                {_('Version {{version}}', { version: getAppVersion() })} {`(${browserInfo})`}\n              </p>\n            </div>\n            <div className='my-1 h-5'>\n              {!updateStatus && (\n                <button\n                  className='btn btn-sm btn-primary cursor-pointer p-1 text-xs'\n                  onClick={appService?.hasUpdater ? handleCheckUpdate : handleShowRecentUpdates}\n                >\n                  {_('Check Update')}\n                </button>\n              )}\n              {updateStatus === 'updated' && (\n                <p className='text-neutral-content mt-2 text-xs'>\n                  {_('Already the latest version')}\n                </p>\n              )}\n              {updateStatus === 'checking' && (\n                <p className='text-neutral-content mt-2 text-xs'>{_('Checking for updates...')}</p>\n              )}\n              {updateStatus === 'error' && (\n                <p className='text-error mt-2 text-xs'>{_('Error checking for updates')}</p>\n              )}\n            </div>\n          </div>\n\n          <hr className='border-base-300 my-12 w-full sm:my-4' />\n\n          <div\n            className='flex flex-1 flex-col items-center justify-start gap-2 px-4 text-center'\n            dir='ltr'\n          >\n            <p className='text-neutral-content text-sm'>\n               {new Date().getFullYear()} Bilingify LLC. All rights reserved.\n            </p>\n\n            <p className='text-neutral-content text-xs'>\n              This software is licensed under the{' '}\n              <Link\n                href='https://www.gnu.org/licenses/agpl-3.0.html'\n                className='text-blue-500 underline'\n              >\n                GNU Affero General Public License v3.0\n              </Link>\n              . You are free to use, modify, and distribute this software under the terms of the\n              AGPL v3 license. Please see the license for more details.\n            </p>\n            <p className='text-neutral-content text-xs'>\n              Source code is available at{' '}\n              <Link href='https://github.com/readest/readest' className='text-blue-500 underline'>\n                GitHub\n              </Link>\n              .\n            </p>\n\n            <LegalLinks />\n          </div>\n          <SupportLinks />\n        </div>\n      )}\n    </Dialog>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1538, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Alert.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React from 'react';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useKeyDownActions } from '@/hooks/useKeyDownActions';\n\nconst Alert: React.FC<{\n  title: string;\n  message: string;\n  onCancel: () => void;\n  onConfirm: () => void;\n}> = ({ title, message, onCancel, onConfirm }) => {\n  const _ = useTranslation();\n  const [isProcessing, setIsProcessing] = React.useState(false);\n  const divRef = useKeyDownActions({ onCancel, onConfirm });\n\n  return (\n    <div className={clsx('z-[100] flex justify-center px-4')}>\n      <div\n        ref={divRef}\n        role='alert'\n        className={clsx(\n          'alert flex items-center justify-between',\n          'bg-base-300 rounded-lg border-none p-4 shadow-2xl',\n          'w-full max-w-[90vw] sm:max-w-[70vw] md:max-w-[50vw] lg:max-w-[40vw] xl:max-w-[40vw]',\n          'min-w-[70vw] flex-col sm:min-w-[40vw] sm:flex-row',\n        )}\n      >\n        <div className='labels flex items-center space-x-2 self-start sm:space-x-4 sm:self-center'>\n          <svg\n            xmlns='http://www.w3.org/2000/svg'\n            fill='none'\n            viewBox='0 0 24 24'\n            className='stroke-info h-6 w-6 shrink-0'\n          >\n            <path\n              strokeLinecap='round'\n              strokeLinejoin='round'\n              strokeWidth='2'\n              d='M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'\n            ></path>\n          </svg>\n          <div className='flex flex-col gap-y-2'>\n            <h3 className='text-start text-sm font-medium sm:text-center'>{title}</h3>\n            <div className='text-start text-sm sm:text-center'>{message}</div>\n          </div>\n        </div>\n        <div className='buttons flex flex-wrap items-center justify-end gap-2 self-end sm:max-w-[20vw] sm:self-center'>\n          <button className='btn btn-sm btn-neutral' onClick={onCancel}>\n            {_('Cancel')}\n          </button>\n          <button\n            className={clsx('btn btn-sm btn-warning', { 'btn-disabled': isProcessing })}\n            onClick={() => {\n              setIsProcessing(true);\n              onConfirm();\n            }}\n          >\n            {_('Confirm')}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Alert;\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,QAKD,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE;IAC3C,MAAM,IAAI,IAAA,0KAAc;IACxB,MAAM,CAAC,cAAc,gBAAgB,GAAG,kXAAK,CAAC,QAAQ,CAAC;IACvD,MAAM,SAAS,IAAA,gLAAiB,EAAC;QAAE;QAAU;IAAU;IAEvD,qBACE,gZAAC;QAAI,WAAW,IAAA,iMAAI,EAAC;kBACnB,cAAA,gZAAC;YACC,KAAK;YACL,MAAK;YACL,WAAW,IAAA,iMAAI,EACb,2CACA,qDACA,uFACA;;8BAGF,gZAAC;oBAAI,WAAU;;sCACb,gZAAC;4BACC,OAAM;4BACN,MAAK;4BACL,SAAQ;4BACR,WAAU;sCAEV,cAAA,gZAAC;gCACC,eAAc;gCACd,gBAAe;gCACf,aAAY;gCACZ,GAAE;;;;;;;;;;;sCAGN,gZAAC;4BAAI,WAAU;;8CACb,gZAAC;oCAAG,WAAU;8CAAiD;;;;;;8CAC/D,gZAAC;oCAAI,WAAU;8CAAqC;;;;;;;;;;;;;;;;;;8BAGxD,gZAAC;oBAAI,WAAU;;sCACb,gZAAC;4BAAO,WAAU;4BAAyB,SAAS;sCACjD,EAAE;;;;;;sCAEL,gZAAC;4BACC,WAAW,IAAA,iMAAI,EAAC,0BAA0B;gCAAE,gBAAgB;4BAAa;4BACzE,SAAS;gCACP,gBAAgB;gCAChB;4BACF;sCAEC,EAAE;;;;;;;;;;;;;;;;;;;;;;;AAMf;uCAEe"}},
    {"offset": {"line": 1670, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/BookCover.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport Image from 'next/image';\nimport { memo, useEffect, useRef, useState } from 'react';\nimport { Book } from '@/types/book';\nimport { LibraryCoverFitType, LibraryViewModeType } from '@/types/settings';\nimport { formatAuthors, formatTitle } from '@/utils/book';\n\ninterface BookCoverProps {\n  book: Book;\n  mode?: LibraryViewModeType;\n  coverFit?: LibraryCoverFitType;\n  className?: string;\n  imageClassName?: string;\n  showSpine?: boolean;\n  isPreview?: boolean;\n  onImageError?: () => void;\n}\n\nconst BookCover: React.FC<BookCoverProps> = memo<BookCoverProps>(\n  ({\n    book,\n    mode = 'grid',\n    coverFit = 'crop',\n    showSpine = false,\n    className,\n    imageClassName,\n    isPreview,\n    onImageError,\n  }) => {\n    const coverRef = useRef<HTMLDivElement>(null);\n    const [imageLoaded, setImageLoaded] = useState(false);\n    const [imageError, setImageError] = useState(false);\n\n    const shouldShowSpine = showSpine && imageLoaded && !imageError;\n\n    const toggleImageVisibility = (showImage: boolean) => {\n      if (coverRef.current) {\n        const coverImage = coverRef.current.querySelector('.cover-image');\n        const fallbackCover = coverRef.current.querySelector('.fallback-cover');\n        if (coverImage) {\n          coverImage.classList.toggle('invisible', !showImage);\n        }\n        if (fallbackCover) {\n          fallbackCover.classList.toggle('invisible', showImage);\n        }\n      }\n    };\n\n    const handleImageLoad = () => {\n      setImageLoaded(true);\n      setImageError(false);\n      toggleImageVisibility(true);\n    };\n\n    const handleImageError = () => {\n      setImageLoaded(false);\n      setImageError(true);\n      toggleImageVisibility(false);\n      onImageError?.();\n    };\n\n    useEffect(() => {\n      toggleImageVisibility(true);\n    }, [book.metadata?.coverImageUrl, book.coverImageUrl]);\n\n    return (\n      <div\n        ref={coverRef}\n        className={clsx('book-cover-container relative flex h-full w-full', className)}\n      >\n        {coverFit === 'crop' ? (\n          <>\n            <Image\n              src={book.metadata?.coverImageUrl || book.coverImageUrl!}\n              alt={book.title}\n              fill={true}\n              className={clsx('cover-image crop-cover-img object-cover', imageClassName)}\n              onLoad={handleImageLoad}\n              onError={handleImageError}\n            />\n            <div\n              className={`book-spine absolute inset-0 ${shouldShowSpine ? 'visible' : 'invisible'}`}\n            />\n          </>\n        ) : (\n          <div className={clsx('flex h-full w-full justify-start')}>\n            <div\n              className={clsx(\n                'flex h-full max-h-full items-end',\n                mode === 'grid' ? 'items-end' : 'items-center',\n              )}\n            >\n              <Image\n                src={book.metadata?.coverImageUrl || book.coverImageUrl!}\n                alt={book.title}\n                width={0}\n                height={0}\n                sizes='100vw'\n                className={clsx(\n                  'cover-image fit-cover-img h-auto max-h-full w-auto max-w-full shadow-md',\n                  imageClassName,\n                )}\n                onLoad={handleImageLoad}\n                onError={handleImageError}\n              />\n              <div\n                className={`book-spine absolute inset-0 ${shouldShowSpine ? 'visible' : 'invisible'}`}\n              />\n            </div>\n          </div>\n        )}\n\n        <div\n          className={clsx(\n            'fallback-cover invisible absolute inset-0 p-2',\n            'text-neutral-content text-center font-serif font-medium',\n            isPreview ? 'bg-base-200/50' : 'bg-base-100',\n            imageClassName,\n          )}\n        >\n          <div className='flex h-1/2 items-center justify-center'>\n            <span\n              className={clsx(\n                isPreview ? 'line-clamp-2' : mode === 'grid' ? 'line-clamp-3' : 'line-clamp-2',\n                isPreview ? 'text-[0.5em]' : mode === 'grid' ? 'text-lg' : 'text-sm',\n              )}\n            >\n              {formatTitle(book.title)}\n            </span>\n          </div>\n          <div className='h-1/6'></div>\n          <div className='flex h-1/3 items-center justify-center'>\n            <span\n              className={clsx(\n                'text-neutral-content/50 line-clamp-1',\n                isPreview ? 'text-[0.4em]' : mode === 'grid' ? 'text-base' : 'text-xs',\n              )}\n            >\n              {formatAuthors(book.author)}\n            </span>\n          </div>\n        </div>\n      </div>\n    );\n  },\n  (prevProps, nextProps) => {\n    return (\n      prevProps.book.coverImageUrl === nextProps.book.coverImageUrl &&\n      prevProps.book.metadata?.coverImageUrl === nextProps.book.metadata?.coverImageUrl &&\n      prevProps.book.updatedAt === nextProps.book.updatedAt &&\n      prevProps.mode === nextProps.mode &&\n      prevProps.coverFit === nextProps.coverFit &&\n      prevProps.isPreview === nextProps.isPreview &&\n      prevProps.showSpine === nextProps.showSpine &&\n      prevProps.className === nextProps.className &&\n      prevProps.imageClassName === nextProps.imageClassName\n    );\n  },\n);\n\nBookCover.displayName = 'BookCover';\n\nexport default BookCover;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1843, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/MenuItem.tsx"],"sourcesContent":["import clsx from 'clsx';\nimport React from 'react';\nimport { IconType } from 'react-icons';\nimport { MdCheck } from 'react-icons/md';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\n\ninterface MenuItemProps {\n  label: string;\n  toggled?: boolean;\n  description?: string;\n  tooltip?: string;\n  buttonClass?: string;\n  labelClass?: string;\n  shortcut?: string;\n  disabled?: boolean;\n  noIcon?: boolean;\n  transient?: boolean;\n  Icon?: React.ReactNode | IconType;\n  iconClassName?: string;\n  children?: React.ReactNode;\n  siblings?: React.ReactNode;\n  onClick?: () => void;\n  setIsDropdownOpen?: (isOpen: boolean) => void;\n}\n\nconst MenuItem: React.FC<MenuItemProps> = ({\n  label,\n  toggled,\n  description,\n  tooltip,\n  buttonClass,\n  labelClass,\n  shortcut,\n  disabled,\n  noIcon = false,\n  transient = false,\n  Icon,\n  iconClassName,\n  children,\n  siblings,\n  onClick,\n  setIsDropdownOpen,\n}) => {\n  const _ = useTranslation();\n  const iconSize = useResponsiveSize(16);\n  const IconType = Icon || (toggled !== undefined ? (toggled ? MdCheck : undefined) : undefined);\n\n  const handleClick = () => {\n    onClick?.();\n    if (transient) {\n      setIsDropdownOpen?.(false);\n    }\n  };\n\n  const buttonContent = (\n    <>\n      <div className='flex w-full items-center justify-between'>\n        <div className='flex min-w-0 items-center'>\n          {!noIcon && (\n            <span style={{ minWidth: `${iconSize}px` }}>\n              {typeof IconType === 'function' ? (\n                <IconType\n                  className={clsx(disabled ? 'text-gray-400' : 'text-base-content', iconClassName)}\n                  size={iconSize}\n                />\n              ) : (\n                IconType\n              )}\n            </span>\n          )}\n          <span\n            className={clsx('mx-2 flex-1 truncate text-base sm:text-sm', labelClass)}\n            style={{ minWidth: 0 }}\n          >\n            {label}\n          </span>\n        </div>\n        {shortcut && (\n          <kbd\n            className={clsx(\n              'border-base-300/40 bg-base-300/75 hidden rounded-md border shadow-sm sm:flex',\n              'shrink-0 px-1.5 py-0.5 text-xs font-medium',\n              disabled ? 'text-gray-400' : 'text-neutral-content',\n            )}\n          >\n            {shortcut}\n          </kbd>\n        )}\n      </div>\n      <div className='flex w-full'>\n        {description && (\n          <span\n            className='mt-1 truncate text-start text-xs text-gray-500'\n            style={{ minWidth: 0, paddingInlineStart: noIcon ? '0' : `${iconSize + 8}px` }}\n          >\n            {description}\n          </span>\n        )}\n      </div>\n    </>\n  );\n\n  if (children) {\n    return (\n      // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n      <ul className='menu rounded-box m-0 p-0' role='menuitem' tabIndex={-1}>\n        <li aria-label={label}>\n          <details>\n            <summary\n              className={clsx(\n                'hover:bg-base-300 text-base-content cursor-pointer rounded-md p-1 py-[10px] pr-3',\n                disabled && 'btn-disabled cursor-not-allowed text-gray-400',\n                buttonClass,\n              )}\n              title={tooltip ? tooltip : ''}\n            >\n              {buttonContent}\n            </summary>\n            {children}\n          </details>\n        </li>\n      </ul>\n    );\n  }\n\n  return (\n    <div className='flex'>\n      <button\n        role={disabled ? 'none' : 'menuitem'}\n        aria-label={\n          toggled !== undefined ? `${label} - ${toggled ? _('ON') : _('OFF')}` : undefined\n        }\n        aria-live={toggled === undefined ? 'polite' : 'off'}\n        tabIndex={disabled ? -1 : 0}\n        className={clsx(\n          'hover:bg-base-300 text-base-content flex w-full flex-col items-center justify-center rounded-md p-1 py-[10px]',\n          disabled && 'btn-disabled text-gray-400',\n          buttonClass,\n        )}\n        title={tooltip ? tooltip : ''}\n        onClick={handleClick}\n        disabled={disabled}\n      >\n        {buttonContent}\n      </button>\n      {siblings}\n    </div>\n  );\n};\n\nexport default MenuItem;\n"],"names":[],"mappings":";;;;;AAAA;AAGA;AACA;AACA;;;;;;AAqBA,MAAM,WAAoC,CAAC,EACzC,KAAK,EACL,OAAO,EACP,WAAW,EACX,OAAO,EACP,WAAW,EACX,UAAU,EACV,QAAQ,EACR,QAAQ,EACR,SAAS,KAAK,EACd,YAAY,KAAK,EACjB,IAAI,EACJ,aAAa,EACb,QAAQ,EACR,QAAQ,EACR,OAAO,EACP,iBAAiB,EAClB;IACC,MAAM,IAAI,IAAA,0KAAc;IACxB,MAAM,WAAW,IAAA,gLAAiB,EAAC;IACnC,MAAM,WAAW,QAAQ,CAAC,YAAY,YAAa,UAAU,0OAAO,GAAG,YAAa,SAAS;IAE7F,MAAM,cAAc;QAClB;QACA,IAAI,WAAW;YACb,oBAAoB;QACtB;IACF;IAEA,MAAM,8BACJ;;0BACE,gZAAC;gBAAI,WAAU;;kCACb,gZAAC;wBAAI,WAAU;;4BACZ,CAAC,wBACA,gZAAC;gCAAK,OAAO;oCAAE,UAAU,GAAG,SAAS,EAAE,CAAC;gCAAC;0CACtC,OAAO,aAAa,2BACnB,gZAAC;oCACC,WAAW,IAAA,iMAAI,EAAC,WAAW,kBAAkB,qBAAqB;oCAClE,MAAM;;;;;+EAGR;;;;;;0CAIN,gZAAC;gCACC,WAAW,IAAA,iMAAI,EAAC,6CAA6C;gCAC7D,OAAO;oCAAE,UAAU;gCAAE;0CAEpB;;;;;;;;;;;;oBAGJ,0BACC,gZAAC;wBACC,WAAW,IAAA,iMAAI,EACb,gFACA,8CACA,WAAW,kBAAkB;kCAG9B;;;;;;;;;;;;0BAIP,gZAAC;gBAAI,WAAU;0BACZ,6BACC,gZAAC;oBACC,WAAU;oBACV,OAAO;wBAAE,UAAU;wBAAG,oBAAoB,SAAS,MAAM,GAAG,WAAW,EAAE,EAAE,CAAC;oBAAC;8BAE5E;;;;;;;;;;;;;IAOX,IAAI,UAAU;QACZ,OACE,kFAAkF;sBAClF,gZAAC;YAAG,WAAU;YAA2B,MAAK;YAAW,UAAU,CAAC;sBAClE,cAAA,gZAAC;gBAAG,cAAY;0BACd,cAAA,gZAAC;;sCACC,gZAAC;4BACC,WAAW,IAAA,iMAAI,EACb,oFACA,YAAY,iDACZ;4BAEF,OAAO,UAAU,UAAU;sCAE1B;;;;;;wBAEF;;;;;;;;;;;;;;;;;IAKX;IAEA,qBACE,gZAAC;QAAI,WAAU;;0BACb,gZAAC;gBACC,MAAM,WAAW,SAAS;gBAC1B,cACE,YAAY,YAAY,GAAG,MAAM,GAAG,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,GAAG;gBAEzE,aAAW,YAAY,YAAY,WAAW;gBAC9C,UAAU,WAAW,CAAC,IAAI;gBAC1B,WAAW,IAAA,iMAAI,EACb,iHACA,YAAY,8BACZ;gBAEF,OAAO,UAAU,UAAU;gBAC3B,SAAS;gBACT,UAAU;0BAET;;;;;;YAEF;;;;;;;AAGP;uCAEe"}},
    {"offset": {"line": 2012, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Dropdown.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useState, isValidElement, ReactElement, ReactNode, useRef } from 'react';\nimport { Overlay } from './Overlay';\nimport MenuItem from './MenuItem';\n\ninterface DropdownProps {\n  label: string;\n  className?: string;\n  menuClassName?: string;\n  buttonClassName?: string;\n  toggleButton: React.ReactNode;\n  children: ReactElement<{\n    setIsDropdownOpen: (isOpen: boolean) => void;\n    menuClassName?: string;\n    children: ReactNode;\n  }>;\n  disabled?: boolean;\n  onToggle?: (isOpen: boolean) => void;\n}\n\nconst enhanceMenuItems = (\n  children: ReactNode,\n  setIsDropdownOpen: (isOpen: boolean) => void,\n): ReactNode => {\n  const processNode = (node: ReactNode): ReactNode => {\n    if (!isValidElement(node)) {\n      return node;\n    }\n\n    const element = node as ReactElement;\n    const isMenuItem =\n      element.type === MenuItem ||\n      (typeof element.type === 'function' && element.type.name === 'MenuItem');\n\n    const clonedElement = isMenuItem\n      ? React.cloneElement(element, {\n          setIsDropdownOpen,\n          ...element.props,\n        })\n      : element;\n\n    if (clonedElement.props?.children) {\n      return React.cloneElement(clonedElement, {\n        ...clonedElement.props,\n        children: React.Children.map(clonedElement.props.children, processNode),\n      });\n    }\n\n    return clonedElement;\n  };\n\n  return React.Children.map(children, processNode);\n};\n\nconst Dropdown: React.FC<DropdownProps> = ({\n  label,\n  className,\n  menuClassName,\n  buttonClassName,\n  toggleButton,\n  children,\n  disabled,\n  onToggle,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isFocused, setIsFocused] = useState(false);\n  const lastInteractionWasTapOrClick = useRef(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const setIsDropdownOpen = (open: boolean) => {\n    if (disabled) return;\n    setIsOpen(open);\n    onToggle?.(open);\n  };\n\n  const handleTouchOrClick = () => {\n    lastInteractionWasTapOrClick.current = true;\n    setTimeout(() => (lastInteractionWasTapOrClick.current = false), 200);\n  };\n\n  const handleFocus = () => {\n    setIsFocused(true);\n    // skip touch and pointer triggered focus, this is only for keyboard and aria navigation\n    if (!lastInteractionWasTapOrClick.current) {\n      setIsDropdownOpen(true);\n    }\n  };\n\n  const toggleDropdown = () => {\n    setIsFocused(!isOpen);\n    setIsDropdownOpen(!isOpen);\n  };\n\n  const handleBlur = (e: React.FocusEvent) => {\n    if (process.env['NODE_ENV'] === 'development') {\n      return;\n    }\n    if (!containerRef.current) return;\n    if (!containerRef.current.contains(e.relatedTarget as Node)) {\n      setIsFocused(false);\n      setIsDropdownOpen(false);\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      if (!isOpen) setIsDropdownOpen(true);\n      e.stopPropagation();\n    } else if (e.key === 'Escape') {\n      setIsDropdownOpen(false);\n      e.stopPropagation();\n    }\n  };\n\n  const childrenWithToggle = isValidElement(children)\n    ? React.cloneElement(children, {\n        ...(typeof children.type !== 'string' && {\n          setIsDropdownOpen,\n          menuClassName,\n        }),\n        children: enhanceMenuItems(children.props?.children, setIsDropdownOpen),\n      })\n    : children;\n\n  return (\n    <div className='dropdown-container flex'>\n      {isOpen && <Overlay onDismiss={() => setIsDropdownOpen(false)} />}\n      <div\n        ref={containerRef}\n        role='menu'\n        tabIndex={-1}\n        onBlur={handleBlur}\n        onKeyDown={handleKeyDown}\n        className={clsx('dropdown flex flex-col', className)}\n      >\n        <button\n          aria-haspopup='menu'\n          aria-expanded={isOpen}\n          aria-label={label}\n          title={label}\n          className={clsx(\n            'dropdown-toggle touch-target',\n            isFocused && isOpen && 'bg-base-300/50',\n            buttonClassName,\n          )}\n          onTouchStart={handleTouchOrClick}\n          onPointerDown={handleTouchOrClick}\n          onFocus={handleFocus}\n          onClick={toggleDropdown}\n        >\n          {toggleButton}\n        </button>\n        <div role='none' className={clsx('flex items-center justify-center')}>\n          {isOpen && childrenWithToggle}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Dropdown;\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAsBA,MAAM,mBAAmB,CACvB,UACA;IAEA,MAAM,cAAc,CAAC;QACnB,IAAI,eAAC,IAAA,yXAAc,EAAC,OAAO;YACzB,OAAO;QACT;QAEA,MAAM,UAAU;QAChB,MAAM,aACJ,QAAQ,IAAI,KAAK,mKAAQ,IACxB,OAAO,QAAQ,IAAI,KAAK,cAAc,QAAQ,IAAI,CAAC,IAAI,KAAK;QAE/D,MAAM,gBAAgB,2BAClB,kXAAK,CAAC,YAAY,CAAC,SAAS;YAC1B;YACA,GAAG,QAAQ,KAAK;QAClB,KACA;QAEJ,IAAI,cAAc,KAAK,EAAE,UAAU;YACjC,qBAAO,kXAAK,CAAC,YAAY,CAAC,eAAe;gBACvC,GAAG,cAAc,KAAK;gBACtB,UAAU,kXAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,cAAc,KAAK,CAAC,QAAQ,EAAE;YAC7D;QACF;QAEA,OAAO;IACT;IAEA,OAAO,kXAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU;AACtC;AAEA,MAAM,WAAoC,CAAC,EACzC,KAAK,EACL,SAAS,EACT,aAAa,EACb,eAAe,EACf,YAAY,EACZ,QAAQ,EACR,QAAQ,EACR,QAAQ,EACT;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,mXAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,mXAAQ,EAAC;IAC3C,MAAM,+BAA+B,IAAA,iXAAM,EAAC;IAC5C,MAAM,eAAe,IAAA,iXAAM,EAAiB;IAE5C,MAAM,oBAAoB,CAAC;QACzB,IAAI,UAAU;QACd,UAAU;QACV,WAAW;IACb;IAEA,MAAM,qBAAqB;QACzB,6BAA6B,OAAO,GAAG;QACvC,WAAW,IAAO,6BAA6B,OAAO,GAAG,OAAQ;IACnE;IAEA,MAAM,cAAc;QAClB,aAAa;QACb,wFAAwF;QACxF,IAAI,CAAC,6BAA6B,OAAO,EAAE;YACzC,kBAAkB;QACpB;IACF;IAEA,MAAM,iBAAiB;QACrB,aAAa,CAAC;QACd,kBAAkB,CAAC;IACrB;IAEA,MAAM,aAAa,CAAC;QAClB,wCAA+C;YAC7C;QACF;;;IAMF;IAEA,MAAM,gBAAgB,CAAC;QACrB,IAAI,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK;YACtC,IAAI,CAAC,QAAQ,kBAAkB;YAC/B,EAAE,eAAe;QACnB,OAAO,IAAI,EAAE,GAAG,KAAK,UAAU;YAC7B,kBAAkB;YAClB,EAAE,eAAe;QACnB;IACF;IAEA,MAAM,mCAAqB,IAAA,yXAAc,EAAC,0BACtC,kXAAK,CAAC,YAAY,CAAC,UAAU;QAC3B,GAAI,OAAO,SAAS,IAAI,KAAK,YAAY;YACvC;YACA;QACF,CAAC;QACD,UAAU,iBAAiB,SAAS,KAAK,EAAE,UAAU;IACvD,KACA;IAEJ,qBACE,gZAAC;QAAI,WAAU;;YACZ,wBAAU,gZAAC,kKAAO;gBAAC,WAAW,IAAM,kBAAkB;;;;;;0BACvD,gZAAC;gBACC,KAAK;gBACL,MAAK;gBACL,UAAU,CAAC;gBACX,QAAQ;gBACR,WAAW;gBACX,WAAW,IAAA,iMAAI,EAAC,0BAA0B;;kCAE1C,gZAAC;wBACC,iBAAc;wBACd,iBAAe;wBACf,cAAY;wBACZ,OAAO;wBACP,WAAW,IAAA,iMAAI,EACb,gCACA,aAAa,UAAU,kBACvB;wBAEF,cAAc;wBACd,eAAe;wBACf,SAAS;wBACT,SAAS;kCAER;;;;;;kCAEH,gZAAC;wBAAI,MAAK;wBAAO,WAAW,IAAA,iMAAI,EAAC;kCAC9B,UAAU;;;;;;;;;;;;;;;;;;AAKrB;uCAEe"}},
    {"offset": {"line": 2157, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Spinner.tsx"],"sourcesContent":["import clsx from 'clsx';\nimport React from 'react';\nimport { useThemeStore } from '@/store/themeStore';\nimport { useTranslation } from '@/hooks/useTranslation';\n\nconst Spinner: React.FC<{\n  loading: boolean;\n  className?: string;\n}> = ({ loading, className }) => {\n  const _ = useTranslation();\n  const { safeAreaInsets } = useThemeStore();\n  if (!loading) return null;\n\n  return (\n    <div\n      className={clsx('absolute left-1/2 top-4 -translate-x-1/2 transform text-center')}\n      style={{\n        paddingTop: `${(safeAreaInsets?.top || 0) + 64}px`,\n      }}\n      role='status'\n    >\n      <span\n        className={clsx('loading loading-lg not-eink:loading-dots eink:loading-spinner', className)}\n      ></span>\n      <span className='sr-only'>{_('Loading...')}</span>\n    </div>\n  );\n};\n\nexport default Spinner;\n"],"names":[],"mappings":";;;;;AAAA;AAEA;AACA;;;;;AAEA,MAAM,UAGD,CAAC,EAAE,OAAO,EAAE,SAAS,EAAE;IAC1B,MAAM,IAAI,IAAA,0KAAc;IACxB,MAAM,EAAE,cAAc,EAAE,GAAG,IAAA,qKAAa;IACxC,IAAI,CAAC,SAAS,OAAO;IAErB,qBACE,gZAAC;QACC,WAAW,IAAA,iMAAI,EAAC;QAChB,OAAO;YACL,YAAY,GAAG,CAAC,gBAAgB,OAAO,CAAC,IAAI,GAAG,EAAE,CAAC;QACpD;QACA,MAAK;;0BAEL,gZAAC;gBACC,WAAW,IAAA,iMAAI,EAAC,iEAAiE;;;;;;0BAEnF,gZAAC;gBAAK,WAAU;0BAAW,EAAE;;;;;;;;;;;;AAGnC;uCAEe"}},
    {"offset": {"line": 2207, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/ModalPortal.tsx"],"sourcesContent":["import clsx from 'clsx';\nimport React, { ReactNode } from 'react';\nimport ReactDOM from 'react-dom';\n\ninterface ModalPortalProps {\n  children: ReactNode;\n  showOverlay?: boolean;\n}\n\nconst ModalPortal: React.FC<ModalPortalProps> = ({ children, showOverlay = true }) => {\n  return ReactDOM.createPortal(\n    <div\n      className={clsx(\n        'fixed inset-0 isolate z-[100] flex items-center justify-center',\n        showOverlay && 'bg-black bg-opacity-50',\n      )}\n      style={{ transform: 'translateZ(0)' }}\n    >\n      {children}\n    </div>,\n    document.body,\n  );\n};\n\nexport default ModalPortal;\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAOA,MAAM,cAA0C,CAAC,EAAE,QAAQ,EAAE,cAAc,IAAI,EAAE;IAC/E,qBAAO,yXAAQ,CAAC,YAAY,eAC1B,gZAAC;QACC,WAAW,IAAA,iMAAI,EACb,kEACA,eAAe;QAEjB,OAAO;YAAE,WAAW;QAAgB;kBAEnC;;;;;kDAEH,SAAS,IAAI;AAEjB;uCAEe"}},
    {"offset": {"line": 2235, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Toast.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useThemeStore } from '@/store/themeStore';\nimport { eventDispatcher } from '@/utils/event';\n\nexport type ToastType = 'info' | 'success' | 'warning' | 'error';\n\nexport const Toast = () => {\n  const { safeAreaInsets } = useThemeStore();\n  const [toastMessage, setToastMessage] = useState('');\n  const [toastType, setToastType] = useState<ToastType>('info');\n  const [toastTimeout, setToastTimeout] = useState(5000);\n  const [messageClass, setMessageClass] = useState('');\n  const [isVisible, setIsVisible] = useState(false);\n  const toastDismissTimeout = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const toastClassMap = {\n    info: 'toast-info toast-center toast-middle',\n    success: 'toast-success toast-top sm:toast-end toast-center',\n    warning: 'toast-warning toast-top sm:toast-end toast-center',\n    error: 'toast-error toast-top sm:toast-end toast-center',\n  };\n\n  const alertClassMap = {\n    info: 'alert-primary border-base-300',\n    success: 'alert-success not-eink:from-green-500 not-eink:to-emerald-500',\n    warning: 'alert-warning not-eink:from-amber-500 not-eink:to-orange-500',\n    error: 'alert-error not-eink:from-red-500 not-eink:to-rose-500',\n  };\n\n  const iconMap = {\n    info: (\n      <svg className='h-5 w-5' fill='currentColor' viewBox='0 0 20 20'>\n        <path\n          fillRule='evenodd'\n          d='M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z'\n          clipRule='evenodd'\n        />\n      </svg>\n    ),\n    success: (\n      <svg className='h-5 w-5' fill='currentColor' viewBox='0 0 20 20'>\n        <path\n          fillRule='evenodd'\n          d='M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z'\n          clipRule='evenodd'\n        />\n      </svg>\n    ),\n    warning: (\n      <svg className='h-5 w-5' fill='currentColor' viewBox='0 0 20 20'>\n        <path\n          fillRule='evenodd'\n          d='M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z'\n          clipRule='evenodd'\n        />\n      </svg>\n    ),\n    error: (\n      <svg className='h-5 w-5' fill='currentColor' viewBox='0 0 20 20'>\n        <path\n          fillRule='evenodd'\n          d='M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z'\n          clipRule='evenodd'\n        />\n      </svg>\n    ),\n  };\n\n  useEffect(() => {\n    if (toastMessage) {\n      setTimeout(() => {\n        setIsVisible(true);\n      }, 0);\n    }\n  }, [toastMessage]);\n\n  useEffect(() => {\n    if (toastDismissTimeout.current) clearTimeout(toastDismissTimeout.current);\n    if (toastMessage) {\n      const timeout = setTimeout(() => {\n        setIsVisible(false);\n        setTimeout(() => setToastMessage(''), 300);\n      }, toastTimeout);\n      toastDismissTimeout.current = timeout;\n      return () => {\n        if (timeout) clearTimeout(timeout);\n      };\n    }\n    return;\n  }, [toastMessage, toastTimeout]);\n\n  const handleShowToast = async (event: CustomEvent) => {\n    const { message, type = 'info', timeout, className = '', callback = null } = event.detail;\n    setToastMessage(message);\n    setToastType(type);\n    if (timeout) setToastTimeout(timeout);\n    if (callback && typeof callback === 'function') {\n      setTimeout(() => callback(), timeout || 5000);\n    }\n    setMessageClass(className);\n  };\n\n  useEffect(() => {\n    eventDispatcher.on('toast', handleShowToast);\n    return () => {\n      eventDispatcher.off('toast', handleShowToast);\n    };\n  }, []);\n\n  const handleDismiss = () => {\n    setIsVisible(false);\n    setTimeout(() => setToastMessage(''), 300);\n    if (toastDismissTimeout.current) clearTimeout(toastDismissTimeout.current);\n  };\n\n  return (\n    toastMessage && (\n      <div\n        className={clsx(\n          'toast z-50 w-auto max-w-screen-sm transition-all duration-300',\n          toastClassMap[toastType],\n          isVisible ? 'scale-100 opacity-100' : 'scale-95 opacity-0',\n        )}\n        style={{\n          top: toastClassMap[toastType].includes('toast-top')\n            ? `${(safeAreaInsets?.top || 0) + 44}px`\n            : undefined,\n        }}\n      >\n        <div\n          className={clsx(\n            'alert flex items-center gap-3 shadow-2xl backdrop-blur-sm',\n            'min-h-0 rounded-2xl px-5 py-4',\n            'not-eink:bg-gradient-to-r border-0',\n            alertClassMap[toastType],\n            'eink:bg-base-100 eink:border eink:border-base-content',\n            toastType !== 'info' && 'text-white',\n          )}\n        >\n          {/* Icon */}\n          <div className='flex-shrink-0'>{iconMap[toastType]}</div>\n\n          {/* Message */}\n          <span\n            className={clsx(\n              'max-h-[50vh] flex-1 overflow-y-auto',\n              'font-sans text-base font-medium leading-snug sm:text-sm',\n              toastType === 'info'\n                ? 'max-w-[60vw] truncate sm:max-w-[80vw]'\n                : 'min-w-[60vw] max-w-[80vw] whitespace-normal break-words sm:min-w-40 sm:max-w-80',\n              messageClass,\n            )}\n          >\n            {toastMessage.split('\\n').map((line, idx) => (\n              <React.Fragment key={idx}>\n                {line || <>&nbsp;</>}\n                {idx < toastMessage.split('\\n').length - 1 && <br />}\n              </React.Fragment>\n            ))}\n          </span>\n\n          {/* Close button */}\n          <button\n            onClick={handleDismiss}\n            className={clsx(\n              'flex-shrink-0 rounded-lg p-1 transition-colors',\n              toastType === 'info' ? 'hover:bg-base-300' : 'hover:bg-white/20 active:bg-white/30',\n            )}\n            aria-label='Dismiss'\n          >\n            <svg className='h-4 w-4' fill='currentColor' viewBox='0 0 20 20'>\n              <path\n                fillRule='evenodd'\n                d='M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z'\n                clipRule='evenodd'\n              />\n            </svg>\n          </button>\n        </div>\n      </div>\n    )\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2473, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/DropIndicator.tsx"],"sourcesContent":["import React from 'react';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { HiArrowDownTray } from 'react-icons/hi2';\n\nconst DropIndicator: React.FC = () => {\n  const _ = useTranslation();\n  return (\n    <>\n      <div className='drag-overlay'></div>\n      <div className='drop-indicator'>\n        <div className='flex flex-col items-center justify-center'>\n          <HiArrowDownTray className='h-12 w-12' />\n          <p className='mt-2 font-medium'>{_('Drop to Import Books')}</p>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default DropIndicator;\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAEA,MAAM,gBAA0B;IAC9B,MAAM,IAAI,IAAA,0KAAc;IACxB,qBACE;;0BACE,gZAAC;gBAAI,WAAU;;;;;;0BACf,gZAAC;gBAAI,WAAU;0BACb,cAAA,gZAAC;oBAAI,WAAU;;sCACb,gZAAC,mPAAe;4BAAC,WAAU;;;;;;sCAC3B,gZAAC;4BAAE,WAAU;sCAAoB,EAAE;;;;;;;;;;;;;;;;;;;AAK7C;uCAEe"}},
    {"offset": {"line": 2533, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/Select.tsx"],"sourcesContent":["import clsx from 'clsx';\nimport React from 'react';\n\ntype Option = {\n  value: string;\n  label: string;\n};\n\ntype SelectProps = {\n  value: string;\n  onChange: (e: React.ChangeEvent<HTMLSelectElement>) => void;\n  options: Option[];\n  disabled?: boolean;\n  className?: string;\n};\n\nexport default function Select({\n  value,\n  onChange,\n  options,\n  className,\n  disabled = false,\n}: SelectProps) {\n  return (\n    <select\n      value={value}\n      onChange={onChange}\n      onKeyDown={(e) => e.stopPropagation()}\n      className={clsx(\n        'select bg-base-200 h-8 min-h-8 max-w-[60%] truncate rounded-md border-none text-sm',\n        className,\n      )}\n      disabled={disabled}\n      style={{\n        textAlignLast: 'end',\n      }}\n    >\n      {options.map(({ value, label }) => (\n        <option key={value} value={value}>\n          {label}\n        </option>\n      ))}\n    </select>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;;AAgBe,SAAS,OAAO,EAC7B,KAAK,EACL,QAAQ,EACR,OAAO,EACP,SAAS,EACT,WAAW,KAAK,EACJ;IACZ,qBACE,gZAAC;QACC,OAAO;QACP,UAAU;QACV,WAAW,CAAC,IAAM,EAAE,eAAe;QACnC,WAAW,IAAA,iMAAI,EACb,sFACA;QAEF,UAAU;QACV,OAAO;YACL,eAAe;QACjB;kBAEC,QAAQ,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,iBAC5B,gZAAC;gBAAmB,OAAO;0BACxB;eADU;;;;;;;;;;AAMrB"}}]
}