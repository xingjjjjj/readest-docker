{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/NumberInput.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useEffect, useState } from 'react';\nimport { FiMinus, FiPlus } from 'react-icons/fi';\nimport { useTranslation } from '@/hooks/useTranslation';\n\ninterface NumberInputProps {\n  className?: string;\n  inputClassName?: string;\n  label: string;\n  iconSize?: number;\n  value: number;\n  min: number;\n  max: number;\n  step?: number;\n  disabled?: boolean;\n  onChange: (value: number) => void;\n}\n\nconst NumberInput: React.FC<NumberInputProps> = ({\n  className,\n  inputClassName,\n  label,\n  iconSize,\n  value,\n  onChange,\n  min,\n  max,\n  step,\n  disabled,\n}) => {\n  const _ = useTranslation();\n  const [localValue, setLocalValue] = useState(value);\n  const numberStep = step || 1;\n\n  useEffect(() => {\n    setLocalValue(value);\n  }, [value]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n\n    // Allow empty string or valid numbers without leading zeros\n    if (value === '' || /^[1-9]\\d*\\.?\\d*$|^0?\\.?\\d*$/.test(value)) {\n      const newValue = value === '' ? 0 : parseFloat(value);\n      setLocalValue(newValue);\n\n      if (!isNaN(newValue)) {\n        const roundedValue = Math.round(newValue * 10) / 10;\n        onChange(Math.max(min, Math.min(max, roundedValue)));\n      }\n    }\n  };\n\n  const increment = () => {\n    const newValue = Math.min(max, localValue + numberStep);\n    const roundedValue = Math.round(newValue * 10) / 10;\n    setLocalValue(roundedValue);\n    onChange(roundedValue);\n  };\n\n  const decrement = () => {\n    const newValue = Math.max(min, localValue - numberStep);\n    const roundedValue = Math.round(newValue * 10) / 10;\n    setLocalValue(roundedValue);\n    onChange(roundedValue);\n  };\n\n  const handleOnBlur = () => {\n    const newValue = Math.max(min, Math.min(max, localValue));\n    setLocalValue(newValue);\n    onChange(newValue);\n  };\n\n  return (\n    <div className={clsx('config-item', className)}>\n      <span className='text-base-content line-clamp-2'>{label}</span>\n      {iconSize && <span style={{ minWidth: `${iconSize}px` }} />}\n      <div className='text-base-content flex items-center gap-2'>\n        <input\n          type='text'\n          inputMode='decimal'\n          disabled={disabled}\n          value={localValue}\n          onChange={handleChange}\n          onBlur={handleOnBlur}\n          className={clsx(\n            'input input-ghost settings-content text-base-content w-16 max-w-xs rounded border-0 bg-transparent pe-3 !outline-none',\n            label && 'py-1 ps-1 text-right',\n            disabled && 'input-disabled cursor-not-allowed disabled:bg-transparent',\n            inputClassName,\n          )}\n          onFocus={(e) => e.target.select()}\n        />\n        <button\n          tabIndex={disabled ? -1 : 0}\n          aria-label={_('Decrease')}\n          onClick={decrement}\n          className={`btn btn-circle btn-sm ${value <= min || disabled ? 'btn-disabled !bg-opacity-5' : ''}`}\n        >\n          <FiMinus className='h-4 w-4' />\n        </button>\n        <button\n          tabIndex={disabled ? -1 : 0}\n          aria-label={_('Increase')}\n          onClick={increment}\n          className={`btn btn-circle btn-sm ${value >= max || disabled ? 'btn-disabled !bg-opacity-5' : ''}`}\n        >\n          <FiPlus className='h-4 w-4' />\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default NumberInput;\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAoBA,MAAM,cAA0C,CAAC,EAC/C,SAAS,EACT,cAAc,EACd,KAAK,EACL,QAAQ,EACR,KAAK,EACL,QAAQ,EACR,GAAG,EACH,GAAG,EACH,IAAI,EACJ,QAAQ,EACT;;IACC,MAAM,IAAI,IAAA,6KAAc;IACxB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,2UAAQ,EAAC;IAC7C,MAAM,aAAa,QAAQ;IAE3B,IAAA,4UAAS;iCAAC;YACR,cAAc;QAChB;gCAAG;QAAC;KAAM;IAEV,MAAM,eAAe,CAAC;QACpB,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;QAE5B,4DAA4D;QAC5D,IAAI,UAAU,MAAM,8BAA8B,IAAI,CAAC,QAAQ;YAC7D,MAAM,WAAW,UAAU,KAAK,IAAI,WAAW;YAC/C,cAAc;YAEd,IAAI,CAAC,MAAM,WAAW;gBACpB,MAAM,eAAe,KAAK,KAAK,CAAC,WAAW,MAAM;gBACjD,SAAS,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,KAAK;YACvC;QACF;IACF;IAEA,MAAM,YAAY;QAChB,MAAM,WAAW,KAAK,GAAG,CAAC,KAAK,aAAa;QAC5C,MAAM,eAAe,KAAK,KAAK,CAAC,WAAW,MAAM;QACjD,cAAc;QACd,SAAS;IACX;IAEA,MAAM,YAAY;QAChB,MAAM,WAAW,KAAK,GAAG,CAAC,KAAK,aAAa;QAC5C,MAAM,eAAe,KAAK,KAAK,CAAC,WAAW,MAAM;QACjD,cAAc;QACd,SAAS;IACX;IAEA,MAAM,eAAe;QACnB,MAAM,WAAW,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,KAAK;QAC7C,cAAc;QACd,SAAS;IACX;IAEA,qBACE,+VAAC;QAAI,WAAW,IAAA,oMAAI,EAAC,eAAe;;0BAClC,+VAAC;gBAAK,WAAU;0BAAkC;;;;;;YACjD,0BAAY,+VAAC;gBAAK,OAAO;oBAAE,UAAU,GAAG,SAAS,EAAE,CAAC;gBAAC;;;;;;0BACtD,+VAAC;gBAAI,WAAU;;kCACb,+VAAC;wBACC,MAAK;wBACL,WAAU;wBACV,UAAU;wBACV,OAAO;wBACP,UAAU;wBACV,QAAQ;wBACR,WAAW,IAAA,oMAAI,EACb,yHACA,SAAS,wBACT,YAAY,6DACZ;wBAEF,SAAS,CAAC,IAAM,EAAE,MAAM,CAAC,MAAM;;;;;;kCAEjC,+VAAC;wBACC,UAAU,WAAW,CAAC,IAAI;wBAC1B,cAAY,EAAE;wBACd,SAAS;wBACT,WAAW,CAAC,sBAAsB,EAAE,SAAS,OAAO,WAAW,+BAA+B,IAAI;kCAElG,cAAA,+VAAC,6OAAO;4BAAC,WAAU;;;;;;;;;;;kCAErB,+VAAC;wBACC,UAAU,WAAW,CAAC,IAAI;wBAC1B,cAAY,EAAE;wBACd,SAAS;wBACT,WAAW,CAAC,sBAAsB,EAAE,SAAS,OAAO,WAAW,+BAA+B,IAAI;kCAElG,cAAA,+VAAC,4OAAM;4BAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK5B;GA9FM;;QAYM,6KAAc;;;KAZpB;uCAgGS"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/FontDropDown.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useMemo } from 'react';\nimport { FixedSizeList as List } from 'react-window';\nimport { FiChevronUp, FiChevronLeft } from 'react-icons/fi';\nimport { MdCheck } from 'react-icons/md';\nimport { useEnv } from '@/context/EnvContext';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\n\ninterface DropdownProps {\n  family?: string;\n  selected: string;\n  options: { option: string; label?: string }[];\n  moreOptions?: { option: string; label?: string }[];\n  onSelect: (option: string) => void;\n  onGetFontFamily: (option: string, family: string) => string;\n}\n\ninterface FontItemProps {\n  index: number;\n  style: React.CSSProperties;\n  data: {\n    options: { option: string; label?: string }[];\n    selected: string;\n    onSelect: (option: string) => void;\n    onGetFontFamily: (option: string, family: string) => string;\n    family: string;\n    iconSize: number;\n  };\n}\n\nconst FontItem: React.FC<FontItemProps> = ({ index, style, data }) => {\n  const { options, selected, onSelect, onGetFontFamily, family, iconSize: iconSize16 } = data;\n  const option = options[index]!;\n\n  return (\n    <li\n      role='option'\n      aria-selected={selected === option.option}\n      className='px-2'\n      key={option.option}\n      style={style}\n    >\n      <div\n        role='button'\n        tabIndex={0}\n        onClick={() => onSelect(option.option)}\n        onKeyDown={(e) => {\n          if (e.key === 'Enter' || e.key === ' ') {\n            onSelect(option.option);\n          }\n        }}\n        aria-label={option.label || option.option}\n        className='flex w-full items-center overflow-hidden !px-0 text-sm'\n      >\n        <span style={{ minWidth: `${iconSize16}px` }}>\n          {selected === option.option && (\n            <MdCheck className='text-base-content' size={iconSize16} />\n          )}\n        </span>\n        <span\n          className='line-clamp-1 overflow-visible break-all leading-loose'\n          style={{ fontFamily: onGetFontFamily(option.option, family) }}\n          title={option.label || option.option}\n        >\n          {option.label || option.option}\n        </span>\n      </div>\n    </li>\n  );\n};\n\nconst FontDropdown: React.FC<DropdownProps> = ({\n  family,\n  selected,\n  options,\n  moreOptions,\n  onSelect,\n  onGetFontFamily,\n}) => {\n  const _ = useTranslation();\n  const { appService } = useEnv();\n  const iconSize = useResponsiveSize(16);\n  const allOptions = [...options, ...(moreOptions ?? [])];\n  const selectedOption = allOptions.find((option) => option.option === selected) ?? allOptions[0]!;\n\n  const ITEM_HEIGHT = 40;\n  const MAX_HEIGHT = 320;\n\n  const mainListData = useMemo(\n    () => ({\n      options,\n      selected,\n      onSelect,\n      onGetFontFamily,\n      family: family ?? '',\n      iconSize,\n      appService,\n    }),\n    [options, selected, onSelect, onGetFontFamily, family, iconSize, appService],\n  );\n\n  const moreListData = useMemo(\n    () => ({\n      options: moreOptions ?? [],\n      selected,\n      onSelect,\n      onGetFontFamily,\n      family: family ?? '',\n      iconSize,\n    }),\n    [moreOptions, selected, onSelect, onGetFontFamily, family, iconSize],\n  );\n\n  return (\n    <div className='dropdown dropdown-top'>\n      <button\n        tabIndex={0}\n        className='btn btn-sm flex items-center px-[10px] font-normal normal-case sm:px-[20px]'\n        onClick={(e) => e.currentTarget.focus()}\n      >\n        <div className='flex items-center gap-x-1'>\n          <span\n            className='line-clamp-1 break-all leading-loose'\n            style={{\n              fontFamily: onGetFontFamily(selectedOption.option, family ?? ''),\n            }}\n          >\n            {selectedOption.label}\n          </span>\n          <FiChevronUp size={iconSize} />\n        </div>\n      </button>\n      <ul\n        role='listbox'\n        tabIndex={0}\n        className={clsx(\n          'dropdown-content bgcolor-base-200 no-triangle menu rounded-box absolute z-[1] mt-4 shadow',\n          'right-[-32px] w-[46vw] !px-0 sm:right-0 sm:w-44',\n          moreOptions?.length ? '' : 'inline overflow-hidden',\n        )}\n      >\n        {/* Virtualized main options */}\n        <div style={{ height: Math.min(options.length * ITEM_HEIGHT, MAX_HEIGHT) }}>\n          <List\n            width='100%'\n            height={Math.min(options.length * ITEM_HEIGHT, MAX_HEIGHT)}\n            itemCount={options.length}\n            itemSize={ITEM_HEIGHT}\n            itemData={mainListData}\n          >\n            {FontItem}\n          </List>\n        </div>\n\n        {/* More options with nested dropdown */}\n        {moreOptions && moreOptions.length > 0 && (\n          <li className='dropdown dropdown-left dropdown-top px-2'>\n            <div className='flex items-center px-0 text-sm'>\n              <span style={{ minWidth: `${iconSize}px` }}>\n                <FiChevronLeft size={iconSize} />\n              </span>\n              <span>{_('System Fonts')}</span>\n            </div>\n            <ul\n              role='listbox'\n              tabIndex={0}\n              className={clsx(\n                'dropdown-content bgcolor-base-200 menu rounded-box relative z-[1] shadow',\n                '!mr-4 mb-[-46px] inline w-[46vw] overflow-hidden !px-0 sm:w-[200px]',\n              )}\n            >\n              {/* Virtualized more options */}\n              <div style={{ height: Math.min(moreOptions.length * ITEM_HEIGHT, MAX_HEIGHT) }}>\n                <List\n                  width='100%'\n                  height={Math.min(moreOptions.length * ITEM_HEIGHT, MAX_HEIGHT)}\n                  itemCount={moreOptions.length}\n                  itemSize={ITEM_HEIGHT}\n                  itemData={moreListData}\n                >\n                  {FontItem}\n                </List>\n              </div>\n            </ul>\n          </li>\n        )}\n      </ul>\n    </div>\n  );\n};\n\nexport default FontDropdown;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 463, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/CustomFonts.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useState } from 'react';\nimport { MdAdd, MdDelete } from 'react-icons/md';\nimport { IoMdCloseCircleOutline } from 'react-icons/io';\nimport { useEnv } from '@/context/EnvContext';\nimport { useReaderStore } from '@/store/readerStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useCustomFontStore } from '@/store/customFontStore';\nimport { useFileSelector } from '@/hooks/useFileSelector';\nimport { saveViewSettings } from '@/helpers/settings';\nimport { CustomFont, mountCustomFont } from '@/styles/fonts';\n\ninterface CustomFontsProps {\n  bookKey: string;\n  onBack: () => void;\n}\n\ntype FontFamily = {\n  name: string;\n  fonts: CustomFont[];\n};\n\nconst CustomFonts: React.FC<CustomFontsProps> = ({ bookKey, onBack }) => {\n  const _ = useTranslation();\n  const { appService, envConfig } = useEnv();\n  const { settings } = useSettingsStore();\n  const {\n    fonts: customFonts,\n    addFont,\n    loadFont,\n    removeFont,\n    getAvailableFonts,\n    saveCustomFonts,\n  } = useCustomFontStore();\n  const { getViewSettings } = useReaderStore();\n  const viewSettings = getViewSettings(bookKey) || settings.globalViewSettings;\n  const [isDeleteMode, setIsDeleteMode] = useState(false);\n\n  const { selectFiles } = useFileSelector(appService, _);\n\n  const currentDefaultFont =\n    viewSettings.defaultFont.toLowerCase() === 'serif' ? 'serif' : 'sans-serif';\n\n  const currentFontFamily =\n    currentDefaultFont === 'serif' ? viewSettings.serifFont : viewSettings.sansSerifFont;\n\n  const handleImportFont = () => {\n    selectFiles({ type: 'fonts', multiple: true }).then(async (result) => {\n      if (result.error || result.files.length === 0) return;\n      for (const selectedFile of result.files) {\n        const fontInfo = await appService?.importFont(selectedFile.path || selectedFile.file);\n        if (!fontInfo) continue;\n\n        const customFont = addFont(fontInfo.path, {\n          name: fontInfo.name,\n          family: fontInfo.family,\n          style: fontInfo.style,\n          weight: fontInfo.weight,\n          variable: fontInfo.variable,\n        });\n        console.log('Added custom font:', customFont);\n        if (customFont && !customFont.error) {\n          const loadedFont = await loadFont(envConfig, customFont.id);\n          mountCustomFont(document, loadedFont);\n        }\n      }\n      saveCustomFonts(envConfig);\n    });\n  };\n\n  const handleDeleteFamily = (family: FontFamily) => {\n    for (const font of family.fonts) {\n      if (font) {\n        if (removeFont(font.id)) {\n          appService?.deleteFont(font);\n          saveCustomFonts(envConfig);\n          if (getAvailableFonts().length === 0) {\n            setIsDeleteMode(false);\n          }\n        }\n      }\n    }\n  };\n\n  const handleSelectFamily = (family: FontFamily) => {\n    if (currentDefaultFont === 'serif') {\n      saveViewSettings(envConfig, bookKey, 'serifFont', family.name);\n    } else {\n      saveViewSettings(envConfig, bookKey, 'sansSerifFont', family.name);\n    }\n  };\n\n  const toggleDeleteMode = () => {\n    setIsDeleteMode(!isDeleteMode);\n  };\n\n  const getAvailableFamilies = (fonts: CustomFont[]): FontFamily[] => {\n    const familyMap = new Map<string, string[]>();\n\n    for (const font of fonts) {\n      const family = font.family || font.name;\n      if (!familyMap.has(family)) {\n        familyMap.set(family, []);\n      }\n      familyMap.get(family)!.push(font.id);\n    }\n\n    return Array.from(familyMap.entries()).map(([family, ids]) => ({\n      name: family,\n      fonts: ids.map((id) => fonts.find((f) => f.id === id)!).filter((f): f is CustomFont => !!f),\n    }));\n  };\n\n  const availableFonts = customFonts\n    .filter((font) => !font.deletedAt)\n    .sort((a, b) => (b.downloadedAt || 0) - (a.downloadedAt || 0));\n\n  const availableFamilies = getAvailableFamilies(availableFonts);\n\n  return (\n    <div className='w-full'>\n      <div className='mb-6 flex h-8 items-center justify-between'>\n        <div className='breadcrumbs py-1'>\n          <ul>\n            <li>\n              <button className='font-semibold' onClick={onBack}>\n                {_('Font')}\n              </button>\n            </li>\n            <li className='font-medium'>{_('Custom Fonts')}</li>\n          </ul>\n        </div>\n        {availableFonts.length > 0 && (\n          <button\n            onClick={toggleDeleteMode}\n            className={`btn btn-ghost btn-sm text-base-content gap-2`}\n            title={isDeleteMode ? _('Cancel Delete') : _('Delete Font')}\n          >\n            {isDeleteMode ? (\n              <>{_('Cancel')}</>\n            ) : (\n              <>\n                <MdDelete className='h-4 w-4' />\n                {_('Delete')}\n              </>\n            )}\n          </button>\n        )}\n      </div>\n\n      <div className='grid grid-cols-2 gap-4'>\n        <div className='card border-primary/50 hover:border-primary/75 group h-12 border-2 transition-colors'>\n          <button\n            className='card-body flex cursor-pointer items-center justify-center p-2 text-center'\n            onClick={handleImportFont}\n          >\n            <div className='flex items-center gap-2'>\n              <div className='flex items-center justify-center'>\n                <MdAdd className='text-primary/85 group-hover:text-primary h-6 w-6' />\n              </div>\n              <div className='text-primary/85 group-hover:text-primary line-clamp-1 font-medium'>\n                {_('Import Font')}\n              </div>\n            </div>\n          </button>\n        </div>\n\n        {availableFamilies.map((family) => (\n          <div\n            role='none'\n            key={family.name}\n            className={clsx(\n              'card h-12 border shadow-sm',\n              currentFontFamily === family.name\n                ? 'border-primary/50 bg-primary/50'\n                : `border-base-200 bg-base-200 ${isDeleteMode ? '' : 'cursor-pointer'}`,\n            )}\n            onClick={!isDeleteMode ? () => handleSelectFamily(family) : undefined}\n            title={family.fonts.map((f) => f.name).join('\\n')}\n          >\n            <div className='card-body flex items-center justify-center p-2'>\n              <div\n                style={{\n                  fontFamily: `\"${family.name}\", sans-serif`,\n                  fontWeight: 400,\n                }}\n                className='text-base-content line-clamp-1 break-all'\n              >\n                {family.name}\n              </div>\n              {isDeleteMode && (\n                <button\n                  onClick={() => handleDeleteFamily(family)}\n                  className='btn btn-ghost btn-xs absolute right-[-10px] top-[-10px] h-6 min-h-0 w-6 p-0 hover:bg-transparent'\n                  title={_('Delete Font')}\n                >\n                  <IoMdCloseCircleOutline className='text-base-content/75 h-6 w-6' />\n                </button>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className='bg-base-200/30 my-8 rounded-lg p-4'>\n        <div className='text-base-content/70 text-sm sm:text-xs'>\n          <div className='mb-1 indent-2 font-medium'>{_('Tips')}:</div>\n          <ul className='list-outside list-disc space-y-1 ps-2'>\n            <li>{_('Supported font formats: .ttf, .otf, .woff, .woff2')}</li>\n            <li>{_('Custom fonts can be selected from the Font Face menu')}</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CustomFonts;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 824, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/FontPanel.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useEffect, useState } from 'react';\nimport { MdSettings } from 'react-icons/md';\n\nimport {\n  CJK_EXCLUDE_PATTENS,\n  CJK_FONTS_PATTENS,\n  CJK_SANS_SERIF_FONTS,\n  CJK_SERIF_FONTS,\n  IOS_FONTS,\n  LINUX_FONTS,\n  MACOS_FONTS,\n  MONOSPACE_FONTS,\n  NON_FREE_FONTS,\n  SANS_SERIF_FONTS,\n  SERIF_FONTS,\n  WINDOWS_FONTS,\n} from '@/services/constants';\nimport { useEnv } from '@/context/EnvContext';\nimport { useReaderStore } from '@/store/readerStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useCustomFontStore } from '@/store/customFontStore';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\nimport { getOSPlatform, isCJKEnv } from '@/utils/misc';\nimport { getSysFontsList } from '@/utils/bridge';\nimport { isCJKStr } from '@/utils/lang';\nimport { isTauriAppPlatform } from '@/services/environment';\nimport { useResetViewSettings } from '@/hooks/useResetSettings';\nimport { saveViewSettings } from '@/helpers/settings';\nimport { SettingsPanelPanelProp } from './SettingsDialog';\nimport NumberInput from './NumberInput';\nimport FontDropdown from './FontDropDown';\nimport CustomFonts from './CustomFonts';\n\nconst genCJKFontsList = (sysFonts: string[]) => {\n  return Array.from(new Set([...sysFonts, ...CJK_SERIF_FONTS, ...CJK_SANS_SERIF_FONTS]))\n    .filter((font) => CJK_FONTS_PATTENS.test(font) || isCJKStr(font))\n    .filter((font) => !CJK_EXCLUDE_PATTENS.test(font))\n    .sort((a, b) => a.localeCompare(b));\n};\n\nconst isSymbolicFontName = (font: string) =>\n  /emoji|icons|symbol|dingbats|ornaments|webdings|wingdings|miuiex/i.test(font);\n\ninterface FontFaceProps {\n  className?: string;\n  family: string;\n  label: string;\n  options: string[];\n  moreOptions?: string[];\n  selected: string;\n  onSelect: (option: string) => void;\n}\n\nconst handleFontFaceFont = (option: string, family: string) => {\n  return `'${option}', ${family}`;\n};\n\nconst filterNonFreeFonts = (font: string) => {\n  return !['android', 'linux'].includes(getOSPlatform()) || !NON_FREE_FONTS.includes(font);\n};\n\nconst FontFace = ({\n  className,\n  family,\n  label,\n  options,\n  moreOptions,\n  selected,\n  onSelect,\n}: FontFaceProps) => {\n  const _ = useTranslation();\n  return (\n    <div className={clsx('config-item', className)}>\n      <span className='line-clamp-2 min-w-10'>{label}</span>\n      <FontDropdown\n        family={family}\n        options={options.map((option) => ({ option, label: _(option) }))}\n        moreOptions={moreOptions?.map((option) => ({ option, label: option })) ?? []}\n        selected={selected}\n        onSelect={onSelect}\n        onGetFontFamily={handleFontFaceFont}\n      />\n    </div>\n  );\n};\n\nconst FontPanel: React.FC<SettingsPanelPanelProp> = ({ bookKey, onRegisterReset }) => {\n  const _ = useTranslation();\n  const { envConfig, appService } = useEnv();\n  const { getView, getViewSettings } = useReaderStore();\n  const { settings, fontPanelView, setFontPanelView } = useSettingsStore();\n  const { fonts: allCustomFonts, getFontFamilies } = useCustomFontStore();\n  const viewSettings = getViewSettings(bookKey) || settings.globalViewSettings;\n  const view = getView(bookKey);\n  const iconSize18 = useResponsiveSize(18);\n\n  const fontFamilyOptions = [\n    {\n      option: 'Serif',\n      label: _('Serif Font'),\n    },\n    {\n      option: 'Sans-serif',\n      label: _('Sans-Serif Font'),\n    },\n  ];\n\n  const osPlatform = getOSPlatform();\n  let defaultSysFonts: string[] = [];\n  switch (osPlatform) {\n    case 'macos':\n      defaultSysFonts = MACOS_FONTS;\n      break;\n    case 'windows':\n      defaultSysFonts = WINDOWS_FONTS;\n      break;\n    case 'linux':\n      defaultSysFonts = LINUX_FONTS;\n      break;\n    case 'ios':\n      defaultSysFonts = IOS_FONTS;\n      break;\n    case 'android':\n      defaultSysFonts = [];\n      break;\n    default:\n      break;\n  }\n  const [sysFonts, setSysFonts] = useState<string[]>(defaultSysFonts);\n  const [defaultFont, setDefaultFont] = useState(viewSettings.defaultFont);\n  const [defaultFontSize, setDefaultFontSize] = useState(viewSettings.defaultFontSize);\n  const [minFontSize, setMinFontSize] = useState(viewSettings.minimumFontSize);\n  const [overrideFont, setOverrideFont] = useState(viewSettings.overrideFont);\n  const [defaultCJKFont, setDefaultCJKFont] = useState(viewSettings.defaultCJKFont);\n  const [serifFont, setSerifFont] = useState(viewSettings.serifFont);\n  const [sansSerifFont, setSansSerifFont] = useState(viewSettings.sansSerifFont);\n  const [monospaceFont, setMonospaceFont] = useState(viewSettings.monospaceFont);\n  const [fontWeight, setFontWeight] = useState(viewSettings.fontWeight);\n\n  const [customFonts, setCustomFonts] = useState<string[]>(getFontFamilies());\n  const [CJKFonts, setCJKFonts] = useState<string[]>(() => {\n    return genCJKFontsList([...customFonts, ...sysFonts]);\n  });\n\n  const resetToDefaults = useResetViewSettings();\n\n  const handleReset = () => {\n    resetToDefaults({\n      defaultFont: setDefaultFont,\n      defaultFontSize: setDefaultFontSize,\n      minimumFontSize: setMinFontSize,\n      overrideFont: setOverrideFont,\n      defaultCJKFont: setDefaultCJKFont,\n      serifFont: setSerifFont,\n      sansSerifFont: setSansSerifFont,\n      monospaceFont: setMonospaceFont,\n      fontWeight: setFontWeight,\n    });\n  };\n\n  const handleManageCustomFonts = () => {\n    setFontPanelView('custom-fonts');\n  };\n\n  const handleBackToMain = () => {\n    setFontPanelView('main-fonts');\n  };\n\n  useEffect(() => {\n    onRegisterReset(handleReset);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [appService]);\n\n  useEffect(() => {\n    setCJKFonts((prev) => {\n      const newFonts = genCJKFontsList([...customFonts, ...sysFonts]);\n      return prev.length !== newFonts.length ? newFonts : prev;\n    });\n  }, [customFonts, sysFonts]);\n\n  useEffect(() => {\n    setCustomFonts(getFontFamilies());\n  }, [allCustomFonts, getFontFamilies]);\n\n  useEffect(() => {\n    setSerifFont(viewSettings.serifFont);\n    setSansSerifFont(viewSettings.sansSerifFont);\n    setMonospaceFont(viewSettings.monospaceFont);\n  }, [viewSettings.serifFont, viewSettings.sansSerifFont, viewSettings.monospaceFont]);\n\n  useEffect(() => {\n    if (isTauriAppPlatform() && appService && !appService.isAndroidApp) {\n      getSysFontsList().then((res) => {\n        if (res.error || Object.keys(res.fonts).length === 0) {\n          console.error('Failed to get system fonts list:', res.error);\n          return;\n        }\n        const processedFonts: string[] = [];\n        Object.entries(res.fonts).forEach(([fontName, fontFamily]) => {\n          if (!fontName || isSymbolicFontName(fontName)) return;\n\n          const fontsInFamily = Object.entries(res.fonts).filter(\n            ([_, family]) => family === fontFamily,\n          );\n\n          if (fontsInFamily.length === 1) {\n            processedFonts.push(fontFamily);\n          } else {\n            processedFonts.push(fontName);\n          }\n        });\n        setSysFonts([...new Set(processedFonts)].sort((a, b) => a.localeCompare(b)));\n      });\n    }\n  }, [appService]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'defaultFont', defaultFont);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [defaultFont]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'defaultCJKFont', defaultCJKFont);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [defaultCJKFont]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'defaultFontSize', defaultFontSize);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [defaultFontSize]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'minimumFontSize', minFontSize);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [minFontSize]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'fontWeight', fontWeight);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fontWeight]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'serifFont', serifFont);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [serifFont]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'sansSerifFont', sansSerifFont);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [sansSerifFont]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'monospaceFont', monospaceFont);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [monospaceFont]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'overrideFont', overrideFont);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [overrideFont]);\n\n  const handleFontFamilyFont = (option: string) => {\n    switch (option) {\n      case 'Serif':\n        return `'${serifFont}', serif`;\n      case 'Sans-serif':\n        return `'${sansSerifFont}', sans-serif`;\n      case 'Monospace':\n        return `'${monospaceFont}', monospace`;\n      default:\n        return '';\n    }\n  };\n\n  if (fontPanelView === 'custom-fonts') {\n    return (\n      <div className='my-4 w-full'>\n        <CustomFonts bookKey={bookKey} onBack={handleBackToMain} />\n      </div>\n    );\n  }\n\n  return (\n    <div className='my-4 w-full space-y-6'>\n      <div className='flex items-center justify-between'>\n        <h2 className='font-medium'>{_('Override Book Font')}</h2>\n        <input\n          type='checkbox'\n          className='toggle'\n          checked={overrideFont}\n          onChange={() => setOverrideFont(!overrideFont)}\n        />\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Font Size')}</h2>\n        <div className='card border-base-200 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <NumberInput\n              label={_('Default Font Size')}\n              value={defaultFontSize}\n              onChange={setDefaultFontSize}\n              min={minFontSize}\n              max={120}\n            />\n            <NumberInput\n              label={_('Minimum Font Size')}\n              value={minFontSize}\n              onChange={setMinFontSize}\n              min={1}\n              max={120}\n            />\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Font Weight')}</h2>\n        <div className='card border-base-200 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <NumberInput\n              label={_('Font Weight')}\n              value={fontWeight}\n              onChange={setFontWeight}\n              min={100}\n              max={900}\n              step={100}\n            />\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Font Family')}</h2>\n        <div className='card border-base-200 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <div className='config-item'>\n              <span className=''>{_('Default Font')}</span>\n              <FontDropdown\n                options={fontFamilyOptions}\n                selected={defaultFont}\n                onSelect={setDefaultFont}\n                onGetFontFamily={handleFontFamilyFont}\n              />\n            </div>\n\n            {(isCJKEnv() || view?.language.isCJK) && (\n              <FontFace\n                className='config-item-top'\n                family='serif'\n                label={_('CJK Font')}\n                options={CJKFonts}\n                selected={defaultCJKFont}\n                onSelect={setDefaultCJKFont}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <div className='mb-2 flex items-center justify-between'>\n          <h2 className='font-medium'>{_('Font Face')}</h2>\n          <button\n            onClick={handleManageCustomFonts}\n            className='btn btn-ghost btn-xs gap-1 hover:bg-transparent'\n            title={_('Manage Custom Fonts')}\n          >\n            <MdSettings size={iconSize18} />\n          </button>\n        </div>\n        <div className='card border-base-200 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <FontFace\n              className='config-item-top'\n              family='serif'\n              label={_('Serif Font')}\n              options={[\n                ...customFonts,\n                ...SERIF_FONTS.filter(filterNonFreeFonts),\n                ...CJK_SERIF_FONTS,\n              ]}\n              moreOptions={sysFonts}\n              selected={serifFont}\n              onSelect={setSerifFont}\n            />\n            <FontFace\n              family='sans-serif'\n              label={_('Sans-Serif Font')}\n              options={[\n                ...customFonts,\n                ...SANS_SERIF_FONTS.filter(filterNonFreeFonts),\n                ...CJK_SANS_SERIF_FONTS,\n              ]}\n              moreOptions={sysFonts}\n              selected={sansSerifFont}\n              onSelect={setSansSerifFont}\n            />\n            <FontFace\n              className='config-item-bottom'\n              family='monospace'\n              label={_('Monospace Font')}\n              options={[...customFonts, ...MONOSPACE_FONTS]}\n              moreOptions={sysFonts}\n              selected={monospaceFont}\n              onSelect={setMonospaceFont}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default FontPanel;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1528, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/LayoutPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { MdOutlineAutoMode, MdOutlineScreenRotation } from 'react-icons/md';\nimport { MdOutlineTextRotationNone, MdTextRotateVertical } from 'react-icons/md';\nimport { IoPhoneLandscapeOutline, IoPhonePortraitOutline } from 'react-icons/io5';\nimport { TbTextDirectionRtl } from 'react-icons/tb';\n\nimport { useEnv } from '@/context/EnvContext';\nimport { useReaderStore } from '@/store/readerStore';\nimport { useBookDataStore } from '@/store/bookDataStore';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useResetViewSettings } from '@/hooks/useResetSettings';\nimport { isCJKEnv } from '@/utils/misc';\nimport { getStyles } from '@/utils/style';\nimport { getMaxInlineSize } from '@/utils/config';\nimport { lockScreenOrientation } from '@/utils/bridge';\nimport { saveViewSettings } from '@/helpers/settings';\nimport { getBookDirFromWritingMode, getBookLangCode } from '@/utils/book';\nimport { MIGHT_BE_RTL_LANGS } from '@/services/constants';\nimport { SettingsPanelPanelProp } from './SettingsDialog';\nimport Select from '@/components/Select';\nimport NumberInput from './NumberInput';\n\nconst LayoutPanel: React.FC<SettingsPanelPanelProp> = ({ bookKey, onRegisterReset }) => {\n  const _ = useTranslation();\n  const { envConfig, appService } = useEnv();\n  const { settings } = useSettingsStore();\n  const { getView, getViewSettings, getGridInsets } = useReaderStore();\n  const { setViewSettings, recreateViewer } = useReaderStore();\n  const { getBookData } = useBookDataStore();\n  const viewSettings = getViewSettings(bookKey) || settings.globalViewSettings;\n\n  const view = getView(bookKey);\n  const bookData = getBookData(bookKey);\n  const gridInsets = getGridInsets(bookKey) || { top: 0, bottom: 0, left: 0, right: 0 };\n\n  const [paragraphMargin, setParagraphMargin] = useState(viewSettings.paragraphMargin);\n  const [lineHeight, setLineHeight] = useState(viewSettings.lineHeight);\n  const [wordSpacing, setWordSpacing] = useState(viewSettings.wordSpacing);\n  const [letterSpacing, setLetterSpacing] = useState(viewSettings.letterSpacing);\n  const [textIndent, setTextIndent] = useState(viewSettings.textIndent!);\n  const [fullJustification, setFullJustification] = useState(viewSettings.fullJustification);\n  const [hyphenation, setHyphenation] = useState(viewSettings.hyphenation);\n  const [marginTopPx, setMarginTopPx] = useState(viewSettings.marginPx || viewSettings.marginTopPx);\n  const [marginBottomPx, setMarginBottomPx] = useState(viewSettings.marginBottomPx);\n  const [marginLeftPx, setMarginLeftPx] = useState(viewSettings.marginLeftPx);\n  const [marginRightPx, setMarginRightPx] = useState(viewSettings.marginRightPx);\n  const [compactMarginTopPx, setCompactMarginTopPx] = useState(\n    viewSettings.compactMarginPx || viewSettings.compactMarginTopPx,\n  );\n  const [compactMarginBottomPx, setCompactMarginBottomPx] = useState(\n    viewSettings.compactMarginBottomPx,\n  );\n  const [gapPercent, setGapPercent] = useState(viewSettings.gapPercent);\n  const [compactMarginLeftPx, setCompactMarginLeftPx] = useState(viewSettings.compactMarginLeftPx);\n  const [compactMarginRightPx, setCompactMarginRightPx] = useState(\n    viewSettings.compactMarginRightPx,\n  );\n  const [maxColumnCount, setMaxColumnCount] = useState(viewSettings.maxColumnCount);\n  const [maxInlineSize, setMaxInlineSize] = useState(viewSettings.maxInlineSize);\n  const [maxBlockSize, setMaxBlockSize] = useState(viewSettings.maxBlockSize);\n  const [writingMode, setWritingMode] = useState(viewSettings.writingMode);\n  const [overrideLayout, setOverrideLayout] = useState(viewSettings.overrideLayout);\n  const [doubleBorder, setDoubleBorder] = useState(viewSettings.doubleBorder);\n  const [borderColor, setBorderColor] = useState(viewSettings.borderColor);\n  const [showHeader, setShowHeader] = useState(viewSettings.showHeader);\n  const [showFooter, setShowFooter] = useState(viewSettings.showFooter);\n  const [showBarsOnScroll, setShowBarsOnScroll] = useState(viewSettings.showBarsOnScroll);\n  const [showMarginsOnScroll, setShowMarginsOnScroll] = useState(viewSettings.showMarginsOnScroll);\n  const [showRemainingTime, setShowRemainingTime] = useState(viewSettings.showRemainingTime);\n  const [showRemainingPages, setShowRemainingPages] = useState(viewSettings.showRemainingPages);\n  const [showProgressInfo, setShowProgressInfo] = useState(viewSettings.showProgressInfo);\n  const [tapToToggleFooter, setTapToToggleFooter] = useState(viewSettings.tapToToggleFooter);\n  const [progressStyle, setProgressStyle] = useState(viewSettings.progressStyle);\n  const [screenOrientation, setScreenOrientation] = useState(viewSettings.screenOrientation);\n  const resetToDefaults = useResetViewSettings();\n\n  const handleReset = () => {\n    resetToDefaults({\n      paragraphMargin: setParagraphMargin,\n      lineHeight: setLineHeight,\n      wordSpacing: setWordSpacing,\n      letterSpacing: setLetterSpacing,\n      textIndent: setTextIndent,\n      fullJustification: setFullJustification,\n      hyphenation: setHyphenation,\n      marginTopPx: setMarginTopPx,\n      marginBottomPx: setMarginBottomPx,\n      marginLeftPx: setMarginLeftPx,\n      marginRightPx: setMarginRightPx,\n      compactMarginTopPx: setCompactMarginTopPx,\n      compactMarginBottomPx: setCompactMarginBottomPx,\n      compactMarginLeftPx: setCompactMarginLeftPx,\n      compactMarginRightPx: setCompactMarginRightPx,\n      gapPercent: setGapPercent,\n      maxColumnCount: setMaxColumnCount,\n      maxInlineSize: setMaxInlineSize,\n      maxBlockSize: setMaxBlockSize,\n      overrideLayout: setOverrideLayout,\n      doubleBorder: setDoubleBorder,\n      borderColor: setBorderColor,\n      showHeader: setShowHeader,\n      showFooter: setShowFooter,\n      showBarsOnScroll: setShowBarsOnScroll,\n      showRemainingTime: setShowRemainingTime,\n      showRemainingPages: setShowRemainingPages,\n      showProgressInfo: setShowProgressInfo,\n      tapToToggleFooter: setTapToToggleFooter,\n      showMarginsOnScroll: setShowMarginsOnScroll,\n    });\n  };\n\n  useEffect(() => {\n    onRegisterReset(handleReset);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'paragraphMargin', paragraphMargin);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [paragraphMargin]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'lineHeight', lineHeight);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [lineHeight]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'wordSpacing', wordSpacing);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [wordSpacing]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'letterSpacing', letterSpacing);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [letterSpacing]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'textIndent', textIndent);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [textIndent]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'fullJustification', fullJustification);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fullJustification]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'hyphenation', hyphenation);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [hyphenation]);\n\n  useEffect(() => {\n    if (marginTopPx === viewSettings.marginTopPx) return;\n    if (viewSettings.marginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'marginPx', undefined, false, false);\n    }\n    saveViewSettings(envConfig, bookKey, 'marginTopPx', marginTopPx, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [marginTopPx]);\n\n  useEffect(() => {\n    if (marginBottomPx === viewSettings.marginBottomPx) return;\n    if (viewSettings.marginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'marginPx', undefined, false, false);\n    }\n    saveViewSettings(envConfig, bookKey, 'marginBottomPx', marginBottomPx, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [marginBottomPx]);\n\n  useEffect(() => {\n    if (marginRightPx === viewSettings.marginRightPx) return;\n    if (viewSettings.marginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'marginPx', undefined, false, false);\n    }\n    saveViewSettings(envConfig, bookKey, 'marginRightPx', marginRightPx, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [marginRightPx]);\n\n  useEffect(() => {\n    if (marginLeftPx === viewSettings.marginLeftPx) return;\n    if (viewSettings.marginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'marginPx', undefined, false, false);\n    }\n    saveViewSettings(envConfig, bookKey, 'marginLeftPx', marginLeftPx, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [marginLeftPx]);\n\n  useEffect(() => {\n    if (compactMarginTopPx === viewSettings.compactMarginTopPx) return;\n    if (viewSettings.compactMarginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'compactMarginPx', undefined, false, false);\n    }\n    saveViewSettings(envConfig, bookKey, 'compactMarginTopPx', compactMarginTopPx, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [compactMarginTopPx]);\n\n  useEffect(() => {\n    if (compactMarginBottomPx === viewSettings.compactMarginBottomPx) return;\n    if (viewSettings.compactMarginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'compactMarginPx', undefined, false, false);\n    }\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      'compactMarginBottomPx',\n      compactMarginBottomPx,\n      false,\n      false,\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [compactMarginBottomPx]);\n\n  useEffect(() => {\n    if (compactMarginRightPx === viewSettings.compactMarginRightPx) return;\n    if (viewSettings.compactMarginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'compactMarginPx', undefined, false, false);\n    }\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      'compactMarginRightPx',\n      compactMarginRightPx,\n      false,\n      false,\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [compactMarginRightPx]);\n\n  useEffect(() => {\n    if (compactMarginLeftPx === viewSettings.compactMarginLeftPx) return;\n    if (viewSettings.compactMarginPx !== undefined) {\n      saveViewSettings(envConfig, bookKey, 'compactMarginPx', undefined, false, false);\n    }\n    saveViewSettings(envConfig, bookKey, 'compactMarginLeftPx', compactMarginLeftPx, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [compactMarginLeftPx]);\n\n  useEffect(() => {\n    if (gapPercent === viewSettings.gapPercent) return;\n    saveViewSettings(envConfig, bookKey, 'gapPercent', gapPercent, false, false);\n    view?.renderer.setAttribute('gap', `${gapPercent}%`);\n    if (viewSettings.scrolled) {\n      view?.renderer.setAttribute('flow', 'scrolled');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [gapPercent]);\n\n  useEffect(() => {\n    if (maxColumnCount === viewSettings.maxColumnCount) return;\n    saveViewSettings(envConfig, bookKey, 'maxColumnCount', maxColumnCount, false, false);\n    const newViewSettings = getViewSettings(bookKey)!;\n    view?.renderer.setAttribute('max-column-count', maxColumnCount);\n    view?.renderer.setAttribute('max-inline-size', `${getMaxInlineSize(newViewSettings)}px`);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [maxColumnCount]);\n\n  useEffect(() => {\n    if (maxInlineSize === viewSettings.maxInlineSize) return;\n    saveViewSettings(envConfig, bookKey, 'maxInlineSize', maxInlineSize, false, false);\n    const newViewSettings = getViewSettings(bookKey)!;\n    view?.renderer.setAttribute('max-inline-size', `${getMaxInlineSize(newViewSettings)}px`);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [maxInlineSize]);\n\n  useEffect(() => {\n    if (maxBlockSize === viewSettings.maxBlockSize) return;\n    saveViewSettings(envConfig, bookKey, 'maxBlockSize', maxBlockSize, false, false);\n    view?.renderer.setAttribute('max-block-size', `${maxBlockSize}px`);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [maxBlockSize]);\n\n  useEffect(() => {\n    if (writingMode === viewSettings.writingMode) return;\n    // global settings are not supported for writing mode\n    const prevWritingMode = viewSettings.writingMode;\n    if (writingMode.includes('vertical')) {\n      viewSettings.vertical = true;\n    } else {\n      viewSettings.vertical = false;\n    }\n    saveViewSettings(envConfig, bookKey, 'writingMode', writingMode, true).then(() => {\n      if (view) {\n        const newViewSettings = getViewSettings(bookKey)!;\n        view.renderer.setStyles?.(getStyles(newViewSettings));\n        view.book.dir = getBookDirFromWritingMode(writingMode);\n      }\n      if (\n        prevWritingMode !== writingMode &&\n        (['horizontal-rl', 'vertical-rl'].includes(writingMode) ||\n          ['horizontal-rl', 'vertical-rl'].includes(prevWritingMode))\n      ) {\n        recreateViewer(envConfig, bookKey);\n      }\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [writingMode]);\n\n  useEffect(() => {\n    if (overrideLayout === viewSettings.overrideLayout) return;\n    saveViewSettings(envConfig, bookKey, 'overrideLayout', overrideLayout);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [overrideLayout]);\n\n  useEffect(() => {\n    if (doubleBorder === viewSettings.doubleBorder) return;\n    saveViewSettings(envConfig, bookKey, 'doubleBorder', doubleBorder, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [doubleBorder]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'borderColor', borderColor, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [borderColor]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'showBarsOnScroll', showBarsOnScroll, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showBarsOnScroll]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'showMarginsOnScroll', showMarginsOnScroll, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showMarginsOnScroll]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'showRemainingTime', showRemainingTime, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showRemainingTime]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'showRemainingPages', showRemainingPages, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showRemainingPages]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'showProgressInfo', showProgressInfo, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showProgressInfo]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'progressStyle', progressStyle, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [progressStyle]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'tapToToggleFooter', tapToToggleFooter, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [tapToToggleFooter]);\n\n  useEffect(() => {\n    if (showHeader === viewSettings.showHeader) return;\n    if (showHeader && !viewSettings.vertical) {\n      const minMarginTop = Math.max(0, Math.round((44 - gridInsets.top) / 4) * 4);\n      viewSettings.marginTopPx = Math.max(viewSettings.marginTopPx, minMarginTop);\n      setMarginTopPx(viewSettings.marginTopPx);\n      setViewSettings(bookKey, viewSettings);\n    }\n    saveViewSettings(envConfig, bookKey, 'showHeader', showHeader, false, false);\n    // Margin and gap settings will be applied in FoliateViewer\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showHeader]);\n\n  useEffect(() => {\n    if (showFooter === viewSettings.showFooter) return;\n    if (showFooter && !viewSettings.vertical) {\n      const minMarginBottom = Math.max(0, Math.round((44 - gridInsets.bottom) / 4) * 4);\n      viewSettings.marginBottomPx = Math.max(viewSettings.marginBottomPx, minMarginBottom);\n      setMarginBottomPx(viewSettings.marginBottomPx);\n      setViewSettings(bookKey, viewSettings);\n    }\n    saveViewSettings(envConfig, bookKey, 'showFooter', showFooter, false, false);\n    // Margin and gap settings will be applied in FoliateViewer\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showFooter]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'screenOrientation', screenOrientation, false, false);\n    if (appService?.isMobileApp) {\n      lockScreenOrientation({ orientation: screenOrientation });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [screenOrientation]);\n\n  const langCode = getBookLangCode(bookData?.bookDoc?.metadata?.language);\n  const mightBeRTLBook = MIGHT_BE_RTL_LANGS.includes(langCode) || isCJKEnv();\n  const isVertical = viewSettings.vertical || writingMode.includes('vertical');\n\n  return (\n    <div className='my-4 w-full space-y-6'>\n      <div className='flex items-center justify-between'>\n        <h2 className='font-medium'>{_('Override Book Layout')}</h2>\n        <input\n          type='checkbox'\n          className='toggle'\n          checked={overrideLayout}\n          onChange={() => setOverrideLayout(!overrideLayout)}\n        />\n      </div>\n      {mightBeRTLBook && (\n        <div className='flex items-center justify-between'>\n          <h2 className='font-medium'>{_('Writing Mode')}</h2>\n          <div className='flex gap-4'>\n            <button\n              title={_('Default')}\n              className={`btn btn-ghost btn-circle btn-sm ${writingMode === 'auto' ? 'btn-active bg-base-300' : ''}`}\n              onClick={() => setWritingMode('auto')}\n            >\n              <MdOutlineAutoMode />\n            </button>\n\n            <button\n              title={_('Horizontal Direction')}\n              className={`btn btn-ghost btn-circle btn-sm ${writingMode === 'horizontal-tb' ? 'btn-active bg-base-300' : ''}`}\n              onClick={() => setWritingMode('horizontal-tb')}\n            >\n              <MdOutlineTextRotationNone />\n            </button>\n\n            <button\n              title={_('Vertical Direction')}\n              className={`btn btn-ghost btn-circle btn-sm ${writingMode === 'vertical-rl' ? 'btn-active bg-base-300' : ''}`}\n              onClick={() => setWritingMode('vertical-rl')}\n            >\n              <MdTextRotateVertical />\n            </button>\n\n            <button\n              title={_('RTL Direction')}\n              className={`btn btn-ghost btn-circle btn-sm ${writingMode === 'horizontal-rl' ? 'btn-active bg-base-300' : ''}`}\n              onClick={() => setWritingMode('horizontal-rl')}\n            >\n              <TbTextDirectionRtl />\n            </button>\n          </div>\n        </div>\n      )}\n\n      {viewSettings.vertical && (\n        <div className='w-full'>\n          <h2 className='mb-2 font-medium'>{_('Border Frame')}</h2>\n          <div className='card bg-base-100 border-base-200 border shadow'>\n            <div className='divide-base-200 divide-y'>\n              <div className='config-item'>\n                <span className=''>{_('Double Border')}</span>\n                <input\n                  type='checkbox'\n                  className='toggle'\n                  checked={doubleBorder}\n                  onChange={() => setDoubleBorder(!doubleBorder)}\n                />\n              </div>\n\n              <div className='config-item'>\n                <span className=''>{_('Border Color')}</span>\n                <div className='flex gap-4'>\n                  <button\n                    className={`btn btn-circle btn-sm bg-red-300 hover:bg-red-500 ${borderColor === 'red' ? 'btn-active !bg-red-500' : ''}`}\n                    onClick={() => setBorderColor('red')}\n                  ></button>\n\n                  <button\n                    className={`btn btn-circle btn-sm bg-black/50 hover:bg-black ${borderColor === 'black' ? 'btn-active !bg-black' : ''}`}\n                    onClick={() => setBorderColor('black')}\n                  ></button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Paragraph')}</h2>\n        <div className='card bg-base-100 border-base-200 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <NumberInput\n              label={_('Paragraph Margin')}\n              value={paragraphMargin}\n              onChange={setParagraphMargin}\n              min={0}\n              max={4}\n              step={0.1}\n            />\n            <NumberInput\n              label={_('Line Spacing')}\n              value={lineHeight}\n              onChange={setLineHeight}\n              min={1.0}\n              max={3.0}\n              step={0.1}\n            />\n            {langCode !== 'zh' && (\n              <NumberInput\n                label={_('Word Spacing')}\n                value={wordSpacing}\n                onChange={setWordSpacing}\n                min={-4}\n                max={8}\n                step={0.5}\n              />\n            )}\n            <NumberInput\n              label={_('Letter Spacing')}\n              value={letterSpacing}\n              onChange={setLetterSpacing}\n              min={-2}\n              max={4}\n              step={0.5}\n            />\n            <NumberInput\n              label={_('Text Indent')}\n              value={textIndent}\n              onChange={setTextIndent}\n              min={-2}\n              max={4}\n              step={1}\n            />\n            <div className='config-item'>\n              <span className=''>{_('Full Justification')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={fullJustification}\n                onChange={() => setFullJustification(!fullJustification)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Hyphenation')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={hyphenation}\n                onChange={() => setHyphenation(!hyphenation)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Page')}</h2>\n        <div className='card bg-base-100 border-base-200 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <NumberInput\n              label={_('Top Margin (px)')}\n              value={showHeader && !isVertical ? marginTopPx : compactMarginTopPx}\n              onChange={showHeader && !isVertical ? setMarginTopPx : setCompactMarginTopPx}\n              min={\n                showHeader && !isVertical\n                  ? Math.max(0, Math.round((44 - gridInsets.top) / 4) * 4)\n                  : 0\n              }\n              max={88}\n              step={4}\n            />\n            <NumberInput\n              label={_('Bottom Margin (px)')}\n              value={showFooter && !isVertical ? marginBottomPx : compactMarginBottomPx}\n              onChange={showFooter && !isVertical ? setMarginBottomPx : setCompactMarginBottomPx}\n              min={\n                showFooter && !isVertical\n                  ? Math.max(0, Math.round((44 - gridInsets.bottom) / 4) * 4)\n                  : 0\n              }\n              max={88}\n              step={4}\n            />\n            <NumberInput\n              label={_('Left Margin (px)')}\n              value={showFooter && isVertical ? marginLeftPx : compactMarginLeftPx}\n              onChange={showFooter && isVertical ? setMarginLeftPx : setCompactMarginLeftPx}\n              min={0}\n              max={88}\n              step={4}\n            />\n            <NumberInput\n              label={_('Right Margin (px)')}\n              value={showHeader && isVertical ? marginRightPx : compactMarginRightPx}\n              onChange={showHeader && isVertical ? setMarginRightPx : setCompactMarginRightPx}\n              min={0}\n              max={88}\n              step={4}\n            />\n            <NumberInput\n              label={_('Column Gap (%)')}\n              value={gapPercent}\n              onChange={setGapPercent}\n              min={0}\n              max={30}\n            />\n            <NumberInput\n              label={_('Maximum Number of Columns')}\n              value={maxColumnCount}\n              onChange={setMaxColumnCount}\n              min={1}\n              max={4}\n            />\n            <NumberInput\n              label={viewSettings.vertical ? _('Maximum Column Height') : _('Maximum Column Width')}\n              value={maxInlineSize}\n              onChange={setMaxInlineSize}\n              disabled={false}\n              min={200}\n              max={9999}\n              step={50}\n            />\n            <NumberInput\n              label={viewSettings.vertical ? _('Maximum Column Width') : _('Maximum Column Height')}\n              value={maxBlockSize}\n              onChange={setMaxBlockSize}\n              disabled={false}\n              min={400}\n              max={9999}\n              step={50}\n            />\n            <div className='config-item'>\n              <span className=''>{_('Apply also in Scrolled Mode')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showMarginsOnScroll}\n                onChange={() => setShowMarginsOnScroll(!showMarginsOnScroll)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Header & Footer')}</h2>\n        <div className='card bg-base-100 border-base-200 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <div className='config-item'>\n              <span className=''>{_('Show Header')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showHeader}\n                onChange={() => setShowHeader(!showHeader)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Show Footer')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showFooter}\n                onChange={() => setShowFooter(!showFooter)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Show Remaining Time')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showRemainingTime}\n                disabled={!showFooter}\n                onChange={() => {\n                  if (!showRemainingTime) {\n                    setShowRemainingTime(true);\n                    setShowRemainingPages(false);\n                  } else {\n                    setShowRemainingTime(false);\n                  }\n                }}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Show Remaining Pages')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showRemainingPages}\n                disabled={!showFooter}\n                onChange={() => {\n                  if (!showRemainingPages) {\n                    setShowRemainingPages(true);\n                    setShowRemainingTime(false);\n                  } else {\n                    setShowRemainingPages(false);\n                  }\n                }}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Show Reading Progress')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showProgressInfo}\n                disabled={!showFooter}\n                onChange={() => setShowProgressInfo(!showProgressInfo)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Reading Progress Style')}</span>\n              <Select\n                value={progressStyle}\n                onChange={(e) => setProgressStyle(e.target.value as 'percentage' | 'fraction')}\n                options={[\n                  { value: 'fraction', label: _('Page Number') },\n                  { value: 'percentage', label: _('Percentage') },\n                ]}\n                disabled={!showProgressInfo}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Tap to Toggle Footer')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={tapToToggleFooter}\n                disabled={!showFooter}\n                onChange={() => setTapToToggleFooter(!tapToToggleFooter)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Apply also in Scrolled Mode')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showBarsOnScroll}\n                onChange={() => setShowBarsOnScroll(!showBarsOnScroll)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {appService?.hasOrientationLock && (\n        <div className='w-full'>\n          <h2 className='mb-2 font-medium'>{_('Screen')}</h2>\n          <div className='card border-base-200 bg-base-100 border shadow'>\n            <div className='divide-base-200 divide-y'>\n              <div className='config-item'>\n                <span className=''>{_('Orientation')}</span>\n                <div className='flex gap-4'>\n                  <div className='lg:tooltip lg:tooltip-bottom' data-tip={_('Auto')}>\n                    <button\n                      className={`btn btn-ghost btn-circle btn-sm ${screenOrientation === 'auto' ? 'btn-active bg-base-300' : ''}`}\n                      onClick={() => setScreenOrientation('auto')}\n                    >\n                      <MdOutlineScreenRotation />\n                    </button>\n                  </div>\n\n                  <div className='lg:tooltip lg:tooltip-bottom' data-tip={_('Portrait')}>\n                    <button\n                      className={`btn btn-ghost btn-circle btn-sm ${screenOrientation === 'portrait' ? 'btn-active bg-base-300' : ''}`}\n                      onClick={() => setScreenOrientation('portrait')}\n                    >\n                      <IoPhonePortraitOutline />\n                    </button>\n                  </div>\n\n                  <div className='lg:tooltip lg:tooltip-bottom' data-tip={_('Landscape')}>\n                    <button\n                      className={`btn btn-ghost btn-circle btn-sm ${screenOrientation === 'landscape' ? 'btn-active bg-base-300' : ''}`}\n                      onClick={() => setScreenOrientation('landscape')}\n                    >\n                      <IoPhoneLandscapeOutline />\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LayoutPanel;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2969, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/ColorInput.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { SketchPicker, ColorResult } from 'react-color';\n\ntype ColorInputProps = {\n  label: string;\n  value: string;\n  onChange: (value: string) => void;\n  compact?: boolean;\n  pickerPosition?: 'left' | 'center' | 'right';\n};\n\nconst ColorInput: React.FC<ColorInputProps> = ({\n  label,\n  value,\n  onChange,\n  compact = false,\n  pickerPosition = 'left',\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const pickerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (pickerRef.current && !pickerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    }\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    } else {\n      document.removeEventListener('mousedown', handleClickOutside);\n    }\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [isOpen]);\n\n  const handlePickerChange = (colorResult: ColorResult) => {\n    onChange(colorResult.hex);\n  };\n\n  const getPickerPositionClass = () => {\n    if (pickerPosition === 'right') {\n      return 'right-0';\n    } else if (pickerPosition === 'center') {\n      return 'left-1/2 -translate-x-1/2';\n    }\n    return 'left-0';\n  };\n\n  if (compact) {\n    return (\n      <div className='relative'>\n        <input\n          type='text'\n          value={value}\n          spellCheck={false}\n          onChange={(e) => onChange(e.target.value)}\n          onClick={() => setIsOpen(!isOpen)}\n          className='bg-base-100 text-base-content border-base-200/75 w-16 cursor-pointer rounded border px-1 py-0.5 text-center font-mono text-xs'\n        />\n\n        {isOpen && (\n          <div\n            ref={pickerRef}\n            className={`absolute top-full z-50 py-1 ${getPickerPositionClass()}`}\n          >\n            <SketchPicker\n              width='200px'\n              color={value}\n              onChange={handlePickerChange}\n              disableAlpha={true}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className='mb-3'>\n      <label className='mb-1 block text-sm font-medium'>{label}</label>\n      <div className='flex items-center'>\n        <button\n          className='border-base-200/75 relative mr-2 flex h-7 w-8 cursor-pointer items-center justify-center overflow-hidden rounded border'\n          style={{ backgroundColor: value }}\n          onClick={() => setIsOpen(!isOpen)}\n        />\n\n        <input\n          type='text'\n          value={value}\n          spellCheck={false}\n          onChange={(e) => onChange(e.target.value)}\n          className='bg-base-100 text-base-content border-base-200/75 min-w-4 max-w-36 flex-1 rounded border p-1 font-mono text-sm'\n        />\n      </div>\n\n      {isOpen && (\n        <div ref={pickerRef} className='relative z-50 mt-2'>\n          <div className='absolute'>\n            <SketchPicker\n              width='100%'\n              color={value}\n              onChange={handlePickerChange}\n              disableAlpha={true}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ColorInput;\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;AAHA;;;AAaA,MAAM,aAAwC,CAAC,EAC7C,KAAK,EACL,KAAK,EACL,QAAQ,EACR,UAAU,KAAK,EACf,iBAAiB,MAAM,EACxB;;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,2UAAQ,EAAC;IACrC,MAAM,YAAY,IAAA,yUAAM,EAAiB;IAEzC,IAAA,4UAAS;gCAAC;YACR,SAAS,mBAAmB,KAAiB;gBAC3C,IAAI,UAAU,OAAO,IAAI,CAAC,UAAU,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;oBAC1E,UAAU;gBACZ;YACF;YACA,IAAI,QAAQ;gBACV,SAAS,gBAAgB,CAAC,aAAa;YACzC,OAAO;gBACL,SAAS,mBAAmB,CAAC,aAAa;YAC5C;YACA;wCAAO,IAAM,SAAS,mBAAmB,CAAC,aAAa;;QACzD;+BAAG;QAAC;KAAO;IAEX,MAAM,qBAAqB,CAAC;QAC1B,SAAS,YAAY,GAAG;IAC1B;IAEA,MAAM,yBAAyB;QAC7B,IAAI,mBAAmB,SAAS;YAC9B,OAAO;QACT,OAAO,IAAI,mBAAmB,UAAU;YACtC,OAAO;QACT;QACA,OAAO;IACT;IAEA,IAAI,SAAS;QACX,qBACE,+VAAC;YAAI,WAAU;;8BACb,+VAAC;oBACC,MAAK;oBACL,OAAO;oBACP,YAAY;oBACZ,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;oBACxC,SAAS,IAAM,UAAU,CAAC;oBAC1B,WAAU;;;;;;gBAGX,wBACC,+VAAC;oBACC,KAAK;oBACL,WAAW,CAAC,4BAA4B,EAAE,0BAA0B;8BAEpE,cAAA,+VAAC,sTAAY;wBACX,OAAM;wBACN,OAAO;wBACP,UAAU;wBACV,cAAc;;;;;;;;;;;;;;;;;IAM1B;IAEA,qBACE,+VAAC;QAAI,WAAU;;0BACb,+VAAC;gBAAM,WAAU;0BAAkC;;;;;;0BACnD,+VAAC;gBAAI,WAAU;;kCACb,+VAAC;wBACC,WAAU;wBACV,OAAO;4BAAE,iBAAiB;wBAAM;wBAChC,SAAS,IAAM,UAAU,CAAC;;;;;;kCAG5B,+VAAC;wBACC,MAAK;wBACL,OAAO;wBACP,YAAY;wBACZ,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wBACxC,WAAU;;;;;;;;;;;;YAIb,wBACC,+VAAC;gBAAI,KAAK;gBAAW,WAAU;0BAC7B,cAAA,+VAAC;oBAAI,WAAU;8BACb,cAAA,+VAAC,sTAAY;wBACX,OAAM;wBACN,OAAO;wBACP,UAAU;wBACV,cAAc;;;;;;;;;;;;;;;;;;;;;;AAO5B;GAnGM;KAAA;uCAqGS"}},
    {"offset": {"line": 3143, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/ThemeEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { CustomTheme } from '@/styles/themes';\nimport { md5Fingerprint } from '@/utils/md5';\nimport { CUSTOM_THEME_TEMPLATES } from '@/services/constants';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport clsx from 'clsx';\nimport ColorInput from './ColorInput';\n\ntype ThemeEditorProps = {\n  customTheme: CustomTheme | null;\n  onSave: (customTheme: CustomTheme) => void;\n  onDelete: (customTheme: CustomTheme) => void;\n  onCancel: () => void;\n};\n\nconst ThemePreview: React.FC<{\n  textColor: string;\n  backgroundColor: string;\n  primaryColor: string;\n  label: string;\n}> = ({ textColor, backgroundColor, primaryColor, label }) => {\n  const _ = useTranslation();\n  return (\n    <div className='mb-2 mt-4'>\n      <label className='mb-1 block text-sm font-medium'>{label}</label>\n      <div\n        className='border-base-300 overflow-hidden rounded border p-2'\n        style={{\n          backgroundColor: backgroundColor,\n          color: textColor,\n        }}\n      >\n        <p className='mb-2 whitespace-pre-line text-xs'>\n          {_(\n            \"All the world's a stage,\\nAnd all the men and women merely players;\\nThey have their exits and their entrances,\\nAnd one man in his time plays many parts,\\nHis acts being seven ages.\\n\\n William Shakespeare\",\n          )}\n          {'\\n\\n'}\n          <span\n            className='mt-4 cursor-pointer italic'\n            style={{\n              color: primaryColor,\n            }}\n          >\n            {_(\"(from 'As You Like It', Act II)\")}\n          </span>\n        </p>\n      </div>\n    </div>\n  );\n};\n\nconst ThemeEditor: React.FC<ThemeEditorProps> = ({ customTheme, onSave, onDelete, onCancel }) => {\n  const _ = useTranslation();\n  const { settings } = useSettingsStore();\n  const [template] = useState(\n    () => CUSTOM_THEME_TEMPLATES[Math.floor(Math.random() * CUSTOM_THEME_TEMPLATES.length)]!,\n  );\n  const [lightTextColor, setLightTextColor] = useState(\n    customTheme?.colors.light.fg || template.light.fg,\n  );\n  const [lightBackgroundColor, setLightBackgroundColor] = useState(\n    customTheme?.colors.light.bg || template.light.bg,\n  );\n  const [lightPrimaryColor, setLightPrimaryColor] = useState(\n    customTheme?.colors.light.primary || template.light.primary,\n  );\n  const [darkTextColor, setDarkTextColor] = useState(\n    customTheme?.colors.dark.fg || template.dark.fg,\n  );\n  const [darkBackgroundColor, setDarkBackgroundColor] = useState(\n    customTheme?.colors.dark.bg || template.dark.bg,\n  );\n  const [darkPrimaryColor, setDarkPrimaryColor] = useState(\n    customTheme?.colors.dark.primary || template.dark.primary,\n  );\n\n  const [themeName, setThemeName] = useState(customTheme?.label || _('Custom'));\n\n  const getCustomTheme = () => {\n    return {\n      name: md5Fingerprint(themeName),\n      label: themeName,\n      colors: {\n        light: {\n          fg: lightTextColor,\n          bg: lightBackgroundColor,\n          primary: lightPrimaryColor,\n        },\n        dark: {\n          fg: darkTextColor,\n          bg: darkBackgroundColor,\n          primary: darkPrimaryColor,\n        },\n      },\n    };\n  };\n\n  return (\n    <div className='mt-6 rounded-lg'>\n      <div className='mb-4'>\n        <div className='mb-4 flex items-center justify-between'>\n          <label className='font-medium'>{_('Custom Theme')}</label>\n          <div className='flex w-[calc(50%-12px)] justify-between'>\n            <button\n              className='btn btn-ghost btn-sm text-base-content px-2'\n              onClick={() => onSave(getCustomTheme())}\n            >\n              {_('Save')}\n            </button>\n\n            {settings.globalReadSettings.customThemes.find(\n              (theme) => theme.name === md5Fingerprint(themeName),\n            ) && (\n              <button\n                className={clsx('btn btn-ghost btn-sm px-2')}\n                onClick={() => onDelete(getCustomTheme())}\n              >\n                {_('Delete')}\n              </button>\n            )}\n\n            <button className='btn btn-ghost btn-sm px-2' onClick={onCancel}>\n              {_('Cancel')}\n            </button>\n          </div>\n        </div>\n        <div className='mb-4 flex items-center justify-between'>\n          <label className='font-medium'>{_('Theme Name')}</label>\n          <input\n            type='text'\n            value={themeName}\n            onChange={(e) => setThemeName(e.target.value)}\n            className='bg-base-100 text-base-content border-base-200 w-[calc(50%-12px)] rounded border p-2 text-sm'\n          />\n        </div>\n      </div>\n\n      <div className='grid grid-cols-2 gap-6'>\n        <div className='bg-base-200 rounded-lg p-3'>\n          <h3 className='mb-3 text-center font-medium'>{_('Light Mode')}</h3>\n\n          <ColorInput label={_('Text Color')} value={lightTextColor} onChange={setLightTextColor} />\n\n          <ColorInput\n            label={_('Background Color')}\n            value={lightBackgroundColor}\n            onChange={setLightBackgroundColor}\n          />\n\n          <ColorInput\n            label={_('Link Color')}\n            value={lightPrimaryColor}\n            onChange={setLightPrimaryColor}\n          />\n\n          <ThemePreview\n            textColor={lightTextColor}\n            backgroundColor={lightBackgroundColor}\n            primaryColor={lightPrimaryColor}\n            label={_('Preview')}\n          />\n        </div>\n\n        <div className='bg-base-300 rounded-lg p-3'>\n          <h3 className='mb-3 text-center font-medium'>{_('Dark Mode')}</h3>\n\n          <ColorInput label={_('Text Color')} value={darkTextColor} onChange={setDarkTextColor} />\n\n          <ColorInput\n            label={_('Background Color')}\n            value={darkBackgroundColor}\n            onChange={setDarkBackgroundColor}\n          />\n\n          <ColorInput\n            label={_('Link Color')}\n            value={darkPrimaryColor}\n            onChange={setDarkPrimaryColor}\n          />\n\n          <ThemePreview\n            textColor={darkTextColor}\n            backgroundColor={darkBackgroundColor}\n            primaryColor={darkPrimaryColor}\n            label={_('Preview')}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ThemeEditor;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3491, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/ThemeModeSelector.tsx"],"sourcesContent":["import React from 'react';\nimport { MdOutlineLightMode, MdOutlineDarkMode } from 'react-icons/md';\nimport { TbSunMoon } from 'react-icons/tb';\nimport { useTranslation } from '@/hooks/useTranslation';\n\ninterface ThemeModeSelectorProps {\n  themeMode: 'auto' | 'light' | 'dark';\n  onThemeModeChange: (mode: 'auto' | 'light' | 'dark') => void;\n}\n\nconst ThemeModeSelector: React.FC<ThemeModeSelectorProps> = ({ themeMode, onThemeModeChange }) => {\n  const _ = useTranslation();\n\n  return (\n    <div className='flex items-center justify-between'>\n      <h2 className='font-medium'>{_('Theme Mode')}</h2>\n      <div className='flex gap-4'>\n        <button\n          title={_('Auto Mode')}\n          className={`btn btn-ghost btn-circle btn-sm ${themeMode === 'auto' ? 'btn-active bg-base-300' : ''}`}\n          onClick={() => onThemeModeChange('auto')}\n        >\n          <TbSunMoon />\n        </button>\n        <button\n          title={_('Light Mode')}\n          className={`btn btn-ghost btn-circle btn-sm ${themeMode === 'light' ? 'btn-active bg-base-300' : ''}`}\n          onClick={() => onThemeModeChange('light')}\n        >\n          <MdOutlineLightMode />\n        </button>\n        <button\n          title={_('Dark Mode')}\n          className={`btn btn-ghost btn-circle btn-sm ${themeMode === 'dark' ? 'btn-active bg-base-300' : ''}`}\n          onClick={() => onThemeModeChange('dark')}\n        >\n          <MdOutlineDarkMode />\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default ThemeModeSelector;\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;;AAOA,MAAM,oBAAsD,CAAC,EAAE,SAAS,EAAE,iBAAiB,EAAE;;IAC3F,MAAM,IAAI,IAAA,6KAAc;IAExB,qBACE,+VAAC;QAAI,WAAU;;0BACb,+VAAC;gBAAG,WAAU;0BAAe,EAAE;;;;;;0BAC/B,+VAAC;gBAAI,WAAU;;kCACb,+VAAC;wBACC,OAAO,EAAE;wBACT,WAAW,CAAC,gCAAgC,EAAE,cAAc,SAAS,2BAA2B,IAAI;wBACpG,SAAS,IAAM,kBAAkB;kCAEjC,cAAA,+VAAC,+OAAS;;;;;;;;;;kCAEZ,+VAAC;wBACC,OAAO,EAAE;wBACT,WAAW,CAAC,gCAAgC,EAAE,cAAc,UAAU,2BAA2B,IAAI;wBACrG,SAAS,IAAM,kBAAkB;kCAEjC,cAAA,+VAAC,wPAAkB;;;;;;;;;;kCAErB,+VAAC;wBACC,OAAO,EAAE;wBACT,WAAW,CAAC,gCAAgC,EAAE,cAAc,SAAS,2BAA2B,IAAI;wBACpG,SAAS,IAAM,kBAAkB;kCAEjC,cAAA,+VAAC,uPAAiB;;;;;;;;;;;;;;;;;;;;;;AAK5B;GA/BM;;QACM,6KAAc;;;KADpB;uCAiCS"}},
    {"offset": {"line": 3592, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/ThemeColorSelector.tsx"],"sourcesContent":["import React from 'react';\nimport { CgColorPicker } from 'react-icons/cg';\nimport { MdRadioButtonUnchecked, MdRadioButtonChecked } from 'react-icons/md';\nimport { PiPlus } from 'react-icons/pi';\nimport { Theme } from '@/styles/themes';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\n\ninterface ThemeColorSelectorProps {\n  themes: Theme[];\n  themeColor: string;\n  isDarkMode: boolean;\n  onThemeColorChange: (name: string) => void;\n  onEditTheme: (name: string) => void;\n  onCreateTheme: () => void;\n}\n\nconst ThemeColorSelector: React.FC<ThemeColorSelectorProps> = ({\n  themes,\n  themeColor,\n  isDarkMode,\n  onThemeColorChange,\n  onEditTheme,\n  onCreateTheme,\n}) => {\n  const _ = useTranslation();\n  const iconSize16 = useResponsiveSize(16);\n  const iconSize24 = useResponsiveSize(24);\n\n  return (\n    <div>\n      <h2 className='mb-2 font-medium'>{_('Theme Color')}</h2>\n      <div className='grid grid-cols-3 gap-4'>\n        {themes.map(({ name, label, colors, isCustomizale }) => (\n          <button\n            key={name}\n            tabIndex={0}\n            onClick={() => onThemeColorChange(name)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' || e.key === ' ') {\n                onThemeColorChange(name);\n              }\n              e.stopPropagation();\n            }}\n            className={`relative flex cursor-pointer flex-col items-center justify-center rounded-lg px-2 py-4 shadow-md ${\n              themeColor === name ? 'ring-2 ring-indigo-500 ring-offset-2' : ''\n            }`}\n            style={{\n              backgroundColor: isDarkMode ? colors.dark['base-100'] : colors.light['base-100'],\n              color: isDarkMode ? colors.dark['base-content'] : colors.light['base-content'],\n            }}\n          >\n            <input\n              aria-label={_(label)}\n              type='radio'\n              name='theme'\n              value={name}\n              checked={themeColor === name}\n              onChange={() => onThemeColorChange(name)}\n              className='hidden'\n            />\n            {themeColor === name ? (\n              <MdRadioButtonChecked size={iconSize24} />\n            ) : (\n              <MdRadioButtonUnchecked size={iconSize24} />\n            )}\n            <span className='max-w-full truncate'>{_(label)}</span>\n            {isCustomizale && themeColor === name && (\n              <button onClick={() => onEditTheme(name)}>\n                <CgColorPicker size={iconSize16} className='absolute right-2 top-2' />\n              </button>\n            )}\n          </button>\n        ))}\n        <button\n          className='relative flex cursor-pointer flex-col items-center justify-center rounded-lg border border-dashed px-2 py-4 shadow-md'\n          onClick={onCreateTheme}\n        >\n          <PiPlus size={iconSize24} />\n          <span className='max-w-full truncate'>{_('Custom')}</span>\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default ThemeColorSelector;\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAEA;AACA;;;;;;;;AAWA,MAAM,qBAAwD,CAAC,EAC7D,MAAM,EACN,UAAU,EACV,UAAU,EACV,kBAAkB,EAClB,WAAW,EACX,aAAa,EACd;;IACC,MAAM,IAAI,IAAA,6KAAc;IACxB,MAAM,aAAa,IAAA,mLAAiB,EAAC;IACrC,MAAM,aAAa,IAAA,mLAAiB,EAAC;IAErC,qBACE,+VAAC;;0BACC,+VAAC;gBAAG,WAAU;0BAAoB,EAAE;;;;;;0BACpC,+VAAC;gBAAI,WAAU;;oBACZ,OAAO,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,aAAa,EAAE,iBACjD,+VAAC;4BAEC,UAAU;4BACV,SAAS,IAAM,mBAAmB;4BAClC,WAAW,CAAC;gCACV,IAAI,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK;oCACtC,mBAAmB;gCACrB;gCACA,EAAE,eAAe;4BACnB;4BACA,WAAW,CAAC,iGAAiG,EAC3G,eAAe,OAAO,yCAAyC,IAC/D;4BACF,OAAO;gCACL,iBAAiB,aAAa,OAAO,IAAI,CAAC,WAAW,GAAG,OAAO,KAAK,CAAC,WAAW;gCAChF,OAAO,aAAa,OAAO,IAAI,CAAC,eAAe,GAAG,OAAO,KAAK,CAAC,eAAe;4BAChF;;8CAEA,+VAAC;oCACC,cAAY,EAAE;oCACd,MAAK;oCACL,MAAK;oCACL,OAAO;oCACP,SAAS,eAAe;oCACxB,UAAU,IAAM,mBAAmB;oCACnC,WAAU;;;;;;gCAEX,eAAe,qBACd,+VAAC,0PAAoB;oCAAC,MAAM;;;;;6FAE5B,+VAAC,4PAAsB;oCAAC,MAAM;;;;;;8CAEhC,+VAAC;oCAAK,WAAU;8CAAuB,EAAE;;;;;;gCACxC,iBAAiB,eAAe,sBAC/B,+VAAC;oCAAO,SAAS,IAAM,YAAY;8CACjC,cAAA,+VAAC,mPAAa;wCAAC,MAAM;wCAAY,WAAU;;;;;;;;;;;;2BAlC1C;;;;;kCAuCT,+VAAC;wBACC,WAAU;wBACV,SAAS;;0CAET,+VAAC,4OAAM;gCAAC,MAAM;;;;;;0CACd,+VAAC;gCAAK,WAAU;0CAAuB,EAAE;;;;;;;;;;;;;;;;;;;;;;;;AAKnD;GAnEM;;QAQM,6KAAc;QACL,mLAAiB;QACjB,mLAAiB;;;KAVhC;uCAqES"}},
    {"offset": {"line": 3753, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/BackgroundTextureSelector.tsx"],"sourcesContent":["import React from 'react';\nimport { MdRadioButtonChecked, MdClose, MdAdd } from 'react-icons/md';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\nimport Select from '@/components/Select';\n\ninterface Texture {\n  id: string;\n  url?: string;\n  blobUrl?: string;\n  loaded?: boolean;\n}\n\ninterface BackgroundTextureSelectorProps {\n  predefinedTextures: Texture[];\n  customTextures: Texture[];\n  selectedTextureId: string;\n  backgroundOpacity: number;\n  backgroundSize: string;\n  onTextureSelect: (id: string) => void;\n  onOpacityChange: (opacity: number) => void;\n  onSizeChange: (size: string) => void;\n  onImportImage: () => void;\n  onDeleteTexture: (id: string) => void;\n}\n\nconst BackgroundTextureSelector: React.FC<BackgroundTextureSelectorProps> = ({\n  predefinedTextures,\n  customTextures,\n  selectedTextureId,\n  backgroundOpacity,\n  backgroundSize,\n  onTextureSelect,\n  onOpacityChange,\n  onSizeChange,\n  onImportImage,\n  onDeleteTexture,\n}) => {\n  const _ = useTranslation();\n  const iconSize24 = useResponsiveSize(24);\n\n  const allTextures = [...predefinedTextures, ...customTextures];\n\n  return (\n    <div>\n      <h2 className='mb-2 font-medium'>{_('Background Image')}</h2>\n      <div className='mb-4 grid grid-cols-2 gap-4'>\n        {allTextures.map((texture) => (\n          <button\n            key={texture.id}\n            onClick={() => onTextureSelect(texture.id)}\n            className={`bg-base-100 relative flex flex-col items-center justify-center rounded-lg border-2 p-4 shadow-md transition-all ${\n              selectedTextureId === texture.id\n                ? 'ring-2 ring-indigo-500 ring-offset-2'\n                : 'border-base-300'\n            }`}\n            style={{\n              backgroundImage: texture.loaded ? `url(\"${texture.blobUrl || texture.url}\")` : 'none',\n              backgroundSize: 'cover',\n              backgroundPosition: 'top',\n              minHeight: '80px',\n            }}\n          >\n            {selectedTextureId === texture.id && (\n              <MdRadioButtonChecked\n                size={iconSize24}\n                className='absolute right-2 top-2 rounded-full bg-white text-indigo-500'\n              />\n            )}\n            {!predefinedTextures.find((t) => t.id === texture.id) && (\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onDeleteTexture(texture.id);\n                }}\n                className='absolute left-2 top-2 rounded-full bg-red-500 p-1 text-white transition-colors hover:bg-red-600'\n                title={_('Delete')}\n              >\n                <MdClose size={16} />\n              </button>\n            )}\n          </button>\n        ))}\n\n        {/* Custom Image Upload */}\n        <div\n          className='border-base-300 relative flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed p-4 shadow-md transition-all'\n          style={{ minHeight: '80px' }}\n        >\n          <button\n            className='card-body flex cursor-pointer items-center justify-center p-2 text-center'\n            onClick={onImportImage}\n          >\n            <div className='flex items-center gap-2'>\n              <div className='flex items-center justify-center'>\n                <MdAdd className='text-primary/85 group-hover:text-primary h-6 w-6' />\n              </div>\n              <div className='text-primary/85 group-hover:text-primary line-clamp-1 font-medium'>\n                {_('Import Image')}\n              </div>\n            </div>\n          </button>\n        </div>\n      </div>\n\n      {/* Background Image Settings */}\n      {selectedTextureId !== 'none' && (\n        <div className='card border-base-200 bg-base-100 space-y-4 border p-4 shadow'>\n          <div className='flex items-center justify-between'>\n            <span className='text-sm font-medium'>{_('Opacity')}</span>\n            <div className='flex items-center gap-2'>\n              <input\n                type='range'\n                min='0'\n                max='1'\n                step='0.05'\n                value={backgroundOpacity}\n                onChange={(e) => onOpacityChange(parseFloat(e.target.value))}\n                className='range range-sm w-32'\n              />\n              <span className='w-12 text-right text-sm'>\n                {Math.round(backgroundOpacity * 100)}%\n              </span>\n            </div>\n          </div>\n\n          <div className='flex items-center justify-between'>\n            <span className='text-sm font-medium'>{_('Size')}</span>\n            <Select\n              value={backgroundSize}\n              onChange={(e) => onSizeChange(e.target.value)}\n              options={[\n                { value: 'auto', label: _('Auto') },\n                { value: 'cover', label: _('Cover') },\n                { value: 'contain', label: _('Contain') },\n              ]}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default BackgroundTextureSelector;\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;;AAsBA,MAAM,4BAAsE,CAAC,EAC3E,kBAAkB,EAClB,cAAc,EACd,iBAAiB,EACjB,iBAAiB,EACjB,cAAc,EACd,eAAe,EACf,eAAe,EACf,YAAY,EACZ,aAAa,EACb,eAAe,EAChB;;IACC,MAAM,IAAI,IAAA,6KAAc;IACxB,MAAM,aAAa,IAAA,mLAAiB,EAAC;IAErC,MAAM,cAAc;WAAI;WAAuB;KAAe;IAE9D,qBACE,+VAAC;;0BACC,+VAAC;gBAAG,WAAU;0BAAoB,EAAE;;;;;;0BACpC,+VAAC;gBAAI,WAAU;;oBACZ,YAAY,GAAG,CAAC,CAAC,wBAChB,+VAAC;4BAEC,SAAS,IAAM,gBAAgB,QAAQ,EAAE;4BACzC,WAAW,CAAC,gHAAgH,EAC1H,sBAAsB,QAAQ,EAAE,GAC5B,yCACA,mBACJ;4BACF,OAAO;gCACL,iBAAiB,QAAQ,MAAM,GAAG,CAAC,KAAK,EAAE,QAAQ,OAAO,IAAI,QAAQ,GAAG,CAAC,EAAE,CAAC,GAAG;gCAC/E,gBAAgB;gCAChB,oBAAoB;gCACpB,WAAW;4BACb;;gCAEC,sBAAsB,QAAQ,EAAE,kBAC/B,+VAAC,0PAAoB;oCACnB,MAAM;oCACN,WAAU;;;;;;gCAGb,CAAC,mBAAmB,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,QAAQ,EAAE,mBAClD,+VAAC;oCACC,SAAS,CAAC;wCACR,EAAE,eAAe;wCACjB,gBAAgB,QAAQ,EAAE;oCAC5B;oCACA,WAAU;oCACV,OAAO,EAAE;8CAET,cAAA,+VAAC,6OAAO;wCAAC,MAAM;;;;;;;;;;;;2BA7Bd,QAAQ,EAAE;;;;;kCAoCnB,+VAAC;wBACC,WAAU;wBACV,OAAO;4BAAE,WAAW;wBAAO;kCAE3B,cAAA,+VAAC;4BACC,WAAU;4BACV,SAAS;sCAET,cAAA,+VAAC;gCAAI,WAAU;;kDACb,+VAAC;wCAAI,WAAU;kDACb,cAAA,+VAAC,2OAAK;4CAAC,WAAU;;;;;;;;;;;kDAEnB,+VAAC;wCAAI,WAAU;kDACZ,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAQZ,sBAAsB,wBACrB,+VAAC;gBAAI,WAAU;;kCACb,+VAAC;wBAAI,WAAU;;0CACb,+VAAC;gCAAK,WAAU;0CAAuB,EAAE;;;;;;0CACzC,+VAAC;gCAAI,WAAU;;kDACb,+VAAC;wCACC,MAAK;wCACL,KAAI;wCACJ,KAAI;wCACJ,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC,IAAM,gBAAgB,WAAW,EAAE,MAAM,CAAC,KAAK;wCAC1D,WAAU;;;;;;kDAEZ,+VAAC;wCAAK,WAAU;;4CACb,KAAK,KAAK,CAAC,oBAAoB;4CAAK;;;;;;;;;;;;;;;;;;;kCAK3C,+VAAC;wBAAI,WAAU;;0CACb,+VAAC;gCAAK,WAAU;0CAAuB,EAAE;;;;;;0CACzC,+VAAC,oKAAM;gCACL,OAAO;gCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;gCAC5C,SAAS;oCACP;wCAAE,OAAO;wCAAQ,OAAO,EAAE;oCAAQ;oCAClC;wCAAE,OAAO;wCAAS,OAAO,EAAE;oCAAS;oCACpC;wCAAE,OAAO;wCAAW,OAAO,EAAE;oCAAW;iCACzC;;;;;;;;;;;;;;;;;;;;;;;;AAOf;GApHM;;QAYM,6KAAc;QACL,mLAAiB;;;KAbhC;uCAsHS"}},
    {"offset": {"line": 4009, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/HighlightColorsEditor.tsx"],"sourcesContent":["import React from 'react';\nimport { HighlightColor } from '@/types/book';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport ColorInput from './ColorInput';\n\ninterface HighlightColorsEditorProps {\n  customHighlightColors: Record<HighlightColor, string>;\n  onChange: (colors: Record<HighlightColor, string>) => void;\n}\n\nconst HighlightColorsEditor: React.FC<HighlightColorsEditorProps> = ({\n  customHighlightColors,\n  onChange,\n}) => {\n  const _ = useTranslation();\n\n  const handleColorChange = (color: HighlightColor, value: string) => {\n    const updated = { ...customHighlightColors, [color]: value };\n    onChange(updated);\n  };\n\n  return (\n    <div>\n      <h2 className='mb-2 font-medium'>{_('Highlight Colors')}</h2>\n      <div className='card border-base-200 bg-base-100 overflow-visible border p-4 shadow'>\n        <div className='grid grid-cols-3 gap-3 sm:grid-cols-5'>\n          {(['red', 'violet', 'blue', 'green', 'yellow'] as HighlightColor[]).map(\n            (color, index, array) => {\n              const position =\n                index === 0 ? 'left' : index === array.length - 1 ? 'right' : 'center';\n              return (\n                <div key={color} className='flex flex-col items-center gap-2'>\n                  <div\n                    className='border-base-300 h-8 w-8 rounded-full border-2 shadow-sm'\n                    style={{ backgroundColor: customHighlightColors[color] }}\n                  />\n                  <ColorInput\n                    label=''\n                    value={customHighlightColors[color]}\n                    compact={true}\n                    pickerPosition={position}\n                    onChange={(value: string) => handleColorChange(color, value)}\n                  />\n                </div>\n              );\n            },\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default HighlightColorsEditor;\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAOA,MAAM,wBAA8D,CAAC,EACnE,qBAAqB,EACrB,QAAQ,EACT;;IACC,MAAM,IAAI,IAAA,6KAAc;IAExB,MAAM,oBAAoB,CAAC,OAAuB;QAChD,MAAM,UAAU;YAAE,GAAG,qBAAqB;YAAE,CAAC,MAAM,EAAE;QAAM;QAC3D,SAAS;IACX;IAEA,qBACE,+VAAC;;0BACC,+VAAC;gBAAG,WAAU;0BAAoB,EAAE;;;;;;0BACpC,+VAAC;gBAAI,WAAU;0BACb,cAAA,+VAAC;oBAAI,WAAU;8BACZ,AAAC;wBAAC;wBAAO;wBAAU;wBAAQ;wBAAS;qBAAS,CAAsB,GAAG,CACrE,CAAC,OAAO,OAAO;wBACb,MAAM,WACJ,UAAU,IAAI,SAAS,UAAU,MAAM,MAAM,GAAG,IAAI,UAAU;wBAChE,qBACE,+VAAC;4BAAgB,WAAU;;8CACzB,+VAAC;oCACC,WAAU;oCACV,OAAO;wCAAE,iBAAiB,qBAAqB,CAAC,MAAM;oCAAC;;;;;;8CAEzD,+VAAC,6LAAU;oCACT,OAAM;oCACN,OAAO,qBAAqB,CAAC,MAAM;oCACnC,SAAS;oCACT,gBAAgB;oCAChB,UAAU,CAAC,QAAkB,kBAAkB,OAAO;;;;;;;2BAVhD;;;;;oBAcd;;;;;;;;;;;;;;;;;AAMZ;GAzCM;;QAIM,6KAAc;;;KAJpB;uCA2CS"}},
    {"offset": {"line": 4116, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/TTSHighlightStyleEditor.tsx"],"sourcesContent":["import React from 'react';\nimport { MdClose } from 'react-icons/md';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport Select from '@/components/Select';\nimport ColorInput from './ColorInput';\n\nexport type TTSHighlightStyle =\n  | 'highlight'\n  | 'underline'\n  | 'strikethrough'\n  | 'squiggly'\n  | 'outline';\n\ninterface TTSHighlightStyleEditorProps {\n  style: TTSHighlightStyle;\n  color: string;\n  customColors: string[];\n  onStyleChange: (style: TTSHighlightStyle) => void;\n  onColorChange: (color: string) => void;\n  onCustomColorsChange: (colors: string[]) => void;\n}\n\nconst TTSHighlightStyleEditor: React.FC<TTSHighlightStyleEditorProps> = ({\n  style,\n  color,\n  customColors,\n  onStyleChange,\n  onColorChange,\n  onCustomColorsChange,\n}) => {\n  const _ = useTranslation();\n\n  const defaultQuickColors = [\n    { color: '#FFD700', label: 'Gold' },\n    { color: '#00CED1', label: 'Cyan' },\n    { color: '#FF69B4', label: 'Pink' },\n    { color: '#90EE90', label: 'Green' },\n    { color: '#FFA500', label: 'Orange' },\n  ];\n\n  const handleAddCustomColor = () => {\n    if (!customColors.includes(color) && !defaultQuickColors.some((c) => c.color === color)) {\n      const updatedColors = [...customColors, color];\n      onCustomColorsChange(updatedColors);\n    }\n  };\n\n  const handleDeleteCustomColor = (colorToDelete: string) => {\n    const updatedColors = customColors.filter((c) => c !== colorToDelete);\n    onCustomColorsChange(updatedColors);\n  };\n\n  return (\n    <div className='w-full'>\n      <h2 className='mb-2 font-medium'>{_('TTS Highlighting')}</h2>\n      <div className='card border-base-200 bg-base-100 border p-4 shadow'>\n        <div className='space-y-4'>\n          <div className='flex items-center justify-between'>\n            <span className='text-sm font-medium'>{_('Style')}</span>\n            <Select\n              value={style}\n              onChange={(e) => onStyleChange(e.target.value as TTSHighlightStyle)}\n              options={[\n                { value: 'highlight', label: _('Highlighter') },\n                { value: 'underline', label: _('Underline') },\n                { value: 'strikethrough', label: _('Strikethrough') },\n                { value: 'squiggly', label: _('Squiggly') },\n                { value: 'outline', label: _('Outline') },\n              ]}\n            />\n          </div>\n\n          <div className='flex items-center justify-between'>\n            <span className='text-sm font-medium'>{_('Color')}</span>\n            <div className='flex items-center gap-2'>\n              <div\n                className='border-base-300 pointer-events-none h-8 w-8 cursor-pointer rounded-full border-2 shadow-sm'\n                style={{ backgroundColor: color }}\n              />\n              <ColorInput\n                label=''\n                value={color}\n                compact={true}\n                pickerPosition='center'\n                onChange={onColorChange}\n              />\n              <button\n                onClick={handleAddCustomColor}\n                disabled={\n                  customColors.includes(color) || defaultQuickColors.some((c) => c.color === color)\n                }\n                className='btn btn-ghost btn-sm gap-1 bg-transparent disabled:bg-transparent'\n                title={_('Save Current Color')}\n              >\n                <span className='text-xs'>{_('Save')}</span>\n              </button>\n            </div>\n          </div>\n\n          <div className='border-base-200 flex justify-between border-t pt-4'>\n            <div className='flex items-center'>\n              <span className='text-sm font-medium'>{_('Quick Colors')}</span>\n            </div>\n\n            <div className='flex max-w-[70%] flex-wrap justify-end gap-2'>\n              {defaultQuickColors.map(({ color: quickColor }) => (\n                <button\n                  key={quickColor}\n                  onClick={() => onColorChange(quickColor)}\n                  className={`h-8 w-8 rounded-full border-2 transition-all hover:scale-110 ${\n                    color === quickColor\n                      ? 'ring-2 ring-indigo-500 ring-offset-2'\n                      : 'border-base-300'\n                  }`}\n                  style={{ backgroundColor: quickColor }}\n                />\n              ))}\n\n              {customColors.map((customColor) => (\n                <div key={customColor} className='group relative'>\n                  <button\n                    onClick={() => onColorChange(customColor)}\n                    className={`h-8 w-8 rounded-full border-2 transition-all hover:scale-110 ${\n                      color === customColor\n                        ? 'ring-2 ring-indigo-500 ring-offset-2'\n                        : 'border-base-300'\n                    }`}\n                    style={{ backgroundColor: customColor }}\n                  />\n                  <button\n                    onClick={() => handleDeleteCustomColor(customColor)}\n                    className='absolute -right-1 -top-1 rounded-full bg-red-500 p-0.5 text-white opacity-0 transition-opacity hover:opacity-100 group-hover:opacity-100'\n                    title={_('Delete')}\n                  >\n                    <MdClose size={12} />\n                  </button>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TTSHighlightStyleEditor;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4411, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/color/CodeHighlightingSettings.tsx"],"sourcesContent":["import React from 'react';\nimport { CODE_LANGUAGES, CodeLanguage } from '@/utils/highlightjs';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport Select from '@/components/Select';\n\ninterface CodeHighlightingSettingsProps {\n  codeHighlighting: boolean;\n  codeLanguage: string;\n  onToggle: (enabled: boolean) => void;\n  onLanguageChange: (language: CodeLanguage) => void;\n}\n\nconst CodeHighlightingSettings: React.FC<CodeHighlightingSettingsProps> = ({\n  codeHighlighting,\n  codeLanguage,\n  onToggle,\n  onLanguageChange,\n}) => {\n  const _ = useTranslation();\n\n  return (\n    <div className='w-full'>\n      <h2 className='mb-2 font-medium'>{_('Code Highlighting')}</h2>\n      <div className='card border-base-200 bg-base-100 border shadow'>\n        <div className='divide-base-200'>\n          <div className='config-item'>\n            <span>{_('Enable Highlighting')}</span>\n            <input\n              type='checkbox'\n              className='toggle'\n              checked={codeHighlighting}\n              onChange={() => onToggle(!codeHighlighting)}\n            />\n          </div>\n\n          <div className='config-item'>\n            <span>{_('Code Language')}</span>\n            <Select\n              value={codeLanguage}\n              onChange={(event) => onLanguageChange(event.target.value as CodeLanguage)}\n              options={CODE_LANGUAGES.map((lang) => ({\n                value: lang,\n                label: lang === 'auto-detect' ? _('Auto') : lang,\n              }))}\n              disabled={!codeHighlighting}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CodeHighlightingSettings;\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;;AASA,MAAM,2BAAoE,CAAC,EACzE,gBAAgB,EAChB,YAAY,EACZ,QAAQ,EACR,gBAAgB,EACjB;;IACC,MAAM,IAAI,IAAA,6KAAc;IAExB,qBACE,+VAAC;QAAI,WAAU;;0BACb,+VAAC;gBAAG,WAAU;0BAAoB,EAAE;;;;;;0BACpC,+VAAC;gBAAI,WAAU;0BACb,cAAA,+VAAC;oBAAI,WAAU;;sCACb,+VAAC;4BAAI,WAAU;;8CACb,+VAAC;8CAAM,EAAE;;;;;;8CACT,+VAAC;oCACC,MAAK;oCACL,WAAU;oCACV,SAAS;oCACT,UAAU,IAAM,SAAS,CAAC;;;;;;;;;;;;sCAI9B,+VAAC;4BAAI,WAAU;;8CACb,+VAAC;8CAAM,EAAE;;;;;;8CACT,+VAAC,oKAAM;oCACL,OAAO;oCACP,UAAU,CAAC,QAAU,iBAAiB,MAAM,MAAM,CAAC,KAAK;oCACxD,SAAS,0KAAc,CAAC,GAAG,CAAC,CAAC,OAAS,CAAC;4CACrC,OAAO;4CACP,OAAO,SAAS,gBAAgB,EAAE,UAAU;wCAC9C,CAAC;oCACD,UAAU,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOzB;GAvCM;;QAMM,6KAAc;;;KANpB;uCAyCS"}},
    {"offset": {"line": 4532, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/ColorPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  applyCustomTheme,\n  CustomTheme,\n  generateDarkPalette,\n  generateLightPalette,\n  Theme,\n  themes,\n} from '@/styles/themes';\nimport { useEnv } from '@/context/EnvContext';\nimport { useThemeStore } from '@/store/themeStore';\nimport { useReaderStore } from '@/store/readerStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useResetViewSettings } from '@/hooks/useResetSettings';\nimport { useCustomTextureStore } from '@/store/customTextureStore';\nimport { saveViewSettings } from '@/helpers/settings';\nimport { manageSyntaxHighlighting } from '@/utils/highlightjs';\nimport { SettingsPanelPanelProp } from './SettingsDialog';\nimport { useFileSelector } from '@/hooks/useFileSelector';\nimport { PREDEFINED_TEXTURES } from '@/styles/textures';\nimport { HIGHLIGHT_COLOR_HEX } from '@/services/constants';\nimport ThemeEditor from './color/ThemeEditor';\nimport ThemeModeSelector from './color/ThemeModeSelector';\nimport ThemeColorSelector from './color/ThemeColorSelector';\nimport BackgroundTextureSelector from './color/BackgroundTextureSelector';\nimport HighlightColorsEditor from './color/HighlightColorsEditor';\nimport TTSHighlightStyleEditor, { TTSHighlightStyle } from './color/TTSHighlightStyleEditor';\nimport CodeHighlightingSettings from './color/CodeHighlightingSettings';\n\nconst ColorPanel: React.FC<SettingsPanelPanelProp> = ({ bookKey, onRegisterReset }) => {\n  const _ = useTranslation();\n  const { themeMode, themeColor, isDarkMode, setThemeMode, setThemeColor, saveCustomTheme } =\n    useThemeStore();\n  const { envConfig, appService } = useEnv();\n  const { settings, setSettings, saveSettings } = useSettingsStore();\n  const { getView, getViewSettings } = useReaderStore();\n  const viewSettings = getViewSettings(bookKey) || settings.globalViewSettings;\n\n  const [invertImgColorInDark, setInvertImgColorInDark] = useState(\n    viewSettings.invertImgColorInDark,\n  );\n  const [editTheme, setEditTheme] = useState<CustomTheme | null>(null);\n  const [customThemes, setCustomThemes] = useState<Theme[]>([]);\n  const [showCustomThemeEditor, setShowCustomThemeEditor] = useState(false);\n  const [overrideColor, setOverrideColor] = useState(viewSettings.overrideColor);\n  const [codeHighlighting, setcodeHighlighting] = useState(viewSettings.codeHighlighting);\n  const [codeLanguage, setCodeLanguage] = useState(viewSettings.codeLanguage);\n  const [selectedTextureId, setSelectedTextureId] = useState(viewSettings.backgroundTextureId);\n  const [backgroundOpacity, setBackgroundOpacity] = useState(viewSettings.backgroundOpacity);\n  const [backgroundSize, setBackgroundSize] = useState(viewSettings.backgroundSize);\n  const [ttsHighlightStyle, setTtsHighlightStyle] = useState(\n    viewSettings.ttsHighlightOptions.style,\n  );\n  const [ttsHighlightColor, setTtsHighlightColor] = useState(\n    viewSettings.ttsHighlightOptions.color,\n  );\n  const [customHighlightColors, setCustomHighlightColors] = useState(\n    settings.globalReadSettings.customHighlightColors,\n  );\n  const [customTtsHighlightColors, setCustomTtsHighlightColors] = useState(\n    settings.globalReadSettings.customTtsHighlightColors || [],\n  );\n\n  const {\n    textures: customTextures,\n    addTexture,\n    loadTexture,\n    applyTexture,\n    removeTexture,\n    loadCustomTextures,\n    saveCustomTextures,\n  } = useCustomTextureStore();\n  const resetToDefaults = useResetViewSettings();\n  const { selectFiles } = useFileSelector(appService, _);\n\n  const handleReset = () => {\n    resetToDefaults({\n      overrideColor: setOverrideColor,\n      invertImgColorInDark: setInvertImgColorInDark,\n      codeHighlighting: setcodeHighlighting,\n      codeLanguage: setCodeLanguage,\n    });\n    setThemeColor('default');\n    setThemeMode('auto');\n    setSelectedTextureId('none');\n    setBackgroundOpacity(0.6);\n    setBackgroundSize('cover');\n    setCustomHighlightColors(HIGHLIGHT_COLOR_HEX);\n  };\n\n  useEffect(() => {\n    onRegisterReset(handleReset);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    loadCustomTextures(envConfig);\n  }, [loadCustomTextures, envConfig]);\n\n  useEffect(() => {\n    if (invertImgColorInDark === viewSettings.invertImgColorInDark) return;\n    saveViewSettings(envConfig, bookKey, 'invertImgColorInDark', invertImgColorInDark);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [invertImgColorInDark]);\n\n  useEffect(() => {\n    if (overrideColor === viewSettings.overrideColor) return;\n    saveViewSettings(envConfig, bookKey, 'overrideColor', overrideColor);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [overrideColor]);\n\n  useEffect(() => {\n    let update = false;\n    if (codeHighlighting !== viewSettings.codeHighlighting) {\n      saveViewSettings(envConfig, bookKey, 'codeHighlighting', codeHighlighting);\n      update = true;\n    }\n    if (codeLanguage !== viewSettings.codeLanguage) {\n      saveViewSettings(envConfig, bookKey, 'codeLanguage', codeLanguage);\n      update = true;\n    }\n    if (!update) return;\n    const view = getView(bookKey);\n    if (!view) return;\n    const docs = view.renderer.getContents();\n    docs.forEach(({ doc }) => manageSyntaxHighlighting(doc, viewSettings));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [codeHighlighting, codeLanguage]);\n\n  useEffect(() => {\n    if (selectedTextureId === viewSettings.backgroundTextureId) return;\n    saveViewSettings(envConfig, bookKey, 'backgroundTextureId', selectedTextureId);\n    applyBackgroundTexture();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedTextureId]);\n\n  useEffect(() => {\n    if (backgroundOpacity === viewSettings.backgroundOpacity) return;\n    saveViewSettings(envConfig, bookKey, 'backgroundOpacity', backgroundOpacity);\n    applyBackgroundTexture();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [backgroundOpacity]);\n\n  useEffect(() => {\n    if (backgroundSize === viewSettings.backgroundSize) return;\n    saveViewSettings(envConfig, bookKey, 'backgroundSize', backgroundSize);\n    applyBackgroundTexture();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [backgroundSize]);\n\n  const applyBackgroundTexture = () => {\n    applyTexture(envConfig, selectedTextureId);\n    document.documentElement.style.setProperty('--bg-texture-opacity', `${backgroundOpacity}`);\n    document.documentElement.style.setProperty('--bg-texture-size', backgroundSize);\n  };\n\n  useEffect(() => {\n    const customThemes = settings.globalReadSettings.customThemes ?? [];\n    setCustomThemes(\n      customThemes.map((customTheme) => ({\n        name: customTheme.name,\n        label: customTheme.label,\n        colors: {\n          light: generateLightPalette(customTheme.colors.light),\n          dark: generateDarkPalette(customTheme.colors.dark),\n        },\n        isCustomizale: true,\n      })),\n    );\n  }, [settings]);\n\n  const handleSaveCustomTheme = (customTheme: CustomTheme) => {\n    applyCustomTheme(customTheme);\n    saveCustomTheme(envConfig, settings, customTheme);\n    setSettings({ ...settings });\n    setThemeColor(customTheme.name);\n    setShowCustomThemeEditor(false);\n  };\n\n  const handleDeleteCustomTheme = (customTheme: CustomTheme) => {\n    saveCustomTheme(envConfig, settings, customTheme, true);\n    setSettings({ ...settings });\n    setThemeColor('default');\n    setShowCustomThemeEditor(false);\n  };\n\n  const handleEditTheme = (name: string) => {\n    const customTheme = settings.globalReadSettings.customThemes.find((t) => t.name === name);\n    if (customTheme) {\n      setEditTheme(customTheme);\n      setShowCustomThemeEditor(true);\n    }\n  };\n\n  const handleImportImage = () => {\n    selectFiles({ type: 'images', multiple: true }).then(async (result) => {\n      if (result.error || result.files.length === 0) return;\n      for (const selectedFile of result.files) {\n        const textureInfo = await appService?.importImage(selectedFile.path || selectedFile.file);\n        if (!textureInfo) continue;\n\n        const customTexture = addTexture(textureInfo.path);\n        console.log('Added custom texture:', customTexture);\n        if (customTexture && !customTexture.error) {\n          await loadTexture(envConfig, customTexture.id);\n        }\n      }\n      saveCustomTextures(envConfig);\n    });\n  };\n\n  const handleDeleteCustomTexture = (textureId: string) => {\n    removeTexture(textureId);\n    const updatedTextures = customTextures.filter((t) => t.id !== textureId);\n\n    settings.customTextures = updatedTextures;\n    setSettings(settings);\n\n    if (selectedTextureId === textureId) {\n      setSelectedTextureId('none');\n    }\n    saveCustomTextures(envConfig);\n  };\n\n  const handleHighlightColorsChange = (colors: typeof customHighlightColors) => {\n    setCustomHighlightColors(colors);\n    settings.globalReadSettings.customHighlightColors = colors;\n    setSettings(settings);\n    saveSettings(envConfig, settings);\n  };\n\n  const handleTTSStyleChange = (style: TTSHighlightStyle) => {\n    setTtsHighlightStyle(style);\n    saveViewSettings(envConfig, bookKey, 'ttsHighlightOptions', {\n      style,\n      color: ttsHighlightColor,\n    });\n  };\n\n  const handleTTSColorChange = (color: string) => {\n    setTtsHighlightColor(color);\n    saveViewSettings(envConfig, bookKey, 'ttsHighlightOptions', {\n      style: ttsHighlightStyle,\n      color,\n    });\n  };\n\n  const handleCustomTtsColorsChange = (colors: string[]) => {\n    setCustomTtsHighlightColors(colors);\n    settings.globalReadSettings.customTtsHighlightColors = colors;\n    setSettings(settings);\n    saveSettings(envConfig, settings);\n  };\n\n  return (\n    <div className='my-4 w-full space-y-6'>\n      {showCustomThemeEditor ? (\n        <ThemeEditor\n          customTheme={editTheme}\n          onSave={handleSaveCustomTheme}\n          onDelete={handleDeleteCustomTheme}\n          onCancel={() => setShowCustomThemeEditor(false)}\n        />\n      ) : (\n        <>\n          <ThemeModeSelector themeMode={themeMode} onThemeModeChange={setThemeMode} />\n\n          <div className='flex items-center justify-between'>\n            <h2 className='font-medium'>{_('Invert Image In Dark Mode')}</h2>\n            <input\n              type='checkbox'\n              className='toggle'\n              checked={invertImgColorInDark}\n              disabled={!isDarkMode}\n              onChange={() => setInvertImgColorInDark(!invertImgColorInDark)}\n            />\n          </div>\n\n          <div className='flex items-center justify-between'>\n            <h2 className='font-medium'>{_('Override Book Color')}</h2>\n            <input\n              type='checkbox'\n              className='toggle'\n              checked={overrideColor}\n              onChange={() => setOverrideColor(!overrideColor)}\n            />\n          </div>\n\n          <ThemeColorSelector\n            themes={themes.concat(customThemes)}\n            themeColor={themeColor}\n            isDarkMode={isDarkMode}\n            onThemeColorChange={setThemeColor}\n            onEditTheme={handleEditTheme}\n            onCreateTheme={() => setShowCustomThemeEditor(true)}\n          />\n\n          <BackgroundTextureSelector\n            predefinedTextures={PREDEFINED_TEXTURES}\n            customTextures={customTextures.filter((t) => !t.deletedAt)}\n            selectedTextureId={selectedTextureId}\n            backgroundOpacity={backgroundOpacity}\n            backgroundSize={backgroundSize}\n            onTextureSelect={setSelectedTextureId}\n            onOpacityChange={setBackgroundOpacity}\n            onSizeChange={setBackgroundSize}\n            onImportImage={handleImportImage}\n            onDeleteTexture={handleDeleteCustomTexture}\n          />\n\n          <HighlightColorsEditor\n            customHighlightColors={customHighlightColors}\n            onChange={handleHighlightColorsChange}\n          />\n\n          <TTSHighlightStyleEditor\n            style={ttsHighlightStyle}\n            color={ttsHighlightColor}\n            customColors={customTtsHighlightColors}\n            onStyleChange={handleTTSStyleChange}\n            onColorChange={handleTTSColorChange}\n            onCustomColorsChange={handleCustomTtsColorsChange}\n          />\n\n          <CodeHighlightingSettings\n            codeHighlighting={codeHighlighting}\n            codeLanguage={codeLanguage}\n            onToggle={setcodeHighlighting}\n            onLanguageChange={setCodeLanguage}\n          />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default ColorPanel;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4973, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/DialogMenu.tsx"],"sourcesContent":["import clsx from 'clsx';\nimport React from 'react';\nimport { MdCheck } from 'react-icons/md';\nimport { useEnv } from '@/context/EnvContext';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useCustomFontStore } from '@/store/customFontStore';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\nimport { SettingsPanelType } from './SettingsDialog';\nimport MenuItem from '@/components/MenuItem';\n\ninterface DialogMenuProps {\n  activePanel: SettingsPanelType;\n  setIsDropdownOpen?: (open: boolean) => void;\n  onReset: () => void;\n  resetLabel?: string;\n}\n\nconst DialogMenu: React.FC<DialogMenuProps> = ({\n  activePanel,\n  setIsDropdownOpen,\n  onReset,\n  resetLabel,\n}) => {\n  const _ = useTranslation();\n  const { envConfig, appService } = useEnv();\n  const iconSize = useResponsiveSize(16);\n  const { setFontPanelView, isSettingsGlobal, setSettingsGlobal } = useSettingsStore();\n  const { getAllFonts, removeFont, saveCustomFonts } = useCustomFontStore();\n\n  const handleToggleGlobal = () => {\n    setSettingsGlobal(!isSettingsGlobal);\n    setIsDropdownOpen?.(false);\n  };\n\n  const handleResetToDefaults = () => {\n    onReset();\n    setIsDropdownOpen?.(false);\n  };\n\n  const handleManageCustomFont = () => {\n    setFontPanelView('custom-fonts');\n    setIsDropdownOpen?.(false);\n  };\n\n  const handleClearCustomFont = () => {\n    getAllFonts().forEach((font) => {\n      if (removeFont(font.id)) {\n        appService!.deleteFont(font);\n      }\n    });\n    saveCustomFonts(envConfig);\n    setIsDropdownOpen?.(false);\n  };\n\n  return (\n    <div\n      className={clsx(\n        'dropdown-content dropdown-right no-triangle border-base-200 z-20 mt-1 border shadow-2xl',\n        'text-base sm:text-sm',\n      )}\n    >\n      <MenuItem\n        label={_('Global Settings')}\n        tooltip={isSettingsGlobal ? _('Apply to All Books') : _('Apply to This Book')}\n        buttonClass='lg:tooltip'\n        Icon={isSettingsGlobal ? <MdCheck size={iconSize} className='text-base-content' /> : null}\n        onClick={handleToggleGlobal}\n      />\n      <MenuItem label={resetLabel || _('Reset Settings')} onClick={handleResetToDefaults} />\n      {activePanel === 'Font' && (\n        <>\n          <MenuItem label={_('Clear Custom Fonts')} onClick={handleClearCustomFont} />\n          <MenuItem label={_('Manage Custom Fonts')} onClick={handleManageCustomFont} />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default DialogMenu;\n"],"names":[],"mappings":";;;;;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;AASA,MAAM,aAAwC,CAAC,EAC7C,WAAW,EACX,iBAAiB,EACjB,OAAO,EACP,UAAU,EACX;;IACC,MAAM,IAAI,IAAA,6KAAc;IACxB,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,IAAA,oKAAM;IACxC,MAAM,WAAW,IAAA,mLAAiB,EAAC;IACnC,MAAM,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,GAAG,IAAA,8KAAgB;IAClF,MAAM,EAAE,WAAW,EAAE,UAAU,EAAE,eAAe,EAAE,GAAG,IAAA,kLAAkB;IAEvE,MAAM,qBAAqB;QACzB,kBAAkB,CAAC;QACnB,oBAAoB;IACtB;IAEA,MAAM,wBAAwB;QAC5B;QACA,oBAAoB;IACtB;IAEA,MAAM,yBAAyB;QAC7B,iBAAiB;QACjB,oBAAoB;IACtB;IAEA,MAAM,wBAAwB;QAC5B,cAAc,OAAO,CAAC,CAAC;YACrB,IAAI,WAAW,KAAK,EAAE,GAAG;gBACvB,WAAY,UAAU,CAAC;YACzB;QACF;QACA,gBAAgB;QAChB,oBAAoB;IACtB;IAEA,qBACE,+VAAC;QACC,WAAW,IAAA,oMAAI,EACb,2FACA;;0BAGF,+VAAC,sKAAQ;gBACP,OAAO,EAAE;gBACT,SAAS,mBAAmB,EAAE,wBAAwB,EAAE;gBACxD,aAAY;gBACZ,MAAM,iCAAmB,+VAAC,6OAAO;oBAAC,MAAM;oBAAU,WAAU;;;;;6BAAyB;gBACrF,SAAS;;;;;;0BAEX,+VAAC,sKAAQ;gBAAC,OAAO,cAAc,EAAE;gBAAmB,SAAS;;;;;;YAC5D,gBAAgB,wBACf;;kCACE,+VAAC,sKAAQ;wBAAC,OAAO,EAAE;wBAAuB,SAAS;;;;;;kCACnD,+VAAC,sKAAQ;wBAAC,OAAO,EAAE;wBAAwB,SAAS;;;;;;;;;;;;;;AAK9D;GA5DM;;QAMM,6KAAc;QACU,oKAAM;QACvB,mLAAiB;QACgC,8KAAgB;QAC7B,kLAAkB;;;KAVnE;uCA8DS"}},
    {"offset": {"line": 5100, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/ControlPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { useEnv } from '@/context/EnvContext';\nimport { useReaderStore } from '@/store/readerStore';\nimport { useDeviceControlStore } from '@/store/deviceStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useBookDataStore } from '@/store/bookDataStore';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useResetViewSettings } from '@/hooks/useResetSettings';\nimport { useEinkMode } from '@/hooks/useEinkMode';\nimport { getStyles } from '@/utils/style';\nimport { getMaxInlineSize } from '@/utils/config';\nimport { saveSysSettings, saveViewSettings } from '@/helpers/settings';\nimport { SettingsPanelPanelProp } from './SettingsDialog';\nimport { annotationToolQuickActions } from '@/app/reader/components/annotator/AnnotationTools';\nimport NumberInput from './NumberInput';\nimport Select from '../Select';\n\nconst ControlPanel: React.FC<SettingsPanelPanelProp> = ({ bookKey, onRegisterReset }) => {\n  const _ = useTranslation();\n  const { envConfig, appService } = useEnv();\n  const { getView, getViewSettings, recreateViewer } = useReaderStore();\n  const { getBookData } = useBookDataStore();\n  const { settings } = useSettingsStore();\n  const { applyEinkMode } = useEinkMode();\n  const { acquireVolumeKeyInterception, releaseVolumeKeyInterception } = useDeviceControlStore();\n  const bookData = getBookData(bookKey);\n  const viewSettings = getViewSettings(bookKey) || settings.globalViewSettings;\n\n  const [isScrolledMode, setScrolledMode] = useState(viewSettings.scrolled);\n  const [isContinuousScroll, setIsContinuousScroll] = useState(viewSettings.continuousScroll);\n  const [scrollingOverlap, setScrollingOverlap] = useState(viewSettings.scrollingOverlap);\n  const [volumeKeysToFlip, setVolumeKeysToFlip] = useState(viewSettings.volumeKeysToFlip);\n  const [isDisableClick, setIsDisableClick] = useState(viewSettings.disableClick);\n  const [fullscreenClickArea, setFullscreenClickArea] = useState(viewSettings.fullscreenClickArea);\n  const [swapClickArea, setSwapClickArea] = useState(viewSettings.swapClickArea);\n  const [isDisableDoubleClick, setIsDisableDoubleClick] = useState(viewSettings.disableDoubleClick);\n  const [enableAnnotationQuickActions, setEnableAnnotationQuickActions] = useState(\n    viewSettings.enableAnnotationQuickActions,\n  );\n  const [annotationQuickAction, setAnnotationQuickAction] = useState(\n    viewSettings.annotationQuickAction,\n  );\n  const [copyToNotebook, setCopyToNotebook] = useState(viewSettings.copyToNotebook);\n  const [animated, setAnimated] = useState(viewSettings.animated);\n  const [isEink, setIsEink] = useState(viewSettings.isEink);\n  const [autoScreenBrightness, setAutoScreenBrightness] = useState(settings.autoScreenBrightness);\n  const [allowScript, setAllowScript] = useState(viewSettings.allowScript);\n\n  const resetToDefaults = useResetViewSettings();\n\n  const handleReset = () => {\n    resetToDefaults({\n      scrolled: setScrolledMode,\n      continuousScroll: setIsContinuousScroll,\n      scrollingOverlap: setScrollingOverlap,\n      volumeKeysToFlip: setVolumeKeysToFlip,\n      disableClick: setIsDisableClick,\n      swapClickArea: setSwapClickArea,\n      animated: setAnimated,\n      isEink: setIsEink,\n      allowScript: setAllowScript,\n      fullscreenClickArea: setFullscreenClickArea,\n      disableDoubleClick: setIsDisableDoubleClick,\n      enableAnnotationQuickActions: setEnableAnnotationQuickActions,\n      copyToNotebook: setCopyToNotebook,\n    });\n  };\n\n  useEffect(() => {\n    onRegisterReset(handleReset);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (isScrolledMode === viewSettings.scrolled) return;\n    saveViewSettings(envConfig, bookKey, 'scrolled', isScrolledMode);\n    getView(bookKey)?.renderer.setAttribute('flow', isScrolledMode ? 'scrolled' : 'paginated');\n    getView(bookKey)?.renderer.setAttribute(\n      'max-inline-size',\n      `${getMaxInlineSize(viewSettings)}px`,\n    );\n    getView(bookKey)?.renderer.setStyles?.(getStyles(viewSettings!));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isScrolledMode]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'continuousScroll', isContinuousScroll, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isContinuousScroll]);\n\n  useEffect(() => {\n    if (scrollingOverlap === viewSettings.scrollingOverlap) return;\n    saveViewSettings(envConfig, bookKey, 'scrollingOverlap', scrollingOverlap, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [scrollingOverlap]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'volumeKeysToFlip', volumeKeysToFlip, false, false);\n    if (appService?.isMobileApp) {\n      if (volumeKeysToFlip) {\n        acquireVolumeKeyInterception();\n      } else {\n        releaseVolumeKeyInterception();\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [volumeKeysToFlip]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'disableClick', isDisableClick, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isDisableClick]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'disableDoubleClick', isDisableDoubleClick, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isDisableDoubleClick]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'fullscreenClickArea', fullscreenClickArea, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fullscreenClickArea]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'swapClickArea', swapClickArea, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [swapClickArea]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'animated', animated, false, false);\n    if (animated) {\n      getView(bookKey)?.renderer.setAttribute('animated', '');\n    } else {\n      getView(bookKey)?.renderer.removeAttribute('animated');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [animated]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'isEink', isEink);\n    if (isEink) {\n      getView(bookKey)?.renderer.setAttribute('eink', '');\n    } else {\n      getView(bookKey)?.renderer.removeAttribute('eink');\n    }\n    applyEinkMode(isEink);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isEink]);\n\n  useEffect(() => {\n    if (autoScreenBrightness === settings.autoScreenBrightness) return;\n    saveSysSettings(envConfig, 'autoScreenBrightness', autoScreenBrightness);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [autoScreenBrightness]);\n\n  useEffect(() => {\n    if (viewSettings.allowScript === allowScript) return;\n    saveViewSettings(envConfig, bookKey, 'allowScript', allowScript, true, false).then(() => {\n      recreateViewer(envConfig, bookKey);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [allowScript]);\n\n  useEffect(() => {\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      'enableAnnotationQuickActions',\n      enableAnnotationQuickActions,\n      false,\n      false,\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [enableAnnotationQuickActions]);\n\n  useEffect(() => {\n    saveViewSettings(envConfig, bookKey, 'copyToNotebook', copyToNotebook, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [copyToNotebook]);\n\n  const getQuickActionOptions = () => {\n    return [\n      {\n        value: '',\n        label: _('None'),\n      },\n      ...annotationToolQuickActions.map((button) => ({\n        value: button.type,\n        label: _(button.label),\n      })),\n    ];\n  };\n\n  const handleSelectAnnotationQuickAction = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const action = event.target.value as typeof annotationQuickAction;\n    setAnnotationQuickAction(action);\n    saveViewSettings(envConfig, bookKey, 'annotationQuickAction', action, false, true);\n  };\n\n  return (\n    <div className='my-4 w-full space-y-6'>\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Scroll')}</h2>\n        <div className='card border-base-200 bg-base-100 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <div className='config-item'>\n              <span className=''>{_('Scrolled Mode')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={isScrolledMode}\n                disabled={bookData?.isFixedLayout}\n                onChange={() => setScrolledMode(!isScrolledMode)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Continuous Scroll')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={isContinuousScroll}\n                disabled={bookData?.isFixedLayout}\n                onChange={() => setIsContinuousScroll(!isContinuousScroll)}\n              />\n            </div>\n            <NumberInput\n              label={_('Overlap Pixels')}\n              value={scrollingOverlap}\n              onChange={setScrollingOverlap}\n              disabled={!viewSettings.scrolled}\n              min={0}\n              max={200}\n              step={10}\n            />\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Pagination')}</h2>\n        <div className='card border-base-200 bg-base-100 border shadow'>\n          <div className='divide-base-200'>\n            <div className='config-item'>\n              <span className=''>\n                {appService?.isMobileApp ? _('Tap to Paginate') : _('Click to Paginate')}\n              </span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={!isDisableClick}\n                onChange={() => setIsDisableClick(!isDisableClick)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>\n                {appService?.isMobileApp ? _('Tap Both Sides') : _('Click Both Sides')}\n              </span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={fullscreenClickArea}\n                disabled={isDisableClick}\n                onChange={() => setFullscreenClickArea(!fullscreenClickArea)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>\n                {appService?.isMobileApp ? _('Swap Tap Sides') : _('Swap Click Sides')}\n              </span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={swapClickArea}\n                disabled={isDisableClick || fullscreenClickArea}\n                onChange={() => setSwapClickArea(!swapClickArea)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>\n                {appService?.isMobileApp ? _('Disable Double Tap') : _('Disable Double Click')}\n              </span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={isDisableDoubleClick}\n                onChange={() => setIsDisableDoubleClick(!isDisableDoubleClick)}\n              />\n            </div>\n            {appService?.isMobileApp && (\n              <div className='config-item'>\n                <span className=''>{_('Volume Keys for Page Flip')}</span>\n                <input\n                  type='checkbox'\n                  className='toggle'\n                  checked={volumeKeysToFlip}\n                  onChange={() => setVolumeKeysToFlip(!volumeKeysToFlip)}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Annotation Tools')}</h2>\n        <div className='card border-base-200 bg-base-100 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <div className='config-item'>\n              <span className=''>{_('Enable Quick Actions')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={enableAnnotationQuickActions}\n                onChange={() => setEnableAnnotationQuickActions(!enableAnnotationQuickActions)}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Quick Action')}</span>\n              <Select\n                value={annotationQuickAction || ''}\n                onChange={handleSelectAnnotationQuickAction}\n                options={getQuickActionOptions()}\n                disabled={!enableAnnotationQuickActions}\n              />\n            </div>\n            <div className='config-item'>\n              <span className=''>{_('Copy to Notebook')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={copyToNotebook}\n                onChange={() => setCopyToNotebook(!copyToNotebook)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Animation')}</h2>\n        <div className='card border-base-200 bg-base-100 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <div className='config-item'>\n              <span className=''>{_('Paging Animation')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={animated}\n                onChange={() => setAnimated(!animated)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {(appService?.isMobileApp || appService?.appPlatform === 'web') && (\n        <div className='w-full'>\n          <h2 className='mb-2 font-medium'>{_('Device')}</h2>\n          <div className='card border-base-200 bg-base-100 border shadow'>\n            <div className='divide-base-200 divide-y'>\n              {(appService?.isAndroidApp || appService?.appPlatform === 'web') && (\n                <div className='config-item'>\n                  <span className=''>{_('E-Ink Mode')}</span>\n                  <input\n                    type='checkbox'\n                    className='toggle'\n                    checked={isEink}\n                    onChange={() => setIsEink(!isEink)}\n                  />\n                </div>\n              )}\n              {appService?.isMobileApp && (\n                <div className='config-item'>\n                  <span className=''>{_('Auto Screen Brightness')}</span>\n                  <input\n                    type='checkbox'\n                    className='toggle'\n                    checked={autoScreenBrightness}\n                    onChange={() => setAutoScreenBrightness(!autoScreenBrightness)}\n                  />\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Security')}</h2>\n        <div className='card border-base-200 bg-base-100 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <div className='config-item !h-16'>\n              <div className='flex flex-col gap-1'>\n                <span className=''>{_('Allow JavaScript')}</span>\n                <span className='text-xs'>{_('Enable only if you trust the file.')}</span>\n              </div>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={allowScript}\n                disabled={bookData?.book?.format !== 'EPUB'}\n                onChange={() => setAllowScript(!allowScript)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ControlPanel;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5986, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/LangPanel.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useEffect, useState } from 'react';\nimport { useEnv } from '@/context/EnvContext';\nimport { useAuth } from '@/context/AuthContext';\nimport { useReaderStore } from '@/store/readerStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { saveViewSettings } from '@/helpers/settings';\nimport { getTranslators } from '@/services/translators';\nimport { useResetViewSettings } from '@/hooks/useResetSettings';\nimport { TRANSLATED_LANGS, TRANSLATOR_LANGS } from '@/services/constants';\nimport { ConvertChineseVariant } from '@/types/book';\nimport { SettingsPanelPanelProp } from './SettingsDialog';\nimport { isCJKEnv } from '@/utils/misc';\nimport Select from '@/components/Select';\n\nconst LangPanel: React.FC<SettingsPanelPanelProp> = ({ bookKey, onRegisterReset }) => {\n  const _ = useTranslation();\n  const { token } = useAuth();\n  const { envConfig } = useEnv();\n  const { settings, applyUILanguage } = useSettingsStore();\n  const { getView, getViewSettings, setViewSettings, recreateViewer } = useReaderStore();\n  const view = getView(bookKey);\n  const viewSettings = getViewSettings(bookKey) || settings.globalViewSettings;\n\n  const [uiLanguage, setUILanguage] = useState(viewSettings.uiLanguage);\n  const [translationEnabled, setTranslationEnabled] = useState(viewSettings.translationEnabled);\n  const [translationProvider, setTranslationProvider] = useState(viewSettings.translationProvider);\n  const [translateTargetLang, setTranslateTargetLang] = useState(viewSettings.translateTargetLang);\n  const [showTranslateSource, setShowTranslateSource] = useState(viewSettings.showTranslateSource);\n  const [ttsReadAloudText, setTtsReadAloudText] = useState(viewSettings.ttsReadAloudText);\n  const [replaceQuotationMarks, setReplaceQuotationMarks] = useState(\n    viewSettings.replaceQuotationMarks,\n  );\n  const [convertChineseVariant, setConvertChineseVariant] = useState(\n    viewSettings.convertChineseVariant,\n  );\n\n  const resetToDefaults = useResetViewSettings();\n\n  const handleReset = () => {\n    resetToDefaults({\n      uiLanguage: setUILanguage,\n      translationEnabled: setTranslationEnabled,\n      translationProvider: setTranslationProvider,\n      translateTargetLang: setTranslateTargetLang,\n      showTranslateSource: setShowTranslateSource,\n      ttsReadAloudText: setTtsReadAloudText,\n      replaceQuotationMarks: setReplaceQuotationMarks,\n    });\n  };\n\n  useEffect(() => {\n    onRegisterReset(handleReset);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const getCurrentUILangOption = () => {\n    const uiLanguage = viewSettings.uiLanguage;\n    return {\n      value: uiLanguage,\n      label:\n        uiLanguage === ''\n          ? _('Auto')\n          : TRANSLATED_LANGS[uiLanguage as keyof typeof TRANSLATED_LANGS],\n    };\n  };\n\n  const getLangOptions = (langs: Record<string, string>) => {\n    const options = Object.entries(langs).map(([value, label]) => ({ value, label }));\n    options.sort((a, b) => a.label.localeCompare(b.label));\n    options.unshift({ value: '', label: _('System Language') });\n    return options;\n  };\n\n  const handleSelectUILang = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const option = event.target.value;\n    setUILanguage(option);\n  };\n\n  const getTranslationProviderOptions = () => {\n    const translators = getTranslators();\n    const availableProviders = translators.map((t) => {\n      let label = t.label;\n      if (t.authRequired && !token) {\n        label = `${label} (${_('Login Required')})`;\n      } else if (t.quotaExceeded) {\n        label = `${label} (${_('Quota Exceeded')})`;\n      }\n      return { value: t.name, label };\n    });\n    return availableProviders;\n  };\n\n  const getCurrentTranslationProviderOption = () => {\n    const value = translationProvider;\n    const allProviders = getTranslationProviderOptions();\n    const availableTranslators = getTranslators().filter(\n      (t) => (t.authRequired ? !!token : true) && !t.quotaExceeded,\n    );\n    const currentProvider = availableTranslators.find((t) => t.name === value)\n      ? value\n      : availableTranslators[0]?.name;\n    return allProviders.find((p) => p.value === currentProvider) || allProviders[0]!;\n  };\n\n  const handleSelectTranslationProvider = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const option = event.target.value;\n    setTranslationProvider(option);\n    saveViewSettings(envConfig, bookKey, 'translationProvider', option, false, false);\n    viewSettings.translationProvider = option;\n    setViewSettings(bookKey, { ...viewSettings });\n  };\n\n  const getCurrentTargetLangOption = () => {\n    const value = translateTargetLang;\n    const availableOptions = getLangOptions(TRANSLATOR_LANGS);\n    return availableOptions.find((o) => o.value === value) || availableOptions[0]!;\n  };\n\n  const handleSelectTargetLang = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const option = event.target.value;\n    setTranslateTargetLang(option);\n    saveViewSettings(envConfig, bookKey, 'translateTargetLang', option, false, false);\n    viewSettings.translateTargetLang = option;\n    setViewSettings(bookKey, { ...viewSettings });\n  };\n\n  const handleSelectTTSText = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const option = event.target.value;\n    setTtsReadAloudText(option);\n    saveViewSettings(envConfig, bookKey, 'ttsReadAloudText', option, false, false);\n  };\n\n  const getTTSTextOptions = () => {\n    return [\n      { value: 'both', label: _('Source and Translated') },\n      { value: 'translated', label: _('Translated Only') },\n      { value: 'source', label: _('Source Only') },\n    ];\n  };\n\n  useEffect(() => {\n    if (uiLanguage === viewSettings.uiLanguage) return;\n    saveViewSettings(envConfig, bookKey, 'uiLanguage', uiLanguage, false, false);\n    applyUILanguage(uiLanguage);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [uiLanguage]);\n\n  useEffect(() => {\n    if (translationEnabled === viewSettings.translationEnabled) return;\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      'translationEnabled',\n      translationEnabled,\n      true,\n      false,\n    ).then(() => {\n      if (!showTranslateSource && translationEnabled) {\n        recreateViewer(envConfig, bookKey);\n      }\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [translationEnabled]);\n\n  useEffect(() => {\n    if (showTranslateSource === viewSettings.showTranslateSource) return;\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      'showTranslateSource',\n      showTranslateSource,\n      false,\n      false,\n    ).then(() => {\n      recreateViewer(envConfig, bookKey);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [showTranslateSource]);\n\n  useEffect(() => {\n    if (ttsReadAloudText === viewSettings.ttsReadAloudText) return;\n    saveViewSettings(envConfig, bookKey, 'ttsReadAloudText', ttsReadAloudText, false, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ttsReadAloudText]);\n\n  useEffect(() => {\n    if (replaceQuotationMarks === viewSettings.replaceQuotationMarks) return;\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      'replaceQuotationMarks',\n      replaceQuotationMarks,\n      false,\n      false,\n    ).then(() => {\n      recreateViewer(envConfig, bookKey);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [replaceQuotationMarks]);\n\n  const getConvertModeOptions: () => { value: ConvertChineseVariant; label: string }[] = () => {\n    return [\n      { value: 'none', label: _('No Conversion') },\n      { value: 's2t', label: _('Simplified to Traditional') },\n      { value: 't2s', label: _('Traditional to Simplified') },\n      { value: 's2tw', label: _('Simplified to Traditional (Taiwan)') },\n      { value: 's2hk', label: _('Simplified to Traditional (Hong Kong)') },\n      { value: 's2twp', label: _('Simplified to Traditional (Taiwan), with phrases') },\n      { value: 'tw2s', label: _('Traditional (Taiwan) to Simplified') },\n      { value: 'hk2s', label: _('Traditional (Hong Kong) to Simplified') },\n      { value: 'tw2sp', label: _('Traditional (Taiwan) to Simplified, with phrases') },\n    ];\n  };\n\n  const getConvertModeOption = () => {\n    const value = convertChineseVariant;\n    const availableOptions = getConvertModeOptions();\n    return availableOptions.find((o) => o.value === value) || availableOptions[0]!;\n  };\n\n  const handleSelectConvertMode = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const option = event.target.value as ConvertChineseVariant;\n    setConvertChineseVariant(option);\n  };\n\n  useEffect(() => {\n    if (convertChineseVariant === viewSettings.convertChineseVariant) return;\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      'convertChineseVariant',\n      convertChineseVariant,\n      false,\n      false,\n    ).then(() => {\n      recreateViewer(envConfig, bookKey);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [convertChineseVariant]);\n\n  return (\n    <div className={clsx('my-4 w-full space-y-6')}>\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Language')}</h2>\n        <div className='card border-base-200 bg-base-100 border shadow'>\n          <div className='divide-base-200 divide-y'>\n            <div className='config-item'>\n              <span className=''>{_('Interface Language')}</span>\n              <Select\n                value={getCurrentUILangOption().value}\n                onChange={handleSelectUILang}\n                options={getLangOptions(TRANSLATED_LANGS)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className='w-full'>\n        <h2 className='mb-2 font-medium'>{_('Translation')}</h2>\n        <div className='card border-base-200 bg-base-100 border shadow'>\n          <div className='divide-base-200'>\n            <div className='config-item'>\n              <span className=''>{_('Enable Translation')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={translationEnabled}\n                onChange={() => setTranslationEnabled(!translationEnabled)}\n                disabled={!bookKey}\n              />\n            </div>\n\n            <div className='config-item'>\n              <span className=''>{_('Show Source Text')}</span>\n              <input\n                type='checkbox'\n                className='toggle'\n                checked={showTranslateSource}\n                onChange={() => setShowTranslateSource(!showTranslateSource)}\n              />\n            </div>\n\n            <div className='config-item'>\n              <span className=''>{_('TTS Text')}</span>\n              <Select\n                value={ttsReadAloudText}\n                onChange={handleSelectTTSText}\n                options={getTTSTextOptions()}\n              />\n            </div>\n\n            <div className='config-item'>\n              <span className=''>{_('Translation Service')}</span>\n              <Select\n                value={getCurrentTranslationProviderOption().value}\n                onChange={handleSelectTranslationProvider}\n                options={getTranslationProviderOptions()}\n              />\n            </div>\n\n            <div className='config-item'>\n              <span className=''>{_('Translate To')}</span>\n              <Select\n                value={getCurrentTargetLangOption().value}\n                onChange={handleSelectTargetLang}\n                options={getLangOptions(TRANSLATOR_LANGS)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {(isCJKEnv() || view?.language.isCJK) && (\n        <div className='w-full'>\n          <h2 className='mb-2 font-medium'>{_('Punctuation')}</h2>\n          <div className='card border-base-200 bg-base-100 border shadow'>\n            <div className='divide-base-200'>\n              <div className='config-item !h-16'>\n                <div className='flex flex-col gap-1'>\n                  <span className=''>{_('Replace Quotation Marks')}</span>\n                  <span className='text-xs'>{_('Enabled only in vertical layout.')}</span>\n                </div>\n                <input\n                  type='checkbox'\n                  className='toggle'\n                  checked={replaceQuotationMarks}\n                  onChange={() => setReplaceQuotationMarks(!replaceQuotationMarks)}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {(isCJKEnv() || view?.language.isCJK) && (\n        <div className='w-full'>\n          <h2 className='mb-2 font-medium'>{_('Convert Simplified and Traditional Chinese')}</h2>\n          <div className='card border-base-200 bg-base-100 border shadow'>\n            <div className='divide-base-200'>\n              <div className='config-item'>\n                <span className=''>{_('Convert Mode')}</span>\n                <Select\n                  value={getConvertModeOption().value}\n                  onChange={handleSelectConvertMode}\n                  options={getConvertModeOptions()}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LangPanel;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6654, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/MiscPanel.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useEffect, useRef, useState } from 'react';\n\nimport { useEnv } from '@/context/EnvContext';\nimport { useReaderStore } from '@/store/readerStore';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { useResetViewSettings } from '@/hooks/useResetSettings';\nimport { SettingsPanelPanelProp } from './SettingsDialog';\nimport { saveViewSettings } from '@/helpers/settings';\nimport { validateCSS, formatCSS } from '@/utils/css';\nimport { getStyles } from '@/utils/style';\n\ntype CSSType = 'book' | 'reader';\n\nconst MiscPanel: React.FC<SettingsPanelPanelProp> = ({ bookKey, onRegisterReset }) => {\n  const _ = useTranslation();\n  const { appService, envConfig } = useEnv();\n  const { settings, isSettingsGlobal, setSettings } = useSettingsStore();\n  const { getView, getViewSettings, setViewSettings } = useReaderStore();\n  const viewSettings = getViewSettings(bookKey) || settings.globalViewSettings;\n\n  const [draftContentStylesheet, setDraftContentStylesheet] = useState(viewSettings.userStylesheet);\n  const [draftContentStylesheetSaved, setDraftContentStylesheetSaved] = useState(true);\n  const [contentError, setContentError] = useState<string | null>(null);\n  const [draftUIStylesheet, setDraftUIStylesheet] = useState(viewSettings.userUIStylesheet);\n  const [draftUIStylesheetSaved, setDraftUIStylesheetSaved] = useState(true);\n  const [uiError, setUIError] = useState<string | null>(null);\n\n  const [inputFocusInAndroid, setInputFocusInAndroid] = useState(false);\n  const contentTextareaRef = useRef<HTMLTextAreaElement | null>(null);\n  const uiTextareaRef = useRef<HTMLTextAreaElement | null>(null);\n\n  const resetToDefaults = useResetViewSettings();\n\n  const handleReset = () => {\n    resetToDefaults({\n      userStylesheet: setDraftContentStylesheet,\n      userUIStylesheet: setDraftUIStylesheet,\n    });\n    applyStyles('book', true);\n    applyStyles('reader', true);\n  };\n\n  useEffect(() => {\n    onRegisterReset(handleReset);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleValidateCSS = (cssInput: string): { isValid: boolean; error?: string } => {\n    if (!cssInput.trim()) return { isValid: true };\n\n    try {\n      const { isValid, error } = validateCSS(cssInput);\n      if (!isValid) {\n        return { isValid: false, error: error || 'Invalid CSS' };\n      }\n      return { isValid: true };\n    } catch (err: unknown) {\n      if (err instanceof Error) {\n        return { isValid: false, error: err.message };\n      }\n      return { isValid: false, error: 'Invalid CSS: Please check your input.' };\n    }\n  };\n\n  const handleStylesheetChange = (e: React.ChangeEvent<HTMLTextAreaElement>, type: CSSType) => {\n    const cssInput = e.target.value;\n\n    if (type === 'book') {\n      setDraftContentStylesheet(cssInput);\n      setDraftContentStylesheetSaved(false);\n\n      const { isValid, error } = handleValidateCSS(cssInput);\n      setContentError(isValid ? null : error || 'Invalid CSS');\n    } else {\n      setDraftUIStylesheet(cssInput);\n      setDraftUIStylesheetSaved(false);\n\n      const { isValid, error } = handleValidateCSS(cssInput);\n      setUIError(isValid ? null : error || 'Invalid CSS');\n    }\n  };\n\n  const applyStyles = (type: CSSType, clear = false) => {\n    const cssInput = type === 'book' ? draftContentStylesheet : draftUIStylesheet;\n    const formattedCSS = formatCSS(clear ? '' : cssInput);\n\n    if (type === 'book') {\n      setDraftContentStylesheet(formattedCSS);\n      setDraftContentStylesheetSaved(true);\n      viewSettings.userStylesheet = formattedCSS;\n\n      if (isSettingsGlobal) {\n        settings.globalViewSettings.userStylesheet = formattedCSS;\n        setSettings(settings);\n      }\n    } else {\n      setDraftUIStylesheet(formattedCSS);\n      setDraftUIStylesheetSaved(true);\n      viewSettings.userUIStylesheet = formattedCSS;\n\n      if (isSettingsGlobal) {\n        settings.globalViewSettings.userUIStylesheet = formattedCSS;\n        setSettings(settings);\n      }\n    }\n\n    setViewSettings(bookKey, { ...viewSettings });\n    getView(bookKey)?.renderer.setStyles?.(getStyles(viewSettings));\n    saveViewSettings(\n      envConfig,\n      bookKey,\n      type === 'book' ? 'userStylesheet' : 'userUIStylesheet',\n      formattedCSS,\n      false,\n      false,\n    );\n  };\n\n  const handleInput = (e: React.FormEvent<HTMLTextAreaElement>) => {\n    e.stopPropagation();\n    e.nativeEvent.stopImmediatePropagation();\n  };\n\n  const handleInputFocus = (textareaRef: React.RefObject<HTMLTextAreaElement>) => {\n    if (appService?.isAndroidApp) {\n      setInputFocusInAndroid(true);\n    }\n    setTimeout(() => {\n      textareaRef.current?.scrollIntoView({\n        behavior: 'instant',\n        block: 'center',\n      });\n    }, 300);\n  };\n\n  const handleInputBlur = () => {\n    if (appService?.isAndroidApp) {\n      setTimeout(() => {\n        setInputFocusInAndroid(false);\n      }, 100);\n    }\n  };\n\n  const renderCSSEditor = (\n    type: CSSType,\n    title: string,\n    placeholder: string,\n    value: string,\n    error: string | null,\n    saved: boolean,\n    textareaRef: React.RefObject<HTMLTextAreaElement>,\n  ) => (\n    <div className='w-full'>\n      <h2 className='mb-2 font-medium' aria-label={_(title)}>\n        {_(title)}\n      </h2>\n      <div\n        className={`card border-base-200 bg-base-100 border shadow ${error ? 'border-red-500' : ''}`}\n      >\n        <div className='relative p-1'>\n          <textarea\n            ref={textareaRef}\n            className={clsx(\n              'textarea textarea-ghost h-48 w-full border-0 p-3 text-base !outline-none sm:text-sm',\n              'placeholder:text-base-content/70',\n            )}\n            placeholder={_(placeholder)}\n            spellCheck='false'\n            value={value}\n            onFocus={() => handleInputFocus(textareaRef)}\n            onBlur={handleInputBlur}\n            onInput={handleInput}\n            onKeyDown={handleInput}\n            onKeyUp={handleInput}\n            onChange={(e) => handleStylesheetChange(e, type)}\n          />\n          <button\n            className={clsx(\n              'btn btn-ghost bg-base-200 absolute bottom-2 right-4 h-8 min-h-8 px-4 py-2',\n              saved ? 'hidden' : '',\n              error ? 'btn-disabled' : '',\n            )}\n            onClick={() => applyStyles(type)}\n            disabled={!!error}\n          >\n            {_('Apply')}\n          </button>\n        </div>\n      </div>\n      {error && <p className='mt-1 text-sm text-red-500'>{error}</p>}\n    </div>\n  );\n\n  return (\n    <div\n      className={clsx(\n        'my-4 w-full space-y-6',\n        inputFocusInAndroid && 'h-[50%] overflow-y-auto pb-[200px]',\n      )}\n    >\n      {renderCSSEditor(\n        'book',\n        _('Custom Content CSS'),\n        _('Enter CSS for book content styling...'),\n        draftContentStylesheet,\n        contentError,\n        draftContentStylesheetSaved,\n        contentTextareaRef,\n      )}\n\n      {renderCSSEditor(\n        'reader',\n        _('Custom Reader UI CSS'),\n        _('Enter CSS for reader interface styling...'),\n        draftUIStylesheet,\n        uiError,\n        draftUIStylesheetSaved,\n        uiTextareaRef,\n      )}\n    </div>\n  );\n};\n\nexport default MiscPanel;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6904, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/apps/readest-app/src/components/settings/SettingsDialog.tsx"],"sourcesContent":["'use client';\n\nimport clsx from 'clsx';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useEnv } from '@/context/EnvContext';\nimport { useSettingsStore } from '@/store/settingsStore';\nimport { useResponsiveSize } from '@/hooks/useResponsiveSize';\nimport { useTranslation } from '@/hooks/useTranslation';\nimport { RiFontSize } from 'react-icons/ri';\nimport { RiDashboardLine, RiTranslate } from 'react-icons/ri';\nimport { VscSymbolColor } from 'react-icons/vsc';\nimport { PiDotsThreeVerticalBold } from 'react-icons/pi';\nimport { LiaHandPointerSolid } from 'react-icons/lia';\nimport { IoAccessibilityOutline } from 'react-icons/io5';\nimport { MdArrowBackIosNew, MdArrowForwardIos, MdClose } from 'react-icons/md';\nimport { getDirFromUILanguage } from '@/utils/rtl';\nimport FontPanel from './FontPanel';\nimport LayoutPanel from './LayoutPanel';\nimport ColorPanel from './ColorPanel';\nimport Dropdown from '@/components/Dropdown';\nimport Dialog from '@/components/Dialog';\nimport DialogMenu from './DialogMenu';\nimport ControlPanel from './ControlPanel';\nimport LangPanel from './LangPanel';\nimport MiscPanel from './MiscPanel';\n\nexport type SettingsPanelType = 'Font' | 'Layout' | 'Color' | 'Control' | 'Language' | 'Custom';\nexport type SettingsPanelPanelProp = {\n  bookKey: string;\n  onRegisterReset: (resetFn: () => void) => void;\n};\n\ntype TabConfig = {\n  tab: SettingsPanelType;\n  icon: React.ElementType;\n  label: string;\n};\n\nconst SettingsDialog: React.FC<{ bookKey: string }> = ({ bookKey }) => {\n  const _ = useTranslation();\n  const { appService } = useEnv();\n  const closeIconSize = useResponsiveSize(16);\n  const [isRtl] = useState(() => getDirFromUILanguage() === 'rtl');\n  const tabsRef = useRef<HTMLDivElement | null>(null);\n  const [showAllTabLabels, setShowAllTabLabels] = useState(false);\n  const { setFontPanelView, setSettingsDialogOpen } = useSettingsStore();\n\n  const tabConfig = [\n    {\n      tab: 'Font',\n      icon: RiFontSize,\n      label: _('Font'),\n    },\n    {\n      tab: 'Layout',\n      icon: RiDashboardLine,\n      label: _('Layout'),\n    },\n    {\n      tab: 'Color',\n      icon: VscSymbolColor,\n      label: _('Color'),\n    },\n    {\n      tab: 'Control',\n      icon: LiaHandPointerSolid,\n      label: _('Behavior'),\n    },\n    {\n      tab: 'Language',\n      icon: RiTranslate,\n      label: _('Language'),\n    },\n    {\n      tab: 'Custom',\n      icon: IoAccessibilityOutline,\n      label: _('Custom'),\n    },\n  ] as TabConfig[];\n\n  const [activePanel, setActivePanel] = useState<SettingsPanelType>(() => {\n    const lastPanel = localStorage.getItem('lastConfigPanel');\n    if (lastPanel && tabConfig.some((tab) => tab.tab === lastPanel)) {\n      return lastPanel as SettingsPanelType;\n    }\n    return 'Font' as SettingsPanelType;\n  });\n\n  const handleSetActivePanel = (tab: SettingsPanelType) => {\n    setActivePanel(tab);\n    setFontPanelView('main-fonts');\n    localStorage.setItem('lastConfigPanel', tab);\n  };\n\n  const [resetFunctions, setResetFunctions] = useState<\n    Record<SettingsPanelType, (() => void) | null>\n  >({\n    Font: null,\n    Layout: null,\n    Color: null,\n    Control: null,\n    Language: null,\n    Custom: null,\n  });\n\n  const registerResetFunction = (panel: SettingsPanelType, resetFn: () => void) => {\n    setResetFunctions((prev) => ({ ...prev, [panel]: resetFn }));\n  };\n\n  const handleResetCurrentPanel = () => {\n    const resetFn = resetFunctions[activePanel];\n    if (resetFn) {\n      resetFn();\n    }\n  };\n\n  const handleClose = () => {\n    setSettingsDialogOpen(false);\n  };\n\n  useEffect(() => {\n    setFontPanelView('main-fonts');\n\n    const container = tabsRef.current;\n    if (!container) return;\n\n    const checkButtonWidths = () => {\n      const threshold = (container.clientWidth - 64) * 0.22;\n      const hideLabel = Array.from(container.querySelectorAll('button')).some((button) => {\n        const labelSpan = button.querySelector('span');\n        const labelText = labelSpan?.textContent || '';\n        const clone = button.cloneNode(true) as HTMLButtonElement;\n        clone.style.position = 'absolute';\n        clone.style.visibility = 'hidden';\n        clone.style.width = 'auto';\n        const cloneSpan = clone.querySelector('span');\n        if (cloneSpan) {\n          cloneSpan.classList.remove('hidden');\n          cloneSpan.textContent = labelText;\n        }\n        document.body.appendChild(clone);\n        const fullWidth = clone.scrollWidth;\n        document.body.removeChild(clone);\n        return fullWidth > threshold;\n      });\n      setShowAllTabLabels(!hideLabel);\n    };\n\n    checkButtonWidths();\n\n    const resizeObserver = new ResizeObserver(checkButtonWidths);\n    resizeObserver.observe(container);\n    const mutationObserver = new MutationObserver(checkButtonWidths);\n    mutationObserver.observe(container, {\n      subtree: true,\n      characterData: true,\n    });\n\n    return () => {\n      resizeObserver.disconnect();\n      mutationObserver.disconnect();\n    };\n  }, [setFontPanelView]);\n\n  const currentPanel = tabConfig.find((tab) => tab.tab === activePanel);\n\n  return (\n    <Dialog\n      isOpen={true}\n      onClose={handleClose}\n      className='modal-open'\n      bgClassName={bookKey ? 'sm:!bg-black/20' : 'sm:!bg-black/50'}\n      boxClassName={clsx('sm:min-w-[520px]', appService?.isMobile && 'sm:max-w-[90%] sm:w-3/4')}\n      snapHeight={appService?.isMobile ? 0.7 : undefined}\n      header={\n        <div className='flex w-full flex-col items-center'>\n          <div className='tab-title flex pb-2 text-base font-semibold sm:hidden'>\n            {currentPanel?.label || ''}\n          </div>\n          <div className='flex w-full flex-row items-center justify-between'>\n            <button\n              tabIndex={-1}\n              aria-label={_('Close')}\n              onClick={handleClose}\n              className={\n                'btn btn-ghost btn-circle flex h-8 min-h-8 w-8 hover:bg-transparent focus:outline-none sm:hidden'\n              }\n            >\n              {isRtl ? <MdArrowForwardIos /> : <MdArrowBackIosNew />}\n            </button>\n            <div\n              ref={tabsRef}\n              role='group'\n              aria-label={_('Settings Panels') + ' - ' + (currentPanel?.label || '')}\n              className={clsx('dialog-tabs ms-1 flex h-10 w-full items-center gap-1 sm:ms-0')}\n            >\n              {tabConfig.map(({ tab, icon: Icon, label }) => (\n                <button\n                  key={tab}\n                  data-tab={tab}\n                  tabIndex={0}\n                  title={label}\n                  className={clsx(\n                    'btn btn-ghost text-base-content btn-sm gap-1 px-2',\n                    activePanel === tab ? 'btn-active' : '',\n                  )}\n                  onClick={() => handleSetActivePanel(tab)}\n                >\n                  <Icon className='mr-0' />\n                  <span\n                    className={clsx(\n                      window.innerWidth < 640 && 'hidden',\n                      !(showAllTabLabels || activePanel === tab) && 'hidden',\n                    )}\n                  >\n                    {label}\n                  </span>\n                </button>\n              ))}\n            </div>\n            <div className='flex h-full items-center justify-end gap-x-2'>\n              <Dropdown\n                label={_('Settings Menu')}\n                className='dropdown-bottom dropdown-end'\n                buttonClassName='btn btn-ghost h-8 min-h-8 w-8 p-0 flex items-center justify-center'\n                toggleButton={<PiDotsThreeVerticalBold />}\n              >\n                <DialogMenu\n                  activePanel={activePanel}\n                  onReset={handleResetCurrentPanel}\n                  resetLabel={\n                    currentPanel\n                      ? _('Reset {{settings}}', { settings: currentPanel.label })\n                      : undefined\n                  }\n                />\n              </Dropdown>\n              <button\n                onClick={handleClose}\n                aria-label={_('Close')}\n                className={\n                  'bg-base-300/65 btn btn-ghost btn-circle hidden h-6 min-h-6 w-6 p-0 sm:flex'\n                }\n              >\n                <MdClose size={closeIconSize} />\n              </button>\n            </div>\n          </div>\n        </div>\n      }\n    >\n      <div role='group' aria-label={`${_(currentPanel?.label || '')} - ${_('Settings')}`}>\n        {activePanel === 'Font' && (\n          <FontPanel\n            bookKey={bookKey}\n            onRegisterReset={(fn) => registerResetFunction('Font', fn)}\n          />\n        )}\n        {activePanel === 'Layout' && (\n          <LayoutPanel\n            bookKey={bookKey}\n            onRegisterReset={(fn) => registerResetFunction('Layout', fn)}\n          />\n        )}\n        {activePanel === 'Color' && (\n          <ColorPanel\n            bookKey={bookKey}\n            onRegisterReset={(fn) => registerResetFunction('Color', fn)}\n          />\n        )}\n        {activePanel === 'Control' && (\n          <ControlPanel\n            bookKey={bookKey}\n            onRegisterReset={(fn) => registerResetFunction('Control', fn)}\n          />\n        )}\n        {activePanel === 'Language' && (\n          <LangPanel\n            bookKey={bookKey}\n            onRegisterReset={(fn) => registerResetFunction('Language', fn)}\n          />\n        )}\n        {activePanel === 'Custom' && (\n          <MiscPanel\n            bookKey={bookKey}\n            onRegisterReset={(fn) => registerResetFunction('Custom', fn)}\n          />\n        )}\n      </div>\n    </Dialog>\n  );\n};\n\nexport default SettingsDialog;\n"],"names":[],"mappings":"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"}}]
}