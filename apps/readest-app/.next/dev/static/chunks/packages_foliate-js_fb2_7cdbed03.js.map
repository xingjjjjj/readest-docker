{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/packages/foliate-js/fb2.js"],"sourcesContent":["const normalizeWhitespace = str => str ? str\n    .replace(/[\\t\\n\\f\\r ]+/g, ' ')\n    .replace(/^[\\t\\n\\f\\r ]+/, '')\n    .replace(/[\\t\\n\\f\\r ]+$/, '') : ''\nconst getElementText = el => normalizeWhitespace(el?.textContent)\n\nconst NS = {\n    XLINK: 'http://www.w3.org/1999/xlink',\n    EPUB: 'http://www.idpf.org/2007/ops',\n}\n\nconst MIME = {\n    XML: 'application/xml',\n    XHTML: 'application/xhtml+xml',\n}\n\nconst STYLE = {\n    'strong': ['strong', 'self'],\n    'emphasis': ['em', 'self'],\n    'style': ['span', 'self'],\n    'a': 'anchor',\n    'strikethrough': ['s', 'self'],\n    'sub': ['sub', 'self'],\n    'sup': ['sup', 'self'],\n    'code': ['code', 'self'],\n    'image': 'image',\n}\n\nconst TABLE = {\n    'tr': ['tr', {\n        'th': ['th', STYLE, ['colspan', 'rowspan', 'align', 'valign']],\n        'td': ['td', STYLE, ['colspan', 'rowspan', 'align', 'valign']],\n    }, ['align']],\n}\n\nconst POEM = {\n    'epigraph': ['blockquote'],\n    'subtitle': ['h2', STYLE],\n    'text-author': ['p', STYLE],\n    'date': ['p', STYLE],\n    'stanza': ['div', 'self'],\n    'v': ['div', STYLE],\n}\n\nconst SECTION = {\n    'title': ['header', {\n        'p': ['h1', STYLE],\n        'empty-line': ['br'],\n    }],\n    'epigraph': ['blockquote', 'self'],\n    'image': 'image',\n    'annotation': ['aside'],\n    'section': ['section', 'self'],\n    'p': ['p', STYLE],\n    'poem': ['blockquote', POEM],\n    'subtitle': ['h2', STYLE],\n    'cite': ['blockquote', 'self'],\n    'empty-line': ['br'],\n    'table': ['table', TABLE],\n    'text-author': ['p', STYLE],\n}\nPOEM['epigraph'].push(SECTION)\n\nconst BODY = {\n    'image': 'image',\n    'title': ['section', {\n        'p': ['h1', STYLE],\n        'empty-line': ['br'],\n    }],\n    'epigraph': ['section', SECTION],\n    'section': ['section', SECTION],\n}\n\nclass FB2Converter {\n    constructor(fb2) {\n        this.fb2 = fb2\n        this.doc = document.implementation.createDocument(NS.XHTML, 'html')\n        // use this instead of `getElementById` to allow images like\n        // `<image l:href=\"#img1.jpg\" id=\"img1.jpg\" />`\n        this.bins = new Map(Array.from(this.fb2.getElementsByTagName('binary'),\n            el => [el.id, el]))\n    }\n    getImageSrc(el) {\n        const href = el.getAttributeNS(NS.XLINK, 'href')\n        if (!href) return 'data:,'\n        const [, id] = href.split('#')\n        if (!id) return href\n        const bin = this.bins.get(id)\n        return bin\n            ? `data:${bin.getAttribute('content-type')};base64,${bin.textContent}`\n            : href\n    }\n    image(node) {\n        const el = this.doc.createElement('img')\n        el.alt = node.getAttribute('alt')\n        el.title = node.getAttribute('title')\n        el.setAttribute('src', this.getImageSrc(node))\n        return el\n    }\n    anchor(node) {\n        const el = this.convert(node, { 'a': ['a', STYLE] })\n        el.setAttribute('href', node.getAttributeNS(NS.XLINK, 'href'))\n        if (node.getAttribute('type') === 'note')\n            el.setAttributeNS(NS.EPUB, 'epub:type', 'noteref')\n        return el\n    }\n    convert(node, def) {\n        // not an element; return text content\n        if (node.nodeType === 3) return this.doc.createTextNode(node.textContent)\n        if (node.nodeType === 4) return this.doc.createCDATASection(node.textContent)\n        if (node.nodeType === 8) return this.doc.createComment(node.textContent)\n\n        const d = def?.[node.nodeName]\n        if (!d) return null\n        if (typeof d === 'string') return this[d](node)\n\n        const [name, opts, attrs] = d\n        const el = this.doc.createElement(name)\n\n        // copy the ID, and set class name from original element name\n        if (node.id) el.id = node.id\n        el.classList.add(node.nodeName)\n\n        // copy attributes\n        if (Array.isArray(attrs)) for (const attr of attrs) {\n            const value = node.getAttribute(attr)\n            if (value) el.setAttribute(attr, value)\n        }\n\n        // process child elements recursively\n        const childDef = opts === 'self' ? def : opts\n        let child = node.firstChild\n        while (child) {\n            const childEl = this.convert(child, childDef)\n            if (childEl) el.append(childEl)\n            child = child.nextSibling\n        }\n        return el\n    }\n}\n\nconst parseXML = async blob => {\n    const buffer = await blob.arrayBuffer()\n    const str = new TextDecoder('utf-8').decode(buffer)\n    const parser = new DOMParser()\n    const doc = parser.parseFromString(str, MIME.XML)\n    const encoding = doc.xmlEncoding\n        // `Document.xmlEncoding` is deprecated, and already removed in Firefox\n        // so parse the XML declaration manually\n        || str.match(/^<\\?xml\\s+version\\s*=\\s*[\"']1.\\d+\"\\s+encoding\\s*=\\s*[\"']([A-Za-z0-9._-]*)[\"']/)?.[1]\n    if (encoding && encoding.toLowerCase() !== 'utf-8') {\n        const str = new TextDecoder(encoding).decode(buffer)\n        return parser.parseFromString(str, MIME.XML)\n    }\n    return doc\n}\n\nconst style = URL.createObjectURL(new Blob([`\n@namespace epub \"http://www.idpf.org/2007/ops\";\nbody > img, section > img {\n    display: block;\n    margin: auto;\n}\n.title h1 {\n    text-align: center;\n}\nbody > section > .title, body.notesBodyType > .title {\n    margin: 3em 0;\n}\nbody.notesBodyType > section .title h1 {\n    text-align: start;\n}\nbody.notesBodyType > section .title {\n    margin: 1em 0;\n}\np {\n    text-indent: 1em;\n    margin: 0;\n}\n:not(p) + p, p:first-child {\n    text-indent: 0;\n}\n.stanza {\n    text-indent: 0;\n    margin: 1em 0;\n}\n.text-author, .date {\n    text-align: end;\n}\n.text-author:before {\n    content: \"—\";\n}\ntable {\n    border-collapse: collapse;\n}\ntd, th {\n    padding: .25em;\n}\na[epub|type~=\"noteref\"] {\n    font-size: .75em;\n    vertical-align: super;\n}\nbody:not(.notesBodyType) > .title, body:not(.notesBodyType) > .epigraph {\n    margin: 3em 0;\n}\n`], { type: 'text/css' }))\n\nconst template = html => `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n    <head><link href=\"${style}\" rel=\"stylesheet\" type=\"text/css\"/></head>\n    <body>${html}</body>\n</html>`\n\n// name of custom ID attribute for TOC items\nconst dataID = 'data-foliate-id'\n\nexport const makeFB2 = async blob => {\n    const book = {}\n    const doc = await parseXML(blob)\n    const converter = new FB2Converter(doc)\n\n    const $ = x => doc.querySelector(x)\n    const $$ = x => [...doc.querySelectorAll(x)]\n    const getPerson = el => {\n        const nick = getElementText(el.querySelector('nickname'))\n        if (nick) return nick\n        const first = getElementText(el.querySelector('first-name'))\n        const middle = getElementText(el.querySelector('middle-name'))\n        const last = getElementText(el.querySelector('last-name'))\n        const name = [first, middle, last].filter(x => x).join(' ')\n        const sortAs = last\n            ? [last, [first, middle].filter(x => x).join(' ')].join(', ')\n            : null\n        return { name, sortAs }\n    }\n    const getDate = el => el?.getAttribute('value') ?? getElementText(el)\n    const annotation = $('title-info annotation')\n    book.metadata = {\n        title: getElementText($('title-info book-title')),\n        identifier: getElementText($('document-info id')),\n        language: getElementText($('title-info lang')),\n        author: $$('title-info author').map(getPerson),\n        translator: $$('title-info translator').map(getPerson),\n        contributor: $$('document-info author').map(getPerson)\n            // techincially the program probably shouldn't get the `bkp` role\n            // but it has been so used by calibre, so ¯\\_(ツ)_/¯\n            .concat($$('document-info program-used').map(getElementText))\n            .map(x => Object.assign(typeof x === 'string' ? { name: x } : x,\n                { role: 'bkp' })),\n        publisher: getElementText($('publish-info publisher')),\n        published: getDate($('title-info date')),\n        modified: getDate($('document-info date')),\n        description: annotation ? converter.convert(annotation,\n            { annotation: ['div', SECTION] }).innerHTML : null,\n        subject: $$('title-info genre').map(getElementText),\n    }\n    if ($('coverpage image')) {\n        const src = converter.getImageSrc($('coverpage image'))\n        book.getCover = () => fetch(src).then(res => res.blob())\n    } else book.getCover = () => null\n\n    // get convert each body\n    const bodyData = Array.from(doc.querySelectorAll('body'), body => {\n        const converted = converter.convert(body, { body: ['body', BODY] })\n        return [Array.from(converted.children, el => {\n            // get list of IDs in the section\n            const ids = [el, ...el.querySelectorAll('[id]')].map(el => el.id)\n            return { el, ids }\n        }), converted]\n    })\n\n    const urls = []\n    const sectionData = bodyData[0][0]\n        // make a separate section for each section in the first body\n        .map(({ el, ids }) => {\n            // set up titles for TOC\n            const titles = Array.from(\n                el.querySelectorAll(':scope > section > .title'),\n                (el, index) => {\n                    el.setAttribute(dataID, index)\n                    return { title: getElementText(el), index }\n                })\n            return { ids, titles, el }\n        })\n        // for additional bodies, only make one section for each body\n        .concat(bodyData.slice(1).map(([sections, body]) => {\n            const ids = sections.map(s => s.ids).flat()\n            body.classList.add('notesBodyType')\n            return { ids, el: body, linear: 'no' }\n        }))\n        .map(({ ids, titles, el, linear }) => {\n            const str = template(el.outerHTML)\n            const blob = new Blob([str], { type: MIME.XHTML })\n            const url = URL.createObjectURL(blob)\n            urls.push(url)\n            const title = normalizeWhitespace(\n                el.querySelector('.title, .subtitle, p')?.textContent\n                ?? (el.classList.contains('title') ? el.textContent : ''))\n            return {\n                ids, title, titles, load: () => url,\n                createDocument: () => new DOMParser().parseFromString(str, MIME.XHTML),\n                // doo't count image data as it'd skew the size too much\n                size: blob.size - Array.from(el.querySelectorAll('[src]'),\n                    el => el.getAttribute('src')?.length ?? 0)\n                    .reduce((a, b) => a + b, 0),\n                linear,\n            }\n        })\n\n    const idMap = new Map()\n    book.sections = sectionData.map((section, index) => {\n        const { ids, load, createDocument, size, linear } = section\n        for (const id of ids) if (id) idMap.set(id, index)\n        return { id: index, load, createDocument, size, linear }\n    })\n\n    book.toc = sectionData.map(({ title, titles }, index) => {\n        const id = index.toString()\n        return {\n            label: title,\n            href: id,\n            subitems: titles?.length ? titles.map(({ title, index }) => ({\n                label: title,\n                href: `${id}#${index}`,\n            })) : null,\n        }\n    }).filter(item => item)\n\n    book.resolveHref = href => {\n        const [a, b] = href.split('#')\n        return a\n            // the link is from the TOC\n            ? { index: Number(a), anchor: doc => doc.querySelector(`[${dataID}=\"${b}\"]`) }\n            // link from within the page\n            : { index: idMap.get(b), anchor: doc => doc.getElementById(b) }\n    }\n    book.splitTOCHref = href => href?.split('#')?.map(x => Number(x)) ?? []\n    book.getTOCFragment = (doc, id) => doc.querySelector(`[${dataID}=\"${id}\"]`)\n\n    book.destroy = () => {\n        for (const url of urls) URL.revokeObjectURL(url)\n    }\n    return book\n}\n"],"names":[],"mappings":";;;;AAAA,MAAM,sBAAsB,CAAA,MAAO,MAAM,IACpC,OAAO,CAAC,iBAAiB,KACzB,OAAO,CAAC,iBAAiB,IACzB,OAAO,CAAC,iBAAiB,MAAM;AACpC,MAAM,iBAAiB,CAAA,KAAM,oBAAoB,IAAI;AAErD,MAAM,KAAK;IACP,OAAO;IACP,MAAM;AACV;AAEA,MAAM,OAAO;IACT,KAAK;IACL,OAAO;AACX;AAEA,MAAM,QAAQ;IACV,UAAU;QAAC;QAAU;KAAO;IAC5B,YAAY;QAAC;QAAM;KAAO;IAC1B,SAAS;QAAC;QAAQ;KAAO;IACzB,KAAK;IACL,iBAAiB;QAAC;QAAK;KAAO;IAC9B,OAAO;QAAC;QAAO;KAAO;IACtB,OAAO;QAAC;QAAO;KAAO;IACtB,QAAQ;QAAC;QAAQ;KAAO;IACxB,SAAS;AACb;AAEA,MAAM,QAAQ;IACV,MAAM;QAAC;QAAM;YACT,MAAM;gBAAC;gBAAM;gBAAO;oBAAC;oBAAW;oBAAW;oBAAS;iBAAS;aAAC;YAC9D,MAAM;gBAAC;gBAAM;gBAAO;oBAAC;oBAAW;oBAAW;oBAAS;iBAAS;aAAC;QAClE;QAAG;YAAC;SAAQ;KAAC;AACjB;AAEA,MAAM,OAAO;IACT,YAAY;QAAC;KAAa;IAC1B,YAAY;QAAC;QAAM;KAAM;IACzB,eAAe;QAAC;QAAK;KAAM;IAC3B,QAAQ;QAAC;QAAK;KAAM;IACpB,UAAU;QAAC;QAAO;KAAO;IACzB,KAAK;QAAC;QAAO;KAAM;AACvB;AAEA,MAAM,UAAU;IACZ,SAAS;QAAC;QAAU;YAChB,KAAK;gBAAC;gBAAM;aAAM;YAClB,cAAc;gBAAC;aAAK;QACxB;KAAE;IACF,YAAY;QAAC;QAAc;KAAO;IAClC,SAAS;IACT,cAAc;QAAC;KAAQ;IACvB,WAAW;QAAC;QAAW;KAAO;IAC9B,KAAK;QAAC;QAAK;KAAM;IACjB,QAAQ;QAAC;QAAc;KAAK;IAC5B,YAAY;QAAC;QAAM;KAAM;IACzB,QAAQ;QAAC;QAAc;KAAO;IAC9B,cAAc;QAAC;KAAK;IACpB,SAAS;QAAC;QAAS;KAAM;IACzB,eAAe;QAAC;QAAK;KAAM;AAC/B;AACA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;AAEtB,MAAM,OAAO;IACT,SAAS;IACT,SAAS;QAAC;QAAW;YACjB,KAAK;gBAAC;gBAAM;aAAM;YAClB,cAAc;gBAAC;aAAK;QACxB;KAAE;IACF,YAAY;QAAC;QAAW;KAAQ;IAChC,WAAW;QAAC;QAAW;KAAQ;AACnC;AAEA,MAAM;IACF,YAAY,GAAG,CAAE;QACb,IAAI,CAAC,GAAG,GAAG;QACX,IAAI,CAAC,GAAG,GAAG,SAAS,cAAc,CAAC,cAAc,CAAC,GAAG,KAAK,EAAE;QAC5D,4DAA4D;QAC5D,+CAA+C;QAC/C,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,MAAM,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,oBAAoB,CAAC,WACzD,CAAA,KAAM;gBAAC,GAAG,EAAE;gBAAE;aAAG;IACzB;IACA,YAAY,EAAE,EAAE;QACZ,MAAM,OAAO,GAAG,cAAc,CAAC,GAAG,KAAK,EAAE;QACzC,IAAI,CAAC,MAAM,OAAO;QAClB,MAAM,GAAG,GAAG,GAAG,KAAK,KAAK,CAAC;QAC1B,IAAI,CAAC,IAAI,OAAO;QAChB,MAAM,MAAM,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QAC1B,OAAO,MACD,CAAC,KAAK,EAAE,IAAI,YAAY,CAAC,gBAAgB,QAAQ,EAAE,IAAI,WAAW,EAAE,GACpE;IACV;IACA,MAAM,IAAI,EAAE;QACR,MAAM,KAAK,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC;QAClC,GAAG,GAAG,GAAG,KAAK,YAAY,CAAC;QAC3B,GAAG,KAAK,GAAG,KAAK,YAAY,CAAC;QAC7B,GAAG,YAAY,CAAC,OAAO,IAAI,CAAC,WAAW,CAAC;QACxC,OAAO;IACX;IACA,OAAO,IAAI,EAAE;QACT,MAAM,KAAK,IAAI,CAAC,OAAO,CAAC,MAAM;YAAE,KAAK;gBAAC;gBAAK;aAAM;QAAC;QAClD,GAAG,YAAY,CAAC,QAAQ,KAAK,cAAc,CAAC,GAAG,KAAK,EAAE;QACtD,IAAI,KAAK,YAAY,CAAC,YAAY,QAC9B,GAAG,cAAc,CAAC,GAAG,IAAI,EAAE,aAAa;QAC5C,OAAO;IACX;IACA,QAAQ,IAAI,EAAE,GAAG,EAAE;QACf,sCAAsC;QACtC,IAAI,KAAK,QAAQ,KAAK,GAAG,OAAO,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,KAAK,WAAW;QACxE,IAAI,KAAK,QAAQ,KAAK,GAAG,OAAO,IAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,KAAK,WAAW;QAC5E,IAAI,KAAK,QAAQ,KAAK,GAAG,OAAO,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,KAAK,WAAW;QAEvE,MAAM,IAAI,KAAK,CAAC,KAAK,QAAQ,CAAC;QAC9B,IAAI,CAAC,GAAG,OAAO;QACf,IAAI,OAAO,MAAM,UAAU,OAAO,IAAI,CAAC,EAAE,CAAC;QAE1C,MAAM,CAAC,MAAM,MAAM,MAAM,GAAG;QAC5B,MAAM,KAAK,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC;QAElC,6DAA6D;QAC7D,IAAI,KAAK,EAAE,EAAE,GAAG,EAAE,GAAG,KAAK,EAAE;QAC5B,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,QAAQ;QAE9B,kBAAkB;QAClB,IAAI,MAAM,OAAO,CAAC,QAAQ,KAAK,MAAM,QAAQ,MAAO;YAChD,MAAM,QAAQ,KAAK,YAAY,CAAC;YAChC,IAAI,OAAO,GAAG,YAAY,CAAC,MAAM;QACrC;QAEA,qCAAqC;QACrC,MAAM,WAAW,SAAS,SAAS,MAAM;QACzC,IAAI,QAAQ,KAAK,UAAU;QAC3B,MAAO,MAAO;YACV,MAAM,UAAU,IAAI,CAAC,OAAO,CAAC,OAAO;YACpC,IAAI,SAAS,GAAG,MAAM,CAAC;YACvB,QAAQ,MAAM,WAAW;QAC7B;QACA,OAAO;IACX;AACJ;AAEA,MAAM,WAAW,OAAM;IACnB,MAAM,SAAS,MAAM,KAAK,WAAW;IACrC,MAAM,MAAM,IAAI,YAAY,SAAS,MAAM,CAAC;IAC5C,MAAM,SAAS,IAAI;IACnB,MAAM,MAAM,OAAO,eAAe,CAAC,KAAK,KAAK,GAAG;IAChD,MAAM,WAAW,IAAI,WAAW,IAGzB,IAAI,KAAK,CAAC,kFAAkF,CAAC,EAAE;IACtG,IAAI,YAAY,SAAS,WAAW,OAAO,SAAS;QAChD,MAAM,MAAM,IAAI,YAAY,UAAU,MAAM,CAAC;QAC7C,OAAO,OAAO,eAAe,CAAC,KAAK,KAAK,GAAG;IAC/C;IACA,OAAO;AACX;AAEA,MAAM,QAAQ,IAAI,eAAe,CAAC,IAAI,KAAK;IAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgD7C,CAAC;CAAC,EAAE;IAAE,MAAM;AAAW;AAEvB,MAAM,WAAW,CAAA,OAAQ,CAAC;;sBAEJ,EAAE,MAAM;UACpB,EAAE,KAAK;OACV,CAAC;AAER,4CAA4C;AAC5C,MAAM,SAAS;AAER,MAAM,UAAU,OAAM;IACzB,MAAM,OAAO,CAAC;IACd,MAAM,MAAM,MAAM,SAAS;IAC3B,MAAM,YAAY,IAAI,aAAa;IAEnC,MAAM,IAAI,CAAA,IAAK,IAAI,aAAa,CAAC;IACjC,MAAM,KAAK,CAAA,IAAK;eAAI,IAAI,gBAAgB,CAAC;SAAG;IAC5C,MAAM,YAAY,CAAA;QACd,MAAM,OAAO,eAAe,GAAG,aAAa,CAAC;QAC7C,IAAI,MAAM,OAAO;QACjB,MAAM,QAAQ,eAAe,GAAG,aAAa,CAAC;QAC9C,MAAM,SAAS,eAAe,GAAG,aAAa,CAAC;QAC/C,MAAM,OAAO,eAAe,GAAG,aAAa,CAAC;QAC7C,MAAM,OAAO;YAAC;YAAO;YAAQ;SAAK,CAAC,MAAM,CAAC,CAAA,IAAK,GAAG,IAAI,CAAC;QACvD,MAAM,SAAS,OACT;YAAC;YAAM;gBAAC;gBAAO;aAAO,CAAC,MAAM,CAAC,CAAA,IAAK,GAAG,IAAI,CAAC;SAAK,CAAC,IAAI,CAAC,QACtD;QACN,OAAO;YAAE;YAAM;QAAO;IAC1B;IACA,MAAM,UAAU,CAAA,KAAM,IAAI,aAAa,YAAY,eAAe;IAClE,MAAM,aAAa,EAAE;IACrB,KAAK,QAAQ,GAAG;QACZ,OAAO,eAAe,EAAE;QACxB,YAAY,eAAe,EAAE;QAC7B,UAAU,eAAe,EAAE;QAC3B,QAAQ,GAAG,qBAAqB,GAAG,CAAC;QACpC,YAAY,GAAG,yBAAyB,GAAG,CAAC;QAC5C,aAAa,GAAG,wBAAwB,GAAG,CAAC,UACxC,iEAAiE;QACjE,mDAAmD;SAClD,MAAM,CAAC,GAAG,8BAA8B,GAAG,CAAC,iBAC5C,GAAG,CAAC,CAAA,IAAK,OAAO,MAAM,CAAC,OAAO,MAAM,WAAW;gBAAE,MAAM;YAAE,IAAI,GAC1D;gBAAE,MAAM;YAAM;QACtB,WAAW,eAAe,EAAE;QAC5B,WAAW,QAAQ,EAAE;QACrB,UAAU,QAAQ,EAAE;QACpB,aAAa,aAAa,UAAU,OAAO,CAAC,YACxC;YAAE,YAAY;gBAAC;gBAAO;aAAQ;QAAC,GAAG,SAAS,GAAG;QAClD,SAAS,GAAG,oBAAoB,GAAG,CAAC;IACxC;IACA,IAAI,EAAE,oBAAoB;QACtB,MAAM,MAAM,UAAU,WAAW,CAAC,EAAE;QACpC,KAAK,QAAQ,GAAG,IAAM,MAAM,KAAK,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI;IACzD,OAAO,KAAK,QAAQ,GAAG,IAAM;IAE7B,wBAAwB;IACxB,MAAM,WAAW,MAAM,IAAI,CAAC,IAAI,gBAAgB,CAAC,SAAS,CAAA;QACtD,MAAM,YAAY,UAAU,OAAO,CAAC,MAAM;YAAE,MAAM;gBAAC;gBAAQ;aAAK;QAAC;QACjE,OAAO;YAAC,MAAM,IAAI,CAAC,UAAU,QAAQ,EAAE,CAAA;gBACnC,iCAAiC;gBACjC,MAAM,MAAM;oBAAC;uBAAO,GAAG,gBAAgB,CAAC;iBAAQ,CAAC,GAAG,CAAC,CAAA,KAAM,GAAG,EAAE;gBAChE,OAAO;oBAAE;oBAAI;gBAAI;YACrB;YAAI;SAAU;IAClB;IAEA,MAAM,OAAO,EAAE;IACf,MAAM,cAAc,QAAQ,CAAC,EAAE,CAAC,EAAE,AAC9B,6DAA6D;KAC5D,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,GAAG,EAAE;QACb,wBAAwB;QACxB,MAAM,SAAS,MAAM,IAAI,CACrB,GAAG,gBAAgB,CAAC,8BACpB,CAAC,IAAI;YACD,GAAG,YAAY,CAAC,QAAQ;YACxB,OAAO;gBAAE,OAAO,eAAe;gBAAK;YAAM;QAC9C;QACJ,OAAO;YAAE;YAAK;YAAQ;QAAG;IAC7B,EACA,6DAA6D;KAC5D,MAAM,CAAC,SAAS,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,UAAU,KAAK;QAC3C,MAAM,MAAM,SAAS,GAAG,CAAC,CAAA,IAAK,EAAE,GAAG,EAAE,IAAI;QACzC,KAAK,SAAS,CAAC,GAAG,CAAC;QACnB,OAAO;YAAE;YAAK,IAAI;YAAM,QAAQ;QAAK;IACzC,IACC,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE;QAC7B,MAAM,MAAM,SAAS,GAAG,SAAS;QACjC,MAAM,OAAO,IAAI,KAAK;YAAC;SAAI,EAAE;YAAE,MAAM,KAAK,KAAK;QAAC;QAChD,MAAM,MAAM,IAAI,eAAe,CAAC;QAChC,KAAK,IAAI,CAAC;QACV,MAAM,QAAQ,oBACV,GAAG,aAAa,CAAC,yBAAyB,eACvC,CAAC,GAAG,SAAS,CAAC,QAAQ,CAAC,WAAW,GAAG,WAAW,GAAG,EAAE;QAC5D,OAAO;YACH;YAAK;YAAO;YAAQ,MAAM,IAAM;YAChC,gBAAgB,IAAM,IAAI,YAAY,eAAe,CAAC,KAAK,KAAK,KAAK;YACrE,wDAAwD;YACxD,MAAM,KAAK,IAAI,GAAG,MAAM,IAAI,CAAC,GAAG,gBAAgB,CAAC,UAC7C,CAAA,KAAM,GAAG,YAAY,CAAC,QAAQ,UAAU,GACvC,MAAM,CAAC,CAAC,GAAG,IAAM,IAAI,GAAG;YAC7B;QACJ;IACJ;IAEJ,MAAM,QAAQ,IAAI;IAClB,KAAK,QAAQ,GAAG,YAAY,GAAG,CAAC,CAAC,SAAS;QACtC,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG;QACpD,KAAK,MAAM,MAAM,IAAK,IAAI,IAAI,MAAM,GAAG,CAAC,IAAI;QAC5C,OAAO;YAAE,IAAI;YAAO;YAAM;YAAgB;YAAM;QAAO;IAC3D;IAEA,KAAK,GAAG,GAAG,YAAY,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE;QAC3C,MAAM,KAAK,MAAM,QAAQ;QACzB,OAAO;YACH,OAAO;YACP,MAAM;YACN,UAAU,QAAQ,SAAS,OAAO,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,GAAK,CAAC;oBACzD,OAAO;oBACP,MAAM,GAAG,GAAG,CAAC,EAAE,OAAO;gBAC1B,CAAC,KAAK;QACV;IACJ,GAAG,MAAM,CAAC,CAAA,OAAQ;IAElB,KAAK,WAAW,GAAG,CAAA;QACf,MAAM,CAAC,GAAG,EAAE,GAAG,KAAK,KAAK,CAAC;QAC1B,OAAO,IAED;YAAE,OAAO,OAAO;YAAI,QAAQ,CAAA,MAAO,IAAI,aAAa,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,CAAC;QAAE,IAE3E;YAAE,OAAO,MAAM,GAAG,CAAC;YAAI,QAAQ,CAAA,MAAO,IAAI,cAAc,CAAC;QAAG;IACtE;IACA,KAAK,YAAY,GAAG,CAAA,OAAQ,MAAM,MAAM,MAAM,IAAI,CAAA,IAAK,OAAO,OAAO,EAAE;IACvE,KAAK,cAAc,GAAG,CAAC,KAAK,KAAO,IAAI,aAAa,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,EAAE,GAAG,EAAE,CAAC;IAE1E,KAAK,OAAO,GAAG;QACX,KAAK,MAAM,OAAO,KAAM,IAAI,eAAe,CAAC;IAChD;IACA,OAAO;AACX"}}]
}