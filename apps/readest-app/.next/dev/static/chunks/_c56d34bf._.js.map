{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/packages/foliate-js/fixed-layout.js"],"sourcesContent":["import 'construct-style-sheets-polyfill'\n\nconst parseViewport = str => str\n    ?.split(/[,;\\s]/) // NOTE: technically, only the comma is valid\n    ?.filter(x => x)\n    ?.map(x => x.split('=').map(x => x.trim()))\n\nconst getViewport = (doc, viewport) => {\n    // use `viewBox` for SVG\n    if (doc.documentElement.localName === 'svg') {\n        const [, , width, height] = doc.documentElement\n            .getAttribute('viewBox')?.split(/\\s/) ?? []\n        return { width, height }\n    }\n\n    // get `viewport` `meta` element\n    const meta = parseViewport(doc.querySelector('meta[name=\"viewport\"]')\n        ?.getAttribute('content'))\n    if (meta) return Object.fromEntries(meta)\n\n    // fallback to book's viewport\n    if (typeof viewport === 'string') return parseViewport(viewport)\n    if (viewport?.width && viewport.height) return viewport\n\n    // if no viewport (possibly with image directly in spine), get image size\n    const img = doc.querySelector('img')\n    if (img) return { width: img.naturalWidth, height: img.naturalHeight }\n\n    // just show *something*, i guess...\n    console.warn(new Error('Missing viewport properties'))\n    return { width: 1000, height: 2000 }\n}\n\nexport class FixedLayout extends HTMLElement {\n    static observedAttributes = ['zoom', 'scale-factor', 'spread']\n    #root = this.attachShadow({ mode: 'open' })\n    #observer = new ResizeObserver(() => this.#render())\n    #spreads\n    #index = -1\n    defaultViewport\n    spread\n    #portrait = false\n    #left\n    #right\n    #center\n    #side\n    #zoom\n    #scaleFactor = 1.0\n    #totalScaleFactor = 1.0\n    #scrollLocked = false\n    #isOverflowX = false\n    #isOverflowY = false\n    #preloadCache = new Map()\n    #prerenderedSpreads = new Map()\n    #spreadAccessTime = new Map()\n    #maxConcurrentPreloads = 1\n    #numPrerenderedSpreads = 1\n    #maxCachedSpreads = 2\n    #preloadQueue = []\n    #activePreloads = 0\n    constructor() {\n        super()\n\n        const sheet = new CSSStyleSheet()\n        this.#root.adoptedStyleSheets = [sheet]\n        sheet.replaceSync(`:host {\n            width: 100%;\n            height: 100%;\n            display: flex;\n            justify-content: flex-start;\n            align-items: center;\n            overflow: auto;\n        }\n        @supports (justify-content: safe center) {\n          :host {\n            justify-content: safe center;\n          }\n        }`)\n\n        this.#observer.observe(this)\n    }\n    attributeChangedCallback(name, _, value) {\n        switch (name) {\n            case 'zoom':\n                this.#zoom = value !== 'fit-width' && value !== 'fit-page'\n                    ? parseFloat(value) : value\n                this.#render()\n                break\n            case 'scale-factor':\n                this.#scaleFactor = parseFloat(value) / 100\n                this.#render()\n                break\n            case 'spread':\n                this.#respread(value)\n                break\n        }\n    }\n    async #createFrame({ index, src: srcOption, detached = false }) {\n        const srcOptionIsString = typeof srcOption === 'string'\n        const src = srcOptionIsString ? srcOption : srcOption?.src\n        const data = srcOptionIsString ? null : srcOption?.data\n        const onZoom = srcOptionIsString ? null : srcOption?.onZoom\n        const element = document.createElement('div')\n        element.setAttribute('dir', 'ltr')\n        const iframe = document.createElement('iframe')\n        element.append(iframe)\n        Object.assign(iframe.style, {\n            border: '0',\n            display: 'none',\n            overflow: 'hidden',\n        })\n        // `allow-scripts` is needed for events because of WebKit bug\n        // https://bugs.webkit.org/show_bug.cgi?id=218086\n        iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts')\n        iframe.setAttribute('scrolling', 'no')\n        iframe.setAttribute('part', 'filter')\n        this.#root.append(element)\n\n        if (detached) {\n            Object.assign(element.style, {\n                position: 'absolute',\n                visibility: 'hidden',\n                pointerEvents: 'none',\n            })\n        }\n\n        if (!src) return { blank: true, element, iframe }\n        return new Promise(resolve => {\n            iframe.addEventListener('load', () => {\n                const doc = iframe.contentDocument\n                this.dispatchEvent(new CustomEvent('load', { detail: { doc, index } }))\n                const { width, height } = getViewport(doc, this.defaultViewport)\n                resolve({\n                    element, iframe,\n                    width: parseFloat(width),\n                    height: parseFloat(height),\n                    onZoom,\n                    detached,\n                })\n            }, { once: true })\n            if (data) {\n                iframe.srcdoc = data\n            } else {\n                iframe.src = src\n            }\n        })\n    }\n    #render(side = this.#side) {\n        if (!side) return\n        const left = this.#left ?? {}\n        const right = this.#center ?? this.#right ?? {}\n        const target = side === 'left' ? left : right\n        const { width, height } = this.getBoundingClientRect()\n        // for unfolded devices with slightly taller height than width also use landscape layout\n        const portrait = this.spread !== 'both' && this.spread !== 'portrait'\n            && height > width * 1.2\n        this.#portrait = portrait\n        const blankWidth = left.width ?? right.width ?? 0\n        const blankHeight = left.height ?? right.height ?? 0\n\n        let scale = typeof this.#zoom === 'number' && !isNaN(this.#zoom)\n            ? this.#zoom\n            : (this.#zoom === 'fit-width'\n                ? (portrait || this.#center\n                    ? width / (target.width ?? blankWidth)\n                    : width / ((left.width ?? blankWidth) + (right.width ?? blankWidth)))\n                : (portrait || this.#center\n                    ? Math.min(\n                        width / (target.width ?? blankWidth),\n                        height / (target.height ?? blankHeight))\n                    : Math.min(\n                        width / ((left.width ?? blankWidth) + (right.width ?? blankWidth)),\n                        height / Math.max(\n                            left.height ?? blankHeight,\n                            right.height ?? blankHeight)))\n            ) || 1\n\n        scale *= this.#scaleFactor\n        this.#totalScaleFactor = scale\n\n        const transform = ({frame, styles}) => {\n            let { element, iframe, width, height, blank, onZoom } = frame\n            if (!iframe) return\n            if (onZoom) onZoom({ doc: frame.iframe.contentDocument, scale })\n            const iframeScale = onZoom ? scale : 1\n            const zoomedOut = this.#scaleFactor < 1.0\n            Object.assign(iframe.style, {\n                width: `${width * iframeScale}px`,\n                height: `${height * iframeScale}px`,\n                transform: onZoom ? 'none' : `scale(${scale})`,\n                transformOrigin: 'top left',\n                display: blank ? 'none' : 'block',\n            })\n            Object.assign(element.style, {\n                width: `${(width ?? blankWidth) * scale}px`,\n                height: `${(height ?? blankHeight) * scale}px`,\n                flexShrink: '0',\n                display: zoomedOut ? 'flex' : 'block',\n                marginBlock: zoomedOut ? undefined : 'auto',\n                alignItems: zoomedOut ? 'center' : undefined,\n                justifyContent: zoomedOut ? 'center' : undefined,\n                ...styles,\n            })\n            if (portrait && frame !== target) {\n                element.style.display = 'none'\n            }\n\n            const container= element.parentNode.host\n            const containerWidth = container.clientWidth\n            const containerHeight = container.clientHeight\n            container.scrollLeft = (element.clientWidth - containerWidth) / 2\n\n            return {\n                width: element.clientWidth,\n                height: element.clientHeight,\n                containerWidth,\n                containerHeight,\n            }\n        }\n        if (this.#center) {\n            const dimensions = transform({frame: this.#center, styles: { marginInline: 'auto' }})\n            const {width, height, containerWidth, containerHeight} = dimensions\n            this.#isOverflowX = width > containerWidth\n            this.#isOverflowY = height > containerHeight\n        } else {\n            const leftDimensions = transform({frame: left, styles: { marginInlineStart: 'auto' }})\n            const rightDimensions = transform({frame: right, styles: { marginInlineEnd: 'auto' }})\n            const {width: leftWidth, height: leftHeight, containerWidth, containerHeight} = leftDimensions\n            const {width: rightWidth, height: rightHeight} = rightDimensions\n            this.#isOverflowX = leftWidth + rightWidth > containerWidth\n            this.#isOverflowY = Math.max(leftHeight, rightHeight) > containerHeight\n        }\n    }\n    async #showSpread({ left, right, center, side, spreadIndex }) {\n        this.#left = null\n        this.#right = null\n        this.#center = null\n\n        const cacheKey = spreadIndex !== undefined ? `spread-${spreadIndex}` : null\n        const prerendered = cacheKey ? this.#prerenderedSpreads.get(cacheKey) : null\n\n        if (prerendered) {\n            this.#spreadAccessTime.set(cacheKey, Date.now())\n            if (prerendered.center) {\n                this.#center = prerendered.center\n            } else {\n                this.#left = prerendered.left\n                this.#right = prerendered.right\n            }\n        } else {\n            if (center) {\n                this.#center = await this.#createFrame(center)\n                if (cacheKey) {\n                    this.#prerenderedSpreads.set(cacheKey, { center: this.#center })\n                    this.#spreadAccessTime.set(cacheKey, Date.now())\n                }\n            } else {\n                this.#left = await this.#createFrame(left)\n                this.#right = await this.#createFrame(right)\n                if (cacheKey) {\n                    this.#prerenderedSpreads.set(cacheKey, { left: this.#left, right: this.#right })\n                    this.#spreadAccessTime.set(cacheKey, Date.now())\n                }\n            }\n        }\n\n        this.#side = center ? 'center' : this.#left.blank ? 'right'\n            : this.#right.blank ? 'left' : side\n        const visibleFrames = center\n            ? [this.#center?.element]\n            : [this.#left?.element, this.#right?.element]\n\n        Array.from(this.#root.children).forEach(child => {\n            const isVisible = visibleFrames.includes(child)\n            Object.assign(child.style, {\n                position: isVisible ? 'relative' : 'absolute',\n                visibility: isVisible ? 'visible' : 'hidden',\n                pointerEvents: isVisible ? 'auto' : 'none',\n            })\n        })\n        this.#render()\n    }\n    #goLeft() {\n        if (this.#center || this.#left?.blank) return\n        if (this.#portrait && this.#left?.element?.style?.display === 'none') {\n            this.#side = 'left'\n            this.#render()\n            this.#reportLocation('page')\n            return true\n        }\n    }\n    #goRight() {\n        if (this.#center || this.#right?.blank) return\n        if (this.#portrait && this.#right?.element?.style?.display === 'none') {\n            this.#side = 'right'\n            this.#render()\n            this.#reportLocation('page')\n            return true\n        }\n    }\n    open(book) {\n        this.book = book\n        this.defaultViewport = book.rendition?.viewport\n        this.rtl = book.dir === 'rtl'\n\n        this.#spread()\n    }\n    #spread(mode) {\n        const book = this.book\n        const { rendition } = book\n        const rtl = this.rtl\n        const ltr = !rtl\n        this.spread = mode || rendition?.spread\n\n        if (this.spread === 'none')\n            this.#spreads = book.sections.map(section => ({ center: section }))\n        else this.#spreads = book.sections.reduce((arr, section, i) => {\n            const last = arr[arr.length - 1]\n            const { pageSpread } = section\n            const newSpread = () => {\n                const spread = {}\n                arr.push(spread)\n                return spread\n            }\n            if (pageSpread === 'center') {\n                const spread = last.left || last.right ? newSpread() : last\n                spread.center = section\n            }\n            else if (pageSpread === 'left') {\n                const spread = last.center || last.left || ltr && i ? newSpread() : last\n                spread.left = section\n            }\n            else if (pageSpread === 'right') {\n                const spread = last.center || last.right || rtl && i ? newSpread() : last\n                spread.right = section\n            }\n            else if (ltr) {\n                if (last.center || last.right) newSpread().left = section\n                else if (last.left || !i) last.right = section\n                else last.left = section\n            }\n            else {\n                if (last.center || last.left) newSpread().right = section\n                else if (last.right || !i) last.left = section\n                else last.right = section\n            }\n            return arr\n        }, [{}])\n    }\n    #respread(spreadMode) {\n        if (this.#index === -1) return\n        const section = this.book.sections[this.index]\n        this.#spread(spreadMode)\n        const { index } = this.getSpreadOf(section)\n        this.#index = -1\n        this.#preloadCache.clear()\n        for (const frames of this.#prerenderedSpreads.values()) {\n            if (frames.center) {\n                frames.center.element?.remove()\n            } else {\n                frames.left?.element?.remove()\n                frames.right?.element?.remove()\n            }\n        }\n        this.#prerenderedSpreads.clear()\n        this.#spreadAccessTime.clear()\n        this.goToSpread(index, this.rtl ? 'right' : 'left', 'page')\n    }\n    get index() {\n        const spread = this.#spreads[this.#index]\n        const section = spread?.center ?? (this.#side === 'left'\n            ? spread.left ?? spread.right : spread.right ?? spread.left)\n        return this.book.sections.indexOf(section)\n    }\n    get scrollLocked() {\n        return this.#scrollLocked\n    }\n    set scrollLocked(value) {\n        this.#scrollLocked = value\n    }\n    get isOverflowX() {\n        return this.#isOverflowX\n    }\n    get isOverflowY() {\n        return this.#isOverflowY\n    }\n    #reportLocation(reason) {\n        this.dispatchEvent(new CustomEvent('relocate', { detail:\n            { reason, range: null, index: this.index, fraction: 0, size: 1 } }))\n    }\n    getSpreadOf(section) {\n        const spreads = this.#spreads\n        for (let index = 0; index < spreads.length; index++) {\n            const { left, right, center } = spreads[index]\n            if (left === section) return { index, side: 'left' }\n            if (right === section) return { index, side: 'right' }\n            if (center === section) return { index, side: 'center' }\n        }\n    }\n    async goToSpread(index, side, reason) {\n        if (index < 0 || index > this.#spreads.length - 1) return\n        if (index === this.#index) {\n            this.#render(side)\n            return\n        }\n        this.#index = index\n        const spread = this.#spreads[index]\n        const cacheKey = `spread-${index}`\n        const cached = this.#preloadCache.get(cacheKey)\n        if (cached && cached !== 'loading') {\n            if (cached.center) {\n                const sectionIndex = this.book.sections.indexOf(spread.center)\n                await this.#showSpread({ center: { index: sectionIndex, src: cached.center }, spreadIndex: index, side })\n            } else {\n                const indexL = this.book.sections.indexOf(spread.left)\n                const indexR = this.book.sections.indexOf(spread.right)\n                const left = { index: indexL, src: cached.left }\n                const right = { index: indexR, src: cached.right }\n                await this.#showSpread({ left, right, side, spreadIndex: index })\n            }\n        } else {\n            if (spread.center) {\n                const sectionIndex = this.book.sections.indexOf(spread.center)\n                const src = await spread.center?.load?.()\n                await this.#showSpread({ center: { index: sectionIndex, src }, spreadIndex: index, side })\n            } else {\n                const indexL = this.book.sections.indexOf(spread.left)\n                const indexR = this.book.sections.indexOf(spread.right)\n                const srcL = await spread.left?.load?.()\n                const srcR = await spread.right?.load?.()\n                const left = { index: indexL, src: srcL }\n                const right = { index: indexR, src: srcR }\n                await this.#showSpread({ left, right, side, spreadIndex: index })\n            }\n        }\n\n        this.#reportLocation(reason)\n        this.#preloadNextSpreads()\n    }\n    #preloadNextSpreads() {\n        this.#cleanupPreloadCache()\n\n        if (this.#numPrerenderedSpreads <= 0) return\n\n        const toPreload = []\n        const forwardPreloadCount = Math.max(1, this.#numPrerenderedSpreads - 1)\n        const backwardPreloadCount = Math.max(0, this.#numPrerenderedSpreads - forwardPreloadCount)\n        for (let distance = 1; distance <= forwardPreloadCount; distance++) {\n            const forwardIndex = this.#index + distance\n            if (forwardIndex >= 0 && forwardIndex < this.#spreads.length) {\n                toPreload.push({ index: forwardIndex, direction: 'forward', distance })\n            }\n        }\n        for (let distance = 1; distance <= backwardPreloadCount; distance++) {\n            const backwardIndex = this.#index - distance\n            if (backwardIndex >= 0 && backwardIndex < this.#spreads.length) {\n                toPreload.push({ index: backwardIndex, direction: 'backward', distance })\n            }\n        }\n        for (const { index: targetIndex, direction } of toPreload) {\n            const cacheKey = `spread-${targetIndex}`\n            if (this.#prerenderedSpreads.has(cacheKey)) continue\n            const spread = this.#spreads[targetIndex]\n            if (!spread) continue\n            this.#preloadQueue.push({ targetIndex, direction, spread, cacheKey })\n        }\n\n        this.#processPreloadQueue()\n    }\n\n    async #processPreloadQueue() {\n        while (this.#preloadQueue.length > 0 && this.#activePreloads < this.#maxConcurrentPreloads) {\n            const task = this.#preloadQueue.shift()\n            if (!task) break\n\n            const { spread, cacheKey } = task\n            this.#preloadCache.set(cacheKey, 'loading')\n            this.#activePreloads++\n            Promise.resolve().then(async () => {\n                try {\n                    if (spread.center) {\n                        const src = await spread.center?.load?.()\n                        this.#preloadCache.set(cacheKey, { center: src })\n\n                        const sectionIndex = this.book.sections.indexOf(spread.center)\n                        const frame = await this.#createFrame({ index: sectionIndex, src, detached: true })\n\n                        this.#prerenderedSpreads.set(cacheKey, { center: frame })\n                        this.#spreadAccessTime.set(cacheKey, Date.now())\n                        if (frame.onZoom) {\n                            const doc = frame.iframe.contentDocument\n                            frame.onZoom({ doc, scale: this.#totalScaleFactor })\n                        }\n                    } else {\n                        const srcL = await spread.left?.load?.()\n                        const srcR = await spread.right?.load?.()\n                        this.#preloadCache.set(cacheKey, { left: srcL, right: srcR })\n\n                        const indexL = this.book.sections.indexOf(spread.left)\n                        const indexR = this.book.sections.indexOf(spread.right)\n                        const leftFrame = await this.#createFrame({ index: indexL, src: srcL, detached: true })\n                        const rightFrame = await this.#createFrame({ index: indexR, src: srcR, detached: true })\n\n                        this.#prerenderedSpreads.set(cacheKey, { left: leftFrame, right: rightFrame })\n                        this.#spreadAccessTime.set(cacheKey, Date.now())\n\n                        if (leftFrame.onZoom) {\n                            const docL = leftFrame.iframe.contentDocument\n                            leftFrame.onZoom({ doc: docL, scale: this.#totalScaleFactor })\n                        }\n                        if (rightFrame.onZoom) {\n                            const docR = rightFrame.iframe.contentDocument\n                            rightFrame.onZoom({ doc: docR, scale: this.#totalScaleFactor })\n                        }\n                    }\n                } catch {\n                    this.#preloadCache.delete(cacheKey)\n                    this.#prerenderedSpreads.delete(cacheKey)\n                } finally {\n                    this.#activePreloads--\n                    this.#processPreloadQueue()\n                }\n            })\n        }\n    }\n    #cleanupPreloadCache() {\n        const maxSpreads = this.#maxCachedSpreads\n        if (this.#prerenderedSpreads.size <= maxSpreads) {\n            return\n        }\n\n        const framesByAge = Array.from(this.#prerenderedSpreads.keys())\n            .map(key => ({\n                key,\n                accessTime: this.#spreadAccessTime.get(key) || 0,\n            }))\n            .sort((a, b) => a.accessTime - b.accessTime)\n\n        const numToRemove = this.#prerenderedSpreads.size - maxSpreads\n        const framesToDelete = framesByAge.slice(0, numToRemove).map(item => item.key)\n\n        if (framesToDelete.length > 0) {\n            framesToDelete.forEach(key => {\n                const frames = this.#prerenderedSpreads.get(key)\n                if (frames) {\n                    if (frames.center) {\n                        frames.center.element?.remove()\n                    } else {\n                        frames.left?.element?.remove()\n                        frames.right?.element?.remove()\n                    }\n                }\n\n                this.#prerenderedSpreads.delete(key)\n                this.#spreadAccessTime.delete(key)\n                this.#preloadCache.delete(key)\n            })\n        }\n    }\n    async select(target) {\n        await this.goTo(target)\n        // TODO\n    }\n    async goTo(target) {\n        const { book } = this\n        const resolved = await target\n        const section = book.sections[resolved.index]\n        if (!section) return\n        const { index, side } = this.getSpreadOf(section)\n        await this.goToSpread(index, side)\n    }\n    async next() {\n        const s = this.rtl ? this.#goLeft() : this.#goRight()\n        if (!s) return this.goToSpread(this.#index + 1, this.rtl ? 'right' : 'left', 'page')\n    }\n    async prev() {\n        const s = this.rtl ? this.#goRight() : this.#goLeft()\n        if (!s) return this.goToSpread(this.#index - 1, this.rtl ? 'left' : 'right', 'page')\n    }\n    async pan(dx, dy) {\n        if (this.#scrollLocked) return\n        this.#scrollLocked = true\n\n        const transform = frame => {\n            let { element, iframe } = frame\n            if (!iframe || !element) return\n\n            const scrollableContainer = element.parentNode.host\n            scrollableContainer.scrollLeft += dx\n            scrollableContainer.scrollTop += dy\n        }\n\n        transform(this.#center ?? this.#right ?? {})\n        this.#scrollLocked = false\n    }\n    getContents() {\n        return Array.from(this.#root.querySelectorAll('iframe'), frame => ({\n            doc: frame.contentDocument,\n            // TODO: index, overlayer\n        }))\n    }\n    destroy() {\n        this.#observer.unobserve(this)\n        for (const frames of this.#prerenderedSpreads.values()) {\n            if (frames.center) {\n                frames.center.element?.remove()\n            } else {\n                frames.left?.element?.remove()\n                frames.right?.element?.remove()\n            }\n        }\n        this.#prerenderedSpreads.clear()\n        this.#preloadCache.clear()\n        this.#spreadAccessTime.clear()\n    }\n}\n\ncustomElements.define('foliate-fxl', FixedLayout)\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 716, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/node_modules/.pnpm/construct-style-sheets-polyfill%403.1.0/node_modules/construct-style-sheets-polyfill/dist/adoptedStyleSheets.js"],"sourcesContent":["(function () {\n    'use strict';\n\n    if (typeof document === 'undefined' || 'adoptedStyleSheets' in document) { return; }\n\n    var hasShadyCss = 'ShadyCSS' in window && !ShadyCSS.nativeShadow;\n    var bootstrapper = document.implementation.createHTMLDocument('');\n    var closedShadowRootRegistry = new WeakMap();\n    var _DOMException = typeof DOMException === 'object' ? Error : DOMException;\n    var defineProperty = Object.defineProperty;\n    var forEach = Array.prototype.forEach;\n\n    var importPattern = /@import.+?;?$/gm;\n    function rejectImports(contents) {\n        var _contents = contents.replace(importPattern, '');\n        if (_contents !== contents) {\n            console.warn('@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418');\n        }\n        return _contents.trim();\n    }\n    function isElementConnected(element) {\n        return 'isConnected' in element\n            ? element.isConnected\n            : document.contains(element);\n    }\n    function unique(arr) {\n        return arr.filter(function (value, index) { return arr.indexOf(value) === index; });\n    }\n    function diff(arr1, arr2) {\n        return arr1.filter(function (value) { return arr2.indexOf(value) === -1; });\n    }\n    function removeNode(node) {\n        node.parentNode.removeChild(node);\n    }\n    function getShadowRoot(element) {\n        return element.shadowRoot || closedShadowRootRegistry.get(element);\n    }\n\n    var cssStyleSheetMethods = [\n        'addRule',\n        'deleteRule',\n        'insertRule',\n        'removeRule',\n    ];\n    var NonConstructedStyleSheet = CSSStyleSheet;\n    var nonConstructedProto = NonConstructedStyleSheet.prototype;\n    nonConstructedProto.replace = function () {\n        return Promise.reject(new _DOMException(\"Can't call replace on non-constructed CSSStyleSheets.\"));\n    };\n    nonConstructedProto.replaceSync = function () {\n        throw new _DOMException(\"Failed to execute 'replaceSync' on 'CSSStyleSheet': Can't call replaceSync on non-constructed CSSStyleSheets.\");\n    };\n    function isCSSStyleSheetInstance(instance) {\n        return typeof instance === 'object'\n            ? proto$1.isPrototypeOf(instance) ||\n                nonConstructedProto.isPrototypeOf(instance)\n            : false;\n    }\n    function isNonConstructedStyleSheetInstance(instance) {\n        return typeof instance === 'object'\n            ? nonConstructedProto.isPrototypeOf(instance)\n            : false;\n    }\n    var $basicStyleElement = new WeakMap();\n    var $locations = new WeakMap();\n    var $adoptersByLocation = new WeakMap();\n    var $appliedMethods = new WeakMap();\n    function addAdopterLocation(sheet, location) {\n        var adopter = document.createElement('style');\n        $adoptersByLocation.get(sheet).set(location, adopter);\n        $locations.get(sheet).push(location);\n        return adopter;\n    }\n    function getAdopterByLocation(sheet, location) {\n        return $adoptersByLocation.get(sheet).get(location);\n    }\n    function removeAdopterLocation(sheet, location) {\n        $adoptersByLocation.get(sheet).delete(location);\n        $locations.set(sheet, $locations.get(sheet).filter(function (_location) { return _location !== location; }));\n    }\n    function restyleAdopter(sheet, adopter) {\n        requestAnimationFrame(function () {\n            adopter.textContent = $basicStyleElement.get(sheet).textContent;\n            $appliedMethods\n                .get(sheet)\n                .forEach(function (command) {\n                return adopter.sheet[command.method].apply(adopter.sheet, command.args);\n            });\n        });\n    }\n    function checkInvocationCorrectness(self) {\n        if (!$basicStyleElement.has(self)) {\n            throw new TypeError('Illegal invocation');\n        }\n    }\n    function ConstructedStyleSheet() {\n        var self = this;\n        var style = document.createElement('style');\n        bootstrapper.body.appendChild(style);\n        $basicStyleElement.set(self, style);\n        $locations.set(self, []);\n        $adoptersByLocation.set(self, new WeakMap());\n        $appliedMethods.set(self, []);\n    }\n    var proto$1 = ConstructedStyleSheet.prototype;\n    proto$1.replace = function replace(contents) {\n        try {\n            this.replaceSync(contents);\n            return Promise.resolve(this);\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    };\n    proto$1.replaceSync = function replaceSync(contents) {\n        checkInvocationCorrectness(this);\n        if (typeof contents === 'string') {\n            var self_1 = this;\n            $basicStyleElement.get(self_1).textContent = rejectImports(contents);\n            $appliedMethods.set(self_1, []);\n            $locations.get(self_1).forEach(function (location) {\n                if (location.isConnected()) {\n                    restyleAdopter(self_1, getAdopterByLocation(self_1, location));\n                }\n            });\n        }\n    };\n    defineProperty(proto$1, 'cssRules', {\n        configurable: true,\n        enumerable: true,\n        get: function cssRules() {\n            checkInvocationCorrectness(this);\n            return $basicStyleElement.get(this).sheet.cssRules;\n        },\n    });\n    defineProperty(proto$1, 'media', {\n        configurable: true,\n        enumerable: true,\n        get: function media() {\n            checkInvocationCorrectness(this);\n            return $basicStyleElement.get(this).sheet.media;\n        },\n    });\n    cssStyleSheetMethods.forEach(function (method) {\n        proto$1[method] = function () {\n            var self = this;\n            checkInvocationCorrectness(self);\n            var args = arguments;\n            $appliedMethods.get(self).push({ method: method, args: args });\n            $locations.get(self).forEach(function (location) {\n                if (location.isConnected()) {\n                    var sheet = getAdopterByLocation(self, location).sheet;\n                    sheet[method].apply(sheet, args);\n                }\n            });\n            var basicSheet = $basicStyleElement.get(self).sheet;\n            return basicSheet[method].apply(basicSheet, args);\n        };\n    });\n    defineProperty(ConstructedStyleSheet, Symbol.hasInstance, {\n        configurable: true,\n        value: isCSSStyleSheetInstance,\n    });\n\n    var defaultObserverOptions = {\n        childList: true,\n        subtree: true,\n    };\n    var locations = new WeakMap();\n    function getAssociatedLocation(element) {\n        var location = locations.get(element);\n        if (!location) {\n            location = new Location(element);\n            locations.set(element, location);\n        }\n        return location;\n    }\n    function attachAdoptedStyleSheetProperty(constructor) {\n        defineProperty(constructor.prototype, 'adoptedStyleSheets', {\n            configurable: true,\n            enumerable: true,\n            get: function () {\n                return getAssociatedLocation(this).sheets;\n            },\n            set: function (sheets) {\n                getAssociatedLocation(this).update(sheets);\n            },\n        });\n    }\n    function traverseWebComponents(node, callback) {\n        var iter = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT, function (foundNode) {\n            return getShadowRoot(foundNode)\n                ? NodeFilter.FILTER_ACCEPT\n                : NodeFilter.FILTER_REJECT;\n        },\n        null, false);\n        for (var next = void 0; (next = iter.nextNode());) {\n            callback(getShadowRoot(next));\n        }\n    }\n    var $element = new WeakMap();\n    var $uniqueSheets = new WeakMap();\n    var $observer = new WeakMap();\n    function isExistingAdopter(self, element) {\n        return (element instanceof HTMLStyleElement &&\n            $uniqueSheets.get(self).some(function (sheet) { return getAdopterByLocation(sheet, self); }));\n    }\n    function getAdopterContainer(self) {\n        var element = $element.get(self);\n        return element instanceof Document ? element.body : element;\n    }\n    function adopt(self) {\n        var styleList = document.createDocumentFragment();\n        var sheets = $uniqueSheets.get(self);\n        var observer = $observer.get(self);\n        var container = getAdopterContainer(self);\n        observer.disconnect();\n        sheets.forEach(function (sheet) {\n            styleList.appendChild(getAdopterByLocation(sheet, self) || addAdopterLocation(sheet, self));\n        });\n        container.insertBefore(styleList, null);\n        observer.observe(container, defaultObserverOptions);\n        sheets.forEach(function (sheet) {\n            restyleAdopter(sheet, getAdopterByLocation(sheet, self));\n        });\n    }\n    function Location(element) {\n        var self = this;\n        self.sheets = [];\n        $element.set(self, element);\n        $uniqueSheets.set(self, []);\n        $observer.set(self, new MutationObserver(function (mutations, observer) {\n            if (!document) {\n                observer.disconnect();\n                return;\n            }\n            mutations.forEach(function (mutation) {\n                if (!hasShadyCss) {\n                    forEach.call(mutation.addedNodes, function (node) {\n                        if (!(node instanceof Element)) {\n                            return;\n                        }\n                        traverseWebComponents(node, function (root) {\n                            getAssociatedLocation(root).connect();\n                        });\n                    });\n                }\n                forEach.call(mutation.removedNodes, function (node) {\n                    if (!(node instanceof Element)) {\n                        return;\n                    }\n                    if (isExistingAdopter(self, node)) {\n                        adopt(self);\n                    }\n                    if (!hasShadyCss) {\n                        traverseWebComponents(node, function (root) {\n                            getAssociatedLocation(root).disconnect();\n                        });\n                    }\n                });\n            });\n        }));\n    }\n    Location.prototype = {\n        isConnected: function () {\n            var element = $element.get(this);\n            return element instanceof Document\n                ? element.readyState !== 'loading'\n                : isElementConnected(element.host);\n        },\n        connect: function () {\n            var container = getAdopterContainer(this);\n            $observer.get(this).observe(container, defaultObserverOptions);\n            if ($uniqueSheets.get(this).length > 0) {\n                adopt(this);\n            }\n            traverseWebComponents(container, function (root) {\n                getAssociatedLocation(root).connect();\n            });\n        },\n        disconnect: function () {\n            $observer.get(this).disconnect();\n        },\n        update: function (sheets) {\n            var self = this;\n            var locationType = $element.get(self) === document ? 'Document' : 'ShadowRoot';\n            if (!Array.isArray(sheets)) {\n                throw new TypeError(\"Failed to set the 'adoptedStyleSheets' property on \" + locationType + \": Iterator getter is not callable.\");\n            }\n            if (!sheets.every(isCSSStyleSheetInstance)) {\n                throw new TypeError(\"Failed to set the 'adoptedStyleSheets' property on \" + locationType + \": Failed to convert value to 'CSSStyleSheet'\");\n            }\n            if (sheets.some(isNonConstructedStyleSheetInstance)) {\n                throw new TypeError(\"Failed to set the 'adoptedStyleSheets' property on \" + locationType + \": Can't adopt non-constructed stylesheets\");\n            }\n            self.sheets = sheets;\n            var oldUniqueSheets = $uniqueSheets.get(self);\n            var uniqueSheets = unique(sheets);\n            var removedSheets = diff(oldUniqueSheets, uniqueSheets);\n            removedSheets.forEach(function (sheet) {\n                removeNode(getAdopterByLocation(sheet, self));\n                removeAdopterLocation(sheet, self);\n            });\n            $uniqueSheets.set(self, uniqueSheets);\n            if (self.isConnected() && uniqueSheets.length > 0) {\n                adopt(self);\n            }\n        },\n    };\n\n    window.CSSStyleSheet = ConstructedStyleSheet;\n    attachAdoptedStyleSheetProperty(Document);\n    if ('ShadowRoot' in window) {\n        attachAdoptedStyleSheetProperty(ShadowRoot);\n        var proto = Element.prototype;\n        var attach_1 = proto.attachShadow;\n        proto.attachShadow = function attachShadow(init) {\n            var root = attach_1.call(this, init);\n            if (init.mode === 'closed') {\n                closedShadowRootRegistry.set(this, root);\n            }\n            return root;\n        };\n    }\n    var documentLocation = getAssociatedLocation(document);\n    if (documentLocation.isConnected()) {\n        documentLocation.connect();\n    }\n    else {\n        document.addEventListener('DOMContentLoaded', documentLocation.connect.bind(documentLocation));\n    }\n\n}());\n"],"names":[],"mappings":"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","ignoreList":[0]}}]
}