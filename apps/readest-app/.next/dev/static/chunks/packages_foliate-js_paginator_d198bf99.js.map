{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/readest/packages/foliate-js/paginator.js"],"sourcesContent":["const wait = ms => new Promise(resolve => setTimeout(resolve, ms))\n\nconst debounce = (f, wait, immediate) => {\n    let timeout\n    return (...args) => {\n        const later = () => {\n            timeout = null\n            if (!immediate) f(...args)\n        }\n        const callNow = immediate && !timeout\n        if (timeout) clearTimeout(timeout)\n        timeout = setTimeout(later, wait)\n        if (callNow) f(...args)\n    }\n}\n\nconst lerp = (min, max, x) => x * (max - min) + min\nconst easeOutQuad = x => 1 - (1 - x) * (1 - x)\nconst animate = (a, b, duration, ease, render) => new Promise(resolve => {\n    let start\n    const step = now => {\n        if (document.hidden) {\n            render(lerp(a, b, 1))\n            return resolve()\n        }\n        start ??= now\n        const fraction = Math.min(1, (now - start) / duration)\n        render(lerp(a, b, ease(fraction)))\n        if (fraction < 1) requestAnimationFrame(step)\n        else resolve()\n    }\n    if (document.hidden) {\n        render(lerp(a, b, 1))\n        return resolve()\n    }\n    requestAnimationFrame(step)\n})\n\n// collapsed range doesn't return client rects sometimes (or always?)\n// try make get a non-collapsed range or element\nconst uncollapse = range => {\n    if (!range?.collapsed) return range\n    const { endOffset, endContainer } = range\n    if (endContainer.nodeType === 1) {\n        const node = endContainer.childNodes[endOffset]\n        if (node?.nodeType === 1) return node\n        return endContainer\n    }\n    if (endOffset + 1 < endContainer.length) range.setEnd(endContainer, endOffset + 1)\n    else if (endOffset > 1) range.setStart(endContainer, endOffset - 1)\n    else return endContainer.parentNode\n    return range\n}\n\nconst makeRange = (doc, node, start, end = start) => {\n    const range = doc.createRange()\n    range.setStart(node, start)\n    range.setEnd(node, end)\n    return range\n}\n\n// use binary search to find an offset value in a text node\nconst bisectNode = (doc, node, cb, start = 0, end = node.nodeValue.length) => {\n    if (end - start === 1) {\n        const result = cb(makeRange(doc, node, start), makeRange(doc, node, end))\n        return result < 0 ? start : end\n    }\n    const mid = Math.floor(start + (end - start) / 2)\n    const result = cb(makeRange(doc, node, start, mid), makeRange(doc, node, mid, end))\n    return result < 0 ? bisectNode(doc, node, cb, start, mid)\n        : result > 0 ? bisectNode(doc, node, cb, mid, end) : mid\n}\n\nconst { SHOW_ELEMENT, SHOW_TEXT, SHOW_CDATA_SECTION,\n    FILTER_ACCEPT, FILTER_REJECT, FILTER_SKIP } = NodeFilter\n\nconst filter = SHOW_ELEMENT | SHOW_TEXT | SHOW_CDATA_SECTION\n\n// needed cause there seems to be a bug in `getBoundingClientRect()` in Firefox\n// where it fails to include rects that have zero width and non-zero height\n// (CSSOM spec says \"rectangles [...] of which the height or width is not zero\")\n// which makes the visible range include an extra space at column boundaries\nconst getBoundingClientRect = target => {\n    let top = Infinity, right = -Infinity, left = Infinity, bottom = -Infinity\n    for (const rect of target.getClientRects()) {\n        left = Math.min(left, rect.left)\n        top = Math.min(top, rect.top)\n        right = Math.max(right, rect.right)\n        bottom = Math.max(bottom, rect.bottom)\n    }\n    return new DOMRect(left, top, right - left, bottom - top)\n}\n\nconst getVisibleRange = (doc, start, end, mapRect) => {\n    // first get all visible nodes\n    const acceptNode = node => {\n        const name = node.localName?.toLowerCase()\n        // ignore all scripts, styles, and their children\n        if (name === 'script' || name === 'style') return FILTER_REJECT\n        if (node.nodeType === 1) {\n            const { left, right } = mapRect(node.getBoundingClientRect())\n            // no need to check child nodes if it's completely out of view\n            if (right < start || left > end) return FILTER_REJECT\n            // elements must be completely in view to be considered visible\n            // because you can't specify offsets for elements\n            if (left >= start && right <= end) return FILTER_ACCEPT\n            // TODO: it should probably allow elements that do not contain text\n            // because they can exceed the whole viewport in both directions\n            // especially in scrolled mode\n        } else {\n            // ignore empty text nodes\n            if (!node.nodeValue?.trim()) return FILTER_SKIP\n            // create range to get rect\n            const range = doc.createRange()\n            range.selectNodeContents(node)\n            const { left, right } = mapRect(range.getBoundingClientRect())\n            // it's visible if any part of it is in view\n            if (right >= start && left <= end) return FILTER_ACCEPT\n        }\n        return FILTER_SKIP\n    }\n    const walker = doc.createTreeWalker(doc.body, filter, { acceptNode })\n    const nodes = []\n    for (let node = walker.nextNode(); node; node = walker.nextNode())\n        nodes.push(node)\n\n    // we're only interested in the first and last visible nodes\n    const from = nodes[0] ?? doc.body\n    const to = nodes[nodes.length - 1] ?? from\n\n    // find the offset at which visibility changes\n    const startOffset = from.nodeType === 1 ? 0\n        : bisectNode(doc, from, (a, b) => {\n            const p = mapRect(getBoundingClientRect(a))\n            const q = mapRect(getBoundingClientRect(b))\n            if (p.right < start && q.left > start) return 0\n            return q.left > start ? -1 : 1\n        })\n    const endOffset = to.nodeType === 1 ? 0\n        : bisectNode(doc, to, (a, b) => {\n            const p = mapRect(getBoundingClientRect(a))\n            const q = mapRect(getBoundingClientRect(b))\n            if (p.right < end && q.left > end) return 0\n            return q.left > end ? -1 : 1\n        })\n\n    const range = doc.createRange()\n    range.setStart(from, startOffset)\n    range.setEnd(to, endOffset)\n    return range\n}\n\nconst selectionIsBackward = sel => {\n    const range = document.createRange()\n    range.setStart(sel.anchorNode, sel.anchorOffset)\n    range.setEnd(sel.focusNode, sel.focusOffset)\n    return range.collapsed\n}\n\nconst setSelectionTo = (target, collapse) => {\n    let range\n    if (target.startContainer) range = target.cloneRange()\n    else if (target.nodeType) {\n        range = document.createRange()\n        range.selectNode(target)\n    }\n    if (range) {\n        const sel = range.startContainer.ownerDocument?.defaultView.getSelection()\n        if (sel) {\n            sel.removeAllRanges()\n            if (collapse === -1) range.collapse(true)\n            else if (collapse === 1) range.collapse()\n            sel.addRange(range)\n        }\n    }\n}\n\nconst getDirection = doc => {\n    const { defaultView } = doc\n    const { writingMode, direction } = defaultView.getComputedStyle(doc.body)\n    const vertical = writingMode === 'vertical-rl'\n        || writingMode === 'vertical-lr'\n    const rtl = doc.body.dir === 'rtl'\n        || direction === 'rtl'\n        || doc.documentElement.dir === 'rtl'\n    return { vertical, rtl }\n}\n\nconst getBackground = doc => {\n    const bodyStyle = doc.defaultView.getComputedStyle(doc.body)\n    return bodyStyle.backgroundColor === 'rgba(0, 0, 0, 0)'\n        && bodyStyle.backgroundImage === 'none'\n        ? doc.defaultView.getComputedStyle(doc.documentElement).background\n        : bodyStyle.background\n}\n\nconst makeMarginals = (length, part) => Array.from({ length }, () => {\n    const div = document.createElement('div')\n    const child = document.createElement('div')\n    div.append(child)\n    child.setAttribute('part', part)\n    return div\n})\n\nconst setStylesImportant = (el, styles) => {\n    const { style } = el\n    for (const [k, v] of Object.entries(styles)) style.setProperty(k, v, 'important')\n}\n\nclass View {\n    #observer = new ResizeObserver(() => this.expand())\n    #element = document.createElement('div')\n    #iframe = document.createElement('iframe')\n    #contentRange = document.createRange()\n    #overlayer\n    #vertical = false\n    #rtl = false\n    #column = true\n    #size\n    #layout = {}\n    constructor({ container, onExpand }) {\n        this.container = container\n        this.onExpand = onExpand\n        this.#iframe.setAttribute('part', 'filter')\n        this.#element.append(this.#iframe)\n        Object.assign(this.#element.style, {\n            boxSizing: 'content-box',\n            position: 'relative',\n            overflow: 'hidden',\n            flex: '0 0 auto',\n            width: '100%', height: '100%',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n        })\n        Object.assign(this.#iframe.style, {\n            overflow: 'hidden',\n            border: '0',\n            display: 'none',\n            width: '100%', height: '100%',\n        })\n        // `allow-scripts` is needed for events because of WebKit bug\n        // https://bugs.webkit.org/show_bug.cgi?id=218086\n        this.#iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts')\n        this.#iframe.setAttribute('scrolling', 'no')\n    }\n    get element() {\n        return this.#element\n    }\n    get document() {\n        return this.#iframe.contentDocument\n    }\n    async load(src, data, afterLoad, beforeRender) {\n        if (typeof src !== 'string') throw new Error(`${src} is not string`)\n        return new Promise(resolve => {\n            this.#iframe.addEventListener('load', () => {\n                const doc = this.document\n                afterLoad?.(doc)\n\n                this.#iframe.setAttribute('aria-label', doc.title)\n                // it needs to be visible for Firefox to get computed style\n                this.#iframe.style.display = 'block'\n                const { vertical, rtl } = getDirection(doc)\n                this.docBackground = getBackground(doc)\n                doc.body.style.background = 'none'\n                const background = this.docBackground\n                this.#iframe.style.display = 'none'\n\n                this.#vertical = vertical\n                this.#rtl = rtl\n\n                this.#contentRange.selectNodeContents(doc.body)\n                const layout = beforeRender?.({ vertical, rtl, background })\n                this.#iframe.style.display = 'block'\n                this.render(layout)\n                this.#observer.observe(doc.body)\n\n                // the resize observer above doesn't work in Firefox\n                // (see https://bugzilla.mozilla.org/show_bug.cgi?id=1832939)\n                // until the bug is fixed we can at least account for font load\n                doc.fonts.ready.then(() => this.expand())\n\n                resolve()\n            }, { once: true })\n            if (data) {\n                this.#iframe.srcdoc = data\n            } else {\n                this.#iframe.src = src\n            }\n        })\n    }\n    render(layout) {\n        if (!layout || !this.document) return\n        this.#column = layout.flow !== 'scrolled'\n        this.#layout = layout\n        if (this.#column) this.columnize(layout)\n        else this.scrolled(layout)\n    }\n    scrolled({ marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }) {\n        const vertical = this.#vertical\n        const doc = this.document\n        setStylesImportant(doc.documentElement, {\n            'box-sizing': 'border-box',\n            'padding': vertical\n                ? `${marginTop * 1.5}px ${marginRight}px ${marginBottom * 1.5}px ${marginLeft}px`\n                : `${marginTop}px ${gap / 2 + marginRight / 2}px ${marginBottom}px ${gap / 2 + marginLeft / 2}px`,\n            'column-width': 'auto',\n            'height': 'auto',\n            'width': 'auto',\n            '--page-margin-top': `${vertical ? marginTop * 1.5 : marginTop}px`,\n            '--page-margin-right': `${vertical ? marginRight : marginRight + gap /2}px`,\n            '--page-margin-bottom': `${vertical ? marginBottom * 1.5 : marginBottom}px`,\n            '--page-margin-left': `${vertical ? marginLeft : marginLeft + gap / 2}px`,\n            '--available-width': `${Math.trunc(Math.min(window.innerWidth, columnWidth) - marginLeft - marginRight - gap - 60)}`,\n            '--available-height': `${Math.trunc(window.innerHeight - marginTop - marginBottom)}`,\n        })\n        setStylesImportant(doc.body, {\n            [vertical ? 'max-height' : 'max-width']: `${columnWidth}px`,\n            'margin': 'auto',\n        })\n        this.setImageSize()\n        this.expand()\n    }\n    columnize({ width, height, marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }) {\n        const vertical = this.#vertical\n        this.#size = vertical ? height : width\n\n        const doc = this.document\n        setStylesImportant(doc.documentElement, {\n            'box-sizing': 'border-box',\n            'column-width': `${Math.trunc(columnWidth)}px`,\n            'column-gap': vertical ? `${(marginTop + marginBottom) * 1.5}px` : `${gap + marginRight / 2 + marginLeft / 2}px`,\n            'column-fill': 'auto',\n            ...(vertical\n                ? { 'width': `${width}px` }\n                : { 'height': `${height}px` }),\n            'padding': vertical\n                ? `${marginTop * 1.5}px ${marginRight}px ${marginBottom * 1.5}px ${marginLeft}px`\n                : `${marginTop}px ${gap / 2 + marginRight / 2}px ${marginBottom}px ${gap / 2 + marginLeft / 2}px`,\n            'overflow': 'hidden',\n            // force wrap long words\n            'overflow-wrap': 'break-word',\n            // reset some potentially problematic props\n            'position': 'static', 'border': '0', 'margin': '0',\n            'max-height': 'none', 'max-width': 'none',\n            'min-height': 'none', 'min-width': 'none',\n            // fix glyph clipping in WebKit\n            '-webkit-line-box-contain': 'block glyphs replaced',\n            '--page-margin-top': `${vertical ? marginTop * 1.5 : marginTop}px`,\n            '--page-margin-right': `${vertical ? marginRight : marginRight / 2 + gap /2}px`,\n            '--page-margin-bottom': `${vertical ? marginBottom * 1.5 : marginBottom}px`,\n            '--page-margin-left': `${vertical ? marginLeft : marginLeft / 2 + gap / 2}px`,\n            '--available-width': `${Math.trunc(columnWidth - marginLeft - marginRight - gap)}`,\n            '--available-height': `${Math.trunc(height - marginTop - marginBottom)}`,\n        })\n        setStylesImportant(doc.body, {\n            'max-height': 'none',\n            'max-width': 'none',\n            'margin': '0',\n        })\n        this.setImageSize()\n        this.expand()\n    }\n    setImageSize() {\n        const { width, height, marginTop, marginRight, marginBottom, marginLeft } = this.#layout\n        const vertical = this.#vertical\n        const doc = this.document\n        for (const el of doc.body.querySelectorAll('img, svg, video')) {\n            // preserve max size if they are already set\n            const { maxHeight, maxWidth } = doc.defaultView.getComputedStyle(el)\n            setStylesImportant(el, {\n                'max-height': vertical\n                    ? (maxHeight !== 'none' && maxHeight !== '0px' ? maxHeight : '100%')\n                    : `${height - marginTop - marginBottom }px`,\n                'max-width': vertical\n                    ? `${width - marginLeft - marginRight }px`\n                    : (maxWidth !== 'none' && maxWidth !== '0px' ? maxWidth : '100%'),\n                'object-fit': 'contain',\n                'page-break-inside': 'avoid',\n                'break-inside': 'avoid',\n                'box-sizing': 'border-box',\n            })\n        }\n    }\n    get #zoom() {\n        // Safari does not zoom the client rects, while Chrome, Edge and Firefox does\n        if (/^((?!chrome|android).)*AppleWebKit/i.test(navigator.userAgent) && !window.chrome) {\n            return window.getComputedStyle(this.document.body).zoom || 1.0\n        }\n        return 1.0\n    }\n    expand() {\n        if (!this.document) return\n        const { documentElement } = this.document\n        if (this.#column) {\n            const side = this.#vertical ? 'height' : 'width'\n            const otherSide = this.#vertical ? 'width' : 'height'\n            const contentRect = this.#contentRange.getBoundingClientRect()\n            const rootRect = documentElement.getBoundingClientRect()\n            // offset caused by column break at the start of the page\n            // which seem to be supported only by WebKit and only for horizontal writing\n            const contentStart = this.#vertical ? 0\n                : this.#rtl ? rootRect.right - contentRect.right : contentRect.left - rootRect.left\n            const contentSize = (contentStart + contentRect[side]) * this.#zoom\n            const pageCount = Math.ceil(contentSize / this.#size)\n            const expandedSize = pageCount * this.#size\n            this.#element.style.padding = '0'\n            this.#iframe.style[side] = `${expandedSize}px`\n            this.#element.style[side] = `${expandedSize + this.#size * 2}px`\n            this.#iframe.style[otherSide] = '100%'\n            this.#element.style[otherSide] = '100%'\n            documentElement.style[side] = `${this.#size}px`\n            if (this.#overlayer) {\n                this.#overlayer.element.style.margin = '0'\n                this.#overlayer.element.style.left = this.#vertical ? '0' : `${this.#size}px`\n                this.#overlayer.element.style.top = this.#vertical ? `${this.#size}px` : '0'\n                this.#overlayer.element.style[side] = `${expandedSize}px`\n                this.#overlayer.redraw()\n            }\n        } else {\n            const side = this.#vertical ? 'width' : 'height'\n            const otherSide = this.#vertical ? 'height' : 'width'\n            const contentSize = documentElement.getBoundingClientRect()[side]\n            const expandedSize = contentSize\n            this.#element.style.padding = '0'\n            this.#iframe.style[side] = `${expandedSize}px`\n            this.#element.style[side] = `${expandedSize}px`\n            this.#iframe.style[otherSide] = '100%'\n            this.#element.style[otherSide] = '100%'\n            if (this.#overlayer) {\n                this.#overlayer.element.style.margin = '0'\n                this.#overlayer.element.style.left = '0'\n                this.#overlayer.element.style.top = '0'\n                this.#overlayer.element.style[side] = `${expandedSize}px`\n                this.#overlayer.redraw()\n            }\n        }\n        this.onExpand()\n    }\n    set overlayer(overlayer) {\n        this.#overlayer = overlayer\n        this.#element.append(overlayer.element)\n    }\n    get overlayer() {\n        return this.#overlayer\n    }\n    destroy() {\n        if (this.document) this.#observer.unobserve(this.document.body)\n    }\n}\n\n// NOTE: everything here assumes the so-called \"negative scroll type\" for RTL\nexport class Paginator extends HTMLElement {\n    static observedAttributes = [\n        'flow', 'gap', 'margin-top', 'margin-bottom', 'margin-left', 'margin-right',\n        'max-inline-size', 'max-block-size', 'max-column-count',\n    ]\n    #root = this.attachShadow({ mode: 'open' })\n    #observer = new ResizeObserver(() => this.render())\n    #top\n    #background\n    #container\n    #header\n    #footer\n    #view\n    #vertical = false\n    #rtl = false\n    #marginTop = 0\n    #marginBottom = 0\n    #index = -1\n    #anchor = 0 // anchor view to a fraction (0-1), Range, or Element\n    #justAnchored = false\n    #locked = false // while true, prevent any further navigation\n    #styles\n    #styleMap = new WeakMap()\n    #mediaQuery = matchMedia('(prefers-color-scheme: dark)')\n    #mediaQueryListener\n    #scrollBounds\n    #touchState\n    #touchScrolled\n    #lastVisibleRange\n    #scrollLocked = false\n    constructor() {\n        super()\n        this.#root.innerHTML = `<style>\n        :host {\n            display: block;\n            container-type: size;\n        }\n        :host, #top {\n            box-sizing: border-box;\n            position: relative;\n            overflow: hidden;\n            width: 100%;\n            height: 100%;\n        }\n        #top {\n            --_gap: 7%;\n            --_margin-top: 48px;\n            --_margin-right: 48px;\n            --_margin-bottom: 48px;\n            --_margin-left: 48px;\n            --_max-inline-size: 720px;\n            --_max-block-size: 1440px;\n            --_max-column-count: 2;\n            --_max-column-count-portrait: var(--_max-column-count);\n            --_max-column-count-spread: var(--_max-column-count);\n            --_half-gap: calc(var(--_gap) / 2);\n            --_half-margin-left: calc(var(--_margin-left) / 2);\n            --_half-margin-right: calc(var(--_margin-right) / 2);\n            --_max-width: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            --_max-height: var(--_max-block-size);\n            display: grid;\n            grid-template-columns:\n                minmax(0, 1fr)\n                var(--_margin-left)\n                minmax(0, calc(var(--_max-width) - var(--_gap)))\n                var(--_margin-right)\n                minmax(0, 1fr);\n            grid-template-rows:\n                minmax(var(--_margin-top), 1fr)\n                minmax(0, var(--_max-height))\n                minmax(var(--_margin-bottom), 1fr);\n            &.vertical {\n                --_max-column-count-spread: var(--_max-column-count-portrait);\n                --_max-width: var(--_max-block-size);\n                --_max-height: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            }\n            @container (orientation: portrait) {\n                & {\n                    --_max-column-count-spread: var(--_max-column-count-portrait);\n                }\n                &.vertical {\n                    --_max-column-count-spread: var(--_max-column-count);\n                }\n            }\n        }\n        #background {\n            grid-column: 1 / -1;\n            grid-row: 1 / -1;\n        }\n        #container {\n            grid-column: 2 / 5;\n            grid-row: 1 / -1;\n            overflow: hidden;\n        }\n        :host([flow=\"scrolled\"]) #container {\n            grid-column: 2 / 5;\n            grid-row: 1 / -1;\n            overflow: auto;\n        }\n        #header {\n            grid-column: 3 / 4;\n            grid-row: 1;\n        }\n        #footer {\n            grid-column: 3 / 4;\n            grid-row: 3;\n            align-self: end;\n        }\n        #header {\n            display: grid;\n            height: var(--_margin-top);\n        }\n        #footer {\n            display: grid;\n            height: var(--_margin-bottom);\n        }\n        :is(#header, #footer) > * {\n            display: flex;\n            align-items: center;\n            min-width: 0;\n        }\n        :is(#header, #footer) > * > * {\n            width: 100%;\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            text-align: center;\n            font-size: .75em;\n            opacity: .6;\n        }\n        </style>\n        <div id=\"top\">\n            <div id=\"background\" part=\"filter\"></div>\n            <div id=\"header\"></div>\n            <div id=\"container\" part=\"container\"></div>\n            <div id=\"footer\"></div>\n        </div>\n        `\n\n        this.#top = this.#root.getElementById('top')\n        this.#background = this.#root.getElementById('background')\n        this.#container = this.#root.getElementById('container')\n        this.#header = this.#root.getElementById('header')\n        this.#footer = this.#root.getElementById('footer')\n\n        this.#observer.observe(this.#container)\n        this.#container.addEventListener('scroll', () => this.dispatchEvent(new Event('scroll')))\n        this.#container.addEventListener('scroll', debounce(() => {\n            if (this.scrolled) {\n                if (this.#justAnchored) this.#justAnchored = false\n                else this.#afterScroll('scroll')\n            }\n        }, 250))\n\n        const opts = { passive: false }\n        this.addEventListener('touchstart', this.#onTouchStart.bind(this), opts)\n        this.addEventListener('touchmove', this.#onTouchMove.bind(this), opts)\n        this.addEventListener('touchend', this.#onTouchEnd.bind(this))\n        this.addEventListener('load', ({ detail: { doc } }) => {\n            doc.addEventListener('touchstart', this.#onTouchStart.bind(this), opts)\n            doc.addEventListener('touchmove', this.#onTouchMove.bind(this), opts)\n            doc.addEventListener('touchend', this.#onTouchEnd.bind(this))\n        })\n\n        this.addEventListener('relocate', ({ detail }) => {\n            if (detail.reason === 'selection') setSelectionTo(this.#anchor, 0)\n            else if (detail.reason === 'navigation') {\n                if (this.#anchor === 1) setSelectionTo(detail.range, 1)\n                else if (typeof this.#anchor === 'number')\n                    setSelectionTo(detail.range, -1)\n                else setSelectionTo(this.#anchor, -1)\n            }\n        })\n        const checkPointerSelection = debounce((range, sel) => {\n            if (!sel.rangeCount) return\n            const selRange = sel.getRangeAt(0)\n            const backward = selectionIsBackward(sel)\n            if (backward && selRange.compareBoundaryPoints(Range.START_TO_START, range) < 0)\n                this.prev()\n            else if (!backward && selRange.compareBoundaryPoints(Range.END_TO_END, range) > 0)\n                this.next()\n        }, 700)\n        this.addEventListener('load', ({ detail: { doc } }) => {\n            let isPointerSelecting = false\n            doc.addEventListener('pointerdown', () => isPointerSelecting = true)\n            doc.addEventListener('pointerup', () => isPointerSelecting = false)\n            let isKeyboardSelecting = false\n            doc.addEventListener('keydown', () => isKeyboardSelecting = true)\n            doc.addEventListener('keyup', () => isKeyboardSelecting = false)\n            doc.addEventListener('selectionchange', () => {\n                if (this.scrolled) return\n                const range = this.#lastVisibleRange\n                if (!range) return\n                const sel = doc.getSelection()\n                if (!sel.rangeCount) return\n                // FIXME: this won't work on Android WebView, disable for now\n                if (!isPointerSelecting && isPointerSelecting && sel.type === 'Range')\n                    checkPointerSelection(range, sel)\n                else if (isKeyboardSelecting) {\n                    const selRange = sel.getRangeAt(0).cloneRange()\n                    const backward = selectionIsBackward(sel)\n                    if (!backward) selRange.collapse()\n                    this.#scrollToAnchor(selRange)\n                }\n            })\n            doc.addEventListener('focusin', e => {\n                if (this.scrolled) return null\n                if (this.#container && this.#container.contains(e.target)) {\n                    // NOTE: `requestAnimationFrame` is needed in WebKit\n                    requestAnimationFrame(() => this.#scrollToAnchor(e.target))\n                }\n            })\n        })\n\n        this.#mediaQueryListener = () => {\n            if (!this.#view) return\n            this.#replaceBackground(this.#view.docBackground, this.columnCount)\n        }\n        this.#mediaQuery.addEventListener('change', this.#mediaQueryListener)\n    }\n    attributeChangedCallback(name, _, value) {\n        switch (name) {\n            case 'flow':\n                this.render()\n                break\n            case 'gap':\n            case 'margin-top':\n            case 'margin-bottom':\n            case 'margin-left':\n            case 'margin-right':\n            case 'max-block-size':\n            case 'max-column-count':\n                this.#top.style.setProperty('--_' + name, value)\n                this.render()\n                break\n            case 'max-inline-size':\n                // needs explicit `render()` as it doesn't necessarily resize\n                this.#top.style.setProperty('--_' + name, value)\n                this.render()\n                break\n        }\n    }\n    open(book) {\n        this.bookDir = book.dir\n        this.sections = book.sections\n        book.transformTarget?.addEventListener('data', ({ detail }) => {\n            if (detail.type !== 'text/css') return\n            detail.data = Promise.resolve(detail.data).then(data => data\n                // unprefix as most of the props are (only) supported unprefixed\n                .replace(/([{\\s;])-epub-/gi, '$1')\n                // `page-break-*` unsupported in columns; replace with `column-break-*`\n                .replace(/page-break-(after|before|inside)\\s*:/gi, (_, x) =>\n                    `-webkit-column-break-${x}:`)\n                .replace(/break-(after|before|inside)\\s*:\\s*(avoid-)?page/gi, (_, x, y) =>\n                    `break-${x}: ${y ?? ''}column`))\n        })\n    }\n    #createView() {\n        if (this.#view) {\n            this.#view.destroy()\n            this.#container.removeChild(this.#view.element)\n        }\n        this.#view = new View({\n            container: this,\n            onExpand: () => this.#scrollToAnchor(this.#anchor),\n        })\n        this.#container.append(this.#view.element)\n        return this.#view\n    }\n    #replaceBackground(background, columnCount) {\n        const doc = this.#view?.document\n        if (!doc) return\n        const htmlStyle = doc.defaultView.getComputedStyle(doc.documentElement)\n        const themeBgColor = htmlStyle.getPropertyValue('--theme-bg-color')\n        const overrideColor = htmlStyle.getPropertyValue('--override-color') === 'true'\n        const bgTextureId = htmlStyle.getPropertyValue('--bg-texture-id')\n        const isDarkMode = htmlStyle.getPropertyValue('color-scheme') === 'dark'\n        if (background && themeBgColor) {\n            const parsedBackground = background.split(/\\s(?=(?:url|rgb|hsl|#[0-9a-fA-F]{3,6}))/)\n            if ((isDarkMode || overrideColor) && (bgTextureId === 'none' || !bgTextureId)) {\n                parsedBackground[0] = themeBgColor\n            }\n            background = parsedBackground.join(' ')\n        }\n        this.#background.innerHTML = ''\n        this.#background.style.display = 'grid'\n        this.#background.style.gridTemplateColumns = `repeat(${columnCount}, 1fr)`\n        for (let i = 0; i < columnCount; i++) {\n            const column = document.createElement('div')\n            column.style.background = background\n            column.style.width = '100%'\n            column.style.height = '100%'\n            this.#background.appendChild(column)\n        }\n    }\n    #beforeRender({ vertical, rtl, background }) {\n        this.#vertical = vertical\n        this.#rtl = rtl\n        this.#top.classList.toggle('vertical', vertical)\n\n        const { width, height } = this.#container.getBoundingClientRect()\n        const size = vertical ? height : width\n\n        const style = getComputedStyle(this.#top)\n        const maxInlineSize = parseFloat(style.getPropertyValue('--_max-inline-size'))\n        const maxColumnCount = parseInt(style.getPropertyValue('--_max-column-count-spread'))\n        const marginTop = parseFloat(style.getPropertyValue('--_margin-top'))\n        const marginRight = parseFloat(style.getPropertyValue('--_margin-right'))\n        const marginBottom = parseFloat(style.getPropertyValue('--_margin-bottom'))\n        const marginLeft = parseFloat(style.getPropertyValue('--_margin-left'))\n        this.#marginTop = marginTop\n        this.#marginBottom = marginBottom\n\n        const g = parseFloat(style.getPropertyValue('--_gap')) / 100\n        // The gap will be a percentage of the #container, not the whole view.\n        // This means the outer padding will be bigger than the column gap. Let\n        // `a` be the gap percentage. The actual percentage for the column gap\n        // will be (1 - a) * a. Let us call this `b`.\n        //\n        // To make them the same, we start by shrinking the outer padding\n        // setting to `b`, but keep the column gap setting the same at `a`. Then\n        // the actual size for the column gap will be (1 - b) * a. Repeating the\n        // process again and again, we get the sequence\n        //     x₁ = (1 - b) * a\n        //     x₂ = (1 - x₁) * a\n        //     ...\n        // which converges to x = (1 - x) * a. Solving for x, x = a / (1 + a).\n        // So to make the spacing even, we must shrink the outer padding with\n        //     f(x) = x / (1 + x).\n        // But we want to keep the outer padding, and make the inner gap bigger.\n        // So we apply the inverse, f⁻¹ = -x / (x - 1) to the column gap.\n        const gap = -g / (g - 1) * size\n\n        const flow = this.getAttribute('flow')\n        if (flow === 'scrolled') {\n            // FIXME: vertical-rl only, not -lr\n            this.setAttribute('dir', vertical ? 'rtl' : 'ltr')\n            this.#top.style.padding = '0'\n            const columnWidth = maxInlineSize\n\n            this.heads = null\n            this.feet = null\n            this.#header.replaceChildren()\n            this.#footer.replaceChildren()\n\n            return { flow, marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }\n        }\n\n        const divisor = Math.min(maxColumnCount + (vertical ? 1 : 0), Math.ceil(Math.floor(size) / Math.floor(maxInlineSize)))\n        const columnWidth = vertical\n            ? (size / divisor - marginTop * 1.5 - marginBottom * 1.5)\n            : (size / divisor - gap - marginRight / 2 - marginLeft / 2)\n        this.setAttribute('dir', rtl ? 'rtl' : 'ltr')\n\n        // set background to `doc` background\n        // this is needed because the iframe does not fill the whole element\n        this.columnCount = divisor\n        this.#replaceBackground(background, this.columnCount)\n\n        const marginalDivisor = vertical\n            ? Math.min(2, Math.ceil(Math.floor(width) / Math.floor(maxInlineSize)))\n            : divisor\n        const marginalStyle = {\n            gridTemplateColumns: `repeat(${marginalDivisor}, 1fr)`,\n            gap: `${gap}px`,\n            direction: this.bookDir === 'rtl' ? 'rtl' : 'ltr',\n        }\n        Object.assign(this.#header.style, marginalStyle)\n        Object.assign(this.#footer.style, marginalStyle)\n        const heads = makeMarginals(marginalDivisor, 'head')\n        const feet = makeMarginals(marginalDivisor, 'foot')\n        this.heads = heads.map(el => el.children[0])\n        this.feet = feet.map(el => el.children[0])\n        this.#header.replaceChildren(...heads)\n        this.#footer.replaceChildren(...feet)\n\n        return { height, width, marginTop, marginRight, marginBottom, marginLeft, gap, columnWidth }\n    }\n    render() {\n        if (!this.#view) return\n        this.#view.render(this.#beforeRender({\n            vertical: this.#vertical,\n            rtl: this.#rtl,\n            background: this.#view.docBackground,\n        }))\n        this.#scrollToAnchor(this.#anchor)\n    }\n    get scrolled() {\n        return this.getAttribute('flow') === 'scrolled'\n    }\n    get scrollProp() {\n        const { scrolled } = this\n        return this.#vertical ? (scrolled ? 'scrollLeft' : 'scrollTop')\n            : scrolled ? 'scrollTop' : 'scrollLeft'\n    }\n    get sideProp() {\n        const { scrolled } = this\n        return this.#vertical ? (scrolled ? 'width' : 'height')\n            : scrolled ? 'height' : 'width'\n    }\n    get size() {\n        return this.#container.getBoundingClientRect()[this.sideProp]\n    }\n    get viewSize() {\n        if (!this.#view || !this.#view.element) return 0\n        return this.#view.element.getBoundingClientRect()[this.sideProp]\n    }\n    get start() {\n        return Math.abs(this.#container[this.scrollProp])\n    }\n    get end() {\n        return this.start + this.size\n    }\n    get page() {\n        return Math.floor(((this.start + this.end) / 2) / this.size)\n    }\n    get pages() {\n        return Math.round(this.viewSize / this.size)\n    }\n    get containerPosition() {\n        return this.#container[this.scrollProp]\n    }\n    get isOverflowX() {\n        return false\n    }\n    get isOverflowY() {\n        return false\n    }\n    set containerPosition(newVal) {\n        this.#container[this.scrollProp] = newVal\n    }\n    set scrollLocked(value) {\n        this.#scrollLocked = value\n    }\n\n    scrollBy(dx, dy) {\n        const delta = this.#vertical ? dy : dx\n        const [offset, a, b] = this.#scrollBounds\n        const rtl = this.#rtl\n        const min = rtl ? offset - b : offset - a\n        const max = rtl ? offset + a : offset + b\n        this.containerPosition = Math.max(min, Math.min(max,\n            this.containerPosition + delta))\n    }\n\n    snap(vx, vy) {\n        const velocity = this.#vertical ? vy : vx\n        const horizontal = Math.abs(vx) * 2 > Math.abs(vy)\n        const orthogonal = this.#vertical ? !horizontal : horizontal\n        const [offset, a, b] = this.#scrollBounds\n        const { start, end, pages, size } = this\n        const min = Math.abs(offset) - a\n        const max = Math.abs(offset) + b\n        const d = velocity * (this.#rtl ? -size : size) * (orthogonal ? 1 : 0)\n        const page = Math.floor(\n            Math.max(min, Math.min(max, (start + end) / 2\n                + (isNaN(d) ? 0 : d * 2))) / size)\n\n        this.#scrollToPage(page, 'snap').then(() => {\n            const dir = page <= 0 ? -1 : page >= pages - 1 ? 1 : null\n            if (dir) return this.#goTo({\n                index: this.#adjacentIndex(dir),\n                anchor: dir < 0 ? () => 1 : () => 0,\n            })\n        })\n    }\n    #onTouchStart(e) {\n        const touch = e.changedTouches[0]\n        this.#touchState = {\n            x: touch?.screenX, y: touch?.screenY,\n            t: e.timeStamp,\n            vx: 0, xy: 0,\n            dx: 0, dy: 0,\n        }\n    }\n    #onTouchMove(e) {\n        const state = this.#touchState\n        if (state.pinched) return\n        state.pinched = globalThis.visualViewport.scale > 1\n        if (this.scrolled || state.pinched) return\n        if (e.touches.length > 1) {\n            if (this.#touchScrolled) e.preventDefault()\n            return\n        }\n        const doc = this.#view?.document\n        const selection = doc?.getSelection()\n        if (selection && selection.rangeCount > 0 && !selection.isCollapsed) {\n            return\n        }\n        const touch = e.changedTouches[0]\n        const isStylus = touch.touchType === 'stylus'\n        if (!isStylus) e.preventDefault()\n        if (this.#scrollLocked) return\n        const x = touch.screenX, y = touch.screenY\n        const dx = state.x - x, dy = state.y - y\n        const dt = e.timeStamp - state.t\n        state.x = x\n        state.y = y\n        state.t = e.timeStamp\n        state.vx = dx / dt\n        state.vy = dy / dt\n        state.dx += dx\n        state.dy += dy\n        this.#touchScrolled = true\n        if (!this.hasAttribute('animated') || this.hasAttribute('eink')) return\n        if (!this.#vertical && Math.abs(state.dx) >= Math.abs(state.dy) && !this.hasAttribute('eink') && (!isStylus || Math.abs(dx) > 1)) {\n            this.scrollBy(dx, 0)\n        } else if (this.#vertical && Math.abs(state.dx) < Math.abs(state.dy) && !this.hasAttribute('eink') && (!isStylus || Math.abs(dy) > 1)) {\n            this.scrollBy(0, dy)\n        }\n    }\n    #onTouchEnd() {\n        if (!this.#touchScrolled) return\n        this.#touchScrolled = false\n        if (this.scrolled) return\n\n        // XXX: Firefox seems to report scale as 1... sometimes...?\n        // at this point I'm basically throwing `requestAnimationFrame` at\n        // anything that doesn't work\n        requestAnimationFrame(() => {\n            if (globalThis.visualViewport.scale === 1)\n                this.snap(this.#touchState.vx, this.#touchState.vy)\n        })\n    }\n    // allows one to process rects as if they were LTR and horizontal\n    #getRectMapper() {\n        if (this.scrolled) {\n            const size = this.viewSize\n            const marginTop = this.#marginTop\n            const marginBottom = this.#marginBottom\n            return this.#vertical\n                ? ({ left, right }) =>\n                    ({ left: size - right - marginTop, right: size - left - marginBottom })\n                : ({ top, bottom }) => ({ left: top - marginTop, right: bottom - marginBottom })\n        }\n        const pxSize = this.pages * this.size\n        return this.#rtl\n            ? ({ left, right }) =>\n                ({ left: pxSize - right, right: pxSize - left })\n            : this.#vertical\n                ? ({ top, bottom }) => ({ left: top, right: bottom })\n                : f => f\n    }\n    async #scrollToRect(rect, reason) {\n        if (this.scrolled) {\n            const offset = this.#getRectMapper()(rect).left - 4\n            return this.#scrollTo(offset, reason)\n        }\n        const offset = this.#getRectMapper()(rect).left\n        return this.#scrollToPage(Math.floor(offset / this.size) + (this.#rtl ? -1 : 1), reason)\n    }\n    async #scrollTo(offset, reason, smooth) {\n        const { size } = this\n        if (this.containerPosition === offset) {\n            this.#scrollBounds = [offset, this.atStart ? 0 : size, this.atEnd ? 0 : size]\n            this.#afterScroll(reason)\n            return\n        }\n        // FIXME: vertical-rl only, not -lr\n        if (this.scrolled && this.#vertical) offset = -offset\n        if ((reason === 'snap' || smooth) && this.hasAttribute('animated') && !this.hasAttribute('eink')) return animate(\n            this.containerPosition, offset, 300, easeOutQuad,\n            x => this.containerPosition = x,\n        ).then(() => {\n            this.#scrollBounds = [offset, this.atStart ? 0 : size, this.atEnd ? 0 : size]\n            this.#afterScroll(reason)\n        })\n        else {\n            this.containerPosition = offset\n            this.#scrollBounds = [offset, this.atStart ? 0 : size, this.atEnd ? 0 : size]\n            this.#afterScroll(reason)\n        }\n    }\n    async #scrollToPage(page, reason, smooth) {\n        const offset = this.size * (this.#rtl ? -page : page)\n        return this.#scrollTo(offset, reason, smooth)\n    }\n    async scrollToAnchor(anchor, select) {\n        return this.#scrollToAnchor(anchor, select ? 'selection' : 'navigation')\n    }\n    async #scrollToAnchor(anchor, reason = 'anchor') {\n        this.#anchor = anchor\n        const rects = uncollapse(anchor)?.getClientRects?.()\n        // if anchor is an element or a range\n        if (rects) {\n            // when the start of the range is immediately after a hyphen in the\n            // previous column, there is an extra zero width rect in that column\n            const rect = Array.from(rects)\n                .find(r => r.width > 0 && r.height > 0 && r.x >= 0 && r.y >= 0) || rects[0]\n            if (!rect) return\n            await this.#scrollToRect(rect, reason)\n            // focus the element when navigating with keyboard or screen reader\n            if (reason === 'navigation') {\n                let node = anchor.focus ? anchor : undefined\n                if (!node && anchor.startContainer) {\n                    node = anchor.startContainer\n                    if (node.nodeType === Node.TEXT_NODE) {\n                        node = node.parentElement\n                    }\n                }\n                if (node && node.focus) {\n                    node.tabIndex = -1\n                    node.style.outline = 'none'\n                    node.focus({ preventScroll: true })\n                }\n            }\n            return\n        }\n        // if anchor is a fraction\n        if (this.scrolled) {\n            await this.#scrollTo(anchor * this.viewSize, reason)\n            return\n        }\n        const { pages } = this\n        if (!pages) return\n        const textPages = pages - 2\n        const newPage = Math.round(anchor * (textPages - 1))\n        await this.#scrollToPage(newPage + 1, reason)\n    }\n    #getVisibleRange() {\n        if (this.scrolled) return getVisibleRange(this.#view.document,\n            this.start, this.end, this.#getRectMapper())\n        const size = this.#rtl ? -this.size : this.size\n        return getVisibleRange(this.#view.document,\n            this.start - size, this.end - size, this.#getRectMapper())\n    }\n    #afterScroll(reason) {\n        const range = this.#getVisibleRange()\n        this.#lastVisibleRange = range\n        // don't set new anchor if relocation was to scroll to anchor\n        if (reason !== 'selection' && reason !== 'navigation' && reason !== 'anchor')\n            this.#anchor = range\n        else this.#justAnchored = true\n\n        const index = this.#index\n        const detail = { reason, range, index }\n        if (this.scrolled) detail.fraction = this.start / this.viewSize\n        else if (this.pages > 0) {\n            const { page, pages } = this\n            this.#header.style.visibility = page > 1 ? 'visible' : 'hidden'\n            detail.fraction = (page - 1) / (pages - 2)\n            detail.size = 1 / (pages - 2)\n        }\n        this.dispatchEvent(new CustomEvent('relocate', { detail }))\n    }\n    async #display(promise) {\n        const { index, src, data, anchor, onLoad, select } = await promise\n        this.#index = index\n        const hasFocus = this.#view?.document?.hasFocus()\n        if (src) {\n            const view = this.#createView()\n            const afterLoad = doc => {\n                if (doc.head) {\n                    const $styleBefore = doc.createElement('style')\n                    doc.head.prepend($styleBefore)\n                    const $style = doc.createElement('style')\n                    doc.head.append($style)\n                    this.#styleMap.set(doc, [$styleBefore, $style])\n                }\n                onLoad?.({ doc, index })\n            }\n            const beforeRender = this.#beforeRender.bind(this)\n            await view.load(src, data, afterLoad, beforeRender)\n            this.dispatchEvent(new CustomEvent('create-overlayer', {\n                detail: {\n                    doc: view.document, index,\n                    attach: overlayer => view.overlayer = overlayer,\n                },\n            }))\n            this.#view = view\n        }\n        await this.scrollToAnchor((typeof anchor === 'function'\n            ? anchor(this.#view.document) : anchor) ?? 0, select)\n        if (hasFocus) this.focusView()\n    }\n    #canGoToIndex(index) {\n        return index >= 0 && index <= this.sections.length - 1\n    }\n    async #goTo({ index, anchor, select }) {\n        if (index === this.#index) await this.#display({ index, anchor, select })\n        else {\n            const oldIndex = this.#index\n            const onLoad = detail => {\n                this.sections[oldIndex]?.unload?.()\n                this.setStyles(this.#styles)\n                this.dispatchEvent(new CustomEvent('load', { detail }))\n            }\n            await this.#display(Promise.resolve(this.sections[index].load())\n                .then(async src => {\n                    const data = await this.sections[index].loadContent?.()\n                    return { index, src, data, anchor, onLoad, select }\n                }).catch(e => {\n                    console.warn(e)\n                    console.warn(new Error(`Failed to load section ${index}`))\n                    return {}\n                }))\n        }\n    }\n    async goTo(target) {\n        if (this.#locked) return\n        const resolved = await target\n        if (this.#canGoToIndex(resolved.index)) return this.#goTo(resolved)\n    }\n    #scrollPrev(distance) {\n        if (!this.#view) return true\n        if (this.scrolled) {\n            if (this.start > 0) return this.#scrollTo(\n                Math.max(0, this.start - (distance ?? this.size)), null, true)\n            return !this.atStart\n        }\n        if (this.atStart) return\n        const page = this.page - 1\n        return this.#scrollToPage(page, 'page', true).then(() => page <= 0)\n    }\n    #scrollNext(distance) {\n        if (!this.#view) return true\n        if (this.scrolled) {\n            if (this.viewSize - this.end > 2) return this.#scrollTo(\n                Math.min(this.viewSize, distance ? this.start + distance : this.end), null, true)\n            return !this.atEnd\n        }\n        if (this.atEnd) return\n        const page = this.page + 1\n        const pages = this.pages\n        return this.#scrollToPage(page, 'page', true).then(() => page >= pages - 1)\n    }\n    get atStart() {\n        return this.#adjacentIndex(-1) == null && this.page <= 1\n    }\n    get atEnd() {\n        return this.#adjacentIndex(1) == null && this.page >= this.pages - 2\n    }\n    #adjacentIndex(dir) {\n        for (let index = this.#index + dir; this.#canGoToIndex(index); index += dir)\n            if (this.sections[index]?.linear !== 'no') return index\n    }\n    async #turnPage(dir, distance) {\n        if (this.#locked) return\n        this.#locked = true\n        const prev = dir === -1\n        const shouldGo = await (prev ? this.#scrollPrev(distance) : this.#scrollNext(distance))\n        if (shouldGo) await this.#goTo({\n            index: this.#adjacentIndex(dir),\n            anchor: prev ? () => 1 : () => 0,\n        })\n        if (shouldGo || !this.hasAttribute('animated')) await wait(100)\n        this.#locked = false\n    }\n    async prev(distance) {\n        return await this.#turnPage(-1, distance)\n    }\n    async next(distance) {\n        return await this.#turnPage(1, distance)\n    }\n    async pan(dx, dy) {\n        if (this.#locked) return\n        this.#locked = true\n        this.scrollBy(dx, dy)\n        this.#locked = false\n    }\n    prevSection() {\n        return this.goTo({ index: this.#adjacentIndex(-1) })\n    }\n    nextSection() {\n        return this.goTo({ index: this.#adjacentIndex(1) })\n    }\n    firstSection() {\n        const index = this.sections.findIndex(section => section.linear !== 'no')\n        return this.goTo({ index })\n    }\n    lastSection() {\n        const index = this.sections.findLastIndex(section => section.linear !== 'no')\n        return this.goTo({ index })\n    }\n    getContents() {\n        if (this.#view) return [{\n            index: this.#index,\n            overlayer: this.#view.overlayer,\n            doc: this.#view.document,\n        }]\n        return []\n    }\n    setStyles(styles) {\n        this.#styles = styles\n        const $$styles = this.#styleMap.get(this.#view?.document)\n        if (!$$styles) return\n        const [$beforeStyle, $style] = $$styles\n        if (Array.isArray(styles)) {\n            const [beforeStyle, style] = styles\n            $beforeStyle.textContent = beforeStyle\n            $style.textContent = style\n        } else $style.textContent = styles\n\n        // NOTE: needs `requestAnimationFrame` in Chromium\n        requestAnimationFrame(() => {\n            this.#replaceBackground(this.#view.docBackground, this.columnCount)\n        })\n\n        // needed because the resize observer doesn't work in Firefox\n        this.#view?.document?.fonts?.ready?.then(() => this.#view.expand())\n    }\n    focusView() {\n        this.#view.document.defaultView.focus()\n    }\n    destroy() {\n        this.#observer.unobserve(this)\n        this.#view.destroy()\n        this.#view = null\n        this.sections[this.#index]?.unload?.()\n        this.#mediaQuery.removeEventListener('change', this.#mediaQueryListener)\n    }\n}\n\ncustomElements.define('foliate-paginator', Paginator)\n"],"names":[],"mappings":"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"}}]
}